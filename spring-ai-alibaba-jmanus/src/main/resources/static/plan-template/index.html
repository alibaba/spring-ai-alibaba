<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®¡åˆ’-æ‰§è¡Œ ç¼–è¾‘å™¨ - JTaskPilot</title>
    <!-- å¼•å…¥æ¨¡å—åŒ–CSSæ–‡ä»¶ -->
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/content.css">
    <link rel="stylesheet" href="../css/chat.css">
    <link rel="stylesheet" href="../css/input.css">
    <link rel="stylesheet" href="../css/right-sidebar.css">
    <link rel="stylesheet" href="css/plan-template.css">
    <link rel="stylesheet" href="css/chat-area.css">
    <link rel="stylesheet" href="css/sidebar-collapse.css">
    <style>
        /* Simple icons for demo */
        .icon-placeholder::before {
            content: "â–¡";
            display: inline-block;
            margin-right: 5px;
        }

        .icon-collapse-left::before {
            content: "â—€";
        }

        .icon-expand-left::before {
            content: "â–¶";
        }

        .icon-collapse-right::before {
            content: "â–¶";
        }

        .icon-expand-right::before {
            content: "â—€";
        }

        .icon-terminal::before {
            content: ">_";
        }

        .icon-play::before {
            content: "â–º";
        }

        .icon-realtime::before {
            content: "â—";
            color: #1a73e8;
        }

        .icon-menu::before {
            content: "â‹®";
        }

        .icon-share::before {
            content: "â†‘";
        }

        .icon-star-outline::before {
            content: "â˜†";
        }

        .icon-star-filled::before {
            content: "â˜…";
        }

        .icon-lightbulb::before {
            content: "ğŸ’¡";
        }

        .icon-attach::before {
            content: "ğŸ“";
        }

        .icon-send::before {
            content: "â†‘";
        }

        .icon-add::before {
            content: "+";
        }

        .icon-folder::before {
            content: "ğŸ“";
        }

        .icon-pages::before {
            content: "ğŸ“„";
        }

        .icon-down-arrow::before {
            content: "â–¼";
        }

        .icon-up-arrow::before {
            content: "â–²";
        }

        .icon-edit::before {
            content: "âœ";
        }

        .icon-run::before {
            content: "â–¶";
        }

        .icon-save::before {
            content: "ğŸ’¾";
        }

        .icon-back::before {
            content: "â¬…";
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- å·¦ä¾§è¾¹æ  - å·²ç®€åŒ– -->
        <aside class="sidebar left-sidebar" id="leftSidebar">
            <div class="sidebar-top-icons">
                <div class="icon">[M]</div>
                <div class="icon">[G]</div>
            </div>
            <button class="new-task-btn">
                <span class="icon-add"></span> æ–°å»ºè®¡åˆ’ <span class="shortcut">âŒ˜ K</span>
            </button>
            <ul class="task-list">
                <li class="task-item">
                    <div class="task-icon">[ğŸ“Š]</div>
                    <div class="task-details">
                        <div class="task-title">æ·±åº¦åˆ†æMCPæ ¸å¿ƒæŠ€æœ¯åŸç†</div>
                        <div class="task-preview">æˆ‘å·²ç»æˆåŠŸå°†MCPæ ¸å¿ƒæŠ€æœ¯åŸç†åˆ†ææŠ¥...</div>
                    </div>
                    <div class="task-time">6å°æ—¶å‰</div>
                </li>
                <li class="task-item selected">
                    <div class="task-icon">[ğŸ›¡ï¸]</div>
                    <div class="task-details">
                        <div class="task-title">JTaskPilot æ ¸å¿ƒæŠ€æœ¯è®²è§£ä¸å¼€æº...</div>
                        <div class="task-preview">æˆ‘å·²ç»æˆåŠŸå°†JTaskPilot AIæŒ‡å—ç½‘ç«™éƒ¨ç½²åˆ°...</div>
                    </div>
                    <div class="task-time">2å¤©å‰</div>
                </li>
            </ul>
            <div class="sidebar-bottom">
                <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content-wrapper" id="mainContent">
            <header class="content-header">
                <div class="header-controls-left">
                    <button id="toggleLeftSidebarBtn" class="action-btn toggle-btn" title="åˆ‡æ¢å·¦ä¾§è¾¹æ ">
                        <span class="icon-collapse-left"></span>
                    </button>
                    <div class="header-title-section">
                        <h1>è®¡åˆ’-æ‰§è¡Œ ç¼–è¾‘å™¨</h1>
                        <div class="knowledge-suggestion">
                            <span class="icon-lightbulb"></span> å¯ä»¥åŸºäºpromptç”Ÿæˆå’Œä¿®æ”¹æ‰§è¡Œè®¡åˆ’ï¼Œè¯¦ç»†çš„è®¡åˆ’æ­¥éª¤å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œæ¥è·å–æ›´å‡†ç¡®çš„æ‰§è¡Œç»“æœã€‚
                        </div>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="backToMainBtn" class="action-btn" onclick="window.location.href='../index.html'">
                        <span class="icon-back"></span> è¿”å›ä¸»é¡µ
                    </button>
                    <button id="toggleRightSidebarBtn" class="action-btn toggle-btn" title="åˆ‡æ¢å³ä¾§è¾¹æ ">
                        <span class="icon-collapse-right"></span>
                    </button>
                </div>
            </header>

            <div class="plan-container">
                <div class="plan-input-section">
                    <div class="section-header">
                        <h2>Step1: éœ€æ±‚è¾“å…¥</h2>
                        <div class="section-actions">
                            <button class="action-btn" id="clearBtn">
                                <span class="icon-placeholder"></span> æ¸…ç©º
                            </button>
                        </div>
                    </div>
                    <div class="input-field">
                        <label for="plan-prompt">ä»»åŠ¡æè¿°ï¼š</label>
                        <textarea id="plan-prompt"
                            placeholder="è¯·è¾“å…¥æ‚¨çš„ä»»åŠ¡éœ€æ±‚ï¼Œç³»ç»Ÿå°†åŸºäºæ­¤ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œå¦‚æœæ˜¯æ—¢æœ‰è®¡åˆ’ï¼Œå¯ä»¥è¾“å…¥ä¿®æ”¹æ–¹æ¡ˆï¼Œä»–ä¼šç»“åˆä¹‹å‰çš„è®¡åˆ’ï¼Œå°†æ–°éœ€æ±‚è‡ªåŠ¨æ·»åŠ åˆ°è®¡åˆ’ä¸­..."></textarea>
                    </div>
                    <div class="submit-area">
                        <button class="submit-btn" id="generatePlanBtn">
                            <span class="icon-placeholder"></span> ç”Ÿæˆè®¡åˆ’æ¨¡æ¿
                        </button>
                    </div>
                </div>


                <div class="plan-json-section">
                    <div class="section-header">
                        <h2>Step2: è®¡åˆ’æ¨¡æ¿ç²¾è°ƒ</h2>
                        <div class="section-actions">
                            <button class="action-btn" id="rollbackJsonBtn" title="å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬">
                                <span class="icon-back"></span> å›æ»š
                            </button>
                            <button class="action-btn" id="restoreJsonBtn" title="æ¢å¤åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬">
                                <span class="icon-run"></span> æ¢å¤
                            </button>
                        </div>
                    </div>
                    <div class="plan-json-preview">
                        <!-- é»˜è®¤æ˜¾ç¤ºç¼–è¾‘å™¨è€Œä¸æ˜¯åªè¯»è§†å›¾ -->
                        <textarea id="plan-json-editor" class="preview-content code-view"
                            placeholder="è®¡åˆ’çš„JSONæ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º..."></textarea>
                    </div>
                    <div class="save-plan-container">
                        <button class="secondary-btn" id="modifyPlanBtn">
                            <span class="icon-save"></span> ä¿å­˜è®¡åˆ’
                        </button>
                    </div>
                </div>

                <div class="plan-execution-section">


                    <div class="section-header">
                        <h2>Step3: è®¡åˆ’æ‰§è¡Œæ§åˆ¶</h2>
                    </div>
                    <div class="plan-param-section">
                        <div>é™„åŠ é¢å¤–å‚æ•°</div>
                        <div class="input-field">
                            <textarea id="plan-params"
                                placeholder="å¯é€‰ï¼šè¯·è¾“å…¥è®¡åˆ’æ‰§è¡Œéœ€è¦çš„å‚æ•° ï¼Œä¼šä½œä¸ºé¢å¤–å‚æ•°ç»™åˆ°æ¨¡å‹ ï¼Œ æ ¼å¼è‡ªå®šä¹‰åªè¦èƒ½è·Ÿæ¨¡å‹çš„æ‰§è¡Œpromptå¯¹åº”å³å¯ã€‚ ä¾‹å¦‚ å˜é‡1ï¼š xxx  ï¼Œé‚£ä¹ˆæ‰§è¡Œè®¡åˆ’é‡Œé¢æœ‰ å˜é‡1 ï¼Œæ¨¡å‹å°±ä¼šè‡ªå·±æ›¿æ¢"></textarea>
                        </div>
                        <div class="execution-buttons">
                            <button class="secondary-btn" id="clearParamBtn" title="æ¸…ç©ºå‚æ•°">
                                <span class="icon-placeholder"></span> æ¸…ç©º
                            </button>
                            <button class="primary-btn" id="runPlanBtn">
                                <span class="icon-run"></span> æ‰§è¡Œè®¡åˆ’
                            </button>
                        </div>
                    </div>
                    <div class="plan-actions">
                        <div class="api-call-link">
                            # ä¹Ÿå¯ä»¥é€šè¿‡getæ–¹æ³•é‡å¤è°ƒç”¨é“¾æ¥:
                            <div class="api-url-container">
                                <span class="api-url">http://your-domain/api/plan-template/execute/<span
                                        class="dynamic-id">template_xxxx</span></span>
                            </div>
                            <div class="api-description">
                                <span># è°ƒç”¨ä¼šè¿”å›ç»“æœæ ·ä¾‹: {"planId": "plan_xxxx", "status": "processing", "message":
                                    "è®¡åˆ’æ‰§è¡Œè¯·æ±‚å·²æäº¤ï¼Œæ­£åœ¨å¤„ç†ä¸­"}</span>
                            </div>
                            <div class="api-description">
                                <span># å¯ç›‘æ§æ‰§è¡ŒçŠ¶æ€: http://your-domain/api/executor/details/<span
                                        class="dynamic-plan-id">plan_xxxx</span></span>
                            </div>
                        </div>

                    </div>
                </div>



                <div class="chat-area">
                    <!-- èŠå¤©æ¶ˆæ¯å°†åœ¨æ­¤å¤„åŠ¨æ€ç”Ÿæˆ -->
                </div>
        </main>

        <!-- å³ä¾§è¾¹æ  -->
        <aside class="sidebar right-sidebar" id="rightSidebar">
            <div class="right-sidebar-header">
                <h3>æ‰§è¡Œè¯¦æƒ…</h3>
            </div>
            <div class="right-sidebar-content">
                <!-- æ‰§è¡Œè¯¦æƒ…å°†åœ¨è¿™é‡ŒåŠ¨æ€å¡«å…… -->
                <div class="no-selection-message">
                    <p>ç‚¹å‡»æ‰§è¡Œè®¡åˆ’åæŸ¥çœ‹è¯¦æƒ…</p>
                </div>
            </div>
            <div class="right-sidebar-footer">
                <div class="playback-controls">
                    <button class="icon-play"></button>
                    <div class="progress-bar-stub"></div>
                </div>
                <button class="realtime-btn">
                    <span class="icon-play"></span> è·³åˆ°å®æ—¶
                </button>
                <span class="realtime-indicator">
                    <span class="icon-realtime"></span> å®æ—¶
                </span>
            </div>
            <div class="right-sidebar-status-bar">
                <span id="execution-status">æœªé€‰æ‹©æ‰§è¡Œæ­¥éª¤</span>
                <span id="execution-progress">0 / 0 <span class="icon-up-arrow"></span></span>
            </div>
        </aside>
    </div>

    <!-- å¼•å…¥æ¨¡å—åŒ–JavaScriptæ–‡ä»¶ -->
    <script src="../js/api.js"></script>
    <script src="../js/ui-event-common.js"></script>
    <!-- å¼•å…¥å³ä¾§è¾¹æ å’ŒèŠå¤©å¤„ç†å™¨ -->
    <script src="../js/right-sidebar.js"></script>
    <script src="../js/chat-handler.js"></script>

    <script src="../js/plan-execution-manager.js"></script>

    <!-- å¼•å…¥è®¡åˆ’æ¨¡æ¿é¡µé¢ç‰¹æœ‰çš„JSæ–‡ä»¶ -->
    <script src="js/plan-prompt-generator.js"></script>
    <script src="js/plan-template-handler.js"></script>
    <script src="js/plan-template-list-ui-handler.js"></script>
    <script src="js/template-helpers.js"></script>
    <script src="js/plan-template-execution-controller.js"></script>

    <script src="js/plan-template-main.js"></script> <!-- Ensure plan-template-main.js is loaded -->

</body>

</html>
