var Ee=Object.defineProperty;var xe=(F,t,s)=>t in F?Ee(F,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):F[t]=s;var ge=(F,t,s)=>xe(F,typeof t!="symbol"?t+"":t,s);import{_ as le,I as L}from"./_plugin-vue_export-helper-XLqeYZ5Y.js";import{d as ie,c as r,o as i,e,t as o,f as ve,r as I,x as re,g as H,h as Ce,i as x,u as f,b as B,q as U,w as D,v as se,F as j,j as K,p as Q,C as Ve,a as de,z as ae,T as $e,D as Pe,E as Se,s as _e,B as me,G as Me,k as Ue,H as Be,I as ye}from"./index-BZbJwECV.js";import{L as Ge}from"./index-BYo4zL21.js";const Ie={class:"switch"},Le=["checked"],Oe={class:"switch-label"},Fe=ie({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(F,{emit:t}){const s=t,C=$=>{const v=$.target.checked;s("update:switchValue",v)};return($,v)=>(i(),r("label",Ie,[e("input",{type:"checkbox",checked:$.enabled,onChange:C},null,40,Le),v[0]||(v[0]=e("span",{class:"slider"},null,-1)),e("span",Oe,o($.label),1)]))}}),Re=le(Fe,[["__scopeId","data-v-d484b4a3"]]);class pe{static async getConfigsByGroup(t){try{const s=await fetch(`${this.BASE_URL}/group/${t}`);if(!s.ok)throw new Error(`Failed to get ${t} group configuration: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get ${t} group configuration:`,s),s}}static async batchUpdateConfigs(t){if(t.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const s=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error(`Batch update configuration failed: ${s.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(s){return console.error("Batch update configuration failed:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}static async getConfigById(t){try{const s=await fetch(`${this.BASE_URL}/${t}`);if(!s.ok)throw new Error(`Failed to get configuration item: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get configuration item[${t}]:`,s),s}}static async updateConfig(t){try{const s=await fetch(`${this.BASE_URL}/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error(`Failed to update configuration item: ${s.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(s){return console.error("Failed to update configuration item:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}}ge(pe,"BASE_URL","/api/config");const Ne={class:"config-panel"},De={class:"config-header"},je={class:"header-left"},Ke={class:"config-stats"},qe={class:"stat-item"},Je={class:"stat-value"},ze={key:0,class:"stat-item"},He={class:"stat-value modified"},Xe={class:"header-right"},Ye={class:"import-export-actions"},Qe={class:"action-btn",title:"导入配置"},We={class:"search-box"},Ze=["placeholder"],et={key:0,class:"loading-container"},tt={key:1,class:"config-groups"},st={class:"group-header"},ot={class:"group-info"},nt={class:"group-icon"},at={class:"group-actions"},lt=["onClick","disabled","title"],it={class:"sub-groups"},ct=["onClick"],rt={class:"sub-group-info"},dt={class:"sub-group-title"},ut={class:"item-count"},pt={class:"config-items"},gt={key:0,class:"config-item-content vertical-layout"},ft={class:"config-item-info"},vt={class:"config-item-header"},ht={class:"config-label"},mt={class:"type-badge boolean"},yt={key:0,class:"modified-badge"},_t=["title"],bt={class:"config-control"},Ct=["value","onChange"],$t=["value"],wt={key:1,class:"config-item-content vertical-layout"},kt={class:"config-item-info"},St={class:"config-item-header"},Tt={class:"config-label"},At={class:"type-badge select"},Et={key:0,class:"modified-badge"},xt=["title"],Vt={class:"config-control"},Pt=["value","onChange"],Mt=["value"],Ut={key:2,class:"config-item-content vertical-layout"},Bt={class:"config-item-info"},Gt={class:"config-item-header"},It={class:"config-label"},Lt={class:"type-badge textarea"},Ot={key:0,class:"modified-badge"},Ft=["title"],Rt={class:"config-control"},Nt=["value","onInput"],Dt={key:3,class:"config-item-content vertical-layout"},jt={class:"config-item-info"},Kt={class:"config-item-header"},qt={class:"config-label"},Jt={class:"type-badge number"},zt={key:0,class:"modified-badge"},Ht=["title"],Xt={key:0,class:"config-meta"},Yt={class:"range-info"},Qt={class:"config-control"},Wt=["value","onInput","min","max"],Zt={key:4,class:"config-item-content vertical-layout"},es={class:"config-item-info"},ts={class:"config-item-header"},ss={class:"config-label"},os={class:"type-badge string"},ns={key:0,class:"modified-badge"},as=["title"],ls={class:"config-control"},is=["value","onInput"],cs={key:2,class:"empty-state"},rs=ie({__name:"basicConfig",setup(F){const{t}=ve(),s=I(!0),C=I(!1),$=I([]),v=I(new Map),g=I(new Set),A=re({show:!1,text:"",type:"success"}),k=I(""),q={maxSteps:"智能体执行最大步数",resetAllAgents:"重置所有agent",maxMemory:"能记住的最大消息数",headlessBrowser:"是否使用无头浏览器模式",browserTimeout:t("config.basicConfig.browserTimeout"),browserDebug:"浏览器debug模式",autoOpenBrowser:"启动时自动打开浏览器",consoleInteractive:"启用控制台交互模式",systemName:"系统名称",language:"默认语言",maxThreads:"最大线程数",timeoutSeconds:t("config.basicConfig.requestTimeout")},O={manus:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置"},E={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},W={agent:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置",general:"常规设置"},oe=H(()=>$.value.some(n=>n.subGroups.some(p=>p.items.some(_=>v.value.get(_.id)!==_.configValue)))),G=n=>n==="true",V=n=>parseFloat(n)||0,u=n=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[n]||1,P=n=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[n]||1e4,X=n=>typeof n=="string"?n:n.value,ce=n=>typeof n=="string"?n:n.label,ue=(n,p)=>{if(typeof p=="boolean")return p.toString();if(typeof p=="string"){if(n.options&&n.options.length>0){const _=n.options.find(y=>(typeof y=="string"?y:y.label)===p||(typeof y=="string"?y:y.value)===p);if(_)return typeof _=="string"?_:_.value}return p}return String(p)},J=(n,p,_=!1)=>{let y;n.inputType==="BOOLEAN"||n.inputType==="CHECKBOX"?y=ue(n,p):y=String(p),n.configValue!==y&&(n.configValue=y,n._modified=!0,(_||n.inputType==="BOOLEAN"||n.inputType==="CHECKBOX"||n.inputType==="SELECT")&&d())};let m=null;const d=()=>{m&&clearTimeout(m),m=window.setTimeout(()=>{c()},500)},h=(n,p="success")=>{A.text=n,A.type=p,A.show=!0,setTimeout(()=>{A.show=!1},3e3)},M=async()=>{try{s.value=!0;const p=["manus","browser","interaction","system","performance"].map(async y=>{try{const a=await pe.getConfigsByGroup(y);if(a.length===0)return null;const w=a.map(R=>({...R,displayName:R.description??(q[R.configKey]||R.configKey),min:u(R.configKey),max:P(R.configKey)}));w.forEach(R=>{v.value.set(R.id,R.configValue)});const S=new Map;w.forEach(R=>{const z=R.configSubGroup??"general";S.has(z)||S.set(z,[]),S.get(z).push(R)});const N=Array.from(S.entries()).map(([R,z])=>({name:R,displayName:W[R]||R,items:z}));return{name:y,displayName:O[y]||y,subGroups:N}}catch(a){return console.warn(`加载配置组 ${y} 失败，跳过:`,a),null}}),_=await Promise.all(p);$.value=_.filter(y=>y!==null),console.log("配置加载完成:",$.value)}catch(n){console.error("加载配置失败:",n),h(t("config.basicConfig.loadConfigFailed"),"error")}finally{s.value=!1}},c=async()=>{if(!(C.value||!oe.value))try{C.value=!0;const n=[];if($.value.forEach(_=>{_.subGroups.forEach(y=>{const a=y.items.filter(w=>w._modified);n.push(...a)})}),n.length===0){h("没有需要保存的修改");return}const p=await pe.batchUpdateConfigs(n);p.success?(n.forEach(_=>{v.value.set(_.id,_.configValue),_._modified=!1}),h("配置保存成功")):h(p.message||"保存失败","error")}catch(n){console.error("保存配置失败:",n),h(t("config.basicConfig.saveFailed"),"error")}finally{C.value=!1}},l=async n=>{if(confirm(`确定要重置 "${O[n]||n}" 组的所有配置吗？`))try{C.value=!0;const _=$.value.find(w=>w.name===n);if(!_)return;const y=[];if(_.subGroups.forEach(w=>{w.items.forEach(S=>{const N=T(S.configKey);N!==S.configValue&&y.push({...S,configValue:N})})}),y.length===0){h("该组配置已是默认值");return}const a=await pe.batchUpdateConfigs(y);a.success?(await M(),h(`成功重置 ${y.length} 项配置`)):h(a.message||"重置失败","error")}catch(_){console.error("重置组配置失败:",_),h(t("config.basicConfig.resetFailed"),"error")}finally{C.value=!1}},T=n=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[n]||"",b=(n,p)=>{const _=`${n}-${p}`;g.value.has(_)?g.value.delete(_):g.value.add(_)},Z=(n,p)=>g.value.has(`${n}-${p}`),ee=H(()=>{const n=$.value.reduce((_,y)=>_+y.subGroups.reduce((a,w)=>a+w.items.length,0),0),p=$.value.reduce((_,y)=>_+y.subGroups.reduce((a,w)=>a+w.items.filter(S=>v.value.get(S.id)!==S.configValue).length,0),0);return{total:n,modified:p}}),Y=H(()=>{if(!k.value.trim())return $.value;const n=k.value.toLowerCase();return $.value.map(p=>({...p,subGroups:p.subGroups.map(_=>({..._,items:_.items.filter(y=>y.displayName.toLowerCase().includes(n)||y.configKey.toLowerCase().includes(n)||y.description&&y.description.toLowerCase().includes(n))})).filter(_=>_.items.length>0)})).filter(p=>p.subGroups.length>0)}),ne=()=>{try{const n={timestamp:new Date().toISOString(),version:"1.0",configs:$.value.reduce((a,w)=>(w.subGroups.forEach(S=>{S.items.forEach(N=>{a[N.configKey]=N.configValue})}),a),{})},p=JSON.stringify(n,null,2),_=new Blob([p],{type:"application/json"}),y=document.createElement("a");y.href=URL.createObjectURL(_),y.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,y.click(),h("配置导出成功")}catch(n){console.error("导出配置失败:",n),h("导出失败","error")}},we=n=>{var a;const p=n.target,_=(a=p.files)==null?void 0:a[0];if(!_)return;const y=new FileReader;y.onload=async w=>{var S;try{const N=JSON.parse((S=w.target)==null?void 0:S.result);if(!N.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;C.value=!0;const z=[];if($.value.forEach(Te=>{Te.subGroups.forEach(Ae=>{Ae.items.forEach(he=>{Object.prototype.hasOwnProperty.call(N.configs,he.configKey)&&z.push({...he,configValue:N.configs[he.configKey]})})})}),z.length===0){h("没有找到可导入的配置项");return}const ke=await pe.batchUpdateConfigs(z);ke.success?(await M(),h(`成功导入 ${z.length} 项配置`)):h(ke.message||"导入失败","error")}catch(N){console.error("导入配置失败:",N),h(t("config.basicConfig.importFailed"),"error")}finally{C.value=!1,p.value=""}},y.readAsText(_)};return Ce(()=>{M()}),(n,p)=>(i(),r("div",Ne,[e("div",De,[e("div",je,[e("h2",null,o(f(t)("config.basicConfig.title")),1),e("div",Ke,[e("span",qe,[p[1]||(p[1]=e("span",{class:"stat-label"},"总配置项:",-1)),e("span",Je,o(ee.value.total),1)]),ee.value.modified>0?(i(),r("span",ze,[p[2]||(p[2]=e("span",{class:"stat-label"},"已修改:",-1)),e("span",He,o(ee.value.modified),1)])):B("",!0)])]),e("div",Xe,[e("div",Ye,[e("button",{onClick:ne,class:"action-btn",title:"导出配置"}," 📤 "),e("label",Qe,[p[3]||(p[3]=U(" 📥 ")),e("input",{type:"file",accept:".json",onChange:we,style:{display:"none"}},null,32)])]),e("div",We,[D(e("input",{"onUpdate:modelValue":p[0]||(p[0]=_=>k.value=_),type:"text",placeholder:n.$t("config.search"),class:"search-input"},null,8,Ze),[[se,k.value]]),p[4]||(p[4]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(i(),r("div",et,[p[5]||(p[5]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,o(n.$t("config.loading")),1)])):Y.value.length>0?(i(),r("div",tt,[(i(!0),r(j,null,K(Y.value,_=>(i(),r("div",{key:_.name,class:"config-group"},[e("div",st,[e("div",ot,[e("span",nt,o(E[_.name]||"⚙️"),1)]),e("div",at,[e("button",{onClick:y=>l(_.name),class:"reset-btn",disabled:C.value,title:n.$t("config.resetGroupConfirm")},o(n.$t("config.reset")),9,lt)]),p[6]||(p[6]=e("div",{class:"group-divider"},null,-1))]),e("div",it,[(i(!0),r(j,null,K(_.subGroups,y=>(i(),r("div",{key:y.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:a=>b(_.name,y.name)},[e("div",rt,[p[7]||(p[7]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",dt,o(y.displayName),1),e("span",ut,"("+o(y.items.length)+")",1)]),e("span",{class:Q(["collapse-icon",{collapsed:Z(_.name,y.name)}])}," ▼ ",2)],8,ct),D(e("div",pt,[(i(!0),r(j,null,K(y.items,a=>(i(),r("div",{key:a.id,class:Q(["config-item",{modified:v.value.get(a.id)!==a.configValue}])},[a.inputType==="BOOLEAN"||a.inputType==="CHECKBOX"?(i(),r("div",gt,[e("div",ft,[e("div",vt,[e("label",ht,[U(o(a.description||a.displayName)+" ",1),e("span",mt,o(a.inputType==="CHECKBOX"?n.$t("config.types.checkbox"):n.$t("config.types.boolean")),1),v.value.get(a.id)!==a.configValue?(i(),r("span",yt,o(n.$t("config.modified")),1)):B("",!0)]),e("span",{class:"config-key",title:a.configKey},o(a.configKey),9,_t)])]),e("div",bt,[a.options&&a.options.length>0?(i(),r("select",{key:0,class:"config-input select-input",value:a.configValue,onChange:w=>{var S;return J(a,((S=w.target)==null?void 0:S.value)||"")}},[(i(!0),r(j,null,K(a.options,w=>(i(),r("option",{key:X(w),value:X(w)},o(ce(w)),9,$t))),128))],40,Ct)):(i(),de(Re,{key:1,enabled:G(a.configValue),label:"","onUpdate:switchValue":w=>J(a,w)},null,8,["enabled","onUpdate:switchValue"]))])])):a.inputType==="SELECT"?(i(),r("div",wt,[e("div",kt,[e("div",St,[e("label",Tt,[U(o(a.description||a.displayName)+" ",1),e("span",At,o(n.$t("config.types.select")),1),v.value.get(a.id)!==a.configValue?(i(),r("span",Et,o(n.$t("config.modified")),1)):B("",!0)]),e("span",{class:"config-key",title:a.configKey},o(a.configKey),9,xt)])]),e("div",Vt,[e("select",{class:"config-input select-input",value:a.configValue,onChange:w=>{var S;return J(a,((S=w.target)==null?void 0:S.value)||"")}},[(i(!0),r(j,null,K(a.options||[],w=>(i(),r("option",{key:X(w),value:X(w)},o(ce(w)),9,Mt))),128))],40,Pt)])])):a.inputType==="TEXTAREA"?(i(),r("div",Ut,[e("div",Bt,[e("div",Gt,[e("label",It,[U(o(a.description||a.displayName)+" ",1),e("span",Lt,o(n.$t("config.types.textarea")),1),v.value.get(a.id)!==a.configValue?(i(),r("span",Ot,o(n.$t("config.modified")),1)):B("",!0)]),e("span",{class:"config-key",title:a.configKey},o(a.configKey),9,Ft)])]),e("div",Rt,[e("textarea",{class:"config-input textarea-input",value:a.configValue,onInput:w=>{var S;return J(a,((S=w.target)==null?void 0:S.value)||"")},onBlur:d,rows:"3"},null,40,Nt)])])):a.inputType==="NUMBER"?(i(),r("div",Dt,[e("div",jt,[e("div",Kt,[e("label",qt,[U(o(a.description||a.displayName)+" ",1),e("span",Jt,o(n.$t("config.types.number")),1),v.value.get(a.id)!==a.configValue?(i(),r("span",zt,o(n.$t("config.modified")),1)):B("",!0)]),e("span",{class:"config-key",title:a.configKey},o(a.configKey),9,Ht),a.min||a.max?(i(),r("div",Xt,[e("span",Yt,o(n.$t("config.range"))+": "+o(a.min||0)+" - "+o(a.max||"∞"),1)])):B("",!0)])]),e("div",Qt,[e("input",{type:"number",class:"config-input number-input",value:V(a.configValue),onInput:w=>{var S;return J(a,((S=w.target)==null?void 0:S.value)||"")},onBlur:d,min:a.min||1,max:a.max||1e4},null,40,Wt)])])):(i(),r("div",Zt,[e("div",es,[e("div",ts,[e("label",ss,[U(o(a.description||a.displayName)+" ",1),e("span",os,o(a.inputType==="TEXT"?n.$t("config.types.text"):n.$t("config.types.string")),1),v.value.get(a.id)!==a.configValue?(i(),r("span",ns,o(n.$t("config.modified")),1)):B("",!0)]),e("span",{class:"config-key",title:a.configKey},o(a.configKey),9,as)])]),e("div",ls,[e("input",{type:"text",class:"config-input text-input",value:a.configValue,onInput:w=>{var S;return J(a,((S=w.target)==null?void 0:S.value)||"")},onBlur:d},null,40,is)])]))],2))),128))],512),[[Ve,!Z(_.name,y.name)]])]))),128))])]))),128))])):(i(),r("div",cs,[e("p",null,o(n.$t("config.notFound")),1)])),x($e,{name:"message-fade"},{default:ae(()=>[A.show?(i(),r("div",{key:0,class:Q(["message-toast",A.type])},o(A.text),3)):B("",!0)]),_:1})]))}}),ds=le(rs,[["__scopeId","data-v-99a0498e"]]),us={class:"modal-header"},ps={class:"modal-content"},gs={class:"modal-footer"},fs=ie({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(F){const t=s=>{s.target===s.currentTarget&&(s.stopPropagation(),s.preventDefault())};return(s,C)=>(i(),de(Pe,{to:"body"},[x($e,{name:"modal"},{default:ae(()=>[F.modelValue?(i(),r("div",{key:0,class:"modal-overlay",onClick:t},[e("div",{class:"modal-container",onClick:C[3]||(C[3]=_e(()=>{},["stop"]))},[e("div",us,[e("h3",null,o(F.title),1),e("button",{class:"close-btn",onClick:C[0]||(C[0]=$=>s.$emit("update:modelValue",!1))},[x(f(L),{icon:"carbon:close"})])]),e("div",ps,[Se(s.$slots,"default",{},void 0,!0)]),e("div",gs,[Se(s.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:C[1]||(C[1]=$=>s.$emit("update:modelValue",!1))},o(s.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:C[2]||(C[2]=$=>s.$emit("confirm"))},o(s.$t("common.confirm")),1)],!0)])])])):B("",!0)]),_:3})]))}}),be=le(fs,[["__scopeId","data-v-baaf1c89"]]),vs={class:"tool-selection-content"},hs={class:"tool-controls"},ms={class:"search-container"},ys={class:"sort-container"},_s={class:"tool-summary"},bs={class:"summary-text"},Cs={key:0,class:"tool-groups"},$s=["onClick"],ws={class:"group-title-area"},ks={class:"group-name"},Ss={class:"group-count"},Ts={class:"group-enable-all"},As=["checked","onChange","data-group"],Es={class:"tool-info"},xs={class:"tool-selection-name"},Vs={key:0,class:"tool-selection-desc"},Ps={class:"tool-actions"},Ms=["checked","onChange"],Us={key:1,class:"empty-state"},Bs=ie({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(F,{emit:t}){const s=F,C=t,$=H({get:()=>s.modelValue,set:m=>C("update:modelValue",m)}),v=I(""),g=I("group"),A=I(new Set),k=I([]),q=(m,d)=>{const h=document.querySelector(`input[data-group="${m}"]`);h&&(h.indeterminate=P(d))};me(()=>s.selectedToolIds,m=>{k.value=[...m]},{immediate:!0});const O=H(()=>{let m=s.tools.filter(d=>d.key);if(v.value){const d=v.value.toLowerCase();m=m.filter(h=>{var M;return h.name.toLowerCase().includes(d)||h.description.toLowerCase().includes(d)||(((M=h.serviceGroup)==null?void 0:M.toLowerCase().includes(d))??!1)})}switch(g.value){case"name":m=[...m].sort((d,h)=>d.name.localeCompare(h.name));break;case"enabled":m=[...m].sort((d,h)=>{const M=k.value.includes(d.key),c=k.value.includes(h.key);return M&&!c?-1:!M&&c?1:d.name.localeCompare(h.name)});break;case"group":default:m=[...m].sort((d,h)=>{const M=d.serviceGroup??"未分组",c=h.serviceGroup??"未分组";return M!==c?M.localeCompare(c):d.name.localeCompare(h.name)});break}return m}),E=H(()=>{const m=new Map;return O.value.forEach(d=>{const h=d.serviceGroup??"未分组";m.has(h)||m.set(h,[]),m.get(h).push(d)}),new Map([...m.entries()].sort())}),W=H(()=>O.value.length);me([k,E],()=>{Ue(()=>{for(const[m,d]of E.value)q(m,d)})},{flush:"post",deep:!1});const oe=m=>k.value.includes(m),G=(m,d)=>{d.stopPropagation();const M=d.target.checked;if(!m){console.error("toolKey is undefined, cannot proceed");return}M?k.value.includes(m)||(k.value=[...k.value,m]):k.value=k.value.filter(c=>c!==m)},V=m=>m.filter(d=>k.value.includes(d.key)),u=m=>m.length>0&&m.every(d=>k.value.includes(d.key)),P=m=>{const d=V(m).length;return d>0&&d<m.length},X=(m,d)=>{d.stopPropagation();const M=d.target.checked,c=m.map(l=>l.key);if(M){const l=[...k.value];c.forEach(T=>{l.includes(T)||l.push(T)}),k.value=l}else k.value=k.value.filter(l=>!c.includes(l))},ce=m=>{A.value.has(m)?A.value.delete(m):A.value.add(m)},ue=()=>{C("confirm",[...k.value]),C("update:modelValue",!1)},J=()=>{k.value=[...s.selectedToolIds],C("update:modelValue",!1)};return me($,m=>{if(m){A.value.clear();const d=Array.from(E.value.keys());d.length>1&&d.slice(1).forEach(h=>{A.value.add(h)})}}),(m,d)=>(i(),de(be,{modelValue:$.value,"onUpdate:modelValue":[d[4]||(d[4]=h=>$.value=h),J],title:"选择工具",onConfirm:ue},{default:ae(()=>[e("div",vs,[e("div",hs,[e("div",ms,[D(e("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>v.value=h),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[se,v.value]])]),e("div",ys,[D(e("select",{"onUpdate:modelValue":d[1]||(d[1]=h=>g.value=h),class:"sort-select"},d[5]||(d[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Me,g.value]])])]),e("div",_s,[e("span",bs," 共 "+o(E.value.size)+" 个服务组，"+o(W.value)+" 个工具 (已选择 "+o(k.value.length)+" 个) ",1)]),E.value.size>0?(i(),r("div",Cs,[(i(!0),r(j,null,K(E.value,([h,M])=>(i(),r("div",{key:h,class:"tool-group"},[e("div",{class:Q(["tool-group-header",{collapsed:A.value.has(h)}]),onClick:c=>ce(h)},[e("div",ws,[x(f(L),{icon:A.value.has(h)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),x(f(L),{icon:"carbon:folder",class:"group-icon"}),e("span",ks,o(h),1),e("span",Ss," ("+o(V(M).length)+"/"+o(M.length)+") ",1)]),e("div",{class:"group-actions",onClick:d[2]||(d[2]=_e(()=>{},["stop"]))},[e("label",Ts,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:u(M),onChange:c=>X(M,c),"data-group":h},null,40,As),d[6]||(d[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,$s),e("div",{class:Q(["tool-group-content",{collapsed:A.value.has(h)}])},[(i(!0),r(j,null,K(M.filter(c=>c&&c.key),c=>(i(),r("div",{key:c.key,class:"tool-selection-item"},[e("div",Es,[e("div",xs,o(c.name),1),c.description?(i(),r("div",Vs,o(c.description),1)):B("",!0)]),e("div",Ps,[e("label",{class:"tool-enable-switch",onClick:d[3]||(d[3]=_e(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:oe(c.key),onChange:l=>G(c.key,l)},null,40,Ms),d[7]||(d[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(i(),r("div",Us,[x(f(L),{icon:"carbon:tools",class:"empty-icon"}),d[8]||(d[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),Gs=le(Bs,[["__scopeId","data-v-c30d6872"]]);class te{static async handleResponse(t){if(!t.ok)try{const s=await t.json();throw new Error(s.message||`API request failed: ${t.status}`)}catch{throw new Error(`API request failed: ${t.status} ${t.statusText}`)}return t}static async getAllAgents(){try{const t=await fetch(this.BASE_URL);return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to get Agent list:",t),t}}static async getAgentById(t){try{const s=await fetch(`${this.BASE_URL}/${t}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Agent[${t}] details:`,s),s}}static async createAgent(t){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Agent:",s),s}}static async updateAgent(t,s){try{const C=await fetch(`${this.BASE_URL}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(C)).json()}catch(C){throw console.error(`Failed to update Agent[${t}]:`,C),C}}static async deleteAgent(t){try{const s=await fetch(`${this.BASE_URL}/${t}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Agent[${t}]:`,s),s}}static async getAvailableTools(){try{const t=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to get available tools list:",t),t}}}ge(te,"BASE_URL","/api/agents");const Is={class:"config-panel"},Ls={class:"panel-header"},Os={class:"panel-actions"},Fs=["disabled"],Rs={class:"agent-layout"},Ns={class:"agent-list"},Ds={class:"list-header"},js={class:"agent-count"},Ks={key:0,class:"agents-container"},qs=["onClick"],Js={class:"agent-card-header"},zs={class:"agent-name"},Hs={class:"agent-desc"},Xs={key:0,class:"agent-tools"},Ys={key:0,class:"tool-more"},Qs={key:1,class:"loading-state"},Ws={key:2,class:"empty-state"},Zs={key:0,class:"agent-detail"},eo={class:"detail-header"},to={class:"detail-actions"},so={class:"form-item"},oo=["placeholder"],no={class:"form-item"},ao=["placeholder"],lo={class:"form-item"},io=["value","placeholder"],co={class:"tools-section"},ro={class:"assigned-tools"},uo={class:"section-header"},po={class:"tools-grid"},go={class:"tool-info"},fo={class:"tool-name"},vo={class:"tool-desc"},ho={key:0,class:"no-tools"},mo={key:1,class:"no-selection"},yo={class:"modal-form"},_o={class:"form-item"},bo=["placeholder"],Co={class:"form-item"},$o=["placeholder"],wo={class:"form-item"},ko=["value","placeholder"],So={class:"delete-confirm"},To={class:"warning-text"},Ao=ie({__name:"agentConfig",setup(F){const{t}=ve(),s=I(!1),C=I(""),$=I(""),v=re([]),g=I(null),A=re([]),k=I(!1),q=I(!1),O=I(!1),E=re({name:"",description:"",nextStepPrompt:""}),W=c=>{const l=A.find(T=>T.key===c);return l?l.name:c},oe=c=>{const l=A.find(T=>T.key===c);return l?l.description:""},G=(c,l)=>{l==="success"?($.value=c,setTimeout(()=>{$.value=""},3e3)):(C.value=c,setTimeout(()=>{C.value=""},5e3))},V=async()=>{s.value=!0;try{const[c,l]=await Promise.all([te.getAllAgents(),te.getAvailableTools()]),T=c.map(b=>({...b,availableTools:b.availableTools}));v.splice(0,v.length,...T),A.splice(0,A.length,...l),T.length>0&&await u(T[0])}catch(c){console.error("加载数据失败:",c),G(t("config.agentConfig.loadDataFailed")+": "+c.message,"error");const l=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],T=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];A.splice(0,A.length,...l),v.splice(0,v.length,...T),T.length>0&&(g.value=T[0])}finally{s.value=!1}},u=async c=>{try{const l=await te.getAgentById(c.id);g.value={...l,availableTools:l.availableTools}}catch(l){console.error("加载Agent详情失败:",l),G(t("config.agentConfig.loadDetailsFailed")+": "+l.message,"error"),g.value={...c,availableTools:c.availableTools}}},P=()=>{E.name="",E.description="",E.nextStepPrompt="",k.value=!0},X=async()=>{var c;if(!E.name.trim()||!E.description.trim()){G(t("config.agentConfig.requiredFields"),"error");return}try{const l={name:E.name.trim(),description:E.description.trim(),nextStepPrompt:((c=E.nextStepPrompt)==null?void 0:c.trim())??"",availableTools:[]},T=await te.createAgent(l);v.push(T),g.value=T,k.value=!1,G(t("config.agentConfig.createSuccess"),"success")}catch(l){G(t("config.agentConfig.createFailed")+": "+l.message,"error")}},ce=()=>{O.value=!0},ue=c=>{g.value&&(g.value.availableTools=[...c])},J=async()=>{if(g.value){if(!g.value.name.trim()||!g.value.description.trim()){G(t("config.agentConfig.requiredFields"),"error");return}try{const c=await te.updateAgent(g.value.id,g.value),l=v.findIndex(T=>T.id===c.id);l!==-1&&(v[l]=c),g.value=c,G(t("config.agentConfig.saveSuccess"),"success")}catch(c){G(t("config.agentConfig.saveFailed")+": "+c.message,"error")}}},m=()=>{q.value=!0},d=async()=>{if(g.value)try{await te.deleteAgent(g.value.id);const c=v.findIndex(l=>l.id===g.value.id);c!==-1&&v.splice(c,1),g.value=v.length>0?v[0]:null,q.value=!1,G(t("config.agentConfig.deleteSuccess"),"success")}catch(c){G(t("config.agentConfig.deleteFailed")+": "+c.message,"error")}},h=()=>{const c=document.createElement("input");c.type="file",c.accept=".json",c.onchange=l=>{var b;const T=(b=l.target.files)==null?void 0:b[0];if(T){const Z=new FileReader;Z.onload=async ee=>{var Y;try{const ne=JSON.parse((Y=ee.target)==null?void 0:Y.result);if(!ne.name||!ne.description)throw new Error(t("config.agentConfig.invalidFormat"));const{id:we,...n}=ne,p=await te.createAgent(n);v.push(p),g.value=p,G(t("config.agentConfig.importSuccess"),"success")}catch(ne){G(t("config.agentConfig.importFailed")+": "+ne.message,"error")}},Z.readAsText(T)}},c.click()},M=()=>{if(g.value)try{const c=JSON.stringify(g.value,null,2),l=new Blob([c],{type:"application/json"}),T=URL.createObjectURL(l),b=document.createElement("a");b.href=T,b.download=`agent-${g.value.name}-${new Date().toISOString().split("T")[0]}.json`,b.click(),URL.revokeObjectURL(T),G(t("config.agentConfig.exportSuccess"),"success")}catch(c){G(t("config.agentConfig.exportFailed")+": "+c.message,"error")}};return Ce(()=>{V()}),(c,l)=>{var T;return i(),r("div",Is,[e("div",Ls,[e("h2",null,o(f(t)("config.agentConfig.title")),1),e("div",Os,[e("button",{class:"action-btn",onClick:h},[x(f(L),{icon:"carbon:upload"}),U(" "+o(f(t)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:M,disabled:!g.value},[x(f(L),{icon:"carbon:download"}),U(" "+o(f(t)("config.agentConfig.export")),1)],8,Fs)])]),e("div",Rs,[e("div",Ns,[e("div",Ds,[e("h3",null,o(f(t)("config.agentConfig.configuredAgents")),1),e("span",js,"("+o(v.length)+o(f(t)("config.agentConfig.agentCount"))+")",1)]),s.value?B("",!0):(i(),r("div",Ks,[(i(!0),r(j,null,K(v,b=>{var Z,ee;return i(),r("div",{key:b.id,class:Q(["agent-card",{active:((Z=g.value)==null?void 0:Z.id)===b.id}]),onClick:Y=>u(b)},[e("div",Js,[e("span",zs,o(b.name),1),x(f(L),{icon:"carbon:chevron-right"})]),e("p",Hs,o(b.description),1),((ee=b.availableTools)==null?void 0:ee.length)>0?(i(),r("div",Xs,[(i(!0),r(j,null,K(b.availableTools.slice(0,3),Y=>(i(),r("span",{key:Y,class:"tool-tag"},o(W(Y)),1))),128)),b.availableTools.length>3?(i(),r("span",Ys," +"+o(b.availableTools.length-3),1)):B("",!0)])):B("",!0)],10,qs)}),128))])),s.value?(i(),r("div",Qs,[x(f(L),{icon:"carbon:loading",class:"loading-icon"}),U(" "+o(f(t)("common.loading")),1)])):B("",!0),!s.value&&v.length===0?(i(),r("div",Ws,[x(f(L),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,o(f(t)("config.agentConfig.noAgent")),1)])):B("",!0),e("button",{class:"add-btn",onClick:P},[x(f(L),{icon:"carbon:add"}),U(" "+o(f(t)("config.agentConfig.createNew")),1)])]),g.value?(i(),r("div",Zs,[e("div",eo,[e("h3",null,o(g.value.name),1),e("div",to,[e("button",{class:"action-btn primary",onClick:J},[x(f(L),{icon:"carbon:save"}),U(" "+o(f(t)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:m},[x(f(L),{icon:"carbon:trash-can"}),U(" "+o(f(t)("common.delete")),1)])])]),e("div",so,[e("label",null,[U(o(f(t)("config.agentConfig.agentName"))+" ",1),l[12]||(l[12]=e("span",{class:"required"},"*",-1))]),D(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=b=>g.value.name=b),placeholder:f(t)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,oo),[[se,g.value.name]])]),e("div",no,[e("label",null,[U(o(f(t)("config.agentConfig.description"))+" ",1),l[13]||(l[13]=e("span",{class:"required"},"*",-1))]),D(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=b=>g.value.description=b),rows:"3",placeholder:f(t)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,ao),[[se,g.value.description]])]),e("div",lo,[e("label",null,o(f(t)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:g.value.nextStepPrompt||"",onInput:l[2]||(l[2]=b=>g.value.nextStepPrompt=b.target.value),rows:"8",placeholder:f(t)("config.agentConfig.nextStepPromptPlaceholder")},null,40,io)]),e("div",co,[e("h4",null,o(f(t)("config.agentConfig.toolConfiguration")),1),e("div",ro,[e("div",uo,[e("span",null,o(f(t)("config.agentConfig.assignedTools"))+" ("+o((g.value.availableTools||[]).length)+")",1),A.length>0?(i(),r("button",{key:0,class:"action-btn small",onClick:ce},[x(f(L),{icon:"carbon:add"}),U(" "+o(f(t)("config.agentConfig.addRemoveTools")),1)])):B("",!0)]),e("div",po,[(i(!0),r(j,null,K(g.value.availableTools||[],b=>(i(),r("div",{key:b,class:"tool-item assigned"},[e("div",go,[e("span",fo,o(W(b)),1),e("span",vo,o(oe(b)),1)])]))),128)),g.value.availableTools.length===0?(i(),r("div",ho,[x(f(L),{icon:"carbon:tool-box"}),e("span",null,o(f(t)("config.agentConfig.noAssignedTools")),1)])):B("",!0)])])])])):(i(),r("div",mo,[x(f(L),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,o(f(t)("config.agentConfig.selectAgentHint")),1)]))]),x(be,{modelValue:k.value,"onUpdate:modelValue":l[6]||(l[6]=b=>k.value=b),title:f(t)("config.agentConfig.newAgent"),onConfirm:X},{default:ae(()=>[e("div",yo,[e("div",_o,[e("label",null,[U(o(f(t)("config.agentConfig.agentName"))+" ",1),l[14]||(l[14]=e("span",{class:"required"},"*",-1))]),D(e("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=b=>E.name=b),placeholder:f(t)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,bo),[[se,E.name]])]),e("div",Co,[e("label",null,[U(o(f(t)("config.agentConfig.description"))+" ",1),l[15]||(l[15]=e("span",{class:"required"},"*",-1))]),D(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=b=>E.description=b),rows:"3",placeholder:f(t)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,$o),[[se,E.description]])]),e("div",wo,[e("label",null,o(f(t)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:E.nextStepPrompt||"",onInput:l[5]||(l[5]=b=>E.nextStepPrompt=b.target.value),rows:"8",placeholder:f(t)("config.agentConfig.nextStepPromptPlaceholder")},null,40,ko)])])]),_:1},8,["modelValue","title"]),x(Gs,{modelValue:O.value,"onUpdate:modelValue":l[7]||(l[7]=b=>O.value=b),tools:A,"selected-tool-ids":((T=g.value)==null?void 0:T.availableTools)||[],onConfirm:ue},null,8,["modelValue","tools","selected-tool-ids"]),x(be,{modelValue:q.value,"onUpdate:modelValue":l[9]||(l[9]=b=>q.value=b),title:f(t)("config.agentConfig.deleteConfirm")},{footer:ae(()=>[e("button",{class:"cancel-btn",onClick:l[8]||(l[8]=b=>q.value=!1)},o(f(t)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:d},o(f(t)("common.delete")),1)]),default:ae(()=>{var b;return[e("div",So,[x(f(L),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[U(o(f(t)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,o((b=g.value)==null?void 0:b.name),1),U(" "+o(f(t)("common.confirm"))+"？",1)]),e("p",To,o(f(t)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),C.value?(i(),r("div",{key:0,class:"error-toast",onClick:l[10]||(l[10]=b=>C.value="")},[x(f(L),{icon:"carbon:error"}),U(" "+o(C.value),1)])):B("",!0),$.value?(i(),r("div",{key:1,class:"success-toast",onClick:l[11]||(l[11]=b=>$.value="")},[x(f(L),{icon:"carbon:checkmark"}),U(" "+o($.value),1)])):B("",!0)])}}}),Eo=le(Ao,[["__scopeId","data-v-edefd8f0"]]);class fe{static async getAllMcpServers(){const t=await fetch(`${this.BASE_URL}/list`);if(!t.ok)throw new Error(`Failed to get MCP server list: ${t.status}`);return await t.json()}static async addMcpServer(t){try{const s=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error(`Failed to add MCP server: ${s.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(s){return console.error("Failed to add MCP server:",s),{success:!1,message:s instanceof Error?s.message:"Failed to add, please retry"}}}static async removeMcpServer(t){try{const s=await fetch(`${this.BASE_URL}/remove?id=${t}`);if(!s.ok)throw new Error(`Failed to delete MCP server: ${s.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(s){return console.error(`Failed to delete MCP server[${t}]:`,s),{success:!1,message:s instanceof Error?s.message:"Failed to delete, please retry"}}}}ge(fe,"BASE_URL","/api/mcp");const xo={class:"mcp-config-panel"},Vo={class:"mcp-header"},Po={class:"header-left"},Mo={class:"mcp-stats"},Uo={class:"stat-item"},Bo={class:"stat-value"},Go={class:"header-right"},Io={class:"search-box"},Lo={key:0,class:"loading-container"},Oo={key:1,class:"mcp-layout"},Fo={class:"mcp-table-container"},Ro={key:0,class:"empty-state"},No={class:"empty-state-text"},Do={key:1,class:"mcp-table-wrapper"},jo={class:"mcp-table"},Ko={class:"mcp-id"},qo={class:"mcp-server-name"},Jo={class:"server-name-content"},zo={class:"mcp-connection-type"},Ho={class:"mcp-config"},Xo=["title"],Yo={class:"mcp-actions"},Qo=["onClick","disabled"],Wo={class:"add-mcp-container"},Zo={class:"mcp-form"},en={class:"mcp-form-group"},tn={class:"connection-type-options"},sn={class:"connection-type-option"},on={class:"connection-type-option"},nn={class:"connection-type-option"},an={class:"mcp-form-group"},ln=["placeholder"],cn={class:"mcp-form-actions"},rn=["disabled"],dn=["disabled"],un=ie({__name:"mcpConfig",setup(F){const{t}=ve(),s=I(!1),C=I([]),$=I(""),v=re({connectionType:"STUDIO",configJson:""}),g=re({show:!1,text:"",type:"success"}),A=H(()=>v.configJson.trim().length>0),k=H(()=>{if(!$.value.trim())return C.value;const V=$.value.toLowerCase();return C.value.filter(u=>u.mcpServerName.toLowerCase().includes(V)||u.connectionType.toLowerCase().includes(V)||u.connectionConfig.toLowerCase().includes(V))}),q=V=>V?V.length>50?V.substring(0,50)+"...":V:"",O=(V,u="success")=>{g.text=V,g.type=u,g.show=!0,setTimeout(()=>{g.show=!1},3e3)},E=async()=>{try{s.value=!0,C.value=await fe.getAllMcpServers()}catch(V){console.error("加载MCP服务器列表失败:",V),O("加载MCP服务器列表失败","error")}finally{s.value=!1}},W=async()=>{if(!A.value){O(t("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(v.configJson)}catch{O(t("config.mcpConfig.invalidJson"),"error");return}try{s.value=!0;const V={connectionType:v.connectionType,configJson:v.configJson},u=await fe.addMcpServer(V);u.success?(O("添加MCP服务器成功"),G(),await E()):O(u.message||t("config.mcpConfig.addFailed"),"error")}catch(V){console.error("添加MCP服务器失败:",V),O(t("config.mcpConfig.addFailed"),"error")}finally{s.value=!1}},oe=async V=>{if(confirm("确定要删除这个MCP服务器配置吗？此操作不可恢复。"))try{s.value=!0;const u=await fe.removeMcpServer(V);u.success?(O("删除MCP服务器成功"),await E()):O(u.message||t("config.mcpConfig.deleteFailed"),"error")}catch(u){console.error("删除MCP服务器失败:",u),O(t("config.mcpConfig.deleteFailed"),"error")}finally{s.value=!1}},G=()=>{v.connectionType="STUDIO",v.configJson=""};return Ce(()=>{E()}),(V,u)=>(i(),r("div",xo,[e("div",Vo,[e("div",Po,[u[6]||(u[6]=e("h2",null,"MCP配置",-1)),e("div",Mo,[e("span",Uo,[u[5]||(u[5]=e("span",{class:"stat-label"},"总服务器:",-1)),e("span",Bo,o(C.value.length),1)])])]),e("div",Go,[e("div",Io,[D(e("input",{"onUpdate:modelValue":u[0]||(u[0]=P=>$.value=P),type:"text",placeholder:"搜索MCP服务器...",class:"search-input"},null,512),[[se,$.value]]),u[7]||(u[7]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(i(),r("div",Lo,u[8]||(u[8]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"正在加载MCP服务器...",-1)]))):(i(),r("div",Oo,[e("div",Fo,[u[12]||(u[12]=e("h3",{class:"section-title"},"已配置的MCP服务器",-1)),k.value.length===0?(i(),r("div",Ro,[u[9]||(u[9]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",No,o($.value?"未找到匹配的MCP服务器":"暂无MCP服务器配置"),1)])):(i(),r("div",Do,[e("table",jo,[u[11]||(u[11]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"服务器名称"),e("th",null,"连接类型"),e("th",null,"连接配置"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),r(j,null,K(k.value,P=>(i(),r("tr",{key:P.id,class:"mcp-row"},[e("td",Ko,o(P.id),1),e("td",qo,[e("div",Jo,[u[10]||(u[10]=e("span",{class:"server-icon"},"🔌",-1)),U(" "+o(P.mcpServerName),1)])]),e("td",zo,[e("span",{class:Q(["connection-type-badge",P.connectionType.toLowerCase()])},o(P.connectionType),3)]),e("td",Ho,[e("div",{class:"config-preview",title:P.connectionConfig},o(q(P.connectionConfig)),9,Xo)]),e("td",Yo,[e("button",{onClick:X=>oe(P.id),class:"action-btn delete-btn",disabled:s.value}," 删除 ",8,Qo)])]))),128))])])]))]),e("div",Wo,[u[18]||(u[18]=e("div",{class:"add-mcp-header"},[e("h3",{class:"add-mcp-title"},"添加MCP服务器")],-1)),e("div",Zo,[e("div",en,[u[16]||(u[16]=e("label",{class:"form-label"},"连接类型：",-1)),e("div",tn,[e("div",sn,[D(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":u[1]||(u[1]=P=>v.connectionType=P),value:"STUDIO"},null,512),[[ye,v.connectionType]]),u[13]||(u[13]=e("label",{for:"mcp-connection-type-studio",class:"radio-label"},[e("span",{class:"radio-title"},"STUDIO"),e("span",{class:"connection-type-desc"},"本地mcp server，目前市面上主流的是这个")],-1))]),e("div",on,[D(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":u[2]||(u[2]=P=>v.connectionType=P),value:"SSE"},null,512),[[ye,v.connectionType]]),u[14]||(u[14]=e("label",{for:"mcp-connection-type-sse",class:"radio-label"},[e("span",{class:"radio-title"},"SSE"),e("span",{class:"connection-type-desc"},"通过http server等提供的，目前网络上比较少见")],-1))]),e("div",nn,[D(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":u[3]||(u[3]=P=>v.connectionType=P),value:"STREAMING"},null,512),[[ye,v.connectionType]]),u[15]||(u[15]=e("label",{for:"mcp-connection-type-streaming",class:"radio-label"},[e("span",{class:"radio-title"},"Streaming HTTP"),e("span",{class:"connection-type-desc"},"基于HTTP的流式传输协议，支持实时数据交换")],-1))])])]),e("div",an,[u[17]||(u[17]=e("label",{class:"form-label"},"mcp json配置：",-1)),D(e("textarea",{"onUpdate:modelValue":u[4]||(u[4]=P=>v.configJson=P),placeholder:f(t)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,ln),[[se,v.configJson]])]),e("div",cn,[e("button",{onClick:W,class:"action-btn add-btn",disabled:s.value},o(f(t)("common.add")),9,rn),e("button",{onClick:G,class:"action-btn reset-btn",disabled:s.value},o(f(t)("common.reset")),9,dn)])]),u[19]||(u[19]=Be('<div class="mcp-form-instructions" data-v-2bdb931d><h4 data-v-2bdb931d>使用说明：</h4><ol data-v-2bdb931d><li data-v-2bdb931d>找到你要用的mcp server的配置json： <ul class="indented-list" data-v-2bdb931d><li data-v-2bdb931d><strong data-v-2bdb931d>本地(STDIO)</strong>：可以在<a href="https://mcp.so" target="_blank" rel="noopener" data-v-2bdb931d>mcp.so</a>上找到，需要你有Node.js环境并理解你要配置的json里面的每一个项，做对应调整比如配置ak</li><li data-v-2bdb931d><strong data-v-2bdb931d>远程服务(SSE)</strong>：<a href="https://mcp.higress.ai/" target="_blank" rel="noopener" data-v-2bdb931d>mcp.higress.ai/</a>上可以找到，有SSE和STREAMING两种，目前SSE协议更完备一些</li></ul></li><li data-v-2bdb931d>将json配置复制到上面的输入框，本地选STUDIO，远程选STREAMING或SSE，提交</li><li data-v-2bdb931d>这样mcp tools就注册成功了。</li><li data-v-2bdb931d>然后需要在Agent配置里面，新建一个agent，然后增加指定你刚才添加的mcp tools，这样可以极大减少冲突，增强tools被agent选择的准确性</li></ol></div>',1))])])),x($e,{name:"message-fade"},{default:ae(()=>[g.show?(i(),r("div",{key:0,class:Q(["message-toast",g.type])},o(g.text),3)):B("",!0)]),_:1})]))}}),pn=le(un,[["__scopeId","data-v-2bdb931d"]]),gn={class:"config-container"},fn={class:"config-header"},vn={class:"header-actions"},hn={class:"config-content"},mn={class:"config-nav"},yn=["onClick"],_n={class:"config-details"},bn=ie({__name:"index",setup(F){const{t}=ve(),s=I("basic"),C=H(()=>[{key:"basic",label:t("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:t("config.categories.agent"),icon:"carbon:bot"},{key:"mcp",label:t("config.categories.mcp"),icon:"carbon:tool-box"}]);return($,v)=>(i(),r("div",gn,[e("div",fn,[e("div",vn,[x(Ge),e("button",{class:"action-btn",onClick:v[0]||(v[0]=g=>$.$router.push("/"))},[x(f(L),{icon:"carbon:arrow-left"}),U(" "+o($.$t("backHome")),1)])])]),e("div",hn,[e("nav",mn,[(i(!0),r(j,null,K(C.value,(g,A)=>(i(),r("div",{key:A,class:Q(["nav-item",{active:s.value===g.key}]),onClick:k=>s.value=g.key},[x(f(L),{icon:g.icon,width:"20"},null,8,["icon"]),e("span",null,o(g.label),1)],10,yn))),128))]),e("div",_n,[s.value==="basic"?(i(),de(ds,{key:0})):B("",!0),s.value==="agent"?(i(),de(Eo,{key:1})):B("",!0),s.value==="mcp"?(i(),de(pn,{key:2})):B("",!0)])])]))}}),Sn=le(bn,[["__scopeId","data-v-109cfe5c"]]);export{Sn as default};
