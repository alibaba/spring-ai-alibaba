var Ie=Object.defineProperty;var qe=(M,o,s)=>o in M?Ie(M,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):M[o]=s;var me=(M,o,s)=>qe(M,typeof o!="symbol"?o+"":o,s);import{d as se,c as u,o as d,e,t as n,f as ge,r as E,s as oe,g as ie,h as be,i as y,b as D,p as $,w as O,v as J,F as H,j as Y,m as ee,D as Pe,a as te,y as G,T as Ce,E as we,G as Fe,u as t,q as _e,z as Ae,H as Oe,l as Ge,B as je,n as Ke,I as xe,J as Je,K as ze,A as He,L as Ye,k as We}from"./index-7ROlzU2Y.js";import{_ as ne,I as N}from"./_plugin-vue_export-helper-_Wjfc-Zi.js";import{L as Xe}from"./index-BKuckNtn.js";const Qe={class:"switch"},Ze=["checked"],eo={class:"switch-label"},oo=se({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(M,{emit:o}){const s=o,p=v=>{const g=v.target.checked;s("update:switchValue",g)};return(v,g)=>(d(),u("label",Qe,[e("input",{type:"checkbox",checked:v.enabled,onChange:p},null,40,Ze),g[0]||(g[0]=e("span",{class:"slider"},null,-1)),e("span",eo,n(v.label),1)]))}}),to=ne(oo,[["__scopeId","data-v-d484b4a3"]]);class $e{static async getConfigsByGroup(o){try{const s=await fetch(`${this.BASE_URL}/group/${o}`);if(!s.ok)throw new Error(`Failed to get ${o} group configuration: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get ${o} group configuration:`,s),s}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const s=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Batch update configuration failed: ${s.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(s){return console.error("Batch update configuration failed:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}static async getConfigById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);if(!s.ok)throw new Error(`Failed to get configuration item: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get configuration item[${o}]:`,s),s}}static async updateConfig(o){try{const s=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Failed to update configuration item: ${s.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(s){return console.error("Failed to update configuration item:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}}me($e,"BASE_URL","/api/config");const so={class:"config-panel"},no={class:"config-header"},ao={class:"header-left"},lo={class:"config-stats"},io={class:"stat-item"},co={class:"stat-label"},ro={class:"stat-value"},uo={key:0,class:"stat-item"},po={class:"stat-label"},fo={class:"stat-value modified"},go={class:"header-right"},mo={class:"import-export-actions"},ho=["title"],vo=["title"],yo={class:"search-box"},_o=["placeholder"],bo={key:0,class:"loading-container"},Co={key:1,class:"config-groups"},$o={class:"group-header"},wo={class:"group-info"},ko={class:"group-icon"},So={class:"group-actions"},To=["onClick","disabled","title"],No={class:"sub-groups"},Vo=["onClick"],Ao={class:"sub-group-info"},xo={class:"sub-group-title"},Uo={class:"item-count"},Po={class:"config-items"},Eo={key:0,class:"config-item-content vertical-layout"},Do={class:"config-item-info"},Mo={class:"config-item-header"},Fo={class:"config-label"},Ro={class:"type-badge boolean"},Lo={key:0,class:"modified-badge"},Bo=["title"],Io={class:"config-control"},qo=["value","onChange"],Oo=["value"],Go={key:1,class:"config-item-content vertical-layout"},jo={class:"config-item-info"},Ko={class:"config-item-header"},Jo={class:"config-label"},zo={class:"type-badge select"},Ho={key:0,class:"modified-badge"},Yo=["title"],Wo={class:"config-control"},Xo=["value","onChange"],Qo=["value"],Zo={key:2,class:"config-item-content vertical-layout"},et={class:"config-item-info"},ot={class:"config-item-header"},tt={class:"config-label"},st={class:"type-badge textarea"},nt={key:0,class:"modified-badge"},at=["title"],lt={class:"config-control"},it=["value","onInput"],ct={key:3,class:"config-item-content vertical-layout"},rt={class:"config-item-info"},dt={class:"config-item-header"},ut={class:"config-label"},pt={class:"type-badge number"},ft={key:0,class:"modified-badge"},gt=["title"],mt={key:0,class:"config-meta"},ht={class:"range-info"},vt={class:"config-control"},yt=["value","onInput","min","max"],_t={key:4,class:"config-item-content vertical-layout"},bt={class:"config-item-info"},Ct={class:"config-item-header"},$t={class:"config-label"},wt={class:"type-badge string"},kt={key:0,class:"modified-badge"},St=["title"],Tt={class:"config-control"},Nt=["value","onInput"],Vt={key:2,class:"empty-state"},At=se({__name:"basicConfig",setup(M){const{t:o}=ge(),s=E(!0),p=E(!1),v=E([]),g=E(new Map),h=E(new Set),c=oe({show:!1,text:"",type:"success"}),k=E(""),V={headless:"config.basicConfig.browserSettings.headless",requestTimeout:"config.basicConfig.browserSettings.requestTimeout",debugDetail:"config.basicConfig.general.debugDetail",baseDir:"config.basicConfig.general.baseDir",openBrowser:"config.basicConfig.interactionSettings.openBrowser",maxSteps:"config.basicConfig.agentSettings.maxSteps",userInputTimeout:"config.basicConfig.agentSettings.userInputTimeout",maxMemory:"config.basicConfig.agentSettings.maxMemory",parallelToolCalls:"config.basicConfig.agentSettings.parallelToolCalls",forceOverrideFromYaml:"config.basicConfig.agents.forceOverrideFromYaml",enabled:"config.basicConfig.infiniteContext.enabled",parallelThreads:"config.basicConfig.infiniteContext.parallelThreads",taskContextSize:"config.basicConfig.infiniteContext.taskContextSize",allowExternalAccess:"config.basicConfig.fileSystem.allowExternalAccess"},C={manus:"config.basicConfig.groupDisplayNames.manus"},S={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},j={agent:"config.subGroupDisplayNames.agent",browser:"config.subGroupDisplayNames.browser",interaction:"config.subGroupDisplayNames.interaction",agents:"config.subGroupDisplayNames.agents",infiniteContext:"config.subGroupDisplayNames.infiniteContext",general:"config.subGroupDisplayNames.general",filesystem:"config.subGroupDisplayNames.filesystem"},R=ie(()=>v.value.some(l=>l.subGroups.some(w=>w.items.some(A=>g.value.get(A.id)!==A.configValue)))),W=l=>l==="true",I=l=>parseFloat(l)||0,x=l=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[l]||1,F=l=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[l]||1e4,X=l=>typeof l=="string"?l:l.value,ae=l=>typeof l=="string"?l:l.label,U=(l,w)=>{if(typeof w=="boolean")return w.toString();if(typeof w=="string"){if(l.options&&l.options.length>0){const A=l.options.find(T=>(typeof T=="string"?T:T.label)===w||(typeof T=="string"?T:T.value)===w);if(A)return typeof A=="string"?A:A.value}return w}return String(w)},m=(l,w,A=!1)=>{let T;l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"?T=U(l,w):T=String(w),l.configValue!==T&&(l.configValue=T,l._modified=!0,(A||l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"||l.inputType==="SELECT")&&a())};let i=null;const a=()=>{i&&clearTimeout(i),i=window.setTimeout(()=>{L()},500)},r=(l,w="success")=>{c.text=l,c.type=w,c.show=!0,setTimeout(()=>{c.show=!1},3e3)},_=async()=>{try{s.value=!0;const w=["manus"].map(async T=>{try{const f=await $e.getConfigsByGroup(T);if(f.length===0)return null;const B=f.map(Z=>({...Z,displayName:V[Z.configKey]||Z.configKey,min:x(Z.configKey),max:F(Z.configKey)}));B.forEach(Z=>{g.value.set(Z.id,Z.configValue)});const q=new Map;B.forEach(Z=>{const ce=Z.configSubGroup??"general";q.has(ce)||q.set(ce,[]),q.get(ce).push(Z)});const Q=Array.from(q.entries()).map(([Z,ce])=>({name:Z,displayName:j[Z]||Z,items:ce}));return{name:T,displayName:C[T]||T,subGroups:Q}}catch(f){return console.warn(`加载配置组 ${T} 失败，跳过:`,f),null}}),A=await Promise.all(w);v.value=A.filter(T=>T!==null),console.log(o("config.basicConfig.loadConfigSuccess"),v.value)}catch(l){console.error(o("config.basicConfig.loadConfigFailed"),l),r(o("config.basicConfig.loadConfigFailed"),"error")}finally{s.value=!1}},L=async()=>{if(!(p.value||!R.value))try{p.value=!0;const l=[];if(v.value.forEach(A=>{A.subGroups.forEach(T=>{const f=T.items.filter(B=>B._modified);l.push(...f)})}),l.length===0){r(o("config.basicConfig.noModified"));return}const w=await $e.batchUpdateConfigs(l);w.success?(l.forEach(A=>{g.value.set(A.id,A.configValue),A._modified=!1}),r(o("config.basicConfig.saveSuccess"))):r(w.message||o("config.basicConfig.saveFailed"),"error")}catch(l){console.error(o("config.basicConfig.saveFailed"),l),r(o("config.basicConfig.saveFailed"),"error")}finally{p.value=!1}},z=async l=>{if(confirm(o("config.basicConfig.resetGroupConfirm",C[l]||l)))try{p.value=!0;const A=v.value.find(B=>B.name===l);if(!A)return;const T=[];if(A.subGroups.forEach(B=>{B.items.forEach(q=>{const Q=le(q.configKey);Q!==q.configValue&&T.push({...q,configValue:Q})})}),T.length===0){r(o("config.basicConfig.isDefault"));return}const f=await $e.batchUpdateConfigs(T);f.success?(await _(),r(o("config.basicConfig.resetSuccess",T.length))):r(f.message||o("config.basicConfig.resetFailed"),"error")}catch(A){console.error(o("config.basicConfig.resetFailed"),A),r(o("config.basicConfig.resetFailed"),"error")}finally{p.value=!1}},le=l=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[l]||"",ke=(l,w)=>{const A=`${l}-${w}`;h.value.has(A)?h.value.delete(A):h.value.add(A)},he=(l,w)=>h.value.has(`${l}-${w}`),ue=ie(()=>{const l=v.value.reduce((A,T)=>A+T.subGroups.reduce((f,B)=>f+B.items.length,0),0),w=v.value.reduce((A,T)=>A+T.subGroups.reduce((f,B)=>f+B.items.filter(q=>g.value.get(q.id)!==q.configValue).length,0),0);return{total:l,modified:w}}),P=ie(()=>{if(!k.value.trim())return v.value;const l=k.value.toLowerCase();return v.value.map(w=>({...w,subGroups:w.subGroups.map(A=>({...A,items:A.items.filter(T=>T.displayName.toLowerCase().includes(l)||T.configKey.toLowerCase().includes(l)||T.description&&T.description.toLowerCase().includes(l))})).filter(A=>A.items.length>0)})).filter(w=>w.subGroups.length>0)}),b=()=>{try{const l={timestamp:new Date().toISOString(),version:"1.0",configs:v.value.reduce((f,B)=>(B.subGroups.forEach(q=>{q.items.forEach(Q=>{f[Q.configKey]=Q.configValue})}),f),{})},w=JSON.stringify(l,null,2),A=new Blob([w],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(A),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),r(o("config.basicConfig.exportSuccess"))}catch(l){console.error(o("config.basicConfig.exportFailed"),l),r(o("config.basicConfig.exportFailed"),"error")}},K=l=>{var f;const w=l.target,A=(f=w.files)==null?void 0:f[0];if(!A)return;const T=new FileReader;T.onload=async B=>{var q;try{const Q=JSON.parse((q=B.target)==null?void 0:q.result);if(!Q.configs)throw new Error(o("config.basicConfig.invalidFormat"));if(!confirm(o("config.importConfirm")))return;p.value=!0;const ce=[];if(v.value.forEach(Le=>{Le.subGroups.forEach(Be=>{Be.items.forEach(Ve=>{Object.prototype.hasOwnProperty.call(Q.configs,Ve.configKey)&&ce.push({...Ve,configValue:Q.configs[Ve.configKey]})})})}),ce.length===0){r(o("config.basicConfig.notFound"));return}const De=await $e.batchUpdateConfigs(ce);De.success?(await _(),r(o("config.basicConfig.importSuccess"))):r(De.message||o("config.basicConfig.importFailed"),"error")}catch(Q){console.error(o("config.basicConfig.importFailed"),Q),r(o("config.basicConfig.importFailed"),"error")}finally{p.value=!1,w.value=""}},T.readAsText(A)};return be(()=>{_()}),(l,w)=>(d(),u("div",so,[e("div",no,[e("div",ao,[e("h2",null,n(l.$t("config.basicConfig.title")),1),e("div",lo,[e("span",io,[e("span",co,n(l.$t("config.basicConfig.totalConfigs"))+":",1),e("span",ro,n(ue.value.total),1)]),ue.value.modified>0?(d(),u("span",uo,[e("span",po,n(l.$t("config.basicConfig.modified"))+":",1),e("span",fo,n(ue.value.modified),1)])):D("",!0)])]),e("div",go,[e("div",mo,[e("button",{onClick:b,class:"action-btn",title:l.$t("config.basicConfig.exportConfigs")}," 📤 ",8,ho),e("label",{class:"action-btn",title:l.$t("config.basicConfig.importConfigs")},[w[1]||(w[1]=$(" 📥 ")),e("input",{type:"file",accept:".json",onChange:K,style:{display:"none"}},null,32)],8,vo)]),e("div",yo,[O(e("input",{"onUpdate:modelValue":w[0]||(w[0]=A=>k.value=A),type:"text",placeholder:l.$t("config.search"),class:"search-input"},null,8,_o),[[J,k.value]]),w[2]||(w[2]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(d(),u("div",bo,[w[3]||(w[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,n(l.$t("config.loading")),1)])):P.value.length>0?(d(),u("div",Co,[(d(!0),u(H,null,Y(P.value,A=>(d(),u("div",{key:A.name,class:"config-group"},[e("div",$o,[e("div",wo,[e("span",ko,n(S[A.name]||"⚙️"),1)]),e("div",So,[e("button",{onClick:T=>z(A.name),class:"reset-btn",disabled:p.value,title:l.$t("config.resetGroupConfirm")},n(l.$t("config.reset")),9,To)]),w[4]||(w[4]=e("div",{class:"group-divider"},null,-1))]),e("div",No,[(d(!0),u(H,null,Y(A.subGroups,T=>(d(),u("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:f=>ke(A.name,T.name)},[e("div",Ao,[w[5]||(w[5]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",xo,n(l.$t(T.displayName)),1),e("span",Uo,"("+n(T.items.length)+")",1)]),e("span",{class:ee(["collapse-icon",{collapsed:he(A.name,T.name)}])}," ▼ ",2)],8,Vo),O(e("div",Po,[(d(!0),u(H,null,Y(T.items,f=>(d(),u("div",{key:f.id,class:ee(["config-item",{modified:g.value.get(f.id)!==f.configValue}])},[f.inputType==="BOOLEAN"||f.inputType==="CHECKBOX"?(d(),u("div",Eo,[e("div",Do,[e("div",Mo,[e("label",Fo,[$(n(l.$t(f.displayName)||f.description)+" ",1),e("span",Ro,n(f.inputType==="CHECKBOX"?l.$t("config.types.checkbox"):l.$t("config.types.boolean")),1),g.value.get(f.id)!==f.configValue?(d(),u("span",Lo,n(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,Bo)])]),e("div",Io,[f.options&&f.options.length>0?(d(),u("select",{key:0,class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return m(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options,B=>(d(),u("option",{key:X(B),value:X(B)},n(ae(B)),9,Oo))),128))],40,qo)):(d(),te(to,{key:1,enabled:W(f.configValue),label:"","onUpdate:switchValue":B=>m(f,B)},null,8,["enabled","onUpdate:switchValue"]))])])):f.inputType==="SELECT"?(d(),u("div",Go,[e("div",jo,[e("div",Ko,[e("label",Jo,[$(n(l.$t(f.displayName)||f.description)+" ",1),e("span",zo,n(l.$t("config.types.select")),1),g.value.get(f.id)!==f.configValue?(d(),u("span",Ho,n(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,Yo)])]),e("div",Wo,[e("select",{class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return m(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options||[],B=>(d(),u("option",{key:X(B),value:X(B)},n(ae(B)),9,Qo))),128))],40,Xo)])])):f.inputType==="TEXTAREA"?(d(),u("div",Zo,[e("div",et,[e("div",ot,[e("label",tt,[$(n(l.$t(f.displayName)||f.description)+" ",1),e("span",st,n(l.$t("config.types.textarea")),1),g.value.get(f.id)!==f.configValue?(d(),u("span",nt,n(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,at)])]),e("div",lt,[e("textarea",{class:"config-input textarea-input",value:f.configValue,onInput:B=>{var q;return m(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,rows:"3"},null,40,it)])])):f.inputType==="NUMBER"?(d(),u("div",ct,[e("div",rt,[e("div",dt,[e("label",ut,[$(n(l.$t(f.displayName)||f.description)+" ",1),e("span",pt,n(l.$t("config.types.number")),1),g.value.get(f.id)!==f.configValue?(d(),u("span",ft,n(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,gt),f.min||f.max?(d(),u("div",mt,[e("span",ht,n(l.$t("config.range"))+": "+n(f.min||0)+" - "+n(f.max||"∞"),1)])):D("",!0)])]),e("div",vt,[e("input",{type:"number",class:"config-input number-input",value:I(f.configValue),onInput:B=>{var q;return m(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,min:f.min||1,max:f.max||1e4},null,40,yt)])])):(d(),u("div",_t,[e("div",bt,[e("div",Ct,[e("label",$t,[$(n(l.$t(f.displayName)||f.description)+" ",1),e("span",wt,n(f.inputType==="TEXT"?l.$t("config.types.text"):l.$t("config.types.string")),1),g.value.get(f.id)!==f.configValue?(d(),u("span",kt,n(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,St)])]),e("div",Tt,[e("input",{type:"text",class:"config-input text-input",value:f.configValue,onInput:B=>{var q;return m(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a},null,40,Nt)])]))],2))),128))],512),[[Pe,!he(A.name,T.name)]])]))),128))])]))),128))])):(d(),u("div",Vt,[e("p",null,n(l.$t("config.notFound")),1)])),y(Ce,{name:"message-fade"},{default:G(()=>[c.show?(d(),u("div",{key:0,class:ee(["message-toast",c.type])},n(c.text),3)):D("",!0)]),_:1})]))}}),Me=ne(At,[["__scopeId","data-v-bb27f059"]]),xt={},Ut={class:"config-config"},Pt={class:"panel-header"},Et={class:"panel-actions"};function Dt(M,o){return d(),u("div",Ut,[e("div",Pt,[we(M.$slots,"title",{},void 0),e("div",Et,[we(M.$slots,"actions",{},void 0)])]),we(M.$slots,"default",{},void 0)])}const Ne=ne(xt,[["render",Dt],["__scopeId","data-v-c91688e7"]]),Mt={class:"modal-header"},Ft={class:"modal-content"},Rt={class:"modal-footer"},Lt=se({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(M){const o=s=>{s.target===s.currentTarget&&(s.stopPropagation(),s.preventDefault())};return(s,p)=>(d(),te(Fe,{to:"body"},[y(Ce,{name:"modal"},{default:G(()=>[M.modelValue?(d(),u("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:p[3]||(p[3]=_e(()=>{},["stop"]))},[e("div",Mt,[e("h3",null,n(M.title),1),e("button",{class:"close-btn",onClick:p[0]||(p[0]=v=>s.$emit("update:modelValue",!1))},[y(t(N),{icon:"carbon:close"})])]),e("div",Ft,[we(s.$slots,"default",{},void 0,!0)]),e("div",Rt,[we(s.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:p[1]||(p[1]=v=>s.$emit("update:modelValue",!1))},n(s.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:p[2]||(p[2]=v=>s.$emit("confirm"))},n(s.$t("common.confirm")),1)],!0)])])])):D("",!0)]),_:3})]))}}),de=ne(Lt,[["__scopeId","data-v-baaf1c89"]]),Bt={class:"tool-selection-content"},It={class:"tool-controls"},qt={class:"search-container"},Ot={class:"sort-container"},Gt={class:"tool-summary"},jt={class:"summary-text"},Kt={key:0,class:"tool-groups"},Jt=["onClick"],zt={class:"group-title-area"},Ht={class:"group-name"},Yt={class:"group-count"},Wt={class:"group-enable-all"},Xt=["checked","onChange","data-group"],Qt={class:"tool-info"},Zt={class:"tool-selection-name"},es={key:0,class:"tool-selection-desc"},os={class:"tool-actions"},ts=["checked","onChange"],ss={key:1,class:"empty-state"},ns=se({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(M,{emit:o}){const s=M,p=o,v=ie({get:()=>s.modelValue,set:i=>p("update:modelValue",i)}),g=E(""),h=E("group"),c=E(new Set),k=E([]),V=(i,a)=>{const r=document.querySelector(`input[data-group="${i}"]`);r&&(r.indeterminate=F(a))};Ae(()=>s.selectedToolIds,i=>{k.value=[...i]},{immediate:!0});const C=ie(()=>{let i=s.tools.filter(a=>a.key);if(g.value){const a=g.value.toLowerCase();i=i.filter(r=>{var _;return r.name.toLowerCase().includes(a)||r.description.toLowerCase().includes(a)||(((_=r.serviceGroup)==null?void 0:_.toLowerCase().includes(a))??!1)})}switch(h.value){case"name":i=[...i].sort((a,r)=>a.name.localeCompare(r.name));break;case"enabled":i=[...i].sort((a,r)=>{const _=k.value.includes(a.key),L=k.value.includes(r.key);return _&&!L?-1:!_&&L?1:a.name.localeCompare(r.name)});break;case"group":default:i=[...i].sort((a,r)=>{const _=a.serviceGroup??"未分组",L=r.serviceGroup??"未分组";return _!==L?_.localeCompare(L):a.name.localeCompare(r.name)});break}return i}),S=ie(()=>{const i=new Map;return C.value.forEach(a=>{const r=a.serviceGroup??"未分组";i.has(r)||i.set(r,[]),i.get(r).push(a)}),new Map([...i.entries()].sort())}),j=ie(()=>C.value.length);Ae([k,S],()=>{Ge(()=>{for(const[i,a]of S.value)V(i,a)})},{flush:"post",deep:!1});const R=i=>k.value.includes(i),W=(i,a)=>{a.stopPropagation();const _=a.target.checked;if(!i){console.error("toolKey is undefined, cannot proceed");return}_?k.value.includes(i)||(k.value=[...k.value,i]):k.value=k.value.filter(L=>L!==i)},I=i=>i.filter(a=>k.value.includes(a.key)),x=i=>i.length>0&&i.every(a=>k.value.includes(a.key)),F=i=>{const a=I(i).length;return a>0&&a<i.length},X=(i,a)=>{a.stopPropagation();const _=a.target.checked,L=i.map(z=>z.key);if(_){const z=[...k.value];L.forEach(le=>{z.includes(le)||z.push(le)}),k.value=z}else k.value=k.value.filter(z=>!L.includes(z))},ae=i=>{c.value.has(i)?c.value.delete(i):c.value.add(i)},U=()=>{p("confirm",[...k.value]),p("update:modelValue",!1)},m=()=>{k.value=[...s.selectedToolIds],p("update:modelValue",!1)};return Ae(v,i=>{if(i){c.value.clear();const a=Array.from(S.value.keys());a.length>1&&a.slice(1).forEach(r=>{c.value.add(r)})}}),(i,a)=>(d(),te(de,{modelValue:v.value,"onUpdate:modelValue":[a[4]||(a[4]=r=>v.value=r),m],title:"选择工具",onConfirm:U},{default:G(()=>[e("div",Bt,[e("div",It,[e("div",qt,[O(e("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>g.value=r),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[J,g.value]])]),e("div",Ot,[O(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>h.value=r),class:"sort-select"},a[5]||(a[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Oe,h.value]])])]),e("div",Gt,[e("span",jt," 共 "+n(S.value.size)+" 个服务组，"+n(j.value)+" 个工具 (已选择 "+n(k.value.length)+" 个) ",1)]),S.value.size>0?(d(),u("div",Kt,[(d(!0),u(H,null,Y(S.value,([r,_])=>(d(),u("div",{key:r,class:"tool-group"},[e("div",{class:ee(["tool-group-header",{collapsed:c.value.has(r)}]),onClick:L=>ae(r)},[e("div",zt,[y(t(N),{icon:c.value.has(r)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),y(t(N),{icon:"carbon:folder",class:"group-icon"}),e("span",Ht,n(r),1),e("span",Yt," ("+n(I(_).length)+"/"+n(_.length)+") ",1)]),e("div",{class:"group-actions",onClick:a[2]||(a[2]=_e(()=>{},["stop"]))},[e("label",Wt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:x(_),onChange:L=>X(_,L),"data-group":r},null,40,Xt),a[6]||(a[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Jt),e("div",{class:ee(["tool-group-content",{collapsed:c.value.has(r)}])},[(d(!0),u(H,null,Y(_.filter(L=>L&&L.key),L=>(d(),u("div",{key:L.key,class:"tool-selection-item"},[e("div",Qt,[e("div",Zt,n(L.name),1),L.description?(d(),u("div",es,n(L.description),1)):D("",!0)]),e("div",os,[e("label",{class:"tool-enable-switch",onClick:a[3]||(a[3]=_e(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:R(L.key),onChange:z=>W(L.key,z)},null,40,ts),a[7]||(a[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(d(),u("div",ss,[y(t(N),{icon:"carbon:tools",class:"empty-icon"}),a[8]||(a[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),as=ne(ns,[["__scopeId","data-v-79f6a572"]]);class fe{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const s=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(s)).json()}else{const s=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(s)).json()}}catch(s){throw console.error("Failed to get Agent list:",s),s}}static async getAgentById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Agent[${o}] details:`,s),s}}static async createAgent(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Agent:",s),s}}static async updateAgent(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Agent[${o}]:`,p),p}}static async deleteAgent(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Agent[${o}]:`,s),s}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}me(fe,"BASE_URL","/api/agents");class re{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Model[${o}] details:`,s),s}}static async createModel(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Model:",s),s}}static async updateModel(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Model[${o}]:`,p),p}}static async deleteModel(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Model[${o}]:`,s),s}}}me(re,"BASE_URL","/api/models");const Ee=je("namespace",()=>{const M=E("default");function o(v){M.value=v}const s=E([{name:"Default",id:"default"}]);function p(v){s.value=v}return{namespace:M,db:s,setNamespace:o,setDb:p}}),ls=["disabled"],is={class:"agent-layout"},cs={class:"agent-list"},rs={class:"list-header"},ds={class:"agent-count"},us={key:0,class:"agents-container"},ps=["onClick"],fs={class:"agent-card-header"},gs={class:"agent-name"},ms={class:"agent-desc"},hs={key:0,class:"agent-model"},vs={class:"model-tag"},ys={class:"model-tag"},_s={key:1,class:"agent-tools"},bs={key:0,class:"tool-more"},Cs={key:1,class:"loading-state"},$s={key:2,class:"empty-state"},ws={key:0,class:"agent-detail"},ks={class:"detail-header"},Ss={class:"detail-actions"},Ts={class:"form-item"},Ns=["placeholder"],Vs={class:"form-item"},As=["placeholder"],xs={class:"form-item"},Us=["value","placeholder"],Ps={class:"model-section"},Es={class:"form-item"},Ds={class:"model-chooser"},Ms=["title"],Fs={key:0,class:"current-model"},Rs={class:"model-type"},Ls={class:"model-name"},Bs={key:1,class:"current-model"},Is={class:"current-model"},qs={class:"dropdown-header"},Os={class:"model-options"},Gs=["onClick"],js={class:"model-type"},Ks={class:"model-name"},Js={class:"tools-section"},zs={class:"assigned-tools"},Hs={class:"section-header"},Ys={class:"tools-grid"},Ws={class:"tool-info"},Xs={class:"tool-name"},Qs={class:"tool-desc"},Zs={key:0,class:"no-tools"},en={key:1,class:"no-selection"},on={class:"modal-form"},tn={class:"form-item"},sn=["placeholder"],nn={class:"form-item"},an=["placeholder"],ln={class:"form-item"},cn=["value","placeholder"],rn={class:"delete-confirm"},dn={class:"warning-text"},un=se({__name:"agentConfig",setup(M){const{t:o}=ge(),s=Ee(),p=E(!1),v=E(""),g=E(""),h=oe([]),c=E(null),k=oe([]),V=E(!1),C=E(!1),S=E(!1),j=E(!1),R=E(null),W=oe([]),I=()=>{j.value=!j.value},x=P=>{R.value=P,j.value=!1},F=oe({name:"",description:"",nextStepPrompt:""}),X=P=>{const b=k.find(K=>K.key===P);return b?b.name:P},ae=P=>{const b=k.find(K=>K.key===P);return b?b.description:""},U=(P,b)=>{b==="success"?(g.value=P,setTimeout(()=>{g.value=""},3e3)):(v.value=P,setTimeout(()=>{v.value=""},5e3))},m=async()=>{p.value=!0;try{const[P,b,K]=await Promise.all([fe.getAllAgents(s.namespace),fe.getAvailableTools(),re.getAllModels()]),l=P.map(w=>({...w,availableTools:w.availableTools,...K}));h.splice(0,h.length,...l),k.splice(0,k.length,...b),W.splice(0,W.length,...K),l.length>0&&await i(l[0])}catch(P){console.error("加载数据失败:",P),U(o("config.agentConfig.loadDataFailed")+": "+P.message,"error");const b=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],K=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];k.splice(0,k.length,...b),h.splice(0,h.length,...K),K.length>0&&(c.value=K[0])}finally{p.value=!1}},i=async P=>{try{const b=await fe.getAgentById(P.id);c.value={...b,availableTools:b.availableTools},R.value=b.model??null}catch(b){console.error("加载Agent详情失败:",b),U(o("config.agentConfig.loadDetailsFailed")+": "+b.message,"error"),c.value={...P,availableTools:P.availableTools}}},a=()=>{F.name="",F.description="",F.nextStepPrompt="",V.value=!0},r=async()=>{var P;if(!F.name.trim()||!F.description.trim()){U(o("config.agentConfig.requiredFields"),"error");return}try{const b={name:F.name.trim(),description:F.description.trim(),nextStepPrompt:((P=F.nextStepPrompt)==null?void 0:P.trim())??"",availableTools:[]},K=await fe.createAgent(b);h.push(K),c.value=K,V.value=!1,U(o("config.agentConfig.createSuccess"),"success")}catch(b){U(o("config.agentConfig.createFailed")+": "+b.message,"error")}},_=()=>{S.value=!0},L=P=>{c.value&&(c.value.availableTools=[...P])},z=async()=>{if(c.value){if(!c.value.name.trim()||!c.value.description.trim()){U(o("config.agentConfig.requiredFields"),"error");return}try{c.value.model=R.value;const P=await fe.updateAgent(c.value.id,c.value),b=h.findIndex(K=>K.id===P.id);b!==-1&&(h[b]=P),c.value=P,c.value.model=R.value,U(o("config.agentConfig.saveSuccess"),"success")}catch(P){U(o("config.agentConfig.saveFailed")+": "+P.message,"error")}}},le=()=>{C.value=!0},ke=async()=>{if(c.value)try{await fe.deleteAgent(c.value.id);const P=h.findIndex(b=>b.id===c.value.id);P!==-1&&h.splice(P,1),c.value=h.length>0?h[0]:null,C.value=!1,U(o("config.agentConfig.deleteSuccess"),"success")}catch(P){U(o("config.agentConfig.deleteFailed")+": "+P.message,"error")}},he=()=>{const P=document.createElement("input");P.type="file",P.accept=".json",P.onchange=b=>{var l;const K=(l=b.target.files)==null?void 0:l[0];if(K){const w=new FileReader;w.onload=async A=>{var T;try{const f=JSON.parse((T=A.target)==null?void 0:T.result);if(!f.name||!f.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:B,...q}=f,Q=await fe.createAgent(q);h.push(Q),c.value=Q,U(o("config.agentConfig.importSuccess"),"success")}catch(f){U(o("config.agentConfig.importFailed")+": "+f.message,"error")}},w.readAsText(K)}},P.click()},ue=()=>{if(c.value)try{const P=JSON.stringify(c.value,null,2),b=new Blob([P],{type:"application/json"}),K=URL.createObjectURL(b),l=document.createElement("a");l.href=K,l.download=`agent-${c.value.name}-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(K),U(o("config.agentConfig.exportSuccess"),"success")}catch(P){U(o("config.agentConfig.exportFailed")+": "+P.message,"error")}};return be(()=>{m()}),(P,b)=>(d(),te(Ne,null,{title:G(()=>[e("h2",null,n(t(o)("config.agentConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:he},[y(t(N),{icon:"carbon:upload"}),$(" "+n(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ue,disabled:!c.value},[y(t(N),{icon:"carbon:download"}),$(" "+n(t(o)("config.agentConfig.export")),1)],8,ls)]),default:G(()=>{var K;return[e("div",is,[e("div",cs,[e("div",rs,[e("h3",null,n(t(o)("config.agentConfig.configuredAgents")),1),e("span",ds,"("+n(h.length)+n(t(o)("config.agentConfig.agentCount"))+")",1)]),p.value?D("",!0):(d(),u("div",us,[(d(!0),u(H,null,Y(h,l=>{var w,A;return d(),u("div",{key:l.id,class:ee(["agent-card",{active:((w=c.value)==null?void 0:w.id)===l.id}]),onClick:T=>i(l)},[e("div",fs,[e("span",gs,n(l.name),1),y(t(N),{icon:"carbon:chevron-right"})]),e("p",ms,n(l.description),1),l.model?(d(),u("div",hs,[e("span",vs,n(l.model.type),1),e("span",ys,n(l.model.modelName),1)])):D("",!0),((A=l.availableTools)==null?void 0:A.length)>0?(d(),u("div",_s,[(d(!0),u(H,null,Y(l.availableTools.slice(0,3),T=>(d(),u("span",{key:T,class:"tool-tag"},n(X(T)),1))),128)),l.availableTools.length>3?(d(),u("span",bs," +"+n(l.availableTools.length-3),1)):D("",!0)])):D("",!0)],10,ps)}),128))])),p.value?(d(),u("div",Cs,[y(t(N),{icon:"carbon:loading",class:"loading-icon"}),$(" "+n(t(o)("common.loading")),1)])):D("",!0),!p.value&&h.length===0?(d(),u("div",$s,[y(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.agentConfig.noAgent")),1)])):D("",!0),e("button",{class:"add-btn",onClick:a},[y(t(N),{icon:"carbon:add"}),$(" "+n(t(o)("config.agentConfig.createNew")),1)])]),c.value?(d(),u("div",ws,[e("div",ks,[e("h3",null,n(c.value.name),1),e("div",Ss,[e("button",{class:"action-btn primary",onClick:z},[y(t(N),{icon:"carbon:save"}),$(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:le},[y(t(N),{icon:"carbon:trash-can"}),$(" "+n(t(o)("common.delete")),1)])])]),e("div",Ts,[e("label",null,[$(n(t(o)("config.agentConfig.agentName"))+" ",1),b[15]||(b[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=l=>c.value.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Ns),[[J,c.value.name]])]),e("div",Vs,[e("label",null,[$(n(t(o)("config.agentConfig.description"))+" ",1),b[16]||(b[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[1]||(b[1]=l=>c.value.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,As),[[J,c.value.description]])]),e("div",xs,[e("label",null,n(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:c.value.nextStepPrompt||"",onInput:b[2]||(b[2]=l=>c.value.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,Us)]),e("div",Ps,[e("h4",null,n(t(o)("config.agentConfig.modelConfiguration")),1),e("div",Es,[e("div",Ds,[e("button",{class:"model-btn",onClick:I,title:P.$t("model.switch")},[y(t(N),{icon:"carbon:build-run",width:"18"}),R.value?(d(),u("span",Fs,[e("span",Rs,n(R.value.type),1),b[17]||(b[17]=e("span",{class:"spacer"},null,-1)),e("span",Ls,n(R.value.modelName),1)])):(d(),u("span",Bs,[e("span",Is,n(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),y(t(N),{icon:j.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ms),j.value?(d(),u("div",{key:0,class:"model-dropdown",onClick:b[4]||(b[4]=_e(()=>{},["stop"]))},[e("div",qs,[e("span",null,n(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:b[3]||(b[3]=l=>j.value=!1)},[y(t(N),{icon:"carbon:close",width:"16"})])]),e("div",Os,[(d(!0),u(H,null,Y(W,l=>{var w,A;return d(),u("button",{key:l.id,class:ee(["model-option",{active:((w=R.value)==null?void 0:w.id)===l.id}]),onClick:T=>x(l)},[e("span",js,n(l.type),1),e("span",Ks,n(l.modelName),1),((A=R.value)==null?void 0:A.id)===l.id?(d(),te(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,Gs)}),128))])])):D("",!0),j.value?(d(),u("div",{key:1,class:"backdrop",onClick:b[5]||(b[5]=l=>j.value=!1)})):D("",!0)])])]),e("div",Js,[e("h4",null,n(t(o)("config.agentConfig.toolConfiguration")),1),e("div",zs,[e("div",Hs,[e("span",null,n(t(o)("config.agentConfig.assignedTools"))+" ("+n((c.value.availableTools||[]).length)+")",1),k.length>0?(d(),u("button",{key:0,class:"action-btn small",onClick:_},[y(t(N),{icon:"carbon:add"}),$(" "+n(t(o)("config.agentConfig.addRemoveTools")),1)])):D("",!0)]),e("div",Ys,[(d(!0),u(H,null,Y(c.value.availableTools||[],l=>(d(),u("div",{key:l,class:"tool-item assigned"},[e("div",Ws,[e("span",Xs,n(X(l)),1),e("span",Qs,n(ae(l)),1)])]))),128)),c.value.availableTools.length===0?(d(),u("div",Zs,[y(t(N),{icon:"carbon:tool-box"}),e("span",null,n(t(o)("config.agentConfig.noAssignedTools")),1)])):D("",!0)])])])])):(d(),u("div",en,[y(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.agentConfig.selectAgentHint")),1)]))]),y(de,{modelValue:V.value,"onUpdate:modelValue":b[9]||(b[9]=l=>V.value=l),title:t(o)("config.agentConfig.newAgent"),onConfirm:r},{default:G(()=>[e("div",on,[e("div",tn,[e("label",null,[$(n(t(o)("config.agentConfig.agentName"))+" ",1),b[18]||(b[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[6]||(b[6]=l=>F.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,sn),[[J,F.name]])]),e("div",nn,[e("label",null,[$(n(t(o)("config.agentConfig.description"))+" ",1),b[19]||(b[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[7]||(b[7]=l=>F.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,an),[[J,F.description]])]),e("div",ln,[e("label",null,n(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:F.nextStepPrompt||"",onInput:b[8]||(b[8]=l=>F.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,cn)])])]),_:1},8,["modelValue","title"]),y(as,{modelValue:S.value,"onUpdate:modelValue":b[10]||(b[10]=l=>S.value=l),tools:k,"selected-tool-ids":((K=c.value)==null?void 0:K.availableTools)||[],onConfirm:L},null,8,["modelValue","tools","selected-tool-ids"]),y(de,{modelValue:C.value,"onUpdate:modelValue":b[12]||(b[12]=l=>C.value=l),title:t(o)("config.agentConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:b[11]||(b[11]=l=>C.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:ke},n(t(o)("common.delete")),1)]),default:G(()=>{var l;return[e("div",rn,[y(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(n(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,n((l=c.value)==null?void 0:l.name),1),$(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",dn,n(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),v.value?(d(),u("div",{key:0,class:"error-toast",onClick:b[13]||(b[13]=l=>v.value="")},[y(t(N),{icon:"carbon:error"}),$(" "+n(v.value),1)])):D("",!0),g.value?(d(),u("div",{key:1,class:"success-toast",onClick:b[14]||(b[14]=l=>g.value="")},[y(t(N),{icon:"carbon:checkmark"}),$(" "+n(g.value),1)])):D("",!0)]}),_:1}))}}),pn=ne(un,[["__scopeId","data-v-9e905dc6"]]),fn={class:"custom-select"},gn=["title"],mn={key:0,class:"current-option"},hn={class:"option-name"},vn={key:1,class:"current-option"},yn={class:"dropdown-header"},_n={class:"select-options"},bn=["onClick"],Cn={class:"option-name"},$n=se({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{}},emits:["update:modelValue"],setup(M,{emit:o}){const s=M,p=o,v=E(!1),g=ie(()=>s.options.find(V=>V.id===s.modelValue)),h=V=>V.id===s.modelValue,c=()=>{v.value=!v.value},k=V=>{p("update:modelValue",V.id),v.value=!1};return(V,C)=>(d(),u("div",fn,[e("button",{class:"select-btn",onClick:c,title:V.placeholder},[y(t(N),{icon:s.icon||"carbon:select-01",width:"18"},null,8,["icon"]),g.value?(d(),u("span",mn,[e("span",hn,n(g.value.name),1)])):(d(),u("span",vn,n(V.placeholder),1)),y(t(N),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,gn),y(Ce,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",style:Ke({...V.dropStyles,...s.direction==="right"?{right:0}:{left:0}}),onClick:C[1]||(C[1]=_e(()=>{},["stop"]))},[e("div",yn,[e("span",null,n(V.dropdownTitle),1),e("button",{class:"close-btn",onClick:C[0]||(C[0]=S=>v.value=!1)},[y(t(N),{icon:"carbon:close",width:"16"})])]),e("div",_n,[(d(!0),u(H,null,Y(V.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:j=>k(S)},[e("span",Cn,n(S.name),1),h(S)?(d(),te(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,bn))),128))])],4),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[2]||(C[2]=S=>v.value=!1)})):D("",!0)]))}}),Ue=ne($n,[["__scopeId","data-v-138e90e7"]]),wn=["disabled"],kn={class:"model-layout"},Sn={class:"model-list"},Tn={class:"list-header"},Nn={class:"model-count"},Vn={key:0,class:"models-container"},An=["onClick"],xn={class:"model-card-header"},Un={class:"model-name"},Pn={class:"model-desc"},En={key:0,class:"model-type"},Dn={class:"model-tag"},Mn={key:1,class:"loading-state"},Fn={key:2,class:"empty-state"},Rn={key:0,class:"model-detail"},Ln={class:"detail-header"},Bn={class:"detail-actions"},In={class:"form-item"},qn={class:"form-item"},On=["placeholder"],Gn={class:"form-item"},jn=["placeholder"],Kn={class:"form-item"},Jn=["placeholder"],zn={class:"form-item"},Hn=["placeholder"],Yn={key:1,class:"no-selection"},Wn={class:"modal-form"},Xn={class:"form-item"},Qn={class:"form-item"},Zn=["placeholder"],ea={class:"form-item"},oa=["placeholder"],ta={class:"form-item"},sa=["placeholder"],na={class:"form-item"},aa=["placeholder"],la={class:"delete-confirm"},ia={class:"warning-text"},ca=se({__name:"modelConfig",setup(M){const{t:o}=ge(),s=E(!1),p=E(""),v=E(""),g=oe([]),h=oe([]),c=E(null),k=E(!1),V=E(!1),C=oe({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),S=(m,i)=>{i==="success"?(v.value=m,setTimeout(()=>{v.value=""},3e3)):(p.value=m,setTimeout(()=>{p.value=""},5e3))},j=async()=>{s.value=!0;try{const[m,i]=await Promise.all([re.getAllModels(),re.getAllTypes()]),a=m.map(r=>({...r}));g.splice(0,g.length,...a),h.splice(0,h.length,...i),a.length>0&&await R(a[0])}catch(m){console.error("加载数据失败:",m),S(o("config.modelConfig.loadDataFailed")+": "+m.message,"error")}finally{s.value=!1}},R=async m=>{try{const i=await re.getModelById(m.id);c.value={...i}}catch(i){console.error("加载Model详情失败:",i),S(o("config.modelConfig.loadDetailsFailed")+": "+i.message,"error"),c.value={...m}}},W=()=>{C.baseUrl="",C.apiKey="",C.modelName="",C.modelDescription="",C.type="",k.value=!0},I=async()=>{if(!C.modelName.trim()||!C.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const m={baseUrl:C.baseUrl.trim(),apiKey:C.apiKey.trim(),modelName:C.modelName.trim(),modelDescription:C.modelDescription.trim(),type:C.type.trim()},i=await re.createModel(m);g.push(i),c.value=i,k.value=!1,S(o("config.modelConfig.createSuccess"),"success")}catch(m){S(o("config.modelConfig.createFailed")+": "+m.message,"error")}},x=async()=>{if(c.value){if(!c.value.modelName.trim()||!c.value.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const m=await re.updateModel(c.value.id,c.value),i=g.findIndex(a=>a.id===m.id);i!==-1&&(g[i]=m),c.value=m,S(o("config.modelConfig.saveSuccess"),"success")}catch(m){S(o("config.modelConfig.saveFailed")+": "+m.message,"error")}}},F=()=>{V.value=!0},X=async()=>{if(c.value)try{await re.deleteModel(c.value.id);const m=g.findIndex(i=>i.id===c.value.id);m!==-1&&g.splice(m,1),c.value=g.length>0?g[0]:null,V.value=!1,S(o("config.modelConfig.deleteSuccess"),"success")}catch(m){S(o("config.modelConfig.deleteFailed")+": "+m.message,"error")}},ae=()=>{const m=document.createElement("input");m.type="file",m.accept=".json",m.onchange=i=>{var r;const a=(r=i.target.files)==null?void 0:r[0];if(a){const _=new FileReader;_.onload=async L=>{var z;try{const le=JSON.parse((z=L.target)==null?void 0:z.result);if(!le.modelName||!le.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:ke,...he}=le,ue=await re.createModel(he);g.push(ue),c.value=ue,S(o("config.modelConfig.importSuccess"),"success")}catch(le){S(o("config.modelConfig.importFailed")+": "+le.message,"error")}},_.readAsText(a)}},m.click()},U=()=>{if(c.value)try{const m=JSON.stringify(c.value,null,2),i=new Blob([m],{type:"application/json"}),a=URL.createObjectURL(i),r=document.createElement("a");r.href=a,r.download=`model-${c.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(a),S(o("config.modelConfig.exportSuccess"),"success")}catch(m){S(o("config.modelConfig.exportFailed")+": "+m.message,"error")}};return be(()=>{j()}),(m,i)=>(d(),te(Ne,null,{title:G(()=>[e("h2",null,n(t(o)("config.modelConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:ae},[y(t(N),{icon:"carbon:upload"}),$(" "+n(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:U,disabled:!c.value},[y(t(N),{icon:"carbon:download"}),$(" "+n(t(o)("config.modelConfig.export")),1)],8,wn)]),default:G(()=>[e("div",kn,[e("div",Sn,[e("div",Tn,[e("h3",null,n(t(o)("config.modelConfig.configuredModels")),1),e("span",Nn,"("+n(g.length)+")",1)]),s.value?D("",!0):(d(),u("div",Vn,[(d(!0),u(H,null,Y(g,a=>{var r;return d(),u("div",{key:a.id,class:ee(["model-card",{active:((r=c.value)==null?void 0:r.id)===a.id}]),onClick:_=>R(a)},[e("div",xn,[e("span",Un,n(a.modelName),1),y(t(N),{icon:"carbon:chevron-right"})]),e("p",Pn,n(a.modelDescription),1),a.type?(d(),u("div",En,[e("span",Dn,n(a.type),1)])):D("",!0)],10,An)}),128))])),s.value?(d(),u("div",Mn,[y(t(N),{icon:"carbon:loading",class:"loading-icon"}),$(" "+n(t(o)("common.loading")),1)])):D("",!0),!s.value&&g.length===0?(d(),u("div",Fn,[y(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.modelConfig.noModel")),1)])):D("",!0),e("button",{class:"add-btn",onClick:W},[y(t(N),{icon:"carbon:add"}),$(" "+n(t(o)("config.modelConfig.createNew")),1)])]),c.value?(d(),u("div",Rn,[e("div",Ln,[e("h3",null,n(c.value.modelName),1),e("div",Bn,[e("button",{class:"action-btn primary",onClick:x},[y(t(N),{icon:"carbon:save"}),$(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:F},[y(t(N),{icon:"carbon:trash-can"}),$(" "+n(t(o)("common.delete")),1)])])]),e("div",In,[e("label",null,[$(n(t(o)("config.modelConfig.type"))+" ",1),i[15]||(i[15]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:c.value.type,"onUpdate:modelValue":i[0]||(i[0]=a=>c.value.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",qn,[e("label",null,[$(n(t(o)("config.modelConfig.baseUrl"))+" ",1),i[16]||(i[16]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=a=>c.value.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,On),[[J,c.value.baseUrl]])]),e("div",Gn,[e("label",null,[$(n(t(o)("config.modelConfig.apiKey"))+" ",1),i[17]||(i[17]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[2]||(i[2]=a=>c.value.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,jn),[[J,c.value.apiKey]])]),e("div",Kn,[e("label",null,[$(n(t(o)("config.modelConfig.modelName"))+" ",1),i[18]||(i[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[3]||(i[3]=a=>c.value.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Jn),[[J,c.value.modelName]])]),e("div",zn,[e("label",null,[$(n(t(o)("config.modelConfig.description"))+" ",1),i[19]||(i[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=a=>c.value.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Hn),[[J,c.value.modelDescription]])])])):(d(),u("div",Yn,[y(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.modelConfig.selectModelHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":i[10]||(i[10]=a=>k.value=a),title:t(o)("config.modelConfig.newModel"),onConfirm:I},{default:G(()=>[e("div",Wn,[e("div",Xn,[e("label",null,[$(n(t(o)("config.modelConfig.type"))+" ",1),i[20]||(i[20]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:C.type,"onUpdate:modelValue":i[5]||(i[5]=a=>C.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Qn,[e("label",null,[$(n(t(o)("config.modelConfig.baseUrl"))+" ",1),i[21]||(i[21]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[6]||(i[6]=a=>C.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Zn),[[J,C.baseUrl]])]),e("div",ea,[e("label",null,[$(n(t(o)("config.modelConfig.apiKey"))+" ",1),i[22]||(i[22]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[7]||(i[7]=a=>C.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,oa),[[J,C.apiKey]])]),e("div",ta,[e("label",null,[$(n(t(o)("config.modelConfig.modelName"))+" ",1),i[23]||(i[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[8]||(i[8]=a=>C.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,sa),[[J,C.modelName]])]),e("div",na,[e("label",null,[$(n(t(o)("config.modelConfig.description"))+" ",1),i[24]||(i[24]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=a=>C.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,aa),[[J,C.modelDescription]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:V.value,"onUpdate:modelValue":i[12]||(i[12]=a=>V.value=a),title:"Delete confirmation"},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:i[11]||(i[11]=a=>V.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},n(t(o)("common.delete")),1)]),default:G(()=>{var a;return[e("div",la,[y(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(n(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,n((a=c.value)==null?void 0:a.modelName),1),$(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",ia,n(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),p.value?(d(),u("div",{key:0,class:"error-toast",onClick:i[13]||(i[13]=a=>p.value="")},[y(t(N),{icon:"carbon:error"}),$(" "+n(p.value),1)])):D("",!0),v.value?(d(),u("div",{key:1,class:"success-toast",onClick:i[14]||(i[14]=a=>v.value="")},[y(t(N),{icon:"carbon:checkmark"}),$(" "+n(v.value),1)])):D("",!0)]),_:1}))}}),ra=ne(ca,[["__scopeId","data-v-2ee2eba1"]]);class Te{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const s=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Failed to add MCP server: ${s.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(s){return console.error("Failed to add MCP server:",s),{success:!1,message:s instanceof Error?s.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const s=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!s.ok)throw new Error(`Failed to delete MCP server: ${s.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(s){return console.error(`Failed to delete MCP server[${o}]:`,s),{success:!1,message:s instanceof Error?s.message:"Failed to delete, please retry"}}}}me(Te,"BASE_URL","/api/mcp");const da={class:"mcp-config-panel"},ua={class:"mcp-header"},pa={class:"header-left"},fa={class:"mcp-stats"},ga={class:"stat-item"},ma={class:"stat-label"},ha={class:"stat-value"},va={class:"header-right"},ya={class:"search-box"},_a=["placeholder"],ba={key:0,class:"loading-container"},Ca={key:1,class:"mcp-layout"},$a={class:"mcp-table-container"},wa={class:"section-title"},ka={key:0,class:"empty-state"},Sa={class:"empty-state-text"},Ta={key:1,class:"mcp-table-wrapper"},Na={class:"mcp-table"},Va={class:"mcp-id"},Aa={class:"mcp-server-name"},xa={class:"server-name-content"},Ua={class:"mcp-connection-type"},Pa={class:"mcp-config"},Ea=["title"],Da={class:"mcp-actions"},Ma=["onClick","disabled"],Fa={class:"add-mcp-container"},Ra={class:"add-mcp-header"},La={class:"add-mcp-title"},Ba={class:"mcp-form"},Ia={class:"mcp-form-group"},qa={class:"form-label"},Oa={class:"connection-type-options"},Ga={class:"connection-type-option"},ja={for:"mcp-connection-type-studio",class:"radio-label"},Ka={class:"connection-type-desc"},Ja={class:"connection-type-option"},za={for:"mcp-connection-type-sse",class:"radio-label"},Ha={class:"connection-type-desc"},Ya={class:"connection-type-option"},Wa={for:"mcp-connection-type-streaming",class:"radio-label"},Xa={class:"connection-type-desc"},Qa={class:"mcp-form-group"},Za={class:"form-label"},el=["placeholder"],ol={class:"mcp-form-actions"},tl=["disabled"],sl=["disabled"],nl={class:"mcp-form-instructions"},al={class:"indented-list"},ll=se({__name:"mcpConfig",setup(M){const{t:o}=ge(),s=E(!1),p=E([]),v=E(""),g=oe({connectionType:"STUDIO",configJson:""}),h=oe({show:!1,text:"",type:"success"}),c=ie(()=>g.configJson.trim().length>0),k=ie(()=>{if(!v.value.trim())return p.value;const I=v.value.toLowerCase();return p.value.filter(x=>x.mcpServerName.toLowerCase().includes(I)||x.connectionType.toLowerCase().includes(I)||x.connectionConfig.toLowerCase().includes(I))}),V=I=>I?I.length>50?I.substring(0,50)+"...":I:"",C=(I,x="success")=>{h.text=I,h.type=x,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},S=async()=>{try{s.value=!0,p.value=await Te.getAllMcpServers()}catch(I){console.error("加载MCP服务器列表失败:",I),C(o("config.basicConfig.loadConfigFailed"),"error")}finally{s.value=!1}},j=async()=>{if(!c.value){C(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(g.configJson)}catch{C(o("config.mcpConfig.invalidJson"),"error");return}try{s.value=!0;const I={connectionType:g.connectionType,configJson:g.configJson},x=await Te.addMcpServer(I);x.success?(C(o("config.mcpConfig.addSuccess")),W(),await S()):C(x.message||o("config.mcpConfig.addFailed"),"error")}catch(I){console.error("添加MCP服务器失败:",I),C(o("config.mcpConfig.addFailed"),"error")}finally{s.value=!1}},R=async I=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{s.value=!0;const x=await Te.removeMcpServer(I);x.success?(C(o("config.mcpConfig.deleteSuccess")),await S()):C(x.message||o("config.mcpConfig.deleteFailed"),"error")}catch(x){console.error("删除MCP服务器失败:",x),C(o("config.mcpConfig.deleteFailed"),"error")}finally{s.value=!1}},W=()=>{g.connectionType="STUDIO",g.configJson=""};return be(()=>{S()}),(I,x)=>(d(),u("div",da,[e("div",ua,[e("div",pa,[e("h2",null,n(t(o)("config.mcpConfig.title")),1),e("div",fa,[e("span",ga,[e("span",ma,n(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",ha,n(p.value.length),1)])])]),e("div",va,[e("div",ya,[O(e("input",{"onUpdate:modelValue":x[0]||(x[0]=F=>v.value=F),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,_a),[[J,v.value]]),x[5]||(x[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(d(),u("div",ba,[x[6]||(x[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,n(t(o)("config.loading")),1)])):(d(),u("div",Ca,[e("div",$a,[e("h3",wa,n(t(o)("config.mcpConfig.serverList")),1),k.value.length===0?(d(),u("div",ka,[x[7]||(x[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Sa,n(v.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(d(),u("div",Ta,[e("table",Na,[e("thead",null,[e("tr",null,[x[8]||(x[8]=e("th",null,"ID",-1)),e("th",null,n(t(o)("agent.name")),1),e("th",null,n(t(o)("config.mcpConfig.connectionType")),1),e("th",null,n(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,n(t(o)("common.actions")),1)])]),e("tbody",null,[(d(!0),u(H,null,Y(k.value,F=>(d(),u("tr",{key:F.id,class:"mcp-row"},[e("td",Va,n(F.id),1),e("td",Aa,[e("div",xa,[x[9]||(x[9]=e("span",{class:"server-icon"},"🔌",-1)),$(" "+n(F.mcpServerName),1)])]),e("td",Ua,[e("span",{class:ee(["connection-type-badge",F.connectionType.toLowerCase()])},n(F.connectionType),3)]),e("td",Pa,[e("div",{class:"config-preview",title:F.connectionConfig},n(V(F.connectionConfig)),9,Ea)]),e("td",Da,[e("button",{onClick:X=>R(F.id),class:"action-btn delete-btn",disabled:s.value},n(t(o)("common.delete")),9,Ma)])]))),128))])])]))]),e("div",Fa,[e("div",Ra,[e("h3",La,n(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",Ba,[e("div",Ia,[e("label",qa,n(t(o)("config.mcpConfig.connectionType"))+"：",1),e("div",Oa,[e("div",Ga,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":x[1]||(x[1]=F=>g.connectionType=F),value:"STUDIO"},null,512),[[xe,g.connectionType]]),e("label",ja,[x[10]||(x[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",Ka,n(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",Ja,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":x[2]||(x[2]=F=>g.connectionType=F),value:"SSE"},null,512),[[xe,g.connectionType]]),e("label",za,[x[11]||(x[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Ha,n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Ya,[O(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":x[3]||(x[3]=F=>g.connectionType=F),value:"STREAMING"},null,512),[[xe,g.connectionType]]),e("label",Wa,[x[12]||(x[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",Xa,n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",Qa,[e("label",Za,n(t(o)("config.mcpConfig.configJsonLabel")),1),O(e("textarea",{"onUpdate:modelValue":x[4]||(x[4]=F=>g.configJson=F),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,el),[[J,g.configJson]])]),e("div",ol,[e("button",{onClick:j,class:"action-btn add-btn",disabled:s.value},n(t(o)("common.add")),9,tl),e("button",{onClick:W,class:"action-btn reset-btn",disabled:s.value},n(t(o)("common.reset")),9,sl)])]),e("div",nl,[e("h4",null,n(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[$(n(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",al,[e("li",null,[e("strong",null,n(t(o)("config.mcpConfig.instructionStep1Local")),1),$("："+n(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,n(t(o)("config.mcpConfig.instructionStep1Remote")),1),$("："+n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,n(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,n(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,n(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),y(Ce,{name:"message-fade"},{default:G(()=>[h.show?(d(),u("div",{key:0,class:ee(["message-toast",h.type])},n(h.text),3)):D("",!0)]),_:1})]))}}),il=ne(ll,[["__scopeId","data-v-355da8bb"]]);class ve{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const s=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to get Prompt list:",s),s}}static async getPromptById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,s),s}}static async createPrompt(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Prompt:",s),s}}static async updatePrompt(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Prompt[${o}]:`,p),p}}static async deletePrompt(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Prompt[${o}]:`,s),s}}}me(ve,"BASE_URL","/api/prompt");const cl=se({__name:"Toast",setup(M,{expose:o}){const s=E(!1),p=E(""),v=E("success"),g=E("carbon:checkmark"),h=E(3e3),c=(V,C="success",S=3e3)=>{p.value=V,v.value=C,g.value=C==="success"?"carbon:checkmark":"carbon:error",h.value=S,s.value=!0,setTimeout(()=>{s.value=!1},h.value)},k=()=>{s.value=!1};return o({show:c}),(V,C)=>(d(),te(Fe,{to:"body"},[y(Ce,{name:"slide"},{default:G(()=>[s.value?(d(),u("div",{key:0,class:ee(["toast",`toast--${v.value}`]),onClick:k},[y(t(N),{icon:g.value,class:"toast-icon"},null,8,["icon"]),e("span",null,n(p.value),1)],2)):D("",!0)]),_:1})]))}}),rl=ne(cl,[["__scopeId","data-v-581895ae"]]);let pe=null;const Re=()=>{if(!pe){const M=Je(rl),o=document.createElement("div");document.body.appendChild(o),pe=M.mount(o)}return{success:(M,o)=>{pe==null||pe.show(M,"success",o)},error:(M,o)=>{pe==null||pe.show(M,"error",o)}}},dl={class:"custom-select"},ul=["title"],pl={key:0,class:"current-option"},fl={class:"option-name"},gl={key:1,class:"current-option"},ml={class:"select-options"},hl=["onClick"],vl={class:"option-name"},yl=se({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(M,{emit:o}){const s=M,p=o,v=E(!1),g=ie(()=>s.options.find(V=>V.id===s.modelValue)),h=V=>V.id===s.modelValue,c=()=>{v.value=!v.value},k=V=>{p("update:modelValue",V.id),v.value=!1};return(V,C)=>(d(),u("div",dl,[e("button",{class:"select-btn",onClick:c,title:V.placeholder},[g.value?(d(),u("span",pl,[e("span",fl,n(g.value.name),1)])):(d(),u("span",gl,n(V.placeholder),1)),y(t(N),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,ul),y(Ce,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",onClick:C[0]||(C[0]=_e(()=>{},["stop"]))},[e("div",ml,[(d(!0),u(H,null,Y(V.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:j=>k(S)},[e("span",vl,n(S.name),1),h(S)?(d(),te(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,hl))),128))])],512),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[1]||(C[1]=S=>v.value=!1)})):D("",!0)]))}}),Se=ne(yl,[["__scopeId","data-v-4c6d676f"]]),_l={class:"prompt-layout"},bl={class:"prompt-list"},Cl={class:"list-header"},$l={class:"prompt-count"},wl={key:0,class:"prompts-container"},kl=["onClick"],Sl={class:"prompt-card-header"},Tl={class:"prompt-name"},Nl={key:0,class:"prompt-desc"},Vl={class:"tags"},Al={class:"tag"},xl={key:1,class:"loading-state"},Ul={key:2,class:"empty-state"},Pl={key:0,class:"prompt-detail"},El={class:"detail-header"},Dl={class:"detail-actions"},Ml={class:"form-item"},Fl=["placeholder"],Rl={class:"form-item"},Ll={class:"form-item"},Bl={class:"form-item"},Il=["placeholder"],ql={class:"form-item"},Ol=["placeholder"],Gl={key:1,class:"no-selection"},jl={class:"modal-form"},Kl={class:"form-item"},Jl=["placeholder"],zl={class:"form-item"},Hl={class:"form-item"},Yl={class:"form-item"},Wl=["placeholder"],Xl={class:"form-item"},Ql=["placeholder"],Zl={class:"delete-confirm"},ei={class:"warning-text"},oi=se({__name:"dynamicPromptConfig",setup(M){const{t:o}=ge(),{success:s,error:p}=Re(),v=Ee(),g=E(!1),h=oe([]),c=E(null),k=E(!1),V=E(!1),C=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],S=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],j={promptName:"",messageType:"",type:"",promptDescription:""},R=oe({...j}),W=async()=>{g.value=!0;try{const a=await ve.getAllPrompts(v.namespace);a.length>0&&await I(a[0]),h.splice(0,h.length,...a)}catch(a){console.error("加载数据失败:",a),p(o("config.promptConfig.loadDataFailed")+": "+a.message)}finally{g.value=!1}},I=async a=>{try{const r=await ve.getPromptById(a.id);c.value={...r}}catch(r){console.error("加载Prompt详情失败:",r),p(o("config.promptConfig.loadDetailsFailed")+": "+r.message),c.value={...a}}},x=async()=>{if(ae(R))try{const a={...R,builtIn:!1},r=await ve.createPrompt(a);h.push(r),c.value=r,k.value=!1,s(o("config.promptConfig.createSuccess"))}catch(a){p(o("config.promptConfig.createFailed")+": "+a.message)}},F=async()=>{if(c.value&&ae(c.value))try{const a=await ve.updatePrompt(c.value.id,c.value),r=h.findIndex(_=>_.id===a.id);r!==-1&&(h[r]=a),c.value={...a},s(o("config.promptConfig.saveSuccess"))}catch(a){p(o("config.promptConfig.saveFailed")+": "+a.message)}},X=async()=>{if(c.value)try{await ve.deletePrompt(c.value.id);const a=h.findIndex(r=>r.id===c.value.id);a!==-1&&h.splice(a,1),c.value=h.length>0?h[0]:null,V.value=!1,s(o("config.promptConfig.deleteSuccess"))}catch(a){p(o("config.promptConfig.deleteFailed")+": "+a.message)}};function ae(a){const r=["promptName","messageType","type","promptContent"];for(const L of r){const z=a[L];if(z==null||typeof z=="string"&&z.trim()==="")return p(`${L} is required and cannot be empty`),!1}return!!U(h,a)}function U(a,r){const _=a.find(L=>L.promptName===r.promptName);return _&&r.id&&_.id!==r.id?(p(`Name "${r.promptName}" already exists. Please use a different name.`),!1):_&&!r.id?(p(`Name "${r.promptName}" already exists. Please use a different name.`),!1):!0}const m=()=>{R.promptName="",R.promptDescription="",R.promptContent="",Object.assign(R,j),k.value=!0},i=()=>{V.value=!0};return be(()=>{W()}),(a,r)=>(d(),te(Ne,null,{title:G(()=>[e("h2",null,n(t(o)("config.promptConfig.title")),1)]),default:G(()=>[e("div",_l,[e("div",bl,[e("div",Cl,[e("h3",null,n(t(o)("config.promptConfig.configuredprompts")),1),e("span",$l,"("+n(h.length)+n(t(o)("config.promptConfig.promptCount"))+")",1)]),g.value?D("",!0):(d(),u("div",wl,[(d(!0),u(H,null,Y(h,_=>{var L,z;return d(),u("div",{key:_.id,class:ee(["prompt-card",{active:((L=c.value)==null?void 0:L.id)===_.id}]),onClick:le=>I(_)},[e("div",Sl,[e("span",Tl,n(_.promptName),1),y(t(N),{icon:"carbon:chevron-right"})]),(z=_.promptDescription)!=null&&z.trim()?(d(),u("p",Nl,n(_.promptDescription),1)):D("",!0),e("div",Vl,[e("span",Al,n(_.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,kl)}),128))])),g.value?(d(),u("div",xl,[y(t(N),{icon:"carbon:loading",class:"loading-icon"}),$(" "+n(t(o)("common.loading")),1)])):D("",!0),!g.value&&h.length===0?(d(),u("div",Ul,[y(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.promptConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:m},[y(t(N),{icon:"carbon:add"}),$(" "+n(t(o)("config.promptConfig.createNew")),1)])]),c.value?(d(),u("div",Pl,[e("div",El,[e("h3",null,n(c.value.promptName),1),e("div",Dl,[e("button",{class:"action-btn primary",onClick:F},[y(t(N),{icon:"carbon:save"}),$(" "+n(t(o)("common.save")),1)]),c.value.builtIn?D("",!0):(d(),u("button",{key:0,class:"action-btn danger",onClick:i},[y(t(N),{icon:"carbon:trash-can"}),$(" "+n(t(o)("common.delete")),1)]))])]),e("div",Ml,[e("label",null,[$(n(t(o)("config.promptConfig.promptName"))+" ",1),r[15]||(r[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":r[0]||(r[0]=_=>c.value.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Fl),[[J,c.value.promptName]])]),e("div",Rl,[e("label",null,[$(n(t(o)("config.promptConfig.messageType"))+" ",1),r[16]||(r[16]=e("span",{class:"required"},"*",-1))]),c.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":r[2]||(r[2]=_=>c.value.messageType=_),disabled:!0},null,512)),[[J,c.value.messageType]]):(d(),te(Se,{key:0,modelValue:c.value.messageType,"onUpdate:modelValue":r[1]||(r[1]=_=>c.value.messageType=_),options:C,disabled:c.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Ll,[e("label",null,[$(n(t(o)("config.promptConfig.type"))+" ",1),r[17]||(r[17]=e("span",{class:"required"},"*",-1))]),c.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":r[4]||(r[4]=_=>c.value.type=_),disabled:!0,required:""},null,512)),[[J,c.value.type]]):(d(),te(Se,{key:0,modelValue:c.value.type,"onUpdate:modelValue":r[3]||(r[3]=_=>c.value.type=_),options:S,disabled:c.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Bl,[e("label",null,n(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":r[5]||(r[5]=_=>c.value.promptDescription=_),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Il),[[J,c.value.promptDescription]])]),e("div",ql,[e("label",null,[$(n(t(o)("config.promptConfig.promptContent"))+" ",1),r[18]||(r[18]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":r[6]||(r[6]=_=>c.value.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Ol),[[J,c.value.promptContent]])])])):(d(),u("div",Gl,[y(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.promptConfig.selectPromptHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":r[12]||(r[12]=_=>k.value=_),title:t(o)("config.promptConfig.newPrompt"),onConfirm:x},{default:G(()=>[e("div",jl,[e("div",Kl,[e("label",null,[$(n(t(o)("config.promptConfig.promptName"))+" ",1),r[19]||(r[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":r[7]||(r[7]=_=>R.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Jl),[[J,R.promptName]])]),e("div",zl,[e("label",null,[$(n(t(o)("config.promptConfig.messageType"))+" ",1),r[20]||(r[20]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:R.messageType,"onUpdate:modelValue":r[8]||(r[8]=_=>R.messageType=_),options:C,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Hl,[e("label",null,[$(n(t(o)("config.promptConfig.type"))+" ",1),r[21]||(r[21]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:R.type,"onUpdate:modelValue":r[9]||(r[9]=_=>R.type=_),options:S,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Yl,[e("label",null,n(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":r[10]||(r[10]=_=>R.promptDescription=_),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,Wl),[[J,R.promptDescription]])]),e("div",Xl,[e("label",null,[$(n(t(o)("config.promptConfig.promptContent"))+" ",1),r[22]||(r[22]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":r[11]||(r[11]=_=>R.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Ql),[[J,R.promptContent]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:V.value,"onUpdate:modelValue":r[14]||(r[14]=_=>V.value=_),title:t(o)("config.promptConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:r[13]||(r[13]=_=>V.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},n(t(o)("common.delete")),1)]),default:G(()=>{var _;return[e("div",Zl,[y(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(n(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,n((_=c.value)==null?void 0:_.promptName),1),$(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",ei,n(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),ti=ne(oi,[["__scopeId","data-v-697ad7ba"]]);class ye{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Namespace[${o}] details:`,s),s}}static async createNamespace(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Namespace:",s),s}}static async updateNamespace(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Namespace[${o}]:`,p),p}}static async deleteNamespace(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Namespace[${o}]:`,s),s}}}me(ye,"BASE_URL","/api/namespace");const si={class:"namespace-layout"},ni={class:"namespace-list"},ai={class:"list-header"},li={key:0,class:"namespaces-container"},ii=["onClick"],ci={class:"namespace-card-header"},ri={class:"namespace-name"},di={key:0,class:"loading-state"},ui={key:1,class:"empty-state"},pi={key:0,class:"namespace-detail"},fi={class:"detail-header"},gi={class:"detail-actions"},mi={class:"form-item"},hi=["placeholder"],vi={key:1,class:"no-selection"},yi={class:"modal-form"},_i={class:"form-item"},bi=["placeholder"],Ci={class:"delete-confirm"},$i={class:"warning-text"},wi=se({__name:"namespaceConfig",setup(M){const{t:o}=ge(),{success:s,error:p}=Re(),v=E(!1),g=oe([]),h=E(null),c=E(!1),k=E(!1),V={name:""},C=oe({...V}),S=async()=>{v.value=!0;try{const U=await ye.getAllNamespaces();U.length>0&&await j(U[0]),g.splice(0,g.length,...U)}catch(U){console.error("加载数据失败:",U),p(o("config.namespaceConfig.loadDataFailed")+": "+U.message)}finally{v.value=!1}},j=async U=>{try{const m=await ye.getNamespaceById(U.id);h.value={...m}}catch(m){console.error("加载Prompt详情失败:",m),p(o("config.namespaceConfig.loadDetailsFailed")+": "+m.message),h.value={...U}}},R=async()=>{if(x(C))try{const U={...C},m=await ye.createNamespace(U);g.push(m),h.value=m,c.value=!1,s(o("config.namespaceConfig.createSuccess"))}catch(U){p(o("config.namespaceConfig.createFailed")+": "+U.message)}},W=async()=>{if(h.value&&x(h.value))try{const U=await ye.updateNamespace(h.value.id,h.value),m=g.findIndex(i=>i.id===U.id);m!==-1&&(g[m]=U),h.value={...U},s(o("config.namespaceConfig.saveSuccess"))}catch(U){p(o("config.namespaceConfig.saveFailed")+": "+U.message)}},I=async()=>{if(h.value)try{await ye.deleteNamespace(h.value.id);const U=g.findIndex(m=>m.id===h.value.id);U!==-1&&g.splice(U,1),h.value=g.length>0?g[0]:null,k.value=!1,s(o("config.namespaceConfig.deleteSuccess"))}catch(U){p(o("config.namespaceConfig.deleteFailed")+": "+U.message)}};function x(U){const m=["name"];for(const a of m){const r=U[a];if(r==null||typeof r=="string"&&r.trim()==="")return p(`${a} is required and cannot be empty`),!1}return!!F(g,U)}function F(U,m){const i=U.find(a=>a.name===m.name);return i&&m.id&&i.id!==m.id?(p(`Name "${m.name}" already exists. Please use a different name.`),!1):i&&!m.id?(p(`Name "${m.name}" already exists. Please use a different name.`),!1):!0}const X=()=>{C.name="",Object.assign(C,V),c.value=!0},ae=()=>{k.value=!0};return be(()=>{S()}),(U,m)=>(d(),te(Ne,null,{title:G(()=>[e("h2",null,n(t(o)("config.namespaceConfig.title")),1)]),default:G(()=>[e("div",si,[e("div",ni,[e("div",ai,[e("h3",null,n(t(o)("config.namespaceConfig.configured")),1)]),v.value?D("",!0):(d(),u("div",li,[(d(!0),u(H,null,Y(g,i=>{var a;return d(),u("div",{key:i.id,class:ee(["namespace-card",{active:((a=h.value)==null?void 0:a.id)===i.id}]),onClick:r=>j(i)},[e("div",ci,[e("span",ri,n(i.name),1),y(t(N),{icon:"carbon:chevron-right"})])],10,ii)}),128))]))]),v.value?(d(),u("div",di,[y(t(N),{icon:"carbon:loading",class:"loading-icon"}),$(" "+n(t(o)("common.loading")),1)])):D("",!0),!v.value&&g.length===0?(d(),u("div",ui,[y(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.namespaceConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:X},[y(t(N),{icon:"carbon:add"}),$(" "+n(t(o)("config.namespaceConfig.createNew")),1)])]),h.value?(d(),u("div",pi,[e("div",fi,[e("h3",null,n(h.value.name),1),e("div",gi,[e("button",{class:"action-btn primary",onClick:W},[y(t(N),{icon:"carbon:save"}),$(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:ae},[y(t(N),{icon:"carbon:trash-can"}),$(" "+n(t(o)("common.delete")),1)])])]),e("div",mi,[e("label",null,[$(n(t(o)("config.namespaceConfig.name"))+" ",1),m[5]||(m[5]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":m[0]||(m[0]=i=>h.value.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,hi),[[J,h.value.name]])])])):(d(),u("div",vi,[y(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.namespaceConfig.selectPromptHint")),1)])),y(de,{modelValue:c.value,"onUpdate:modelValue":m[2]||(m[2]=i=>c.value=i),title:t(o)("config.namespaceConfig.newPrompt"),onConfirm:R},{default:G(()=>[e("div",yi,[e("div",_i,[e("label",null,[$(n(t(o)("config.namespaceConfig.name"))+" ",1),m[6]||(m[6]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":m[1]||(m[1]=i=>C.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,bi),[[J,C.name]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:k.value,"onUpdate:modelValue":m[4]||(m[4]=i=>k.value=i),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:m[3]||(m[3]=i=>k.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:I},n(t(o)("common.delete")),1)]),default:G(()=>{var i;return[e("div",Ci,[y(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(n(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,n((i=h.value)==null?void 0:i.name),1),$(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",$i,n(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),ki=ne(wi,[["__scopeId","data-v-d0b2912a"]]),Si=se({__name:"namespaceSwitch",setup(M){const{t:o}=ge(),{namespace:s,setNamespace:p,db:v}=Ee(),g=h=>{p(h)};return(h,c)=>(d(),u("div",null,[y(Ue,{modelValue:t(s),"onUpdate:modelValue":c[0]||(c[0]=k=>ze(s)?s.value=k:null),options:t(v),"dropdown-title":t(o)("config.promptConfig.namespace"),onChange:g,placeholder:t(o)("config.promptConfig.selectNamespace"),direction:"right",dropStyles:{minWidth:"180px"}},null,8,["modelValue","options","dropdown-title","placeholder"])]))}}),Ti={class:"config-container"},Ni={class:"config-header"},Vi={class:"header-actions"},Ai={class:"header-actions-left"},xi={class:"header-actions-right"},Ui={class:"config-content"},Pi={class:"config-nav"},Ei=["onClick"],Di={class:"config-details"},Mi=se({__name:"index",setup(M){const{t:o}=ge(),s=He(),p=We(),v=E(s.params.category||"basic"),g={basic:Me,agent:pn,model:ra,mcp:il,prompt:ti,namespace:ki},h=ie(()=>{const V=v.value;return g[V]||Me}),c=ie(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",disabled:!0,icon:"carbon:repo-artifact"}]),k=V=>{v.value=V,p.push({name:s.name,params:{...s.params,category:V},query:s.query})};return(V,C)=>(d(),u("div",Ti,[e("div",Ni,[e("div",Vi,[e("div",Ai,[e("button",{class:"action-btn",onClick:C[0]||(C[0]=S=>V.$router.push("/"))},[y(t(N),{icon:"carbon:arrow-left"}),$(" "+n(V.$t("backHome")),1)]),y(Xe)]),e("div",xi,[y(Si)])])]),e("div",Ui,[e("nav",Pi,[(d(!0),u(H,null,Y(c.value,(S,j)=>(d(),u(H,null,[S.disabled?D("",!0):(d(),u("div",{key:j,class:ee(["nav-item",{active:v.value===S.key}]),onClick:R=>k(S.key)},[y(t(N),{icon:S.icon,width:"20"},null,8,["icon"]),e("span",null,n(S.label),1)],10,Ei))],64))),256))]),e("div",Di,[(d(),te(Ye(h.value)))])])]))}}),Ii=ne(Mi,[["__scopeId","data-v-5d4a51b7"]]);export{Ii as default};
