var Be=Object.defineProperty;var Oe=(R,o,n)=>o in R?Be(R,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):R[o]=n;var me=(R,o,n)=>Oe(R,typeof o!="symbol"?o+"":o,n);import{d as ce,c as u,o as r,e,t as s,f as ge,r as B,s as ne,g as te,h as he,i as _,b as L,p as C,w as O,v as G,F as W,j as X,m as se,B as Ee,a as ie,y as z,T as ke,G as we,A as je,u as t,q as Ce,z as be,H as Ge,l as Je,D as Ke,I as Pe,n as He,J as xe,K as ze,k as Re,C as Fe,L as Ye}from"./index-DQ4WS5zp.js";import{_ as ae,I as N}from"./_plugin-vue_export-helper-CEAiZ4OQ.js";import{u as Le}from"./useToast-OOcwP7wE.js";import{L as We}from"./index-C4H7_wr3.js";const Xe={class:"switch"},Qe=["checked"],Ze={class:"switch-label"},eo=ce({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(R,{emit:o}){const n=o,m=v=>{const b=v.target.checked;n("update:switchValue",b)};return(v,b)=>(r(),u("label",Xe,[e("input",{type:"checkbox",checked:v.enabled,onChange:m},null,40,Qe),b[0]||(b[0]=e("span",{class:"slider"},null,-1)),e("span",Ze,s(v.label),1)]))}}),oo=ae(eo,[["__scopeId","data-v-d484b4a3"]]);class $e{static async getConfigsByGroup(o){try{const n=await fetch(`${this.BASE_URL}/group/${o}`);if(!n.ok)throw new Error(`Failed to get ${o} group configuration: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get ${o} group configuration:`,n),n}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const n=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Batch update configuration failed: ${n.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(n){return console.error("Batch update configuration failed:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}static async getConfigById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);if(!n.ok)throw new Error(`Failed to get configuration item: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get configuration item[${o}]:`,n),n}}static async updateConfig(o){try{const n=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to update configuration item: ${n.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(n){return console.error("Failed to update configuration item:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}}me($e,"BASE_URL","/api/config");const to={class:"config-panel"},so={class:"config-header"},no={class:"header-left"},ao={class:"config-stats"},lo={class:"stat-item"},io={class:"stat-label"},co={class:"stat-value"},ro={key:0,class:"stat-item"},uo={class:"stat-label"},po={class:"stat-value modified"},fo={class:"header-right"},go={class:"import-export-actions"},mo=["title"],ho=["title"],vo={class:"search-box"},yo=["placeholder"],_o={key:0,class:"loading-container"},bo={key:1,class:"config-groups"},Co={class:"group-header"},$o={class:"group-info"},wo={class:"group-icon"},ko={class:"group-actions"},So=["onClick","disabled","title"],To={class:"sub-groups"},No=["onClick"],Uo={class:"sub-group-info"},Vo={class:"sub-group-title"},xo={class:"item-count"},Ao={class:"config-items"},Eo={key:0,class:"config-item-content vertical-layout"},Po={class:"config-item-info"},Mo={class:"config-item-header"},Do={class:"config-label"},Ro={class:"type-badge boolean"},Fo={key:0,class:"modified-badge"},Lo=["title"],qo={class:"config-control"},Io=["value","onChange"],Bo=["value"],Oo={key:1,class:"config-item-content vertical-layout"},jo={class:"config-item-info"},Go={class:"config-item-header"},Jo={class:"config-label"},Ko={class:"type-badge select"},Ho={key:0,class:"modified-badge"},zo=["title"],Yo={class:"config-control"},Wo=["value","onChange"],Xo=["value"],Qo={key:2,class:"config-item-content vertical-layout"},Zo={class:"config-item-info"},et={class:"config-item-header"},ot={class:"config-label"},tt={class:"type-badge textarea"},st={key:0,class:"modified-badge"},nt=["title"],at={class:"config-control"},lt=["value","onInput"],it={key:3,class:"config-item-content vertical-layout"},ct={class:"config-item-info"},rt={class:"config-item-header"},dt={class:"config-label"},ut={class:"type-badge number"},pt={key:0,class:"modified-badge"},ft=["title"],gt={key:0,class:"config-meta"},mt={class:"range-info"},ht={class:"config-control"},vt=["value","onInput","min","max"],yt={key:4,class:"config-item-content vertical-layout"},_t={class:"config-item-info"},bt={class:"config-item-header"},Ct={class:"config-label"},$t={class:"type-badge string"},wt={key:0,class:"modified-badge"},kt=["title"],St={class:"config-control"},Tt=["value","onInput"],Nt={key:2,class:"empty-state"},Ut=ce({__name:"basicConfig",setup(R){const{t:o}=ge(),n=B(!0),m=B(!1),v=B([]),b=B(new Map),M=B(new Set),g=ne({show:!1,text:"",type:"success"}),i=B(""),$={headless:"config.basicConfig.browserSettings.headless",requestTimeout:"config.basicConfig.browserSettings.requestTimeout",debugDetail:"config.basicConfig.general.debugDetail",baseDir:"config.basicConfig.general.baseDir",openBrowser:"config.basicConfig.interactionSettings.openBrowser",maxSteps:"config.basicConfig.agentSettings.maxSteps",userInputTimeout:"config.basicConfig.agentSettings.userInputTimeout",maxMemory:"config.basicConfig.agentSettings.maxMemory",parallelToolCalls:"config.basicConfig.agentSettings.parallelToolCalls",forceOverrideFromYaml:"config.basicConfig.agents.forceOverrideFromYaml",enabled:"config.basicConfig.infiniteContext.enabled",parallelThreads:"config.basicConfig.infiniteContext.parallelThreads",taskContextSize:"config.basicConfig.infiniteContext.taskContextSize",allowExternalAccess:"config.basicConfig.fileSystem.allowExternalAccess"},P={manus:"config.basicConfig.groupDisplayNames.manus"},A={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},V={agent:"config.subGroupDisplayNames.agent",browser:"config.subGroupDisplayNames.browser",interaction:"config.subGroupDisplayNames.interaction",agents:"config.subGroupDisplayNames.agents",infiniteContext:"config.subGroupDisplayNames.infiniteContext",general:"config.subGroupDisplayNames.general",filesystem:"config.subGroupDisplayNames.filesystem"},x=te(()=>v.value.some(d=>d.subGroups.some(p=>p.items.some(w=>b.value.get(w.id)!==w.configValue)))),D=d=>d==="true",F=d=>parseFloat(d)||0,S=d=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[d]||1,q=d=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[d]||1e4,J=d=>typeof d=="string"?d:d.value,Q=d=>typeof d=="string"?d:d.label,le=(d,p)=>{if(typeof p=="boolean")return p.toString();if(typeof p=="string"){if(d.options&&d.options.length>0){const w=d.options.find(T=>(typeof T=="string"?T:T.label)===p||(typeof T=="string"?T:T.value)===p);if(w)return typeof w=="string"?w:w.value}return p}return String(p)},H=(d,p,w=!1)=>{let T;d.inputType==="BOOLEAN"||d.inputType==="CHECKBOX"?T=le(d,p):T=String(p),d.configValue!==T&&(d.configValue=T,d._modified=!0,(w||d.inputType==="BOOLEAN"||d.inputType==="CHECKBOX"||d.inputType==="SELECT")&&f())};let k=null;const f=()=>{k&&clearTimeout(k),k=window.setTimeout(()=>{c()},500)},l=(d,p="success")=>{g.text=d,g.type=p,g.show=!0,setTimeout(()=>{g.show=!1},3e3)},a=async()=>{try{n.value=!0;const p=["manus"].map(async T=>{try{const h=await $e.getConfigsByGroup(T);if(h.length===0)return null;const I=h.map(Y=>({...Y,displayName:$[Y.configKey]||Y.configKey,min:S(Y.configKey),max:q(Y.configKey)}));I.forEach(Y=>{b.value.set(Y.id,Y.configValue)});const K=new Map;I.forEach(Y=>{const de=Y.configSubGroup??"general";K.has(de)||K.set(de,[]),K.get(de).push(Y)});const oe=Array.from(K.entries()).map(([Y,de])=>({name:Y,displayName:V[Y]||Y,items:de}));return{name:T,displayName:P[T]||T,subGroups:oe}}catch(h){return console.warn(`加载配置组 ${T} 失败，跳过:`,h),null}}),w=await Promise.all(p);v.value=w.filter(T=>T!==null),console.log(o("config.basicConfig.loadConfigSuccess"),v.value)}catch(d){console.error(o("config.basicConfig.loadConfigFailed"),d),l(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},c=async()=>{if(!(m.value||!x.value))try{m.value=!0;const d=[];if(v.value.forEach(w=>{w.subGroups.forEach(T=>{const h=T.items.filter(I=>I._modified);d.push(...h)})}),d.length===0){l(o("config.basicConfig.noModified"));return}const p=await $e.batchUpdateConfigs(d);p.success?(d.forEach(w=>{b.value.set(w.id,w.configValue),w._modified=!1}),l(o("config.basicConfig.saveSuccess"))):l(p.message||o("config.basicConfig.saveFailed"),"error")}catch(d){console.error(o("config.basicConfig.saveFailed"),d),l(o("config.basicConfig.saveFailed"),"error")}finally{m.value=!1}},j=async d=>{if(confirm(o("config.basicConfig.resetGroupConfirm",P[d]||d)))try{m.value=!0;const w=v.value.find(I=>I.name===d);if(!w)return;const T=[];if(w.subGroups.forEach(I=>{I.items.forEach(K=>{const oe=U(K.configKey);oe!==K.configValue&&T.push({...K,configValue:oe})})}),T.length===0){l(o("config.basicConfig.isDefault"));return}const h=await $e.batchUpdateConfigs(T);h.success?(await a(),l(o("config.basicConfig.resetSuccess",T.length))):l(h.message||o("config.basicConfig.resetFailed"),"error")}catch(w){console.error(o("config.basicConfig.resetFailed"),w),l(o("config.basicConfig.resetFailed"),"error")}finally{m.value=!1}},U=d=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[d]||"",Z=(d,p)=>{const w=`${d}-${p}`;M.value.has(w)?M.value.delete(w):M.value.add(w)},ee=(d,p)=>M.value.has(`${d}-${p}`),re=te(()=>{const d=v.value.reduce((w,T)=>w+T.subGroups.reduce((h,I)=>h+I.items.length,0),0),p=v.value.reduce((w,T)=>w+T.subGroups.reduce((h,I)=>h+I.items.filter(K=>b.value.get(K.id)!==K.configValue).length,0),0);return{total:d,modified:p}}),ve=te(()=>{if(!i.value.trim())return v.value;const d=i.value.toLowerCase();return v.value.map(p=>({...p,subGroups:p.subGroups.map(w=>({...w,items:w.items.filter(T=>T.displayName.toLowerCase().includes(d)||T.configKey.toLowerCase().includes(d)||T.description&&T.description.toLowerCase().includes(d))})).filter(w=>w.items.length>0)})).filter(p=>p.subGroups.length>0)}),E=()=>{try{const d={timestamp:new Date().toISOString(),version:"1.0",configs:v.value.reduce((h,I)=>(I.subGroups.forEach(K=>{K.items.forEach(oe=>{h[oe.configKey]=oe.configValue})}),h),{})},p=JSON.stringify(d,null,2),w=new Blob([p],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(w),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),l(o("config.basicConfig.exportSuccess"))}catch(d){console.error(o("config.basicConfig.exportFailed"),d),l(o("config.basicConfig.exportFailed"),"error")}},y=d=>{var h;const p=d.target,w=(h=p.files)==null?void 0:h[0];if(!w)return;const T=new FileReader;T.onload=async I=>{var K;try{const oe=JSON.parse((K=I.target)==null?void 0:K.result);if(!oe.configs)throw new Error(o("config.basicConfig.invalidFormat"));if(!confirm(o("config.importConfirm")))return;m.value=!0;const de=[];if(v.value.forEach(qe=>{qe.subGroups.forEach(Ie=>{Ie.items.forEach(Ve=>{Object.prototype.hasOwnProperty.call(oe.configs,Ve.configKey)&&de.push({...Ve,configValue:oe.configs[Ve.configKey]})})})}),de.length===0){l(o("config.basicConfig.notFound"));return}const Me=await $e.batchUpdateConfigs(de);Me.success?(await a(),l(o("config.basicConfig.importSuccess"))):l(Me.message||o("config.basicConfig.importFailed"),"error")}catch(oe){console.error(o("config.basicConfig.importFailed"),oe),l(o("config.basicConfig.importFailed"),"error")}finally{m.value=!1,p.value=""}},T.readAsText(w)};return he(()=>{a()}),(d,p)=>(r(),u("div",to,[e("div",so,[e("div",no,[e("h2",null,s(d.$t("config.basicConfig.title")),1),e("div",ao,[e("span",lo,[e("span",io,s(d.$t("config.basicConfig.totalConfigs"))+":",1),e("span",co,s(re.value.total),1)]),re.value.modified>0?(r(),u("span",ro,[e("span",uo,s(d.$t("config.basicConfig.modified"))+":",1),e("span",po,s(re.value.modified),1)])):L("",!0)])]),e("div",fo,[e("div",go,[e("button",{onClick:E,class:"action-btn",title:d.$t("config.basicConfig.exportConfigs")}," 📤 ",8,mo),e("label",{class:"action-btn",title:d.$t("config.basicConfig.importConfigs")},[p[1]||(p[1]=C(" 📥 ")),e("input",{type:"file",accept:".json",onChange:y,style:{display:"none"}},null,32)],8,ho)]),e("div",vo,[O(e("input",{"onUpdate:modelValue":p[0]||(p[0]=w=>i.value=w),type:"text",placeholder:d.$t("config.search"),class:"search-input"},null,8,yo),[[G,i.value]]),p[2]||(p[2]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(r(),u("div",_o,[p[3]||(p[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(d.$t("config.loading")),1)])):ve.value.length>0?(r(),u("div",bo,[(r(!0),u(W,null,X(ve.value,w=>(r(),u("div",{key:w.name,class:"config-group"},[e("div",Co,[e("div",$o,[e("span",wo,s(A[w.name]||"⚙️"),1)]),e("div",ko,[e("button",{onClick:T=>j(w.name),class:"reset-btn",disabled:m.value,title:d.$t("config.resetGroupConfirm")},s(d.$t("config.reset")),9,So)]),p[4]||(p[4]=e("div",{class:"group-divider"},null,-1))]),e("div",To,[(r(!0),u(W,null,X(w.subGroups,T=>(r(),u("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:h=>Z(w.name,T.name)},[e("div",Uo,[p[5]||(p[5]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",Vo,s(d.$t(T.displayName)),1),e("span",xo,"("+s(T.items.length)+")",1)]),e("span",{class:se(["collapse-icon",{collapsed:ee(w.name,T.name)}])}," ▼ ",2)],8,No),O(e("div",Ao,[(r(!0),u(W,null,X(T.items,h=>(r(),u("div",{key:h.id,class:se(["config-item",{modified:b.value.get(h.id)!==h.configValue}])},[h.inputType==="BOOLEAN"||h.inputType==="CHECKBOX"?(r(),u("div",Eo,[e("div",Po,[e("div",Mo,[e("label",Do,[C(s(d.$t(h.displayName)||h.description)+" ",1),e("span",Ro,s(h.inputType==="CHECKBOX"?d.$t("config.types.checkbox"):d.$t("config.types.boolean")),1),b.value.get(h.id)!==h.configValue?(r(),u("span",Fo,s(d.$t("config.modified")),1)):L("",!0)]),e("span",{class:"config-key",title:h.configKey},s(h.configKey),9,Lo)])]),e("div",qo,[h.options&&h.options.length>0?(r(),u("select",{key:0,class:"config-input select-input",value:h.configValue,onChange:I=>{var K;return H(h,((K=I.target)==null?void 0:K.value)||"")}},[(r(!0),u(W,null,X(h.options,I=>(r(),u("option",{key:J(I),value:J(I)},s(Q(I)),9,Bo))),128))],40,Io)):(r(),ie(oo,{key:1,enabled:D(h.configValue),label:"","onUpdate:switchValue":I=>H(h,I)},null,8,["enabled","onUpdate:switchValue"]))])])):h.inputType==="SELECT"?(r(),u("div",Oo,[e("div",jo,[e("div",Go,[e("label",Jo,[C(s(d.$t(h.displayName)||h.description)+" ",1),e("span",Ko,s(d.$t("config.types.select")),1),b.value.get(h.id)!==h.configValue?(r(),u("span",Ho,s(d.$t("config.modified")),1)):L("",!0)]),e("span",{class:"config-key",title:h.configKey},s(h.configKey),9,zo)])]),e("div",Yo,[e("select",{class:"config-input select-input",value:h.configValue,onChange:I=>{var K;return H(h,((K=I.target)==null?void 0:K.value)||"")}},[(r(!0),u(W,null,X(h.options||[],I=>(r(),u("option",{key:J(I),value:J(I)},s(Q(I)),9,Xo))),128))],40,Wo)])])):h.inputType==="TEXTAREA"?(r(),u("div",Qo,[e("div",Zo,[e("div",et,[e("label",ot,[C(s(d.$t(h.displayName)||h.description)+" ",1),e("span",tt,s(d.$t("config.types.textarea")),1),b.value.get(h.id)!==h.configValue?(r(),u("span",st,s(d.$t("config.modified")),1)):L("",!0)]),e("span",{class:"config-key",title:h.configKey},s(h.configKey),9,nt)])]),e("div",at,[e("textarea",{class:"config-input textarea-input",value:h.configValue,onInput:I=>{var K;return H(h,((K=I.target)==null?void 0:K.value)||"")},onBlur:f,rows:"3"},null,40,lt)])])):h.inputType==="NUMBER"?(r(),u("div",it,[e("div",ct,[e("div",rt,[e("label",dt,[C(s(d.$t(h.displayName)||h.description)+" ",1),e("span",ut,s(d.$t("config.types.number")),1),b.value.get(h.id)!==h.configValue?(r(),u("span",pt,s(d.$t("config.modified")),1)):L("",!0)]),e("span",{class:"config-key",title:h.configKey},s(h.configKey),9,ft),h.min||h.max?(r(),u("div",gt,[e("span",mt,s(d.$t("config.range"))+": "+s(h.min||0)+" - "+s(h.max||"∞"),1)])):L("",!0)])]),e("div",ht,[e("input",{type:"number",class:"config-input number-input",value:F(h.configValue),onInput:I=>{var K;return H(h,((K=I.target)==null?void 0:K.value)||"")},onBlur:f,min:h.min||1,max:h.max||1e4},null,40,vt)])])):(r(),u("div",yt,[e("div",_t,[e("div",bt,[e("label",Ct,[C(s(d.$t(h.displayName)||h.description)+" ",1),e("span",$t,s(h.inputType==="TEXT"?d.$t("config.types.text"):d.$t("config.types.string")),1),b.value.get(h.id)!==h.configValue?(r(),u("span",wt,s(d.$t("config.modified")),1)):L("",!0)]),e("span",{class:"config-key",title:h.configKey},s(h.configKey),9,kt)])]),e("div",St,[e("input",{type:"text",class:"config-input text-input",value:h.configValue,onInput:I=>{var K;return H(h,((K=I.target)==null?void 0:K.value)||"")},onBlur:f},null,40,Tt)])]))],2))),128))],512),[[Ee,!ee(w.name,T.name)]])]))),128))])]))),128))])):(r(),u("div",Nt,[e("p",null,s(d.$t("config.notFound")),1)])),_(ke,{name:"message-fade"},{default:z(()=>[g.show?(r(),u("div",{key:0,class:se(["message-toast",g.type])},s(g.text),3)):L("",!0)]),_:1})]))}}),De=ae(Ut,[["__scopeId","data-v-bb27f059"]]),Vt={},xt={class:"config-config"},At={class:"panel-header"},Et={class:"panel-actions"};function Pt(R,o){return r(),u("div",xt,[e("div",At,[we(R.$slots,"title",{},void 0),e("div",Et,[we(R.$slots,"actions",{},void 0)])]),we(R.$slots,"default",{},void 0)])}const Ne=ae(Vt,[["render",Pt],["__scopeId","data-v-c91688e7"]]),Mt={class:"modal-header"},Dt={class:"modal-content"},Rt={class:"modal-footer"},Ft=ce({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(R){const o=n=>{n.target===n.currentTarget&&(n.stopPropagation(),n.preventDefault())};return(n,m)=>(r(),ie(je,{to:"body"},[_(ke,{name:"modal"},{default:z(()=>[R.modelValue?(r(),u("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:m[3]||(m[3]=Ce(()=>{},["stop"]))},[e("div",Mt,[e("h3",null,s(R.title),1),e("button",{class:"close-btn",onClick:m[0]||(m[0]=v=>n.$emit("update:modelValue",!1))},[_(t(N),{icon:"carbon:close"})])]),e("div",Dt,[we(n.$slots,"default",{},void 0,!0)]),e("div",Rt,[we(n.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:m[1]||(m[1]=v=>n.$emit("update:modelValue",!1))},s(n.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:m[2]||(m[2]=v=>n.$emit("confirm"))},s(n.$t("common.confirm")),1)],!0)])])])):L("",!0)]),_:3})]))}}),pe=ae(Ft,[["__scopeId","data-v-baaf1c89"]]),Lt={class:"tool-selection-content"},qt={class:"tool-controls"},It={class:"search-container"},Bt={class:"sort-container"},Ot={class:"tool-summary"},jt={class:"summary-text"},Gt={key:0,class:"tool-groups"},Jt=["onClick"],Kt={class:"group-title-area"},Ht={class:"group-name"},zt={class:"group-count"},Yt={class:"group-enable-all"},Wt=["checked","onChange","data-group"],Xt={class:"tool-info"},Qt={class:"tool-selection-name"},Zt={key:0,class:"tool-selection-desc"},es={class:"tool-actions"},os=["checked","onChange"],ts={key:1,class:"empty-state"},ss=ce({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(R,{emit:o}){const n=R,m=o,v=te({get:()=>n.modelValue,set:k=>m("update:modelValue",k)}),b=B(""),M=B("group"),g=B(new Set),i=B([]),$=(k,f)=>{const l=document.querySelector(`input[data-group="${k}"]`);l&&(l.indeterminate=q(f))};be(()=>n.selectedToolIds,k=>{i.value=[...k]},{immediate:!0});const P=te(()=>{let k=n.tools.filter(f=>f.key);if(b.value){const f=b.value.toLowerCase();k=k.filter(l=>{var a;return l.name.toLowerCase().includes(f)||l.description.toLowerCase().includes(f)||(((a=l.serviceGroup)==null?void 0:a.toLowerCase().includes(f))??!1)})}switch(M.value){case"name":k=[...k].sort((f,l)=>f.name.localeCompare(l.name));break;case"enabled":k=[...k].sort((f,l)=>{const a=i.value.includes(f.key),c=i.value.includes(l.key);return a&&!c?-1:!a&&c?1:f.name.localeCompare(l.name)});break;case"group":default:k=[...k].sort((f,l)=>{const a=f.serviceGroup??"未分组",c=l.serviceGroup??"未分组";return a!==c?a.localeCompare(c):f.name.localeCompare(l.name)});break}return k}),A=te(()=>{const k=new Map;return P.value.forEach(f=>{const l=f.serviceGroup??"未分组";k.has(l)||k.set(l,[]),k.get(l).push(f)}),new Map([...k.entries()].sort())}),V=te(()=>P.value.length);be([i,A],()=>{Je(()=>{for(const[k,f]of A.value)$(k,f)})},{flush:"post",deep:!1});const x=k=>i.value.includes(k),D=(k,f)=>{f.stopPropagation();const a=f.target.checked;if(!k){console.error("toolKey is undefined, cannot proceed");return}a?i.value.includes(k)||(i.value=[...i.value,k]):i.value=i.value.filter(c=>c!==k)},F=k=>k.filter(f=>i.value.includes(f.key)),S=k=>k.length>0&&k.every(f=>i.value.includes(f.key)),q=k=>{const f=F(k).length;return f>0&&f<k.length},J=(k,f)=>{f.stopPropagation();const a=f.target.checked,c=k.map(j=>j.key);if(a){const j=[...i.value];c.forEach(U=>{j.includes(U)||j.push(U)}),i.value=j}else i.value=i.value.filter(j=>!c.includes(j))},Q=k=>{g.value.has(k)?g.value.delete(k):g.value.add(k)},le=()=>{m("confirm",[...i.value]),m("update:modelValue",!1)},H=()=>{i.value=[...n.selectedToolIds],m("update:modelValue",!1)};return be(v,k=>{if(k){g.value.clear();const f=Array.from(A.value.keys());f.length>1&&f.slice(1).forEach(l=>{g.value.add(l)})}}),(k,f)=>(r(),ie(pe,{modelValue:v.value,"onUpdate:modelValue":[f[4]||(f[4]=l=>v.value=l),H],title:"选择工具",onConfirm:le},{default:z(()=>[e("div",Lt,[e("div",qt,[e("div",It,[O(e("input",{"onUpdate:modelValue":f[0]||(f[0]=l=>b.value=l),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[G,b.value]])]),e("div",Bt,[O(e("select",{"onUpdate:modelValue":f[1]||(f[1]=l=>M.value=l),class:"sort-select"},f[5]||(f[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Ge,M.value]])])]),e("div",Ot,[e("span",jt," 共 "+s(A.value.size)+" 个服务组，"+s(V.value)+" 个工具 (已选择 "+s(i.value.length)+" 个) ",1)]),A.value.size>0?(r(),u("div",Gt,[(r(!0),u(W,null,X(A.value,([l,a])=>(r(),u("div",{key:l,class:"tool-group"},[e("div",{class:se(["tool-group-header",{collapsed:g.value.has(l)}]),onClick:c=>Q(l)},[e("div",Kt,[_(t(N),{icon:g.value.has(l)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),_(t(N),{icon:"carbon:folder",class:"group-icon"}),e("span",Ht,s(l),1),e("span",zt," ("+s(F(a).length)+"/"+s(a.length)+") ",1)]),e("div",{class:"group-actions",onClick:f[2]||(f[2]=Ce(()=>{},["stop"]))},[e("label",Yt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:S(a),onChange:c=>J(a,c),"data-group":l},null,40,Wt),f[6]||(f[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Jt),e("div",{class:se(["tool-group-content",{collapsed:g.value.has(l)}])},[(r(!0),u(W,null,X(a.filter(c=>c&&c.key),c=>(r(),u("div",{key:c.key,class:"tool-selection-item"},[e("div",Xt,[e("div",Qt,s(c.name),1),c.description?(r(),u("div",Zt,s(c.description),1)):L("",!0)]),e("div",es,[e("label",{class:"tool-enable-switch",onClick:f[3]||(f[3]=Ce(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:x(c.key),onChange:j=>D(c.key,j)},null,40,os),f[7]||(f[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(r(),u("div",ts,[_(t(N),{icon:"carbon:tools",class:"empty-icon"}),f[8]||(f[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),ns=ae(ss,[["__scopeId","data-v-79f6a572"]]);class fe{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}else{const n=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(n)).json()}}catch(n){throw console.error("Failed to get Agent list:",n),n}}static async getAgentById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Agent[${o}] details:`,n),n}}static async createAgent(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Agent:",n),n}}static async updateAgent(o,n){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Agent[${o}]:`,m),m}}static async deleteAgent(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Agent[${o}]:`,n),n}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}me(fe,"BASE_URL","/api/agents");class ue{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Model[${o}] details:`,n),n}}static async createModel(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Model:",n),n}}static async updateModel(o,n){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(m.status===499)throw new Error("Request rejected, please modify the model configuration in the configuration file");return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Model[${o}]:`,m),m}}static async deleteModel(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Model");if(n.status===499)throw new Error("Request rejected, please modify the model configuration in the configuration file");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Model[${o}]:`,n),n}}}me(ue,"BASE_URL","/api/models");const Ue=Ke("namespace",()=>{const R=B("default");function o(v){R.value=v}const n=B([]);function m(v){n.value=v}return{namespace:R,namespaces:n,setCurrentNs:o,setNamespaces:m}}),as=["disabled"],ls={class:"agent-layout"},is={class:"agent-list"},cs={class:"list-header"},rs={class:"agent-count"},ds={key:0,class:"agents-container"},us=["onClick"],ps={class:"agent-card-header"},fs={class:"agent-name"},gs={class:"agent-desc"},ms={key:0,class:"agent-model"},hs={class:"model-tag"},vs={class:"model-tag"},ys={key:1,class:"agent-tools"},_s={key:0,class:"tool-more"},bs={key:1,class:"loading-state"},Cs={key:2,class:"empty-state"},$s={key:0,class:"agent-detail"},ws={class:"detail-header"},ks={class:"detail-actions"},Ss={class:"form-item"},Ts=["placeholder"],Ns={class:"form-item"},Us=["placeholder"],Vs={class:"form-item"},xs=["value","placeholder"],As={class:"model-section"},Es={class:"form-item"},Ps={class:"model-chooser"},Ms=["title"],Ds={key:0,class:"current-model"},Rs={class:"model-type"},Fs={class:"model-name"},Ls={key:1,class:"current-model"},qs={class:"current-model"},Is={class:"dropdown-header"},Bs={class:"model-options"},Os=["onClick"],js={class:"model-type"},Gs={class:"model-name"},Js={class:"tools-section"},Ks={class:"assigned-tools"},Hs={class:"section-header"},zs={class:"tools-grid"},Ys={class:"tool-info"},Ws={class:"tool-name"},Xs={class:"tool-desc"},Qs={key:0,class:"no-tools"},Zs={key:1,class:"no-selection"},en={class:"modal-form"},on={class:"form-item"},tn=["placeholder"],sn={class:"form-item"},nn=["placeholder"],an={class:"form-item"},ln=["value","placeholder"],cn={class:"delete-confirm"},rn={class:"warning-text"},dn=ce({__name:"agentConfig",setup(R){const{t:o}=ge(),n=Ue(),{namespace:m}=Pe(n),v=B(!1),b=B(""),M=B(""),g=ne([]),i=B(null),$=ne([]),P=B(!1),A=B(!1),V=B(!1),x=B(!1),D=B(null),F=ne([]),S=()=>{x.value=!x.value},q=E=>{D.value=E,x.value=!1},J=ne({name:"",description:"",nextStepPrompt:""}),Q=E=>{const y=$.find(d=>d.key===E);return y?y.name:E},le=E=>{const y=$.find(d=>d.key===E);return y?y.description:""},H=(E,y)=>{y==="success"?(M.value=E,setTimeout(()=>{M.value=""},3e3)):(b.value=E,setTimeout(()=>{b.value=""},5e3))},k=async()=>{v.value=!0;try{const[E,y,d]=await Promise.all([fe.getAllAgents(m.value),fe.getAvailableTools(),ue.getAllModels()]),p=E.map(w=>({...w,availableTools:w.availableTools,...d}));g.splice(0,g.length,...p),$.splice(0,$.length,...y),F.splice(0,F.length,...d),p.length>0&&await f(p[0])}catch(E){console.error("加载数据失败:",E),H(o("config.agentConfig.loadDataFailed")+": "+E.message,"error");const y=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],d=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];$.splice(0,$.length,...y),g.splice(0,g.length,...d),d.length>0&&(i.value=d[0])}finally{v.value=!1}},f=async E=>{try{const y=await fe.getAgentById(E.id);i.value={...y,availableTools:y.availableTools},D.value=y.model??null}catch(y){console.error("加载Agent详情失败:",y),H(o("config.agentConfig.loadDetailsFailed")+": "+y.message,"error"),i.value={...E,availableTools:E.availableTools}}},l=()=>{J.name="",J.description="",J.nextStepPrompt="",P.value=!0},a=async()=>{var E;if(!J.name.trim()||!J.description.trim()){H(o("config.agentConfig.requiredFields"),"error");return}try{const y={name:J.name.trim(),description:J.description.trim(),nextStepPrompt:((E=J.nextStepPrompt)==null?void 0:E.trim())??"",availableTools:[],namespace:m.value},d=await fe.createAgent(y);g.push(d),i.value=d,P.value=!1,H(o("config.agentConfig.createSuccess"),"success")}catch(y){H(o("config.agentConfig.createFailed")+": "+y.message,"error")}},c=()=>{V.value=!0},j=E=>{i.value&&(i.value.availableTools=[...E])},U=async()=>{if(i.value){if(!i.value.name.trim()||!i.value.description.trim()){H(o("config.agentConfig.requiredFields"),"error");return}try{i.value.model=D.value;const E=await fe.updateAgent(i.value.id,i.value),y=g.findIndex(d=>d.id===E.id);y!==-1&&(g[y]=E),i.value=E,i.value.model=D.value,H(o("config.agentConfig.saveSuccess"),"success")}catch(E){H(o("config.agentConfig.saveFailed")+": "+E.message,"error")}}},Z=()=>{A.value=!0},ee=async()=>{if(i.value)try{await fe.deleteAgent(i.value.id);const E=g.findIndex(y=>y.id===i.value.id);E!==-1&&g.splice(E,1),i.value=g.length>0?g[0]:null,A.value=!1,H(o("config.agentConfig.deleteSuccess"),"success")}catch(E){H(o("config.agentConfig.deleteFailed")+": "+E.message,"error")}},re=()=>{const E=document.createElement("input");E.type="file",E.accept=".json",E.onchange=y=>{var p;const d=(p=y.target.files)==null?void 0:p[0];if(d){const w=new FileReader;w.onload=async T=>{var h;try{const I=JSON.parse((h=T.target)==null?void 0:h.result);if(!I.name||!I.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:K,...oe}=I,Y=await fe.createAgent(oe);g.push(Y),i.value=Y,H(o("config.agentConfig.importSuccess"),"success")}catch(I){H(o("config.agentConfig.importFailed")+": "+I.message,"error")}},w.readAsText(d)}},E.click()},ve=()=>{if(i.value)try{const E=JSON.stringify(i.value,null,2),y=new Blob([E],{type:"application/json"}),d=URL.createObjectURL(y),p=document.createElement("a");p.href=d,p.download=`agent-${i.value.name}-${new Date().toISOString().split("T")[0]}.json`,p.click(),URL.revokeObjectURL(d),H(o("config.agentConfig.exportSuccess"),"success")}catch(E){H(o("config.agentConfig.exportFailed")+": "+E.message,"error")}};return he(()=>{k()}),be(()=>m.value,(E,y)=>{E!==y&&k()}),(E,y)=>(r(),ie(Ne,null,{title:z(()=>[e("h2",null,s(t(o)("config.agentConfig.title")),1)]),actions:z(()=>[e("button",{class:"action-btn",onClick:re},[_(t(N),{icon:"carbon:upload"}),C(" "+s(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ve,disabled:!i.value},[_(t(N),{icon:"carbon:download"}),C(" "+s(t(o)("config.agentConfig.export")),1)],8,as)]),default:z(()=>{var d;return[e("div",ls,[e("div",is,[e("div",cs,[e("h3",null,s(t(o)("config.agentConfig.configuredAgents")),1),e("span",rs,"("+s(g.length)+s(t(o)("config.agentConfig.agentCount"))+")",1)]),v.value?L("",!0):(r(),u("div",ds,[(r(!0),u(W,null,X(g,p=>{var w,T;return r(),u("div",{key:p.id,class:se(["agent-card",{active:((w=i.value)==null?void 0:w.id)===p.id}]),onClick:h=>f(p)},[e("div",ps,[e("span",fs,s(p.name),1),_(t(N),{icon:"carbon:chevron-right"})]),e("p",gs,s(p.description),1),p.model?(r(),u("div",ms,[e("span",hs,s(p.model.type),1),e("span",vs,s(p.model.modelName),1)])):L("",!0),((T=p.availableTools)==null?void 0:T.length)>0?(r(),u("div",ys,[(r(!0),u(W,null,X(p.availableTools.slice(0,3),h=>(r(),u("span",{key:h,class:"tool-tag"},s(Q(h)),1))),128)),p.availableTools.length>3?(r(),u("span",_s," +"+s(p.availableTools.length-3),1)):L("",!0)])):L("",!0)],10,us)}),128))])),v.value?(r(),u("div",bs,[_(t(N),{icon:"carbon:loading",class:"loading-icon"}),C(" "+s(t(o)("common.loading")),1)])):L("",!0),!v.value&&g.length===0?(r(),u("div",Cs,[_(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.agentConfig.noAgent")),1)])):L("",!0),e("button",{class:"add-btn",onClick:l},[_(t(N),{icon:"carbon:add"}),C(" "+s(t(o)("config.agentConfig.createNew")),1)])]),i.value?(r(),u("div",$s,[e("div",ws,[e("h3",null,s(i.value.name),1),e("div",ks,[e("button",{class:"action-btn primary",onClick:U},[_(t(N),{icon:"carbon:save"}),C(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:Z},[_(t(N),{icon:"carbon:trash-can"}),C(" "+s(t(o)("common.delete")),1)])])]),e("div",Ss,[e("label",null,[C(s(t(o)("config.agentConfig.agentName"))+" ",1),y[15]||(y[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":y[0]||(y[0]=p=>i.value.name=p),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Ts),[[G,i.value.name]])]),e("div",Ns,[e("label",null,[C(s(t(o)("config.agentConfig.description"))+" ",1),y[16]||(y[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":y[1]||(y[1]=p=>i.value.description=p),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,Us),[[G,i.value.description]])]),e("div",Vs,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:i.value.nextStepPrompt||"",onInput:y[2]||(y[2]=p=>i.value.nextStepPrompt=p.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,xs)]),e("div",As,[e("h4",null,s(t(o)("config.agentConfig.modelConfiguration")),1),e("div",Es,[e("div",Ps,[e("button",{class:"model-btn",onClick:S,title:E.$t("model.switch")},[_(t(N),{icon:"carbon:build-run",width:"18"}),D.value?(r(),u("span",Ds,[e("span",Rs,s(D.value.type),1),y[17]||(y[17]=e("span",{class:"spacer"},null,-1)),e("span",Fs,s(D.value.modelName),1)])):(r(),u("span",Ls,[e("span",qs,s(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),_(t(N),{icon:x.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ms),x.value?(r(),u("div",{key:0,class:"model-dropdown",onClick:y[4]||(y[4]=Ce(()=>{},["stop"]))},[e("div",Is,[e("span",null,s(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:y[3]||(y[3]=p=>x.value=!1)},[_(t(N),{icon:"carbon:close",width:"16"})])]),e("div",Bs,[(r(!0),u(W,null,X(F,p=>{var w,T;return r(),u("button",{key:p.id,class:se(["model-option",{active:((w=D.value)==null?void 0:w.id)===p.id}]),onClick:h=>q(p)},[e("span",js,s(p.type),1),e("span",Gs,s(p.modelName),1),((T=D.value)==null?void 0:T.id)===p.id?(r(),ie(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):L("",!0)],10,Os)}),128))])])):L("",!0),x.value?(r(),u("div",{key:1,class:"backdrop",onClick:y[5]||(y[5]=p=>x.value=!1)})):L("",!0)])])]),e("div",Js,[e("h4",null,s(t(o)("config.agentConfig.toolConfiguration")),1),e("div",Ks,[e("div",Hs,[e("span",null,s(t(o)("config.agentConfig.assignedTools"))+" ("+s((i.value.availableTools||[]).length)+")",1),$.length>0?(r(),u("button",{key:0,class:"action-btn small",onClick:c},[_(t(N),{icon:"carbon:add"}),C(" "+s(t(o)("config.agentConfig.addRemoveTools")),1)])):L("",!0)]),e("div",zs,[(r(!0),u(W,null,X(i.value.availableTools||[],p=>(r(),u("div",{key:p,class:"tool-item assigned"},[e("div",Ys,[e("span",Ws,s(Q(p)),1),e("span",Xs,s(le(p)),1)])]))),128)),i.value.availableTools.length===0?(r(),u("div",Qs,[_(t(N),{icon:"carbon:tool-box"}),e("span",null,s(t(o)("config.agentConfig.noAssignedTools")),1)])):L("",!0)])])])])):(r(),u("div",Zs,[_(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.agentConfig.selectAgentHint")),1)]))]),_(pe,{modelValue:P.value,"onUpdate:modelValue":y[9]||(y[9]=p=>P.value=p),title:t(o)("config.agentConfig.newAgent"),onConfirm:a},{default:z(()=>[e("div",en,[e("div",on,[e("label",null,[C(s(t(o)("config.agentConfig.agentName"))+" ",1),y[18]||(y[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":y[6]||(y[6]=p=>J.name=p),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,tn),[[G,J.name]])]),e("div",sn,[e("label",null,[C(s(t(o)("config.agentConfig.description"))+" ",1),y[19]||(y[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":y[7]||(y[7]=p=>J.description=p),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,nn),[[G,J.description]])]),e("div",an,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:J.nextStepPrompt||"",onInput:y[8]||(y[8]=p=>J.nextStepPrompt=p.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,ln)])])]),_:1},8,["modelValue","title"]),_(ns,{modelValue:V.value,"onUpdate:modelValue":y[10]||(y[10]=p=>V.value=p),tools:$,"selected-tool-ids":((d=i.value)==null?void 0:d.availableTools)||[],onConfirm:j},null,8,["modelValue","tools","selected-tool-ids"]),_(pe,{modelValue:A.value,"onUpdate:modelValue":y[12]||(y[12]=p=>A.value=p),title:t(o)("config.agentConfig.deleteConfirm")},{footer:z(()=>[e("button",{class:"cancel-btn",onClick:y[11]||(y[11]=p=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:ee},s(t(o)("common.delete")),1)]),default:z(()=>{var p;return[e("div",cn,[_(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[C(s(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s((p=i.value)==null?void 0:p.name),1),C(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",rn,s(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),b.value?(r(),u("div",{key:0,class:"error-toast",onClick:y[13]||(y[13]=p=>b.value="")},[_(t(N),{icon:"carbon:error"}),C(" "+s(b.value),1)])):L("",!0),M.value?(r(),u("div",{key:1,class:"success-toast",onClick:y[14]||(y[14]=p=>M.value="")},[_(t(N),{icon:"carbon:checkmark"}),C(" "+s(M.value),1)])):L("",!0)]}),_:1}))}}),un=ae(dn,[["__scopeId","data-v-85759186"]]),pn={class:"custom-select"},fn=["title"],gn={key:0,class:"current-option"},mn={class:"option-name"},hn={key:1,class:"current-option"},vn={class:"dropdown-header"},yn={class:"select-options"},_n=["onClick"],bn={class:"option-name"},Cn=ce({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{},onChange:{type:Function}},emits:["update:modelValue"],setup(R,{emit:o}){const n=R,m=o,v=B(!1),b=te(()=>n.options.find($=>$.id===n.modelValue)),M=$=>$.id===n.modelValue,g=()=>{v.value=!v.value},i=$=>{n.onChange?n.onChange($.id,$):m("update:modelValue",$.id),v.value=!1};return($,P)=>(r(),u("div",pn,[e("button",{class:"select-btn",onClick:g,title:$.placeholder},[_(t(N),{icon:n.icon||"carbon:select-01",width:"18"},null,8,["icon"]),b.value?(r(),u("span",gn,[e("span",mn,s(b.value.name),1)])):(r(),u("span",hn,s($.placeholder),1)),_(t(N),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,fn),_(ke,{name:"slideDown"},{default:z(()=>[O(e("div",{class:"select-dropdown",style:He({...$.dropStyles,...n.direction==="right"?{right:0}:{left:0}}),onClick:P[1]||(P[1]=Ce(()=>{},["stop"]))},[e("div",vn,[e("span",null,s($.dropdownTitle),1),e("button",{class:"close-btn",onClick:P[0]||(P[0]=A=>v.value=!1)},[_(t(N),{icon:"carbon:close",width:"16"})])]),e("div",yn,[(r(!0),u(W,null,X($.options,A=>(r(),u("button",{key:A.id,class:se(["select-option",{active:M(A)}]),onClick:V=>i(A)},[e("span",bn,s(A.name),1),M(A)?(r(),ie(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):L("",!0)],10,_n))),128))])],4),[[Ee,v.value]])]),_:1}),v.value?(r(),u("div",{key:0,class:"backdrop",onClick:P[2]||(P[2]=A=>v.value=!1)})):L("",!0)]))}}),Ae=ae(Cn,[["__scopeId","data-v-b753c57e"]]),$n=["disabled"],wn={class:"model-layout"},kn={class:"model-list"},Sn={class:"list-header"},Tn={class:"model-count"},Nn={key:0,class:"models-container"},Un=["onClick"],Vn={class:"model-card-header"},xn={class:"model-name"},An={class:"model-desc"},En={key:0,class:"model-type"},Pn={class:"model-tag"},Mn={key:1,class:"loading-state"},Dn={key:2,class:"empty-state"},Rn={key:0,class:"model-detail"},Fn={class:"detail-header"},Ln={class:"detail-actions"},qn={class:"form-item"},In={class:"form-item"},Bn=["placeholder"],On={class:"form-item"},jn=["placeholder"],Gn={class:"form-item"},Jn=["placeholder"],Kn={class:"form-item"},Hn=["placeholder"],zn={class:"form-item"},Yn=["placeholder"],Wn={key:1,class:"no-selection"},Xn={class:"modal-form"},Qn={class:"form-item"},Zn={class:"form-item"},ea=["placeholder"],oa={class:"form-item"},ta=["placeholder"],sa={class:"form-item"},na=["placeholder"],aa={class:"form-item"},la=["placeholder"],ia={class:"form-item"},ca=["placeholder"],ra={class:"delete-confirm"},da={class:"warning-text"},ua=ce({__name:"modelConfig",setup(R){const{t:o}=ge(),n=B(!1),m=B(""),v=B(""),b=ne([]),M=ne([]),g=B(null),i=B(!1),$=B(!1),P=te({get(){var f;return(f=g.value)!=null&&f.headers?JSON.stringify(g.value.headers,null,2):""},set(f){g.value&&(g.value.headers=f.trim()?JSON.parse(f):null)}}),A=te({get(){return V.headers?JSON.stringify(V.headers,null,2):""},set(f){V.headers=f.trim()?JSON.parse(f):null}}),V=ne({baseUrl:"",headers:null,apiKey:"",modelName:"",modelDescription:"",type:""}),x=(f,l)=>{l==="success"?(v.value=f,setTimeout(()=>{v.value=""},3e3)):(m.value=f,setTimeout(()=>{m.value=""},5e3))},D=async()=>{n.value=!0;try{const[f,l]=await Promise.all([ue.getAllModels(),ue.getAllTypes()]),a=f.map(c=>({...c}));b.splice(0,b.length,...a),M.splice(0,M.length,...l),a.length>0&&await F(a[0])}catch(f){console.error("加载数据失败:",f),x(o("config.modelConfig.loadDataFailed")+": "+f.message,"error")}finally{n.value=!1}},F=async f=>{try{const l=await ue.getModelById(f.id);g.value={...l}}catch(l){console.error("加载Model详情失败:",l),x(o("config.modelConfig.loadDetailsFailed")+": "+l.message,"error"),g.value={...f}}},S=()=>{V.baseUrl="",V.headers=null,V.apiKey="",V.modelName="",V.modelDescription="",V.type="",i.value=!0},q=async()=>{if(!V.modelName.trim()||!V.modelDescription.trim()){x(o("config.modelConfig.requiredFields"),"error");return}try{const f={baseUrl:V.baseUrl.trim(),headers:V.headers,apiKey:V.apiKey.trim(),modelName:V.modelName.trim(),modelDescription:V.modelDescription.trim(),type:V.type.trim()},l=await ue.createModel(f);b.push(l),g.value=l,i.value=!1,x(o("config.modelConfig.createSuccess"),"success")}catch(f){x(o("config.modelConfig.createFailed")+": "+f.message,"error")}},J=async()=>{if(g.value){if(!g.value.modelName.trim()||!g.value.modelDescription.trim()){x(o("config.modelConfig.requiredFields"),"error");return}try{const f=await ue.updateModel(g.value.id,g.value),l=b.findIndex(a=>a.id===f.id);l!==-1&&(b[l]=f),g.value=f,x(o("config.modelConfig.saveSuccess"),"success")}catch(f){x(o("config.modelConfig.saveFailed")+": "+f.message,"error")}}},Q=()=>{$.value=!0},le=async()=>{if(g.value)try{await ue.deleteModel(g.value.id);const f=b.findIndex(l=>l.id===g.value.id);f!==-1&&b.splice(f,1),g.value=b.length>0?b[0]:null,$.value=!1,x(o("config.modelConfig.deleteSuccess"),"success")}catch(f){x(o("config.modelConfig.deleteFailed")+": "+f.message,"error")}},H=()=>{const f=document.createElement("input");f.type="file",f.accept=".json",f.onchange=l=>{var c;const a=(c=l.target.files)==null?void 0:c[0];if(a){const j=new FileReader;j.onload=async U=>{var Z;try{const ee=JSON.parse((Z=U.target)==null?void 0:Z.result);if(!ee.modelName||!ee.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:re,...ve}=ee,E=await ue.createModel(ve);b.push(E),g.value=E,x(o("config.modelConfig.importSuccess"),"success")}catch(ee){x(o("config.modelConfig.importFailed")+": "+ee.message,"error")}},j.readAsText(a)}},f.click()},k=()=>{if(g.value)try{const f=JSON.stringify(g.value,null,2),l=new Blob([f],{type:"application/json"}),a=URL.createObjectURL(l),c=document.createElement("a");c.href=a,c.download=`model-${g.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(a),x(o("config.modelConfig.exportSuccess"),"success")}catch(f){x(o("config.modelConfig.exportFailed")+": "+f.message,"error")}};return he(()=>{D()}),(f,l)=>(r(),ie(Ne,null,{title:z(()=>[e("h2",null,s(t(o)("config.modelConfig.title")),1)]),actions:z(()=>[e("button",{class:"action-btn",onClick:H},[_(t(N),{icon:"carbon:upload"}),C(" "+s(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:k,disabled:!g.value},[_(t(N),{icon:"carbon:download"}),C(" "+s(t(o)("config.modelConfig.export")),1)],8,$n)]),default:z(()=>[e("div",wn,[e("div",kn,[e("div",Sn,[e("h3",null,s(t(o)("config.modelConfig.configuredModels")),1),e("span",Tn,"("+s(b.length)+")",1)]),n.value?L("",!0):(r(),u("div",Nn,[(r(!0),u(W,null,X(b,a=>{var c;return r(),u("div",{key:a.id,class:se(["model-card",{active:((c=g.value)==null?void 0:c.id)===a.id}]),onClick:j=>F(a)},[e("div",Vn,[e("span",xn,s(a.modelName),1),_(t(N),{icon:"carbon:chevron-right"})]),e("p",An,s(a.modelDescription),1),a.type?(r(),u("div",En,[e("span",Pn,s(a.type),1)])):L("",!0)],10,Un)}),128))])),n.value?(r(),u("div",Mn,[_(t(N),{icon:"carbon:loading",class:"loading-icon"}),C(" "+s(t(o)("common.loading")),1)])):L("",!0),!n.value&&b.length===0?(r(),u("div",Dn,[_(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.modelConfig.noModel")),1)])):L("",!0),e("button",{class:"add-btn",onClick:S},[_(t(N),{icon:"carbon:add"}),C(" "+s(t(o)("config.modelConfig.createNew")),1)])]),g.value?(r(),u("div",Rn,[e("div",Fn,[e("h3",null,s(g.value.modelName),1),e("div",Ln,[e("button",{class:"action-btn primary",onClick:J},[_(t(N),{icon:"carbon:save"}),C(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:Q},[_(t(N),{icon:"carbon:trash-can"}),C(" "+s(t(o)("common.delete")),1)])])]),e("div",qn,[e("label",null,[C(s(t(o)("config.modelConfig.type"))+" ",1),l[17]||(l[17]=e("span",{class:"required"},"*",-1))]),_(Ae,{modelValue:g.value.type,"onUpdate:modelValue":l[0]||(l[0]=a=>g.value.type=a),options:M.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",In,[e("label",null,[C(s(t(o)("config.modelConfig.baseUrl"))+" ",1),l[18]||(l[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>g.value.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Bn),[[G,g.value.baseUrl]])]),e("div",On,[e("label",null,s(t(o)("config.modelConfig.headers")),1),O(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=a=>P.value=a),placeholder:t(o)("config.modelConfig.headersPlaceholder")},null,8,jn),[[G,P.value]])]),e("div",Gn,[e("label",null,[C(s(t(o)("config.modelConfig.apiKey"))+" ",1),l[19]||(l[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=a=>g.value.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Jn),[[G,g.value.apiKey]])]),e("div",Kn,[e("label",null,[C(s(t(o)("config.modelConfig.modelName"))+" ",1),l[20]||(l[20]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=a=>g.value.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Hn),[[G,g.value.modelName]])]),e("div",zn,[e("label",null,[C(s(t(o)("config.modelConfig.description"))+" ",1),l[21]||(l[21]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":l[5]||(l[5]=a=>g.value.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Yn),[[G,g.value.modelDescription]])])])):(r(),u("div",Wn,[_(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.modelConfig.selectModelHint")),1)]))]),_(pe,{modelValue:i.value,"onUpdate:modelValue":l[12]||(l[12]=a=>i.value=a),title:t(o)("config.modelConfig.newModel"),onConfirm:q},{default:z(()=>[e("div",Xn,[e("div",Qn,[e("label",null,[C(s(t(o)("config.modelConfig.type"))+" ",1),l[22]||(l[22]=e("span",{class:"required"},"*",-1))]),_(Ae,{modelValue:V.type,"onUpdate:modelValue":l[6]||(l[6]=a=>V.type=a),options:M.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Zn,[e("label",null,[C(s(t(o)("config.modelConfig.baseUrl"))+" ",1),l[23]||(l[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=a=>V.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,ea),[[G,V.baseUrl]])]),e("div",oa,[e("label",null,s(t(o)("config.modelConfig.headers")),1),O(e("input",{type:"text","onUpdate:modelValue":l[8]||(l[8]=a=>A.value=a),placeholder:t(o)("config.modelConfig.headersPlaceholder")},null,8,ta),[[G,A.value]])]),e("div",sa,[e("label",null,[C(s(t(o)("config.modelConfig.apiKey"))+" ",1),l[24]||(l[24]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[9]||(l[9]=a=>V.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,na),[[G,V.apiKey]])]),e("div",aa,[e("label",null,[C(s(t(o)("config.modelConfig.modelName"))+" ",1),l[25]||(l[25]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[10]||(l[10]=a=>V.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,la),[[G,V.modelName]])]),e("div",ia,[e("label",null,[C(s(t(o)("config.modelConfig.description"))+" ",1),l[26]||(l[26]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":l[11]||(l[11]=a=>V.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,ca),[[G,V.modelDescription]])])])]),_:1},8,["modelValue","title"]),_(pe,{modelValue:$.value,"onUpdate:modelValue":l[14]||(l[14]=a=>$.value=a),title:"Delete confirmation"},{footer:z(()=>[e("button",{class:"cancel-btn",onClick:l[13]||(l[13]=a=>$.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:le},s(t(o)("common.delete")),1)]),default:z(()=>{var a;return[e("div",ra,[_(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[C(s(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((a=g.value)==null?void 0:a.modelName),1),C(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",da,s(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),m.value?(r(),u("div",{key:0,class:"error-toast",onClick:l[15]||(l[15]=a=>m.value="")},[_(t(N),{icon:"carbon:error"}),C(" "+s(m.value),1)])):L("",!0),v.value?(r(),u("div",{key:1,class:"success-toast",onClick:l[16]||(l[16]=a=>v.value="")},[_(t(N),{icon:"carbon:checkmark"}),C(" "+s(v.value),1)])):L("",!0)]),_:1}))}}),pa=ae(ua,[["__scopeId","data-v-dfd8f8e2"]]);class Te{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to add MCP server: ${n.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(n){return console.error("Failed to add MCP server:",n),{success:!1,message:n instanceof Error?n.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!n.ok)throw new Error(`Failed to delete MCP server: ${n.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(n){return console.error(`Failed to delete MCP server[${o}]:`,n),{success:!1,message:n instanceof Error?n.message:"Failed to delete, please retry"}}}}me(Te,"BASE_URL","/api/mcp");const fa={class:"mcp-config-panel"},ga={class:"mcp-header"},ma={class:"header-left"},ha={class:"mcp-stats"},va={class:"stat-item"},ya={class:"stat-label"},_a={class:"stat-value"},ba={class:"header-right"},Ca={class:"search-box"},$a=["placeholder"],wa={key:0,class:"loading-container"},ka={key:1,class:"mcp-layout"},Sa={class:"mcp-table-container"},Ta={class:"section-title"},Na={key:0,class:"empty-state"},Ua={class:"empty-state-text"},Va={key:1,class:"mcp-table-wrapper"},xa={class:"mcp-table"},Aa={class:"mcp-id"},Ea={class:"mcp-server-name"},Pa={class:"server-name-content"},Ma={class:"mcp-connection-type"},Da={class:"mcp-config"},Ra=["title"],Fa={class:"mcp-actions"},La=["onClick","disabled"],qa={class:"add-mcp-container"},Ia={class:"add-mcp-header"},Ba={class:"add-mcp-title"},Oa={class:"mcp-form"},ja={class:"mcp-form-group"},Ga={class:"form-label"},Ja={class:"connection-type-options"},Ka={class:"connection-type-option"},Ha={for:"mcp-connection-type-studio",class:"radio-label"},za={class:"connection-type-desc"},Ya={class:"connection-type-option"},Wa={for:"mcp-connection-type-sse",class:"radio-label"},Xa={class:"connection-type-desc"},Qa={class:"connection-type-option"},Za={for:"mcp-connection-type-streaming",class:"radio-label"},el={class:"connection-type-desc"},ol={class:"mcp-form-group"},tl={class:"form-label"},sl=["placeholder"],nl={class:"mcp-form-actions"},al=["disabled"],ll=["disabled"],il={class:"mcp-form-instructions"},cl={class:"indented-list"},rl=ce({__name:"mcpConfig",setup(R){const{t:o}=ge(),n=B(!1),m=B([]),v=B(""),b=ne({connectionType:"STUDIO",configJson:""}),M=ne({show:!1,text:"",type:"success"}),g=te(()=>b.configJson.trim().length>0),i=te(()=>{if(!v.value.trim())return m.value;const F=v.value.toLowerCase();return m.value.filter(S=>S.mcpServerName.toLowerCase().includes(F)||S.connectionType.toLowerCase().includes(F)||S.connectionConfig.toLowerCase().includes(F))}),$=F=>F?F.length>50?F.substring(0,50)+"...":F:"",P=(F,S="success")=>{M.text=F,M.type=S,M.show=!0,setTimeout(()=>{M.show=!1},3e3)},A=async()=>{try{n.value=!0,m.value=await Te.getAllMcpServers()}catch(F){console.error("加载MCP服务器列表失败:",F),P(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},V=async()=>{if(!g.value){P(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(b.configJson)}catch{P(o("config.mcpConfig.invalidJson"),"error");return}try{n.value=!0;const F={connectionType:b.connectionType,configJson:b.configJson},S=await Te.addMcpServer(F);S.success?(P(o("config.mcpConfig.addSuccess")),D(),await A()):P(S.message||o("config.mcpConfig.addFailed"),"error")}catch(F){console.error("添加MCP服务器失败:",F),P(o("config.mcpConfig.addFailed"),"error")}finally{n.value=!1}},x=async F=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{n.value=!0;const S=await Te.removeMcpServer(F);S.success?(P(o("config.mcpConfig.deleteSuccess")),await A()):P(S.message||o("config.mcpConfig.deleteFailed"),"error")}catch(S){console.error("删除MCP服务器失败:",S),P(o("config.mcpConfig.deleteFailed"),"error")}finally{n.value=!1}},D=()=>{b.connectionType="STUDIO",b.configJson=""};return he(()=>{A()}),(F,S)=>(r(),u("div",fa,[e("div",ga,[e("div",ma,[e("h2",null,s(t(o)("config.mcpConfig.title")),1),e("div",ha,[e("span",va,[e("span",ya,s(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",_a,s(m.value.length),1)])])]),e("div",ba,[e("div",Ca,[O(e("input",{"onUpdate:modelValue":S[0]||(S[0]=q=>v.value=q),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,$a),[[G,v.value]]),S[5]||(S[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(r(),u("div",wa,[S[6]||(S[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(t(o)("config.loading")),1)])):(r(),u("div",ka,[e("div",Sa,[e("h3",Ta,s(t(o)("config.mcpConfig.serverList")),1),i.value.length===0?(r(),u("div",Na,[S[7]||(S[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Ua,s(v.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(r(),u("div",Va,[e("table",xa,[e("thead",null,[e("tr",null,[S[8]||(S[8]=e("th",null,"ID",-1)),e("th",null,s(t(o)("agent.name")),1),e("th",null,s(t(o)("config.mcpConfig.connectionType")),1),e("th",null,s(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,s(t(o)("common.actions")),1)])]),e("tbody",null,[(r(!0),u(W,null,X(i.value,q=>(r(),u("tr",{key:q.id,class:"mcp-row"},[e("td",Aa,s(q.id),1),e("td",Ea,[e("div",Pa,[S[9]||(S[9]=e("span",{class:"server-icon"},"🔌",-1)),C(" "+s(q.mcpServerName),1)])]),e("td",Ma,[e("span",{class:se(["connection-type-badge",q.connectionType.toLowerCase()])},s(q.connectionType),3)]),e("td",Da,[e("div",{class:"config-preview",title:q.connectionConfig},s($(q.connectionConfig)),9,Ra)]),e("td",Fa,[e("button",{onClick:J=>x(q.id),class:"action-btn delete-btn",disabled:n.value},s(t(o)("common.delete")),9,La)])]))),128))])])]))]),e("div",qa,[e("div",Ia,[e("h3",Ba,s(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",Oa,[e("div",ja,[e("label",Ga,s(t(o)("config.mcpConfig.connectionType"))+"：",1),e("div",Ja,[e("div",Ka,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":S[1]||(S[1]=q=>b.connectionType=q),value:"STUDIO"},null,512),[[xe,b.connectionType]]),e("label",Ha,[S[10]||(S[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",za,s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",Ya,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":S[2]||(S[2]=q=>b.connectionType=q),value:"SSE"},null,512),[[xe,b.connectionType]]),e("label",Wa,[S[11]||(S[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Xa,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Qa,[O(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":S[3]||(S[3]=q=>b.connectionType=q),value:"STREAMING"},null,512),[[xe,b.connectionType]]),e("label",Za,[S[12]||(S[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",el,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",ol,[e("label",tl,s(t(o)("config.mcpConfig.configJsonLabel")),1),O(e("textarea",{"onUpdate:modelValue":S[4]||(S[4]=q=>b.configJson=q),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,sl),[[G,b.configJson]])]),e("div",nl,[e("button",{onClick:V,class:"action-btn add-btn",disabled:n.value},s(t(o)("common.add")),9,al),e("button",{onClick:D,class:"action-btn reset-btn",disabled:n.value},s(t(o)("common.reset")),9,ll)])]),e("div",il,[e("h4",null,s(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[C(s(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",cl,[e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Local")),1),C("："+s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Remote")),1),C("："+s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,s(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),_(ke,{name:"message-fade"},{default:z(()=>[M.show?(r(),u("div",{key:0,class:se(["message-toast",M.type])},s(M.text),3)):L("",!0)]),_:1})]))}}),dl=ae(rl,[["__scopeId","data-v-355da8bb"]]);class ye{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to get Prompt list:",n),n}}static async getPromptById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,n),n}}static async createPrompt(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Prompt:",n),n}}static async updatePrompt(o,n){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Prompt[${o}]:`,m),m}}static async deletePrompt(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Prompt[${o}]:`,n),n}}}me(ye,"BASE_URL","/api/prompt");const ul={class:"custom-select"},pl=["title"],fl={key:0,class:"current-option"},gl={class:"option-name"},ml={key:1,class:"current-option"},hl={class:"select-options"},vl=["onClick"],yl={class:"option-name"},_l=ce({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(R,{emit:o}){const n=R,m=o,v=B(!1),b=te(()=>n.options.find($=>$.id===n.modelValue)),M=$=>$.id===n.modelValue,g=()=>{v.value=!v.value},i=$=>{m("update:modelValue",$.id),v.value=!1};return($,P)=>(r(),u("div",ul,[e("button",{class:"select-btn",onClick:g,title:$.placeholder},[b.value?(r(),u("span",fl,[e("span",gl,s(b.value.name),1)])):(r(),u("span",ml,s($.placeholder),1)),_(t(N),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,pl),_(ke,{name:"slideDown"},{default:z(()=>[O(e("div",{class:"select-dropdown",onClick:P[0]||(P[0]=Ce(()=>{},["stop"]))},[e("div",hl,[(r(!0),u(W,null,X($.options,A=>(r(),u("button",{key:A.id,class:se(["select-option",{active:M(A)}]),onClick:V=>i(A)},[e("span",yl,s(A.name),1),M(A)?(r(),ie(t(N),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):L("",!0)],10,vl))),128))])],512),[[Ee,v.value]])]),_:1}),v.value?(r(),u("div",{key:0,class:"backdrop",onClick:P[1]||(P[1]=A=>v.value=!1)})):L("",!0)]))}}),Se=ae(_l,[["__scopeId","data-v-4c6d676f"]]),bl={class:"prompt-layout"},Cl={class:"prompt-list"},$l={class:"list-header"},wl={class:"prompt-count"},kl={key:0,class:"prompts-container"},Sl=["onClick"],Tl={class:"prompt-card-header"},Nl={class:"prompt-name"},Ul={key:0,class:"prompt-desc"},Vl={class:"tags"},xl={class:"tag"},Al={key:1,class:"loading-state"},El={key:2,class:"empty-state"},Pl={key:0,class:"prompt-detail"},Ml={class:"detail-header"},Dl={class:"detail-actions"},Rl={class:"form-item"},Fl=["placeholder"],Ll={class:"form-item"},ql={class:"form-item"},Il={class:"form-item"},Bl=["placeholder"],Ol={class:"form-item"},jl=["placeholder"],Gl={key:1,class:"no-selection"},Jl={class:"modal-form"},Kl={class:"form-item"},Hl=["placeholder"],zl={class:"form-item"},Yl={class:"form-item"},Wl={class:"form-item"},Xl=["placeholder"],Ql={class:"form-item"},Zl=["placeholder"],ei={class:"delete-confirm"},oi={class:"warning-text"},ti=ce({__name:"dynamicPromptConfig",setup(R){const{t:o}=ge(),{success:n,error:m}=Le(),v=Ue(),{namespace:b}=Pe(v),M=B(!1),g=ne([]),i=B(null),$=B(!1),P=B(!1),A=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],V=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],x={promptName:"",messageType:"",type:"",promptDescription:""},D=ne({...x}),F=async()=>{M.value=!0;try{const l=await ye.getAllPrompts(b.value);l.length>0&&await S(l[0]),g.splice(0,g.length,...l)}catch(l){console.error("加载数据失败:",l),m(o("config.promptConfig.loadDataFailed")+": "+l.message)}finally{M.value=!1}},S=async l=>{try{const a=await ye.getPromptById(l.id);i.value={...a}}catch(a){console.error("加载Prompt详情失败:",a),m(o("config.promptConfig.loadDetailsFailed")+": "+a.message),i.value={...l}}},q=async()=>{if(le(D))try{const l={...D,namespace:b.value,builtIn:!1},a=await ye.createPrompt(l);g.push(a),i.value=a,$.value=!1,n(o("config.promptConfig.createSuccess"))}catch(l){m(o("config.promptConfig.createFailed")+": "+l.message)}},J=async()=>{if(i.value&&le(i.value))try{const l=await ye.updatePrompt(i.value.id,i.value),a=g.findIndex(c=>c.id===l.id);a!==-1&&(g[a]=l),i.value={...l},n(o("config.promptConfig.saveSuccess"))}catch(l){m(o("config.promptConfig.saveFailed")+": "+l.message)}},Q=async()=>{if(i.value)try{await ye.deletePrompt(i.value.id);const l=g.findIndex(a=>a.id===i.value.id);l!==-1&&g.splice(l,1),i.value=g.length>0?g[0]:null,P.value=!1,n(o("config.promptConfig.deleteSuccess"))}catch(l){m(o("config.promptConfig.deleteFailed")+": "+l.message)}};function le(l){const a=["promptName","messageType","type","promptContent"];for(const j of a){const U=l[j];if(U==null||typeof U=="string"&&U.trim()==="")return m(`${j} is required and cannot be empty`),!1}return!!H(g,l)}function H(l,a){const c=l.find(j=>j.promptName===a.promptName);return c&&a.id&&c.id!==a.id?(m(`Name "${a.promptName}" already exists. Please use a different name.`),!1):c&&!a.id?(m(`Name "${a.promptName}" already exists. Please use a different name.`),!1):!0}const k=()=>{D.promptName="",D.promptDescription="",D.promptContent="",Object.assign(D,x),$.value=!0},f=()=>{P.value=!0};return he(()=>{F()}),be(()=>b.value,(l,a)=>{l!==a&&F()}),(l,a)=>(r(),ie(Ne,null,{title:z(()=>[e("h2",null,s(t(o)("config.promptConfig.title")),1)]),default:z(()=>[e("div",bl,[e("div",Cl,[e("div",$l,[e("h3",null,s(t(o)("config.promptConfig.configuredprompts")),1),e("span",wl,"("+s(g.length)+s(t(o)("config.promptConfig.promptCount"))+")",1)]),M.value?L("",!0):(r(),u("div",kl,[(r(!0),u(W,null,X(g,c=>{var j,U;return r(),u("div",{key:c.id,class:se(["prompt-card",{active:((j=i.value)==null?void 0:j.id)===c.id}]),onClick:Z=>S(c)},[e("div",Tl,[e("span",Nl,s(c.promptName),1),_(t(N),{icon:"carbon:chevron-right"})]),(U=c.promptDescription)!=null&&U.trim()?(r(),u("p",Ul,s(c.promptDescription),1)):L("",!0),e("div",Vl,[e("span",xl,s(c.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,Sl)}),128))])),M.value?(r(),u("div",Al,[_(t(N),{icon:"carbon:loading",class:"loading-icon"}),C(" "+s(t(o)("common.loading")),1)])):L("",!0),!M.value&&g.length===0?(r(),u("div",El,[_(t(N),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.promptConfig.noPrompts")),1)])):L("",!0),e("button",{class:"add-btn",onClick:k},[_(t(N),{icon:"carbon:add"}),C(" "+s(t(o)("config.promptConfig.createNew")),1)])]),i.value?(r(),u("div",Pl,[e("div",Ml,[e("h3",null,s(i.value.promptName),1),e("div",Dl,[e("button",{class:"action-btn primary",onClick:J},[_(t(N),{icon:"carbon:save"}),C(" "+s(t(o)("common.save")),1)]),i.value.builtIn?L("",!0):(r(),u("button",{key:0,class:"action-btn danger",onClick:f},[_(t(N),{icon:"carbon:trash-can"}),C(" "+s(t(o)("common.delete")),1)]))])]),e("div",Rl,[e("label",null,[C(s(t(o)("config.promptConfig.promptName"))+" ",1),a[15]||(a[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":a[0]||(a[0]=c=>i.value.promptName=c),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Fl),[[G,i.value.promptName]])]),e("div",Ll,[e("label",null,[C(s(t(o)("config.promptConfig.messageType"))+" ",1),a[16]||(a[16]=e("span",{class:"required"},"*",-1))]),i.value.builtIn?O((r(),u("input",{key:1,type:"text","onUpdate:modelValue":a[2]||(a[2]=c=>i.value.messageType=c),disabled:!0},null,512)),[[G,i.value.messageType]]):(r(),ie(Se,{key:0,modelValue:i.value.messageType,"onUpdate:modelValue":a[1]||(a[1]=c=>i.value.messageType=c),options:A,disabled:i.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",ql,[e("label",null,[C(s(t(o)("config.promptConfig.type"))+" ",1),a[17]||(a[17]=e("span",{class:"required"},"*",-1))]),i.value.builtIn?O((r(),u("input",{key:1,type:"text","onUpdate:modelValue":a[4]||(a[4]=c=>i.value.type=c),disabled:!0,required:""},null,512)),[[G,i.value.type]]):(r(),ie(Se,{key:0,modelValue:i.value.type,"onUpdate:modelValue":a[3]||(a[3]=c=>i.value.type=c),options:V,disabled:i.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Il,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=c=>i.value.promptDescription=c),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Bl),[[G,i.value.promptDescription]])]),e("div",Ol,[e("label",null,[C(s(t(o)("config.promptConfig.promptContent"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":a[6]||(a[6]=c=>i.value.promptContent=c),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,jl),[[G,i.value.promptContent]])])])):(r(),u("div",Gl,[_(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.promptConfig.selectPromptHint")),1)]))]),_(pe,{modelValue:$.value,"onUpdate:modelValue":a[12]||(a[12]=c=>$.value=c),title:t(o)("config.promptConfig.newPrompt"),onConfirm:q},{default:z(()=>[e("div",Jl,[e("div",Kl,[e("label",null,[C(s(t(o)("config.promptConfig.promptName"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=c=>D.promptName=c),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Hl),[[G,D.promptName]])]),e("div",zl,[e("label",null,[C(s(t(o)("config.promptConfig.messageType"))+" ",1),a[20]||(a[20]=e("span",{class:"required"},"*",-1))]),_(Se,{modelValue:D.messageType,"onUpdate:modelValue":a[8]||(a[8]=c=>D.messageType=c),options:A,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Yl,[e("label",null,[C(s(t(o)("config.promptConfig.type"))+" ",1),a[21]||(a[21]=e("span",{class:"required"},"*",-1))]),_(Se,{modelValue:D.type,"onUpdate:modelValue":a[9]||(a[9]=c=>D.type=c),options:V,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Wl,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":a[10]||(a[10]=c=>D.promptDescription=c),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,Xl),[[G,D.promptDescription]])]),e("div",Ql,[e("label",null,[C(s(t(o)("config.promptConfig.promptContent"))+" ",1),a[22]||(a[22]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":a[11]||(a[11]=c=>D.promptContent=c),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Zl),[[G,D.promptContent]])])])]),_:1},8,["modelValue","title"]),_(pe,{modelValue:P.value,"onUpdate:modelValue":a[14]||(a[14]=c=>P.value=c),title:t(o)("config.promptConfig.deleteConfirm")},{footer:z(()=>[e("button",{class:"cancel-btn",onClick:a[13]||(a[13]=c=>P.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Q},s(t(o)("common.delete")),1)]),default:z(()=>{var c;return[e("div",ei,[_(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[C(s(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,s((c=i.value)==null?void 0:c.promptName),1),C(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",oi,s(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),si=ae(ti,[["__scopeId","data-v-9d1390e7"]]);class _e{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Namespace[${o}] details:`,n),n}}static async createNamespace(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Namespace:",n),n}}static async updateNamespace(o,n){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Namespace[${o}]:`,m),m}}static async deleteNamespace(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Namespace[${o}]:`,n),n}}}me(_e,"BASE_URL","/api/namespaces");const ni={class:"namespace-layout"},ai={class:"namespace-list"},li={class:"list-header"},ii={key:0,class:"namespaces-container"},ci=["onClick"],ri={class:"namespace-card-header"},di={class:"namespace-name"},ui={key:0,class:"namespace-desc"},pi={key:1,class:"loading-state"},fi={key:0,class:"namespace-detail"},gi={class:"detail-header"},mi={class:"detail-actions"},hi={class:"form-item"},vi=["placeholder"],yi={class:"form-item"},_i=["placeholder"],bi={class:"form-item"},Ci=["placeholder"],$i={class:"form-item"},wi=["placeholder"],ki={key:1,class:"no-selection"},Si={class:"modal-form"},Ti={class:"form-item"},Ni=["placeholder"],Ui={class:"form-item"},Vi=["placeholder"],xi={class:"form-item"},Ai=["placeholder"],Ei={class:"form-item"},Pi=["placeholder"],Mi={class:"delete-confirm"},Di={class:"warning-text"},Ri=ce({__name:"namespaceConfig",setup(R){const{t:o}=ge(),{success:n,error:m}=Le(),v=Ue(),{setNamespaces:b}=v,M=B(!1),g=ne([]),i=B(null),$=B(null),P=B(!1),A=B(!1),V={name:""},x=ne({...V}),D=async()=>{M.value=!0;try{const a=await _e.getAllNamespaces();a.length>0&&await F(a[0]),g.splice(0,g.length,...a)}catch(a){console.error("加载数据失败:",a),m(o("config.namespaceConfig.loadDataFailed")+": "+a.message)}finally{M.value=!1}},F=async a=>{i.value={...a},$.value={...a}},S=async()=>{if(le(x)&&k(x.host))try{const a={description:"",...x},c=await _e.createNamespace(a);g.push({...c}),i.value=c,$.value={...c},P.value=!1,Q(),n(o("config.namespaceConfig.saveSuccess"))}catch(a){m(o("config.namespaceConfig.createFailed")+": "+a.message)}},q=async()=>{if(i.value&&le(i.value)&&k(i.value.host))try{const a=await _e.updateNamespace(i.value.id,i.value),c=g.findIndex(j=>j.id===a.id);c!==-1&&(g[c]=a),i.value={...a},$.value={...a},Q(),n(o("config.namespaceConfig.saveSuccess"))}catch(a){m(o("config.namespaceConfig.saveFailed")+": "+a.message)}},J=async()=>{if(i.value)try{await _e.deleteNamespace(i.value.id);const a=g.findIndex(c=>c.id===i.value.id);a!==-1&&g.splice(a,1),i.value=g.length>0?g[0]:null,A.value=!1,Q(),n(o("config.namespaceConfig.deleteSuccess"))}catch(a){m(o("config.namespaceConfig.deleteFailed")+": "+a.message)}},Q=async()=>{b(g.map(a=>({id:a.code,name:a.name})))};function le(a){const c=["name","code"];for(const j of c){const U=a[j];if(U==null||typeof U=="string"&&U.trim()==="")return m(`${j} is required and cannot be empty`),!1}return!!H(g,a,["name","code"])}function H(a,c,j=["name","code"]){for(const U of j){let Z;if(U in c)Z=c[U];else continue;if(!(Z!=null&&Z.trim()))continue;const ee=a.find(re=>re[U]===Z);if(!(ee&&"id"in c&&ee.id===c.id)&&ee)return m(`${U} "${Z}" already exists. Please use a different value.`),!1}return!0}const k=a=>{if(!a)return!0;const j=/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(a);return j||m("Please enter a valid URL format"),j},f=()=>{x.name="",Object.assign(x,V),P.value=!0},l=()=>{A.value=!0};return he(()=>{D()}),(a,c)=>(r(),ie(Ne,null,{title:z(()=>[e("h2",null,s(t(o)("config.namespaceConfig.title")),1)]),default:z(()=>{var j;return[e("div",ni,[e("div",ai,[e("div",li,[e("h3",null,s(t(o)("config.namespaceConfig.configured")),1)]),M.value?L("",!0):(r(),u("div",ii,[(r(!0),u(W,null,X(g,U=>{var Z,ee;return r(),u("div",{key:U.id,class:se(["namespace-card",{active:((Z=i.value)==null?void 0:Z.id)===U.id}]),onClick:re=>F(U)},[e("div",ri,[e("span",di,s(U.name),1),_(t(N),{icon:"carbon:chevron-right"})]),(ee=U.description)!=null&&ee.trim()?(r(),u("p",ui,s(U.description),1)):L("",!0)],10,ci)}),128))])),M.value?(r(),u("div",pi,[_(t(N),{icon:"carbon:loading",class:"loading-icon"}),C(" "+s(t(o)("common.loading")),1)])):L("",!0),e("button",{class:"add-btn",onClick:f},[_(t(N),{icon:"carbon:add"}),C(" "+s(t(o)("config.namespaceConfig.createNew")),1)])]),i.value?(r(),u("div",fi,[e("div",gi,[e("h3",null,s(((j=$.value)==null?void 0:j.name)??""),1),e("div",mi,[e("button",{class:"action-btn primary",onClick:q},[_(t(N),{icon:"carbon:save"}),C(" "+s(t(o)("common.save")),1)]),i.value.code!=="default"?(r(),u("button",{key:0,class:"action-btn danger",onClick:l},[_(t(N),{icon:"carbon:trash-can"}),C(" "+s(t(o)("common.delete")),1)])):L("",!0)])]),e("div",hi,[e("label",null,[C(s(t(o)("config.namespaceConfig.name"))+" ",1),c[11]||(c[11]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=U=>i.value.name=U),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,vi),[[G,i.value.name]])]),e("div",yi,[e("label",null,[C(s(t(o)("config.namespaceConfig.code"))+" ",1),c[12]||(c[12]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[1]||(c[1]=U=>i.value.code=U),disabled:!0,placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,_i),[[G,i.value.code]])]),e("div",bi,[e("label",null,s(t(o)("config.namespaceConfig.host")),1),O(e("input",{type:"text","onUpdate:modelValue":c[2]||(c[2]=U=>i.value.host=U),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,Ci),[[G,i.value.host]])]),e("div",$i,[e("label",null,s(t(o)("config.namespaceConfig.description")),1),O(e("input",{type:"text","onUpdate:modelValue":c[3]||(c[3]=U=>i.value.description=U),placeholder:t(o)("config.namespaceConfig.placeholder")},null,8,wi),[[G,i.value.description]])])])):(r(),u("div",ki,[_(t(N),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.namespaceConfig.selectNameSpaceHint")),1)]))]),_(pe,{modelValue:P.value,"onUpdate:modelValue":c[8]||(c[8]=U=>P.value=U),title:t(o)("config.namespaceConfig.createNew"),onConfirm:S},{default:z(()=>[e("div",Si,[e("div",Ti,[e("label",null,[C(s(t(o)("config.namespaceConfig.name"))+" ",1),c[13]||(c[13]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[4]||(c[4]=U=>x.name=U),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,Ni),[[G,x.name]])]),e("div",Ui,[e("label",null,[C(s(t(o)("config.namespaceConfig.code"))+" ",1),c[14]||(c[14]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[5]||(c[5]=U=>x.code=U),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,Vi),[[G,x.code]])]),e("div",xi,[e("label",null,s(t(o)("config.namespaceConfig.host")),1),O(e("input",{type:"text","onUpdate:modelValue":c[6]||(c[6]=U=>x.host=U),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,Ai),[[G,x.host]])]),e("div",Ei,[e("label",null,s(t(o)("config.namespaceConfig.description")),1),O(e("input",{type:"text","onUpdate:modelValue":c[7]||(c[7]=U=>x.description=U),placeholder:t(o)("config.namespaceConfig.placeholder")},null,8,Pi),[[G,x.description]])])])]),_:1},8,["modelValue","title"]),_(pe,{modelValue:A.value,"onUpdate:modelValue":c[10]||(c[10]=U=>A.value=U),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:z(()=>[e("button",{class:"cancel-btn",onClick:c[9]||(c[9]=U=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:J},s(t(o)("common.delete")),1)]),default:z(()=>{var U;return[e("div",Mi,[_(t(N),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[C(s(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((U=i.value)==null?void 0:U.name),1),C(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",Di,s(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]}),_:1}))}}),Fi=ae(Ri,[["__scopeId","data-v-5add4fe6"]]);function Li(R){return!(R==null||typeof R=="string"&&R.trim()===""||Array.isArray(R)&&R.length===0||typeof R=="object"&&Object.keys(R).length===0)}const qi=ce({__name:"namespaceSwitch",setup(R){const{t:o}=ge(),n=Fe(),m=Re(),v=Ue(),{namespace:b,namespaces:M}=Pe(v),{setCurrentNs:g,setNamespaces:i}=v,$=(V,x)=>{if(Li(x.host)){const D=x.host,F=D.endsWith("/")?D.slice(0,-1):D,S=new URL(F);if(S.pathname.includes("index.html")){window.open(S.toString(),"_blank");return}try{const q=new URL(window.location.href),J=new URL(q.pathname+q.search+q.hash,F);window.open(J.toString(),"_blank?namespace="+V)}catch(q){console.error("Failed to construct new URL:",q);const J=window.location.pathname+window.location.search,Q=F+J;window.open(Q,"_blank?namespace="+V)}}else g(V)},P=async()=>{var S;const V=await _e.getAllNamespaces(),x=window.location.host;let D="";const F=V.find(q=>q.host&&q.host.includes(x));F?D=F.code:D=((S=V[0])==null?void 0:S.code)||"",g(D),i(V.map(q=>({id:q.code,name:q.name,host:q.host})))},A=()=>{m.push({name:n.name,params:{...n.params,category:"namespace"},query:{namespace:b.value}})};return he(async()=>{P()}),(V,x)=>(r(),u("div",null,[_(Ae,{modelValue:t(b),"onUpdate:modelValue":x[0]||(x[0]=D=>ze(b)?b.value=D:null),options:t(M),"dropdown-title":t(o)("config.namespaceConfig.namespace.namespace"),onChange:$,placeholder:t(o)("config.namespaceConfig.namespace.selectNamespace"),direction:"right",dropStyles:{minWidth:"220px"}},null,8,["modelValue","options","dropdown-title","placeholder"]),e("span",{onclick:"event.stopPropagation()",class:"setting-icon-wrapper",onClick:A},[_(t(N),{icon:"carbon:settings-edit",class:"setting-icon",width:"20"})])]))}}),Ii=ae(qi,[["__scopeId","data-v-6f6382d8"]]),Bi={class:"config-container"},Oi={class:"config-header"},ji={class:"header-actions"},Gi={class:"header-actions-left"},Ji={class:"header-actions-right"},Ki={class:"config-content"},Hi={class:"config-nav"},zi=["onClick"],Yi={class:"config-details"},Wi=ce({__name:"index",setup(R){const{t:o}=ge(),n=Fe(),m=Re(),v=B(n.params.category||"basic"),b={basic:De,agent:un,model:pa,mcp:dl,prompt:si,namespace:Fi},M=te(()=>{const $=v.value;return b[$]||De}),g=te(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",label:o("config.categories.namespace"),disabled:!1,icon:"carbon:repo-artifact"}]);be(()=>n.params.category,$=>{$&&(v.value=$)});const i=$=>{m.push({name:n.name,params:{...n.params,category:$},query:n.query})};return($,P)=>(r(),u("div",Bi,[e("div",Oi,[e("div",ji,[e("div",Gi,[e("button",{class:"action-btn",onClick:P[0]||(P[0]=A=>$.$router.push("/"))},[_(t(N),{icon:"carbon:arrow-left"}),C(" "+s($.$t("backHome")),1)]),_(We)]),e("div",Ji,[_(Ii)])])]),e("div",Ki,[e("nav",Hi,[(r(!0),u(W,null,X(g.value,(A,V)=>(r(),u(W,null,[A.disabled?L("",!0):(r(),u("div",{key:V,class:se(["nav-item",{active:v.value===A.key}]),onClick:x=>i(A.key)},[_(t(N),{icon:A.icon,width:"20"},null,8,["icon"]),e("span",null,s(A.label),1)],10,zi))],64))),256))]),e("div",Yi,[(r(),ie(Ye(M.value)))])])]))}}),tc=ae(Wi,[["__scopeId","data-v-396dc970"]]);export{tc as default};
