var De=Object.defineProperty;var Le=(B,o,a)=>o in B?De(B,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):B[o]=a;var me=(B,o,a)=>Le(B,typeof o!="symbol"?o+"":o,a);import{d as le,c as r,o as i,e,t,f as ye,r as M,m as ne,g as ae,h as Ce,i as y,u as s,b as E,s as w,w as I,v as j,F as H,j as Y,q as W,D as Ae,a as ee,z as X,T as _e,E as Ee,G as Pe,x as he,A as Te,H as Re,k as Fe,I as Ve,J as Be,B as Ie,l as qe}from"./index-CkDhIU_7.js";import{_ as ie,I as x}from"./_plugin-vue_export-helper-CdxS40jS.js";import{L as Oe}from"./index-b8HjBFKN.js";const Ge={class:"switch"},je=["checked"],Ke={class:"switch-label"},Je=le({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(B,{emit:o}){const a=o,g=m=>{const p=m.target.checked;a("update:switchValue",p)};return(m,p)=>(i(),r("label",Ge,[e("input",{type:"checkbox",checked:m.enabled,onChange:g},null,40,je),p[0]||(p[0]=e("span",{class:"slider"},null,-1)),e("span",Ke,t(m.label),1)]))}}),ze=ie(Je,[["__scopeId","data-v-d484b4a3"]]);class be{static async getConfigsByGroup(o){try{const a=await fetch(`${this.BASE_URL}/group/${o}`);if(!a.ok)throw new Error(`Failed to get ${o} group configuration: ${a.status}`);return await a.json()}catch(a){throw console.error(`Failed to get ${o} group configuration:`,a),a}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const a=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!a.ok)throw new Error(`Batch update configuration failed: ${a.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(a){return console.error("Batch update configuration failed:",a),{success:!1,message:a instanceof Error?a.message:"Update failed, please try again"}}}static async getConfigById(o){try{const a=await fetch(`${this.BASE_URL}/${o}`);if(!a.ok)throw new Error(`Failed to get configuration item: ${a.status}`);return await a.json()}catch(a){throw console.error(`Failed to get configuration item[${o}]:`,a),a}}static async updateConfig(o){try{const a=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!a.ok)throw new Error(`Failed to update configuration item: ${a.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(a){return console.error("Failed to update configuration item:",a),{success:!1,message:a instanceof Error?a.message:"Update failed, please try again"}}}}me(be,"BASE_URL","/api/config");const He={class:"config-panel"},Ye={class:"config-header"},Xe={class:"header-left"},We={class:"config-stats"},Qe={class:"stat-item"},Ze={class:"stat-value"},eo={key:0,class:"stat-item"},oo={class:"stat-value modified"},to={class:"header-right"},so={class:"import-export-actions"},no={class:"action-btn",title:"导入配置"},ao={class:"search-box"},lo=["placeholder"],io={key:0,class:"loading-container"},co={key:1,class:"config-groups"},ro={class:"group-header"},uo={class:"group-info"},po={class:"group-icon"},fo={class:"group-actions"},go=["onClick","disabled","title"],mo={class:"sub-groups"},vo=["onClick"],ho={class:"sub-group-info"},yo={class:"sub-group-title"},_o={class:"item-count"},bo={class:"config-items"},Co={key:0,class:"config-item-content vertical-layout"},$o={class:"config-item-info"},wo={class:"config-item-header"},ko={class:"config-label"},So={class:"type-badge boolean"},To={key:0,class:"modified-badge"},Vo=["title"],Ao={class:"config-control"},xo=["value","onChange"],Po=["value"],Uo={key:1,class:"config-item-content vertical-layout"},Eo={class:"config-item-info"},Mo={class:"config-item-header"},No={class:"config-label"},Do={class:"type-badge select"},Lo={key:0,class:"modified-badge"},Ro=["title"],Fo={class:"config-control"},Bo=["value","onChange"],Io=["value"],qo={key:2,class:"config-item-content vertical-layout"},Oo={class:"config-item-info"},Go={class:"config-item-header"},jo={class:"config-label"},Ko={class:"type-badge textarea"},Jo={key:0,class:"modified-badge"},zo=["title"],Ho={class:"config-control"},Yo=["value","onInput"],Xo={key:3,class:"config-item-content vertical-layout"},Wo={class:"config-item-info"},Qo={class:"config-item-header"},Zo={class:"config-label"},et={class:"type-badge number"},ot={key:0,class:"modified-badge"},tt=["title"],st={key:0,class:"config-meta"},nt={class:"range-info"},at={class:"config-control"},lt=["value","onInput","min","max"],it={key:4,class:"config-item-content vertical-layout"},ct={class:"config-item-info"},rt={class:"config-item-header"},dt={class:"config-label"},ut={class:"type-badge string"},pt={key:0,class:"modified-badge"},ft=["title"],gt={class:"config-control"},mt=["value","onInput"],vt={key:2,class:"empty-state"},ht=le({__name:"basicConfig",setup(B){const{t:o}=ye(),a=M(!0),g=M(!1),m=M([]),p=M(new Map),d=M(new Set),v=ne({show:!1,text:"",type:"success"}),V=M(""),P={maxSteps:"智能体执行最大步数",resetAllAgents:"重置所有agent",maxMemory:"能记住的最大消息数",parallelToolCalls:"并行工具调用",headlessBrowser:"是否使用无头浏览器模式",browserTimeout:o("config.basicConfig.browserTimeout"),browserDebug:"浏览器debug模式",autoOpenBrowser:"启动时自动打开浏览器",consoleInteractive:"启用控制台交互模式",systemName:"系统名称",language:"默认语言",maxThreads:"最大线程数",timeoutSeconds:o("config.basicConfig.requestTimeout")},b={manus:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置"},S={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},L={agent:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置",general:"常规设置"},Q=ae(()=>m.value.some(u=>u.subGroups.some(_=>_.items.some(k=>p.value.get(k.id)!==k.configValue)))),oe=u=>u==="true",q=u=>parseFloat(u)||0,C=u=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[u]||1,O=u=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[u]||1e4,Z=u=>typeof u=="string"?u:u.value,K=u=>typeof u=="string"?u:u.label,re=(u,_)=>{if(typeof _=="boolean")return _.toString();if(typeof _=="string"){if(u.options&&u.options.length>0){const k=u.options.find(T=>(typeof T=="string"?T:T.label)===_||(typeof T=="string"?T:T.value)===_);if(k)return typeof k=="string"?k:k.value}return _}return String(_)},U=(u,_,k=!1)=>{let T;u.inputType==="BOOLEAN"||u.inputType==="CHECKBOX"?T=re(u,_):T=String(_),u.configValue!==T&&(u.configValue=T,u._modified=!0,(k||u.inputType==="BOOLEAN"||u.inputType==="CHECKBOX"||u.inputType==="SELECT")&&n())};let l=null;const n=()=>{l&&clearTimeout(l),l=window.setTimeout(()=>{D()},500)},c=(u,_="success")=>{v.text=u,v.type=_,v.show=!0,setTimeout(()=>{v.show=!1},3e3)},R=async()=>{try{a.value=!0;const _=["manus","browser","interaction","system","performance"].map(async T=>{try{const f=await be.getConfigsByGroup(T);if(f.length===0)return null;const N=f.map(z=>({...z,displayName:z.description??(P[z.configKey]||z.configKey),min:C(z.configKey),max:O(z.configKey)}));N.forEach(z=>{p.value.set(z.id,z.configValue)});const F=new Map;N.forEach(z=>{const ce=z.configSubGroup??"general";F.has(ce)||F.set(ce,[]),F.get(ce).push(z)});const te=Array.from(F.entries()).map(([z,ce])=>({name:z,displayName:L[z]||z,items:ce}));return{name:T,displayName:b[T]||T,subGroups:te}}catch(f){return console.warn(`加载配置组 ${T} 失败，跳过:`,f),null}}),k=await Promise.all(_);m.value=k.filter(T=>T!==null),console.log("配置加载完成:",m.value)}catch(u){console.error("加载配置失败:",u),c(o("config.basicConfig.loadConfigFailed"),"error")}finally{a.value=!1}},D=async()=>{if(!(g.value||!Q.value))try{g.value=!0;const u=[];if(m.value.forEach(k=>{k.subGroups.forEach(T=>{const f=T.items.filter(N=>N._modified);u.push(...f)})}),u.length===0){c("没有需要保存的修改");return}const _=await be.batchUpdateConfigs(u);_.success?(u.forEach(k=>{p.value.set(k.id,k.configValue),k._modified=!1}),c("配置保存成功")):c(_.message||"保存失败","error")}catch(u){console.error("保存配置失败:",u),c(o("config.basicConfig.saveFailed"),"error")}finally{g.value=!1}},J=async u=>{if(confirm(`确定要重置 "${b[u]||u}" 组的所有配置吗？`))try{g.value=!0;const k=m.value.find(N=>N.name===u);if(!k)return;const T=[];if(k.subGroups.forEach(N=>{N.items.forEach(F=>{const te=se(F.configKey);te!==F.configValue&&T.push({...F,configValue:te})})}),T.length===0){c("该组配置已是默认值");return}const f=await be.batchUpdateConfigs(T);f.success?(await R(),c(`成功重置 ${T.length} 项配置`)):c(f.message||"重置失败","error")}catch(k){console.error("重置组配置失败:",k),c(o("config.basicConfig.resetFailed"),"error")}finally{g.value=!1}},se=u=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[u]||"",$e=(u,_)=>{const k=`${u}-${_}`;d.value.has(k)?d.value.delete(k):d.value.add(k)},ge=(u,_)=>d.value.has(`${u}-${_}`),A=ae(()=>{const u=m.value.reduce((k,T)=>k+T.subGroups.reduce((f,N)=>f+N.items.length,0),0),_=m.value.reduce((k,T)=>k+T.subGroups.reduce((f,N)=>f+N.items.filter(F=>p.value.get(F.id)!==F.configValue).length,0),0);return{total:u,modified:_}}),h=ae(()=>{if(!V.value.trim())return m.value;const u=V.value.toLowerCase();return m.value.map(_=>({..._,subGroups:_.subGroups.map(k=>({...k,items:k.items.filter(T=>T.displayName.toLowerCase().includes(u)||T.configKey.toLowerCase().includes(u)||T.description&&T.description.toLowerCase().includes(u))})).filter(k=>k.items.length>0)})).filter(_=>_.subGroups.length>0)}),G=()=>{try{const u={timestamp:new Date().toISOString(),version:"1.0",configs:m.value.reduce((f,N)=>(N.subGroups.forEach(F=>{F.items.forEach(te=>{f[te.configKey]=te.configValue})}),f),{})},_=JSON.stringify(u,null,2),k=new Blob([_],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(k),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),c("配置导出成功")}catch(u){console.error("导出配置失败:",u),c("导出失败","error")}},$=u=>{var f;const _=u.target,k=(f=_.files)==null?void 0:f[0];if(!k)return;const T=new FileReader;T.onload=async N=>{var F;try{const te=JSON.parse((F=N.target)==null?void 0:F.result);if(!te.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;g.value=!0;const ce=[];if(m.value.forEach(Me=>{Me.subGroups.forEach(Ne=>{Ne.items.forEach(Se=>{Object.prototype.hasOwnProperty.call(te.configs,Se.configKey)&&ce.push({...Se,configValue:te.configs[Se.configKey]})})})}),ce.length===0){c("没有找到可导入的配置项");return}const xe=await be.batchUpdateConfigs(ce);xe.success?(await R(),c(`成功导入 ${ce.length} 项配置`)):c(xe.message||"导入失败","error")}catch(te){console.error("导入配置失败:",te),c(o("config.basicConfig.importFailed"),"error")}finally{g.value=!1,_.value=""}},T.readAsText(k)};return Ce(()=>{R()}),(u,_)=>(i(),r("div",He,[e("div",Ye,[e("div",Xe,[e("h2",null,t(s(o)("config.basicConfig.title")),1),e("div",We,[e("span",Qe,[_[1]||(_[1]=e("span",{class:"stat-label"},"总配置项:",-1)),e("span",Ze,t(A.value.total),1)]),A.value.modified>0?(i(),r("span",eo,[_[2]||(_[2]=e("span",{class:"stat-label"},"已修改:",-1)),e("span",oo,t(A.value.modified),1)])):E("",!0)])]),e("div",to,[e("div",so,[e("button",{onClick:G,class:"action-btn",title:"导出配置"}," 📤 "),e("label",no,[_[3]||(_[3]=w(" 📥 ")),e("input",{type:"file",accept:".json",onChange:$,style:{display:"none"}},null,32)])]),e("div",ao,[I(e("input",{"onUpdate:modelValue":_[0]||(_[0]=k=>V.value=k),type:"text",placeholder:u.$t("config.search"),class:"search-input"},null,8,lo),[[j,V.value]]),_[4]||(_[4]=e("span",{class:"search-icon"},"🔍",-1))])])]),a.value?(i(),r("div",io,[_[5]||(_[5]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,t(u.$t("config.loading")),1)])):h.value.length>0?(i(),r("div",co,[(i(!0),r(H,null,Y(h.value,k=>(i(),r("div",{key:k.name,class:"config-group"},[e("div",ro,[e("div",uo,[e("span",po,t(S[k.name]||"⚙️"),1)]),e("div",fo,[e("button",{onClick:T=>J(k.name),class:"reset-btn",disabled:g.value,title:u.$t("config.resetGroupConfirm")},t(u.$t("config.reset")),9,go)]),_[6]||(_[6]=e("div",{class:"group-divider"},null,-1))]),e("div",mo,[(i(!0),r(H,null,Y(k.subGroups,T=>(i(),r("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:f=>$e(k.name,T.name)},[e("div",ho,[_[7]||(_[7]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",yo,t(T.displayName),1),e("span",_o,"("+t(T.items.length)+")",1)]),e("span",{class:W(["collapse-icon",{collapsed:ge(k.name,T.name)}])}," ▼ ",2)],8,vo),I(e("div",bo,[(i(!0),r(H,null,Y(T.items,f=>(i(),r("div",{key:f.id,class:W(["config-item",{modified:p.value.get(f.id)!==f.configValue}])},[f.inputType==="BOOLEAN"||f.inputType==="CHECKBOX"?(i(),r("div",Co,[e("div",$o,[e("div",wo,[e("label",ko,[w(t(f.description||f.displayName)+" ",1),e("span",So,t(f.inputType==="CHECKBOX"?u.$t("config.types.checkbox"):u.$t("config.types.boolean")),1),p.value.get(f.id)!==f.configValue?(i(),r("span",To,t(u.$t("config.modified")),1)):E("",!0)]),e("span",{class:"config-key",title:f.configKey},t(f.configKey),9,Vo)])]),e("div",Ao,[f.options&&f.options.length>0?(i(),r("select",{key:0,class:"config-input select-input",value:f.configValue,onChange:N=>{var F;return U(f,((F=N.target)==null?void 0:F.value)||"")}},[(i(!0),r(H,null,Y(f.options,N=>(i(),r("option",{key:Z(N),value:Z(N)},t(K(N)),9,Po))),128))],40,xo)):(i(),ee(ze,{key:1,enabled:oe(f.configValue),label:"","onUpdate:switchValue":N=>U(f,N)},null,8,["enabled","onUpdate:switchValue"]))])])):f.inputType==="SELECT"?(i(),r("div",Uo,[e("div",Eo,[e("div",Mo,[e("label",No,[w(t(f.description||f.displayName)+" ",1),e("span",Do,t(u.$t("config.types.select")),1),p.value.get(f.id)!==f.configValue?(i(),r("span",Lo,t(u.$t("config.modified")),1)):E("",!0)]),e("span",{class:"config-key",title:f.configKey},t(f.configKey),9,Ro)])]),e("div",Fo,[e("select",{class:"config-input select-input",value:f.configValue,onChange:N=>{var F;return U(f,((F=N.target)==null?void 0:F.value)||"")}},[(i(!0),r(H,null,Y(f.options||[],N=>(i(),r("option",{key:Z(N),value:Z(N)},t(K(N)),9,Io))),128))],40,Bo)])])):f.inputType==="TEXTAREA"?(i(),r("div",qo,[e("div",Oo,[e("div",Go,[e("label",jo,[w(t(f.description||f.displayName)+" ",1),e("span",Ko,t(u.$t("config.types.textarea")),1),p.value.get(f.id)!==f.configValue?(i(),r("span",Jo,t(u.$t("config.modified")),1)):E("",!0)]),e("span",{class:"config-key",title:f.configKey},t(f.configKey),9,zo)])]),e("div",Ho,[e("textarea",{class:"config-input textarea-input",value:f.configValue,onInput:N=>{var F;return U(f,((F=N.target)==null?void 0:F.value)||"")},onBlur:n,rows:"3"},null,40,Yo)])])):f.inputType==="NUMBER"?(i(),r("div",Xo,[e("div",Wo,[e("div",Qo,[e("label",Zo,[w(t(f.description||f.displayName)+" ",1),e("span",et,t(u.$t("config.types.number")),1),p.value.get(f.id)!==f.configValue?(i(),r("span",ot,t(u.$t("config.modified")),1)):E("",!0)]),e("span",{class:"config-key",title:f.configKey},t(f.configKey),9,tt),f.min||f.max?(i(),r("div",st,[e("span",nt,t(u.$t("config.range"))+": "+t(f.min||0)+" - "+t(f.max||"∞"),1)])):E("",!0)])]),e("div",at,[e("input",{type:"number",class:"config-input number-input",value:q(f.configValue),onInput:N=>{var F;return U(f,((F=N.target)==null?void 0:F.value)||"")},onBlur:n,min:f.min||1,max:f.max||1e4},null,40,lt)])])):(i(),r("div",it,[e("div",ct,[e("div",rt,[e("label",dt,[w(t(f.description||f.displayName)+" ",1),e("span",ut,t(f.inputType==="TEXT"?u.$t("config.types.text"):u.$t("config.types.string")),1),p.value.get(f.id)!==f.configValue?(i(),r("span",pt,t(u.$t("config.modified")),1)):E("",!0)]),e("span",{class:"config-key",title:f.configKey},t(f.configKey),9,ft)])]),e("div",gt,[e("input",{type:"text",class:"config-input text-input",value:f.configValue,onInput:N=>{var F;return U(f,((F=N.target)==null?void 0:F.value)||"")},onBlur:n},null,40,mt)])]))],2))),128))],512),[[Ae,!ge(k.name,T.name)]])]))),128))])]))),128))])):(i(),r("div",vt,[e("p",null,t(u.$t("config.notFound")),1)])),y(_e,{name:"message-fade"},{default:X(()=>[v.show?(i(),r("div",{key:0,class:W(["message-toast",v.type])},t(v.text),3)):E("",!0)]),_:1})]))}}),yt=ie(ht,[["__scopeId","data-v-43f36b25"]]),_t={class:"modal-header"},bt={class:"modal-content"},Ct={class:"modal-footer"},$t=le({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(B){const o=a=>{a.target===a.currentTarget&&(a.stopPropagation(),a.preventDefault())};return(a,g)=>(i(),ee(Ee,{to:"body"},[y(_e,{name:"modal"},{default:X(()=>[B.modelValue?(i(),r("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:g[3]||(g[3]=he(()=>{},["stop"]))},[e("div",_t,[e("h3",null,t(B.title),1),e("button",{class:"close-btn",onClick:g[0]||(g[0]=m=>a.$emit("update:modelValue",!1))},[y(s(x),{icon:"carbon:close"})])]),e("div",bt,[Pe(a.$slots,"default",{},void 0,!0)]),e("div",Ct,[Pe(a.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:g[1]||(g[1]=m=>a.$emit("update:modelValue",!1))},t(a.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:g[2]||(g[2]=m=>a.$emit("confirm"))},t(a.$t("common.confirm")),1)],!0)])])])):E("",!0)]),_:3})]))}}),fe=ie($t,[["__scopeId","data-v-baaf1c89"]]),wt={class:"tool-selection-content"},kt={class:"tool-controls"},St={class:"search-container"},Tt={class:"sort-container"},Vt={class:"tool-summary"},At={class:"summary-text"},xt={key:0,class:"tool-groups"},Pt=["onClick"],Ut={class:"group-title-area"},Et={class:"group-name"},Mt={class:"group-count"},Nt={class:"group-enable-all"},Dt=["checked","onChange","data-group"],Lt={class:"tool-info"},Rt={class:"tool-selection-name"},Ft={key:0,class:"tool-selection-desc"},Bt={class:"tool-actions"},It=["checked","onChange"],qt={key:1,class:"empty-state"},Ot=le({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(B,{emit:o}){const a=B,g=o,m=ae({get:()=>a.modelValue,set:l=>g("update:modelValue",l)}),p=M(""),d=M("group"),v=M(new Set),V=M([]),P=(l,n)=>{const c=document.querySelector(`input[data-group="${l}"]`);c&&(c.indeterminate=O(n))};Te(()=>a.selectedToolIds,l=>{V.value=[...l]},{immediate:!0});const b=ae(()=>{let l=a.tools.filter(n=>n.key);if(p.value){const n=p.value.toLowerCase();l=l.filter(c=>{var R;return c.name.toLowerCase().includes(n)||c.description.toLowerCase().includes(n)||(((R=c.serviceGroup)==null?void 0:R.toLowerCase().includes(n))??!1)})}switch(d.value){case"name":l=[...l].sort((n,c)=>n.name.localeCompare(c.name));break;case"enabled":l=[...l].sort((n,c)=>{const R=V.value.includes(n.key),D=V.value.includes(c.key);return R&&!D?-1:!R&&D?1:n.name.localeCompare(c.name)});break;case"group":default:l=[...l].sort((n,c)=>{const R=n.serviceGroup??"未分组",D=c.serviceGroup??"未分组";return R!==D?R.localeCompare(D):n.name.localeCompare(c.name)});break}return l}),S=ae(()=>{const l=new Map;return b.value.forEach(n=>{const c=n.serviceGroup??"未分组";l.has(c)||l.set(c,[]),l.get(c).push(n)}),new Map([...l.entries()].sort())}),L=ae(()=>b.value.length);Te([V,S],()=>{Fe(()=>{for(const[l,n]of S.value)P(l,n)})},{flush:"post",deep:!1});const Q=l=>V.value.includes(l),oe=(l,n)=>{n.stopPropagation();const R=n.target.checked;if(!l){console.error("toolKey is undefined, cannot proceed");return}R?V.value.includes(l)||(V.value=[...V.value,l]):V.value=V.value.filter(D=>D!==l)},q=l=>l.filter(n=>V.value.includes(n.key)),C=l=>l.length>0&&l.every(n=>V.value.includes(n.key)),O=l=>{const n=q(l).length;return n>0&&n<l.length},Z=(l,n)=>{n.stopPropagation();const R=n.target.checked,D=l.map(J=>J.key);if(R){const J=[...V.value];D.forEach(se=>{J.includes(se)||J.push(se)}),V.value=J}else V.value=V.value.filter(J=>!D.includes(J))},K=l=>{v.value.has(l)?v.value.delete(l):v.value.add(l)},re=()=>{g("confirm",[...V.value]),g("update:modelValue",!1)},U=()=>{V.value=[...a.selectedToolIds],g("update:modelValue",!1)};return Te(m,l=>{if(l){v.value.clear();const n=Array.from(S.value.keys());n.length>1&&n.slice(1).forEach(c=>{v.value.add(c)})}}),(l,n)=>(i(),ee(fe,{modelValue:m.value,"onUpdate:modelValue":[n[4]||(n[4]=c=>m.value=c),U],title:"选择工具",onConfirm:re},{default:X(()=>[e("div",wt,[e("div",kt,[e("div",St,[I(e("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>p.value=c),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[j,p.value]])]),e("div",Tt,[I(e("select",{"onUpdate:modelValue":n[1]||(n[1]=c=>d.value=c),class:"sort-select"},n[5]||(n[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Re,d.value]])])]),e("div",Vt,[e("span",At," 共 "+t(S.value.size)+" 个服务组，"+t(L.value)+" 个工具 (已选择 "+t(V.value.length)+" 个) ",1)]),S.value.size>0?(i(),r("div",xt,[(i(!0),r(H,null,Y(S.value,([c,R])=>(i(),r("div",{key:c,class:"tool-group"},[e("div",{class:W(["tool-group-header",{collapsed:v.value.has(c)}]),onClick:D=>K(c)},[e("div",Ut,[y(s(x),{icon:v.value.has(c)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),y(s(x),{icon:"carbon:folder",class:"group-icon"}),e("span",Et,t(c),1),e("span",Mt," ("+t(q(R).length)+"/"+t(R.length)+") ",1)]),e("div",{class:"group-actions",onClick:n[2]||(n[2]=he(()=>{},["stop"]))},[e("label",Nt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:C(R),onChange:D=>Z(R,D),"data-group":c},null,40,Dt),n[6]||(n[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Pt),e("div",{class:W(["tool-group-content",{collapsed:v.value.has(c)}])},[(i(!0),r(H,null,Y(R.filter(D=>D&&D.key),D=>(i(),r("div",{key:D.key,class:"tool-selection-item"},[e("div",Lt,[e("div",Rt,t(D.name),1),D.description?(i(),r("div",Ft,t(D.description),1)):E("",!0)]),e("div",Bt,[e("label",{class:"tool-enable-switch",onClick:n[3]||(n[3]=he(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:Q(D.key),onChange:J=>oe(D.key,J)},null,40,It),n[7]||(n[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(i(),r("div",qt,[y(s(x),{icon:"carbon:tools",class:"empty-icon"}),n[8]||(n[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),Gt=ie(Ot,[["__scopeId","data-v-79f6a572"]]);class pe{static async handleResponse(o){if(!o.ok)try{const a=await o.json();throw new Error(a.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Agent list:",o),o}}static async getAgentById(o){try{const a=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(a)).json()}catch(a){throw console.error(`Failed to get Agent[${o}] details:`,a),a}}static async createAgent(o){try{const a=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(a)).json()}catch(a){throw console.error("Failed to create Agent:",a),a}}static async updateAgent(o,a){try{const g=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return await(await this.handleResponse(g)).json()}catch(g){throw console.error(`Failed to update Agent[${o}]:`,g),g}}static async deleteAgent(o){try{const a=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(a.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(a)}catch(a){throw console.error(`Failed to delete Agent[${o}]:`,a),a}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}me(pe,"BASE_URL","/api/agents");class de{static async handleResponse(o){if(!o.ok)try{const a=await o.json();throw new Error(a.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const a=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(a)).json()}catch(a){throw console.error(`Failed to get Model[${o}] details:`,a),a}}static async createModel(o){try{const a=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(a)).json()}catch(a){throw console.error("Failed to create Model:",a),a}}static async updateModel(o,a){try{const g=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return await(await this.handleResponse(g)).json()}catch(g){throw console.error(`Failed to update Model[${o}]:`,g),g}}static async deleteModel(o){try{const a=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(a.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(a)}catch(a){throw console.error(`Failed to delete Model[${o}]:`,a),a}}}me(de,"BASE_URL","/api/models");const jt={class:"config-panel"},Kt={class:"panel-header"},Jt={class:"panel-actions"},zt=["disabled"],Ht={class:"agent-layout"},Yt={class:"agent-list"},Xt={class:"list-header"},Wt={class:"agent-count"},Qt={key:0,class:"agents-container"},Zt=["onClick"],es={class:"agent-card-header"},os={class:"agent-name"},ts={class:"agent-desc"},ss={key:0,class:"agent-model"},ns={class:"model-tag"},as={class:"model-tag"},ls={key:1,class:"agent-tools"},is={key:0,class:"tool-more"},cs={key:1,class:"loading-state"},rs={key:2,class:"empty-state"},ds={key:0,class:"agent-detail"},us={class:"detail-header"},ps={class:"detail-actions"},fs={class:"form-item"},gs=["placeholder"],ms={class:"form-item"},vs=["placeholder"],hs={class:"form-item"},ys=["value","placeholder"],_s={class:"model-section"},bs={class:"form-item"},Cs={class:"model-chooser"},$s=["title"],ws={key:0,class:"current-model"},ks={class:"model-type"},Ss={class:"model-name"},Ts={key:1,class:"current-model"},Vs={class:"current-model"},As={class:"dropdown-header"},xs={class:"model-options"},Ps=["onClick"],Us={class:"model-type"},Es={class:"model-name"},Ms={class:"tools-section"},Ns={class:"assigned-tools"},Ds={class:"section-header"},Ls={class:"tools-grid"},Rs={class:"tool-info"},Fs={class:"tool-name"},Bs={class:"tool-desc"},Is={key:0,class:"no-tools"},qs={key:1,class:"no-selection"},Os={class:"modal-form"},Gs={class:"form-item"},js=["placeholder"],Ks={class:"form-item"},Js=["placeholder"],zs={class:"form-item"},Hs=["value","placeholder"],Ys={class:"delete-confirm"},Xs={class:"warning-text"},Ws=le({__name:"agentConfig",setup(B){const{t:o}=ye(),a=M(!1),g=M(""),m=M(""),p=ne([]),d=M(null),v=ne([]),V=M(!1),P=M(!1),b=M(!1),S=M(!1),L=M(null),Q=ne([]),oe=()=>{S.value=!S.value},q=A=>{L.value=A,S.value=!1},C=ne({name:"",description:"",nextStepPrompt:""}),O=A=>{const h=v.find(G=>G.key===A);return h?h.name:A},Z=A=>{const h=v.find(G=>G.key===A);return h?h.description:""},K=(A,h)=>{h==="success"?(m.value=A,setTimeout(()=>{m.value=""},3e3)):(g.value=A,setTimeout(()=>{g.value=""},5e3))},re=async()=>{a.value=!0;try{const[A,h,G]=await Promise.all([pe.getAllAgents(),pe.getAvailableTools(),de.getAllModels()]),$=A.map(u=>({...u,availableTools:u.availableTools,...G}));p.splice(0,p.length,...$),v.splice(0,v.length,...h),Q.splice(0,Q.length,...G),$.length>0&&await U($[0])}catch(A){console.error("加载数据失败:",A),K(o("config.agentConfig.loadDataFailed")+": "+A.message,"error");const h=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],G=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];v.splice(0,v.length,...h),p.splice(0,p.length,...G),G.length>0&&(d.value=G[0])}finally{a.value=!1}},U=async A=>{try{const h=await pe.getAgentById(A.id);d.value={...h,availableTools:h.availableTools},L.value=h.model??null}catch(h){console.error("加载Agent详情失败:",h),K(o("config.agentConfig.loadDetailsFailed")+": "+h.message,"error"),d.value={...A,availableTools:A.availableTools}}},l=()=>{C.name="",C.description="",C.nextStepPrompt="",V.value=!0},n=async()=>{var A;if(!C.name.trim()||!C.description.trim()){K(o("config.agentConfig.requiredFields"),"error");return}try{const h={name:C.name.trim(),description:C.description.trim(),nextStepPrompt:((A=C.nextStepPrompt)==null?void 0:A.trim())??"",availableTools:[]},G=await pe.createAgent(h);p.push(G),d.value=G,V.value=!1,K(o("config.agentConfig.createSuccess"),"success")}catch(h){K(o("config.agentConfig.createFailed")+": "+h.message,"error")}},c=()=>{b.value=!0},R=A=>{d.value&&(d.value.availableTools=[...A])},D=async()=>{if(d.value){if(!d.value.name.trim()||!d.value.description.trim()){K(o("config.agentConfig.requiredFields"),"error");return}try{d.value.model=L.value;const A=await pe.updateAgent(d.value.id,d.value),h=p.findIndex(G=>G.id===A.id);h!==-1&&(p[h]=A),d.value=A,d.value.model=L.value,K(o("config.agentConfig.saveSuccess"),"success")}catch(A){K(o("config.agentConfig.saveFailed")+": "+A.message,"error")}}},J=()=>{P.value=!0},se=async()=>{if(d.value)try{await pe.deleteAgent(d.value.id);const A=p.findIndex(h=>h.id===d.value.id);A!==-1&&p.splice(A,1),d.value=p.length>0?p[0]:null,P.value=!1,K(o("config.agentConfig.deleteSuccess"),"success")}catch(A){K(o("config.agentConfig.deleteFailed")+": "+A.message,"error")}},$e=()=>{const A=document.createElement("input");A.type="file",A.accept=".json",A.onchange=h=>{var $;const G=($=h.target.files)==null?void 0:$[0];if(G){const u=new FileReader;u.onload=async _=>{var k;try{const T=JSON.parse((k=_.target)==null?void 0:k.result);if(!T.name||!T.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:f,...N}=T,F=await pe.createAgent(N);p.push(F),d.value=F,K(o("config.agentConfig.importSuccess"),"success")}catch(T){K(o("config.agentConfig.importFailed")+": "+T.message,"error")}},u.readAsText(G)}},A.click()},ge=()=>{if(d.value)try{const A=JSON.stringify(d.value,null,2),h=new Blob([A],{type:"application/json"}),G=URL.createObjectURL(h),$=document.createElement("a");$.href=G,$.download=`agent-${d.value.name}-${new Date().toISOString().split("T")[0]}.json`,$.click(),URL.revokeObjectURL(G),K(o("config.agentConfig.exportSuccess"),"success")}catch(A){K(o("config.agentConfig.exportFailed")+": "+A.message,"error")}};return Ce(()=>{re()}),(A,h)=>{var G;return i(),r("div",jt,[e("div",Kt,[e("h2",null,t(s(o)("config.agentConfig.title")),1),e("div",Jt,[e("button",{class:"action-btn",onClick:$e},[y(s(x),{icon:"carbon:upload"}),w(" "+t(s(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ge,disabled:!d.value},[y(s(x),{icon:"carbon:download"}),w(" "+t(s(o)("config.agentConfig.export")),1)],8,zt)])]),e("div",Ht,[e("div",Yt,[e("div",Xt,[e("h3",null,t(s(o)("config.agentConfig.configuredAgents")),1),e("span",Wt,"("+t(p.length)+t(s(o)("config.agentConfig.agentCount"))+")",1)]),a.value?E("",!0):(i(),r("div",Qt,[(i(!0),r(H,null,Y(p,$=>{var u,_;return i(),r("div",{key:$.id,class:W(["agent-card",{active:((u=d.value)==null?void 0:u.id)===$.id}]),onClick:k=>U($)},[e("div",es,[e("span",os,t($.name),1),y(s(x),{icon:"carbon:chevron-right"})]),e("p",ts,t($.description),1),$.model?(i(),r("div",ss,[e("span",ns,t($.model.type),1),e("span",as,t($.model.modelName),1)])):E("",!0),((_=$.availableTools)==null?void 0:_.length)>0?(i(),r("div",ls,[(i(!0),r(H,null,Y($.availableTools.slice(0,3),k=>(i(),r("span",{key:k,class:"tool-tag"},t(O(k)),1))),128)),$.availableTools.length>3?(i(),r("span",is," +"+t($.availableTools.length-3),1)):E("",!0)])):E("",!0)],10,Zt)}),128))])),a.value?(i(),r("div",cs,[y(s(x),{icon:"carbon:loading",class:"loading-icon"}),w(" "+t(s(o)("common.loading")),1)])):E("",!0),!a.value&&p.length===0?(i(),r("div",rs,[y(s(x),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,t(s(o)("config.agentConfig.noAgent")),1)])):E("",!0),e("button",{class:"add-btn",onClick:l},[y(s(x),{icon:"carbon:add"}),w(" "+t(s(o)("config.agentConfig.createNew")),1)])]),d.value?(i(),r("div",ds,[e("div",us,[e("h3",null,t(d.value.name),1),e("div",ps,[e("button",{class:"action-btn primary",onClick:D},[y(s(x),{icon:"carbon:save"}),w(" "+t(s(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:J},[y(s(x),{icon:"carbon:trash-can"}),w(" "+t(s(o)("common.delete")),1)])])]),e("div",fs,[e("label",null,[w(t(s(o)("config.agentConfig.agentName"))+" ",1),h[15]||(h[15]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":h[0]||(h[0]=$=>d.value.name=$),placeholder:s(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,gs),[[j,d.value.name]])]),e("div",ms,[e("label",null,[w(t(s(o)("config.agentConfig.description"))+" ",1),h[16]||(h[16]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":h[1]||(h[1]=$=>d.value.description=$),rows:"3",placeholder:s(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,vs),[[j,d.value.description]])]),e("div",hs,[e("label",null,t(s(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:d.value.nextStepPrompt||"",onInput:h[2]||(h[2]=$=>d.value.nextStepPrompt=$.target.value),rows:"8",placeholder:s(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,ys)]),e("div",_s,[e("h4",null,t(s(o)("config.agentConfig.modelConfiguration")),1),e("div",bs,[e("div",Cs,[e("button",{class:"model-btn",onClick:oe,title:A.$t("model.switch")},[y(s(x),{icon:"carbon:build-run",width:"18"}),L.value?(i(),r("span",ws,[e("span",ks,t(L.value.type),1),h[17]||(h[17]=e("span",{class:"spacer"},null,-1)),e("span",Ss,t(L.value.modelName),1)])):(i(),r("span",Ts,[e("span",Vs,t(s(o)("config.agentConfig.modelConfigurationLabel")),1)])),y(s(x),{icon:S.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,$s),S.value?(i(),r("div",{key:0,class:"model-dropdown",onClick:h[4]||(h[4]=he(()=>{},["stop"]))},[e("div",As,[e("span",null,t(s(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:h[3]||(h[3]=$=>S.value=!1)},[y(s(x),{icon:"carbon:close",width:"16"})])]),e("div",xs,[(i(!0),r(H,null,Y(Q,$=>{var u,_;return i(),r("button",{key:$.id,class:W(["model-option",{active:((u=L.value)==null?void 0:u.id)===$.id}]),onClick:k=>q($)},[e("span",Us,t($.type),1),e("span",Es,t($.modelName),1),((_=L.value)==null?void 0:_.id)===$.id?(i(),ee(s(x),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):E("",!0)],10,Ps)}),128))])])):E("",!0),S.value?(i(),r("div",{key:1,class:"backdrop",onClick:h[5]||(h[5]=$=>S.value=!1)})):E("",!0)])])]),e("div",Ms,[e("h4",null,t(s(o)("config.agentConfig.toolConfiguration")),1),e("div",Ns,[e("div",Ds,[e("span",null,t(s(o)("config.agentConfig.assignedTools"))+" ("+t((d.value.availableTools||[]).length)+")",1),v.length>0?(i(),r("button",{key:0,class:"action-btn small",onClick:c},[y(s(x),{icon:"carbon:add"}),w(" "+t(s(o)("config.agentConfig.addRemoveTools")),1)])):E("",!0)]),e("div",Ls,[(i(!0),r(H,null,Y(d.value.availableTools||[],$=>(i(),r("div",{key:$,class:"tool-item assigned"},[e("div",Rs,[e("span",Fs,t(O($)),1),e("span",Bs,t(Z($)),1)])]))),128)),d.value.availableTools.length===0?(i(),r("div",Is,[y(s(x),{icon:"carbon:tool-box"}),e("span",null,t(s(o)("config.agentConfig.noAssignedTools")),1)])):E("",!0)])])])])):(i(),r("div",qs,[y(s(x),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,t(s(o)("config.agentConfig.selectAgentHint")),1)]))]),y(fe,{modelValue:V.value,"onUpdate:modelValue":h[9]||(h[9]=$=>V.value=$),title:s(o)("config.agentConfig.newAgent"),onConfirm:n},{default:X(()=>[e("div",Os,[e("div",Gs,[e("label",null,[w(t(s(o)("config.agentConfig.agentName"))+" ",1),h[18]||(h[18]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":h[6]||(h[6]=$=>C.name=$),placeholder:s(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,js),[[j,C.name]])]),e("div",Ks,[e("label",null,[w(t(s(o)("config.agentConfig.description"))+" ",1),h[19]||(h[19]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":h[7]||(h[7]=$=>C.description=$),rows:"3",placeholder:s(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,Js),[[j,C.description]])]),e("div",zs,[e("label",null,t(s(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:C.nextStepPrompt||"",onInput:h[8]||(h[8]=$=>C.nextStepPrompt=$.target.value),rows:"8",placeholder:s(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,Hs)])])]),_:1},8,["modelValue","title"]),y(Gt,{modelValue:b.value,"onUpdate:modelValue":h[10]||(h[10]=$=>b.value=$),tools:v,"selected-tool-ids":((G=d.value)==null?void 0:G.availableTools)||[],onConfirm:R},null,8,["modelValue","tools","selected-tool-ids"]),y(fe,{modelValue:P.value,"onUpdate:modelValue":h[12]||(h[12]=$=>P.value=$),title:s(o)("config.agentConfig.deleteConfirm")},{footer:X(()=>[e("button",{class:"cancel-btn",onClick:h[11]||(h[11]=$=>P.value=!1)},t(s(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:se},t(s(o)("common.delete")),1)]),default:X(()=>{var $;return[e("div",Ys,[y(s(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(t(s(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,t(($=d.value)==null?void 0:$.name),1),w(" "+t(s(o)("common.confirm"))+"？",1)]),e("p",Xs,t(s(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),g.value?(i(),r("div",{key:0,class:"error-toast",onClick:h[13]||(h[13]=$=>g.value="")},[y(s(x),{icon:"carbon:error"}),w(" "+t(g.value),1)])):E("",!0),m.value?(i(),r("div",{key:1,class:"success-toast",onClick:h[14]||(h[14]=$=>m.value="")},[y(s(x),{icon:"carbon:checkmark"}),w(" "+t(m.value),1)])):E("",!0)])}}}),Qs=ie(Ws,[["__scopeId","data-v-82fd42c0"]]),Zs={class:"custom-select"},en=["title"],on={key:0,class:"current-option"},tn={class:"option-name"},sn={key:1,class:"current-option"},nn={class:"dropdown-header"},an={class:"select-options"},ln=["onClick"],cn={class:"option-name"},rn=le({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{}},emits:["update:modelValue"],setup(B,{emit:o}){const a=B,g=o,m=M(!1),p=ae(()=>a.options.find(P=>P.id===a.modelValue)),d=P=>P.id===a.modelValue,v=()=>{m.value=!m.value},V=P=>{g("update:modelValue",P.id),m.value=!1};return(P,b)=>(i(),r("div",Zs,[e("button",{class:"select-btn",onClick:v,title:P.placeholder},[y(s(x),{icon:a.icon||"carbon:select-01",width:"18"},null,8,["icon"]),p.value?(i(),r("span",on,[e("span",tn,t(p.value.name),1)])):(i(),r("span",sn,t(P.placeholder),1)),y(s(x),{icon:m.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,en),y(_e,{name:"slideDown"},{default:X(()=>[I(e("div",{class:"select-dropdown",onClick:b[1]||(b[1]=he(()=>{},["stop"]))},[e("div",nn,[e("span",null,t(P.dropdownTitle),1),e("button",{class:"close-btn",onClick:b[0]||(b[0]=S=>m.value=!1)},[y(s(x),{icon:"carbon:close",width:"16"})])]),e("div",an,[(i(!0),r(H,null,Y(P.options,S=>(i(),r("button",{key:S.id,class:W(["select-option",{active:d(S)}]),onClick:L=>V(S)},[e("span",cn,t(S.name),1),d(S)?(i(),ee(s(x),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):E("",!0)],10,ln))),128))])],512),[[Ae,m.value]])]),_:1}),m.value?(i(),r("div",{key:0,class:"backdrop",onClick:b[2]||(b[2]=S=>m.value=!1)})):E("",!0)]))}}),Ue=ie(rn,[["__scopeId","data-v-1185e370"]]),dn={class:"config-panel"},un={class:"panel-header"},pn={class:"panel-actions"},fn=["disabled"],gn={class:"model-layout"},mn={class:"model-list"},vn={class:"list-header"},hn={class:"model-count"},yn={key:0,class:"models-container"},_n=["onClick"],bn={class:"model-card-header"},Cn={class:"model-name"},$n={class:"model-desc"},wn={key:0,class:"model-type"},kn={class:"model-tag"},Sn={key:1,class:"loading-state"},Tn={key:2,class:"empty-state"},Vn={key:0,class:"model-detail"},An={class:"detail-header"},xn={class:"detail-actions"},Pn={class:"form-item"},Un={class:"form-item"},En=["placeholder"],Mn={class:"form-item"},Nn=["placeholder"],Dn={class:"form-item"},Ln=["placeholder"],Rn={class:"form-item"},Fn=["placeholder"],Bn={key:1,class:"no-selection"},In={class:"modal-form"},qn={class:"form-item"},On={class:"form-item"},Gn=["placeholder"],jn={class:"form-item"},Kn=["placeholder"],Jn={class:"form-item"},zn=["placeholder"],Hn={class:"form-item"},Yn=["placeholder"],Xn={class:"delete-confirm"},Wn={class:"warning-text"},Qn=le({__name:"modelConfig",setup(B){const{t:o}=ye(),a=M(!1),g=M(""),m=M(""),p=ne([]),d=ne([]),v=M(null),V=M(!1),P=M(!1),b=ne({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),S=(U,l)=>{l==="success"?(m.value=U,setTimeout(()=>{m.value=""},3e3)):(g.value=U,setTimeout(()=>{g.value=""},5e3))},L=async()=>{a.value=!0;try{const[U,l]=await Promise.all([de.getAllModels(),de.getAllTypes()]),n=U.map(c=>({...c}));p.splice(0,p.length,...n),d.splice(0,d.length,...l),n.length>0&&await Q(n[0])}catch(U){console.error("加载数据失败:",U),S(o("config.modelConfig.loadDataFailed")+": "+U.message,"error")}finally{a.value=!1}},Q=async U=>{try{const l=await de.getModelById(U.id);v.value={...l}}catch(l){console.error("加载Model详情失败:",l),S(o("config.modelConfig.loadDetailsFailed")+": "+l.message,"error"),v.value={...U}}},oe=()=>{b.baseUrl="",b.apiKey="",b.modelName="",b.modelDescription="",b.type="",V.value=!0},q=async()=>{if(!b.modelName.trim()||!b.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const U={baseUrl:b.baseUrl.trim(),apiKey:b.apiKey.trim(),modelName:b.modelName.trim(),modelDescription:b.modelDescription.trim(),type:b.type.trim()},l=await de.createModel(U);p.push(l),v.value=l,V.value=!1,S(o("config.modelConfig.createSuccess"),"success")}catch(U){S(o("config.modelConfig.createFailed")+": "+U.message,"error")}},C=async()=>{if(v.value){if(!v.value.modelName.trim()||!v.value.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const U=await de.updateModel(v.value.id,v.value),l=p.findIndex(n=>n.id===U.id);l!==-1&&(p[l]=U),v.value=U,S(o("config.modelConfig.saveSuccess"),"success")}catch(U){S(o("config.modelConfig.saveFailed")+": "+U.message,"error")}}},O=()=>{P.value=!0},Z=async()=>{if(v.value)try{await de.deleteModel(v.value.id);const U=p.findIndex(l=>l.id===v.value.id);U!==-1&&p.splice(U,1),v.value=p.length>0?p[0]:null,P.value=!1,S(o("config.modelConfig.deleteSuccess"),"success")}catch(U){S(o("config.modelConfig.deleteFailed")+": "+U.message,"error")}},K=()=>{const U=document.createElement("input");U.type="file",U.accept=".json",U.onchange=l=>{var c;const n=(c=l.target.files)==null?void 0:c[0];if(n){const R=new FileReader;R.onload=async D=>{var J;try{const se=JSON.parse((J=D.target)==null?void 0:J.result);if(!se.modelName||!se.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:$e,...ge}=se,A=await de.createModel(ge);p.push(A),v.value=A,S(o("config.modelConfig.importSuccess"),"success")}catch(se){S(o("config.modelConfig.importFailed")+": "+se.message,"error")}},R.readAsText(n)}},U.click()},re=()=>{if(v.value)try{const U=JSON.stringify(v.value,null,2),l=new Blob([U],{type:"application/json"}),n=URL.createObjectURL(l),c=document.createElement("a");c.href=n,c.download=`model-${v.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(n),S(o("config.modelConfig.exportSuccess"),"success")}catch(U){S(o("config.modelConfig.exportFailed")+": "+U.message,"error")}};return Ce(()=>{L()}),(U,l)=>(i(),r("div",dn,[e("div",un,[e("h2",null,t(s(o)("config.modelConfig.title")),1),e("div",pn,[e("button",{class:"action-btn",onClick:K},[y(s(x),{icon:"carbon:upload"}),w(" "+t(s(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:re,disabled:!v.value},[y(s(x),{icon:"carbon:download"}),w(" "+t(s(o)("config.modelConfig.export")),1)],8,fn)])]),e("div",gn,[e("div",mn,[e("div",vn,[e("h3",null,t(s(o)("config.modelConfig.configuredModels")),1),e("span",hn,"("+t(p.length)+")",1)]),a.value?E("",!0):(i(),r("div",yn,[(i(!0),r(H,null,Y(p,n=>{var c;return i(),r("div",{key:n.id,class:W(["model-card",{active:((c=v.value)==null?void 0:c.id)===n.id}]),onClick:R=>Q(n)},[e("div",bn,[e("span",Cn,t(n.modelName),1),y(s(x),{icon:"carbon:chevron-right"})]),e("p",$n,t(n.modelDescription),1),n.type?(i(),r("div",wn,[e("span",kn,t(n.type),1)])):E("",!0)],10,_n)}),128))])),a.value?(i(),r("div",Sn,[y(s(x),{icon:"carbon:loading",class:"loading-icon"}),w(" "+t(s(o)("common.loading")),1)])):E("",!0),!a.value&&p.length===0?(i(),r("div",Tn,[y(s(x),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,t(s(o)("config.modelConfig.noModel")),1)])):E("",!0),e("button",{class:"add-btn",onClick:oe},[y(s(x),{icon:"carbon:add"}),w(" "+t(s(o)("config.modelConfig.createNew")),1)])]),v.value?(i(),r("div",Vn,[e("div",An,[e("h3",null,t(v.value.modelName),1),e("div",xn,[e("button",{class:"action-btn primary",onClick:C},[y(s(x),{icon:"carbon:save"}),w(" "+t(s(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:O},[y(s(x),{icon:"carbon:trash-can"}),w(" "+t(s(o)("common.delete")),1)])])]),e("div",Pn,[e("label",null,[w(t(s(o)("config.modelConfig.type"))+" ",1),l[15]||(l[15]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:v.value.type,"onUpdate:modelValue":l[0]||(l[0]=n=>v.value.type=n),options:d.map(n=>({id:n,name:n})),placeholder:s(o)("config.modelConfig.typePlaceholder"),"dropdown-title":s(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Un,[e("label",null,[w(t(s(o)("config.modelConfig.baseUrl"))+" ",1),l[16]||(l[16]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=n=>v.value.baseUrl=n),placeholder:s(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,En),[[j,v.value.baseUrl]])]),e("div",Mn,[e("label",null,[w(t(s(o)("config.modelConfig.apiKey"))+" ",1),l[17]||(l[17]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=n=>v.value.apiKey=n),placeholder:s(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Nn),[[j,v.value.apiKey]])]),e("div",Dn,[e("label",null,[w(t(s(o)("config.modelConfig.modelName"))+" ",1),l[18]||(l[18]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=n=>v.value.modelName=n),placeholder:s(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Ln),[[j,v.value.modelName]])]),e("div",Rn,[e("label",null,[w(t(s(o)("config.modelConfig.description"))+" ",1),l[19]||(l[19]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=n=>v.value.modelDescription=n),rows:"3",placeholder:s(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Fn),[[j,v.value.modelDescription]])])])):(i(),r("div",Bn,[y(s(x),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,t(s(o)("config.modelConfig.selectModelHint")),1)]))]),y(fe,{modelValue:V.value,"onUpdate:modelValue":l[10]||(l[10]=n=>V.value=n),title:s(o)("config.modelConfig.newModel"),onConfirm:q},{default:X(()=>[e("div",In,[e("div",qn,[e("label",null,[w(t(s(o)("config.modelConfig.type"))+" ",1),l[20]||(l[20]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:b.type,"onUpdate:modelValue":l[5]||(l[5]=n=>b.type=n),options:d.map(n=>({id:n,name:n})),placeholder:s(o)("config.modelConfig.typePlaceholder"),"dropdown-title":s(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",On,[e("label",null,[w(t(s(o)("config.modelConfig.baseUrl"))+" ",1),l[21]||(l[21]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[6]||(l[6]=n=>b.baseUrl=n),placeholder:s(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Gn),[[j,b.baseUrl]])]),e("div",jn,[e("label",null,[w(t(s(o)("config.modelConfig.apiKey"))+" ",1),l[22]||(l[22]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=n=>b.apiKey=n),placeholder:s(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Kn),[[j,b.apiKey]])]),e("div",Jn,[e("label",null,[w(t(s(o)("config.modelConfig.modelName"))+" ",1),l[23]||(l[23]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":l[8]||(l[8]=n=>b.modelName=n),placeholder:s(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,zn),[[j,b.modelName]])]),e("div",Hn,[e("label",null,[w(t(s(o)("config.modelConfig.description"))+" ",1),l[24]||(l[24]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=n=>b.modelDescription=n),rows:"3",placeholder:s(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Yn),[[j,b.modelDescription]])])])]),_:1},8,["modelValue","title"]),y(fe,{modelValue:P.value,"onUpdate:modelValue":l[12]||(l[12]=n=>P.value=n),title:"Delete confirmation"},{footer:X(()=>[e("button",{class:"cancel-btn",onClick:l[11]||(l[11]=n=>P.value=!1)},t(s(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Z},t(s(o)("common.delete")),1)]),default:X(()=>{var n;return[e("div",Xn,[y(s(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(t(s(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,t((n=v.value)==null?void 0:n.modelName),1),w(" "+t(s(o)("common.confirm"))+"？",1)]),e("p",Wn,t(s(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),g.value?(i(),r("div",{key:0,class:"error-toast",onClick:l[13]||(l[13]=n=>g.value="")},[y(s(x),{icon:"carbon:error"}),w(" "+t(g.value),1)])):E("",!0),m.value?(i(),r("div",{key:1,class:"success-toast",onClick:l[14]||(l[14]=n=>m.value="")},[y(s(x),{icon:"carbon:checkmark"}),w(" "+t(m.value),1)])):E("",!0)]))}}),Zn=ie(Qn,[["__scopeId","data-v-615182f6"]]);class ke{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const a=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!a.ok)throw new Error(`Failed to add MCP server: ${a.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(a){return console.error("Failed to add MCP server:",a),{success:!1,message:a instanceof Error?a.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const a=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!a.ok)throw new Error(`Failed to delete MCP server: ${a.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(a){return console.error(`Failed to delete MCP server[${o}]:`,a),{success:!1,message:a instanceof Error?a.message:"Failed to delete, please retry"}}}}me(ke,"BASE_URL","/api/mcp");const ea={class:"mcp-config-panel"},oa={class:"mcp-header"},ta={class:"header-left"},sa={class:"mcp-stats"},na={class:"stat-item"},aa={class:"stat-label"},la={class:"stat-value"},ia={class:"header-right"},ca={class:"search-box"},ra=["placeholder"],da={key:0,class:"loading-container"},ua={key:1,class:"mcp-layout"},pa={class:"mcp-table-container"},fa={class:"section-title"},ga={key:0,class:"empty-state"},ma={class:"empty-state-text"},va={key:1,class:"mcp-table-wrapper"},ha={class:"mcp-table"},ya={class:"mcp-id"},_a={class:"mcp-server-name"},ba={class:"server-name-content"},Ca={class:"mcp-connection-type"},$a={class:"mcp-config"},wa=["title"],ka={class:"mcp-actions"},Sa=["onClick","disabled"],Ta={class:"add-mcp-container"},Va={class:"add-mcp-header"},Aa={class:"add-mcp-title"},xa={class:"mcp-form"},Pa={class:"mcp-form-group"},Ua={class:"form-label"},Ea={class:"connection-type-options"},Ma={class:"connection-type-option"},Na={for:"mcp-connection-type-studio",class:"radio-label"},Da={class:"connection-type-desc"},La={class:"connection-type-option"},Ra={for:"mcp-connection-type-sse",class:"radio-label"},Fa={class:"connection-type-desc"},Ba={class:"connection-type-option"},Ia={for:"mcp-connection-type-streaming",class:"radio-label"},qa={class:"connection-type-desc"},Oa={class:"mcp-form-group"},Ga={class:"form-label"},ja=["placeholder"],Ka={class:"mcp-form-actions"},Ja=["disabled"],za=["disabled"],Ha={class:"mcp-form-instructions"},Ya={class:"indented-list"},Xa=le({__name:"mcpConfig",setup(B){const{t:o}=ye(),a=M(!1),g=M([]),m=M(""),p=ne({connectionType:"STUDIO",configJson:""}),d=ne({show:!1,text:"",type:"success"}),v=ae(()=>p.configJson.trim().length>0),V=ae(()=>{if(!m.value.trim())return g.value;const q=m.value.toLowerCase();return g.value.filter(C=>C.mcpServerName.toLowerCase().includes(q)||C.connectionType.toLowerCase().includes(q)||C.connectionConfig.toLowerCase().includes(q))}),P=q=>q?q.length>50?q.substring(0,50)+"...":q:"",b=(q,C="success")=>{d.text=q,d.type=C,d.show=!0,setTimeout(()=>{d.show=!1},3e3)},S=async()=>{try{a.value=!0,g.value=await ke.getAllMcpServers()}catch(q){console.error("加载MCP服务器列表失败:",q),b(o("config.basicConfig.loadConfigFailed"),"error")}finally{a.value=!1}},L=async()=>{if(!v.value){b(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(p.configJson)}catch{b(o("config.mcpConfig.invalidJson"),"error");return}try{a.value=!0;const q={connectionType:p.connectionType,configJson:p.configJson},C=await ke.addMcpServer(q);C.success?(b(o("config.mcpConfig.addSuccess")),oe(),await S()):b(C.message||o("config.mcpConfig.addFailed"),"error")}catch(q){console.error("添加MCP服务器失败:",q),b(o("config.mcpConfig.addFailed"),"error")}finally{a.value=!1}},Q=async q=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{a.value=!0;const C=await ke.removeMcpServer(q);C.success?(b(o("config.mcpConfig.deleteSuccess")),await S()):b(C.message||o("config.mcpConfig.deleteFailed"),"error")}catch(C){console.error("删除MCP服务器失败:",C),b(o("config.mcpConfig.deleteFailed"),"error")}finally{a.value=!1}},oe=()=>{p.connectionType="STUDIO",p.configJson=""};return Ce(()=>{S()}),(q,C)=>(i(),r("div",ea,[e("div",oa,[e("div",ta,[e("h2",null,t(s(o)("config.mcpConfig.title")),1),e("div",sa,[e("span",na,[e("span",aa,t(s(o)("config.mcpConfig.mcpServers"))+":",1),e("span",la,t(g.value.length),1)])])]),e("div",ia,[e("div",ca,[I(e("input",{"onUpdate:modelValue":C[0]||(C[0]=O=>m.value=O),type:"text",placeholder:s(o)("config.mcpSearch"),class:"search-input"},null,8,ra),[[j,m.value]]),C[5]||(C[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),a.value?(i(),r("div",da,[C[6]||(C[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,t(s(o)("config.loading")),1)])):(i(),r("div",ua,[e("div",pa,[e("h3",fa,t(s(o)("config.mcpConfig.serverList")),1),V.value.length===0?(i(),r("div",ga,[C[7]||(C[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",ma,t(m.value?s(o)("config.notFound"):s(o)("config.mcpConfig.noServers")),1)])):(i(),r("div",va,[e("table",ha,[e("thead",null,[e("tr",null,[C[8]||(C[8]=e("th",null,"ID",-1)),e("th",null,t(s(o)("agent.name")),1),e("th",null,t(s(o)("config.mcpConfig.connectionType")),1),e("th",null,t(s(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,t(s(o)("common.actions")),1)])]),e("tbody",null,[(i(!0),r(H,null,Y(V.value,O=>(i(),r("tr",{key:O.id,class:"mcp-row"},[e("td",ya,t(O.id),1),e("td",_a,[e("div",ba,[C[9]||(C[9]=e("span",{class:"server-icon"},"🔌",-1)),w(" "+t(O.mcpServerName),1)])]),e("td",Ca,[e("span",{class:W(["connection-type-badge",O.connectionType.toLowerCase()])},t(O.connectionType),3)]),e("td",$a,[e("div",{class:"config-preview",title:O.connectionConfig},t(P(O.connectionConfig)),9,wa)]),e("td",ka,[e("button",{onClick:Z=>Q(O.id),class:"action-btn delete-btn",disabled:a.value},t(s(o)("common.delete")),9,Sa)])]))),128))])])]))]),e("div",Ta,[e("div",Va,[e("h3",Aa,t(s(o)("config.mcpConfig.addMcpServer")),1)]),e("div",xa,[e("div",Pa,[e("label",Ua,t(s(o)("config.mcpConfig.connectionType"))+"：",1),e("div",Ea,[e("div",Ma,[I(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":C[1]||(C[1]=O=>p.connectionType=O),value:"STUDIO"},null,512),[[Ve,p.connectionType]]),e("label",Na,[C[10]||(C[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",Da,t(s(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",La,[I(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":C[2]||(C[2]=O=>p.connectionType=O),value:"SSE"},null,512),[[Ve,p.connectionType]]),e("label",Ra,[C[11]||(C[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Fa,t(s(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Ba,[I(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":C[3]||(C[3]=O=>p.connectionType=O),value:"STREAMING"},null,512),[[Ve,p.connectionType]]),e("label",Ia,[C[12]||(C[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",qa,t(s(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",Oa,[e("label",Ga,t(s(o)("config.mcpConfig.configJsonLabel")),1),I(e("textarea",{"onUpdate:modelValue":C[4]||(C[4]=O=>p.configJson=O),placeholder:s(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,ja),[[j,p.configJson]])]),e("div",Ka,[e("button",{onClick:L,class:"action-btn add-btn",disabled:a.value},t(s(o)("common.add")),9,Ja),e("button",{onClick:oe,class:"action-btn reset-btn",disabled:a.value},t(s(o)("common.reset")),9,za)])]),e("div",Ha,[e("h4",null,t(s(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[w(t(s(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",Ya,[e("li",null,[e("strong",null,t(s(o)("config.mcpConfig.instructionStep1Local")),1),w("："+t(s(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,t(s(o)("config.mcpConfig.instructionStep1Remote")),1),w("："+t(s(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,t(s(o)("config.mcpConfig.instructionStep2")),1),e("li",null,t(s(o)("config.mcpConfig.instructionStep3")),1),e("li",null,t(s(o)("config.mcpConfig.instructionStep4")),1)])])])])),y(_e,{name:"message-fade"},{default:X(()=>[d.show?(i(),r("div",{key:0,class:W(["message-toast",d.type])},t(d.text),3)):E("",!0)]),_:1})]))}}),Wa=ie(Xa,[["__scopeId","data-v-355da8bb"]]);class ve{static async handleResponse(o){if(!o.ok)try{const a=await o.json();throw new Error(a.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Prompt list:",o),o}}static async getPromptById(o){try{const a=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(a)).json()}catch(a){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,a),a}}static async createPrompt(o){try{const a=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(a)).json()}catch(a){throw console.error("Failed to create Prompt:",a),a}}static async updatePrompt(o,a){try{const g=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return await(await this.handleResponse(g)).json()}catch(g){throw console.error(`Failed to update Prompt[${o}]:`,g),g}}static async deletePrompt(o){try{const a=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(a.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(a)}catch(a){throw console.error(`Failed to delete Prompt[${o}]:`,a),a}}}me(ve,"BASE_URL","/api/prompt");const Qa=le({__name:"Toast",setup(B,{expose:o}){const a=M(!1),g=M(""),m=M("success"),p=M("carbon:checkmark"),d=M(3e3),v=(P,b="success",S=3e3)=>{g.value=P,m.value=b,p.value=b==="success"?"carbon:checkmark":"carbon:error",d.value=S,a.value=!0,setTimeout(()=>{a.value=!1},d.value)},V=()=>{a.value=!1};return o({show:v}),(P,b)=>(i(),ee(Ee,{to:"body"},[y(_e,{name:"slide"},{default:X(()=>[a.value?(i(),r("div",{key:0,class:W(["toast",`toast--${m.value}`]),onClick:V},[y(s(x),{icon:p.value,class:"toast-icon"},null,8,["icon"]),e("span",null,t(g.value),1)],2)):E("",!0)]),_:1})]))}}),Za=ie(Qa,[["__scopeId","data-v-581895ae"]]);let ue=null;const el=()=>{if(!ue){const B=Be(Za),o=document.createElement("div");document.body.appendChild(o),ue=B.mount(o)}return{success:(B,o)=>{ue==null||ue.show(B,"success",o)},error:(B,o)=>{ue==null||ue.show(B,"error",o)}}},ol={class:"custom-select"},tl=["title"],sl={key:0,class:"current-option"},nl={class:"option-name"},al={key:1,class:"current-option"},ll={class:"select-options"},il=["onClick"],cl={class:"option-name"},rl=le({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(B,{emit:o}){const a=B,g=o,m=M(!1),p=ae(()=>a.options.find(P=>P.id===a.modelValue)),d=P=>P.id===a.modelValue,v=()=>{m.value=!m.value},V=P=>{g("update:modelValue",P.id),m.value=!1};return(P,b)=>(i(),r("div",ol,[e("button",{class:"select-btn",onClick:v,title:P.placeholder},[p.value?(i(),r("span",sl,[e("span",nl,t(p.value.name),1)])):(i(),r("span",al,t(P.placeholder),1)),y(s(x),{icon:m.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,tl),y(_e,{name:"slideDown"},{default:X(()=>[I(e("div",{class:"select-dropdown",onClick:b[0]||(b[0]=he(()=>{},["stop"]))},[e("div",ll,[(i(!0),r(H,null,Y(P.options,S=>(i(),r("button",{key:S.id,class:W(["select-option",{active:d(S)}]),onClick:L=>V(S)},[e("span",cl,t(S.name),1),d(S)?(i(),ee(s(x),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):E("",!0)],10,il))),128))])],512),[[Ae,m.value]])]),_:1}),m.value?(i(),r("div",{key:0,class:"backdrop",onClick:b[1]||(b[1]=S=>m.value=!1)})):E("",!0)]))}}),we=ie(rl,[["__scopeId","data-v-4c6d676f"]]),dl={class:"config-panel"},ul={class:"panel-header"},pl={class:"prompt-layout"},fl={class:"prompt-list"},gl={class:"list-header"},ml={class:"prompt-count"},vl={key:0,class:"prompts-container"},hl=["onClick"],yl={class:"prompt-card-header"},_l={class:"prompt-name"},bl={key:0,class:"prompt-desc"},Cl={class:"tags"},$l={class:"tag"},wl={key:1,class:"loading-state"},kl={key:2,class:"empty-state"},Sl={key:0,class:"prompt-detail"},Tl={class:"detail-header"},Vl={class:"detail-actions"},Al={class:"form-item"},xl=["placeholder"],Pl={class:"form-item"},Ul={class:"form-item"},El={class:"form-item"},Ml=["placeholder"],Nl={class:"form-item"},Dl=["placeholder"],Ll={key:1,class:"no-selection"},Rl={class:"modal-form"},Fl={class:"form-item"},Bl=["placeholder"],Il={class:"form-item"},ql={class:"form-item"},Ol={class:"form-item"},Gl=["placeholder"],jl={class:"form-item"},Kl=["placeholder"],Jl={class:"delete-confirm"},zl={class:"warning-text"},Hl=le({__name:"dynamicPromptConfig",setup(B){const{t:o}=ye(),{success:a,error:g}=el(),m=M(!1),p=ne([]),d=M(null),v=M(!1),V=M(!1),P=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],b=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],S={promptName:"",messageType:"",type:"",promptDescription:""},L=ne({...S}),Q=async()=>{m.value=!0;try{const l=await ve.getAllPrompts();l.length>0&&await oe(l[0]),p.splice(0,p.length,...l)}catch(l){console.error("加载数据失败:",l),g(o("config.promptConfig.loadDataFailed")+": "+l.message)}finally{m.value=!1}},oe=async l=>{try{const n=await ve.getPromptById(l.id);d.value={...n}}catch(n){console.error("加载Prompt详情失败:",n),g(o("config.promptConfig.loadDetailsFailed")+": "+n.message),d.value={...l}}},q=async()=>{if(Z(L))try{const l={...L,builtIn:!1},n=await ve.createPrompt(l);p.push(n),d.value=n,v.value=!1,a(o("config.promptConfig.createSuccess"))}catch(l){g(o("config.promptConfig.createFailed")+": "+l.message)}},C=async()=>{if(d.value&&Z(d.value))try{const l=await ve.updatePrompt(d.value.id,d.value),n=p.findIndex(c=>c.id===l.id);n!==-1&&(p[n]=l),d.value={...l},a(o("config.promptConfig.saveSuccess"))}catch(l){g(o("config.promptConfig.saveFailed")+": "+l.message)}},O=async()=>{if(d.value)try{await ve.deletePrompt(d.value.id);const l=p.findIndex(n=>n.id===d.value.id);l!==-1&&p.splice(l,1),d.value=p.length>0?p[0]:null,V.value=!1,a(o("config.promptConfig.deleteSuccess"))}catch(l){g(o("config.promptConfig.deleteFailed")+": "+l.message)}};function Z(l){const n=["promptName","messageType","type","promptContent"];for(const R of n){const D=l[R];if(D==null||typeof D=="string"&&D.trim()==="")return g(`${R} is required and cannot be empty`),!1}return!!K(p,l)}function K(l,n){const c=l.find(R=>R.promptName===n.promptName);return c&&n.id&&c.id!==n.id?(g(`Name "${n.promptName}" already exists. Please use a different name.`),!1):c&&!n.id?(g(`Name "${n.promptName}" already exists. Please use a different name.`),!1):!0}const re=()=>{L.promptName="",L.promptDescription="",L.promptContent="",Object.assign(L,S),v.value=!0},U=()=>{V.value=!0};return Ce(()=>{Q()}),(l,n)=>(i(),r("div",dl,[e("div",ul,[e("h2",null,t(s(o)("config.promptConfig.title")),1)]),e("div",pl,[e("div",fl,[e("div",gl,[e("h3",null,t(s(o)("config.promptConfig.configuredprompts")),1),e("span",ml,"("+t(p.length)+t(s(o)("config.promptConfig.promptCount"))+")",1)]),m.value?E("",!0):(i(),r("div",vl,[(i(!0),r(H,null,Y(p,c=>{var R,D;return i(),r("div",{key:c.id,class:W(["prompt-card",{active:((R=d.value)==null?void 0:R.id)===c.id}]),onClick:J=>oe(c)},[e("div",yl,[e("span",_l,t(c.promptName),1),y(s(x),{icon:"carbon:chevron-right"})]),(D=c.promptDescription)!=null&&D.trim()?(i(),r("p",bl,t(c.promptDescription),1)):E("",!0),e("div",Cl,[e("span",$l,t(c.builtIn?s(o)("config.promptConfig.builtIn"):s(o)("config.promptConfig.custom")),1)])],10,hl)}),128))])),m.value?(i(),r("div",wl,[y(s(x),{icon:"carbon:loading",class:"loading-icon"}),w(" "+t(s(o)("common.loading")),1)])):E("",!0),!m.value&&p.length===0?(i(),r("div",kl,[y(s(x),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,t(s(o)("config.promptConfig.noPrompts")),1)])):E("",!0),e("button",{class:"add-btn",onClick:re},[y(s(x),{icon:"carbon:add"}),w(" "+t(s(o)("config.promptConfig.createNew")),1)])]),d.value?(i(),r("div",Sl,[e("div",Tl,[e("h3",null,t(d.value.promptName),1),e("div",Vl,[e("button",{class:"action-btn primary",onClick:C},[y(s(x),{icon:"carbon:save"}),w(" "+t(s(o)("common.save")),1)]),d.value.builtIn?E("",!0):(i(),r("button",{key:0,class:"action-btn danger",onClick:U},[y(s(x),{icon:"carbon:trash-can"}),w(" "+t(s(o)("common.delete")),1)]))])]),e("div",Al,[e("label",null,[w(t(s(o)("config.promptConfig.promptName"))+" ",1),n[15]||(n[15]=e("span",{class:"required"},"*",-1))]),I(e("input",{disabled:!0,type:"text","onUpdate:modelValue":n[0]||(n[0]=c=>d.value.promptName=c),placeholder:s(o)("config.promptConfig.placeholder"),required:""},null,8,xl),[[j,d.value.promptName]])]),e("div",Pl,[e("label",null,[w(t(s(o)("config.promptConfig.messageType"))+" ",1),n[16]||(n[16]=e("span",{class:"required"},"*",-1))]),d.value.builtIn?I((i(),r("input",{key:1,type:"text","onUpdate:modelValue":n[2]||(n[2]=c=>d.value.messageType=c),disabled:!0},null,512)),[[j,d.value.messageType]]):(i(),ee(we,{key:0,modelValue:d.value.messageType,"onUpdate:modelValue":n[1]||(n[1]=c=>d.value.messageType=c),options:P,disabled:d.value.builtIn,placeholder:s(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Ul,[e("label",null,[w(t(s(o)("config.promptConfig.type"))+" ",1),n[17]||(n[17]=e("span",{class:"required"},"*",-1))]),d.value.builtIn?I((i(),r("input",{key:1,type:"text","onUpdate:modelValue":n[4]||(n[4]=c=>d.value.type=c),disabled:!0,required:""},null,512)),[[j,d.value.type]]):(i(),ee(we,{key:0,modelValue:d.value.type,"onUpdate:modelValue":n[3]||(n[3]=c=>d.value.type=c),options:b,disabled:d.value.builtIn,placeholder:s(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",El,[e("label",null,t(s(o)("config.promptConfig.description")),1),I(e("textarea",{"onUpdate:modelValue":n[5]||(n[5]=c=>d.value.promptDescription=c),rows:"2",placeholder:s(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Ml),[[j,d.value.promptDescription]])]),e("div",Nl,[e("label",null,[w(t(s(o)("config.promptConfig.promptContent"))+" ",1),n[18]||(n[18]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":n[6]||(n[6]=c=>d.value.promptContent=c),rows:"8",placeholder:s(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Dl),[[j,d.value.promptContent]])])])):(i(),r("div",Ll,[y(s(x),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,t(s(o)("config.promptConfig.selectPromptHint")),1)]))]),y(fe,{modelValue:v.value,"onUpdate:modelValue":n[12]||(n[12]=c=>v.value=c),title:s(o)("config.promptConfig.newPrompt"),onConfirm:q},{default:X(()=>[e("div",Rl,[e("div",Fl,[e("label",null,[w(t(s(o)("config.promptConfig.promptName"))+" ",1),n[19]||(n[19]=e("span",{class:"required"},"*",-1))]),I(e("input",{type:"text","onUpdate:modelValue":n[7]||(n[7]=c=>L.promptName=c),placeholder:s(o)("config.promptConfig.placeholder"),required:""},null,8,Bl),[[j,L.promptName]])]),e("div",Il,[e("label",null,[w(t(s(o)("config.promptConfig.messageType"))+" ",1),n[20]||(n[20]=e("span",{class:"required"},"*",-1))]),y(we,{modelValue:L.messageType,"onUpdate:modelValue":n[8]||(n[8]=c=>L.messageType=c),options:P,placeholder:s(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",ql,[e("label",null,[w(t(s(o)("config.promptConfig.type"))+" ",1),n[21]||(n[21]=e("span",{class:"required"},"*",-1))]),y(we,{modelValue:L.type,"onUpdate:modelValue":n[9]||(n[9]=c=>L.type=c),options:b,placeholder:s(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Ol,[e("label",null,t(s(o)("config.promptConfig.description")),1),I(e("textarea",{"onUpdate:modelValue":n[10]||(n[10]=c=>L.promptDescription=c),rows:"3",placeholder:s(o)("config.promptConfig.descriptionPlaceholder")},null,8,Gl),[[j,L.promptDescription]])]),e("div",jl,[e("label",null,[w(t(s(o)("config.promptConfig.promptContent"))+" ",1),n[22]||(n[22]=e("span",{class:"required"},"*",-1))]),I(e("textarea",{"onUpdate:modelValue":n[11]||(n[11]=c=>L.promptContent=c),rows:"8",placeholder:s(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Kl),[[j,L.promptContent]])])])]),_:1},8,["modelValue","title"]),y(fe,{modelValue:V.value,"onUpdate:modelValue":n[14]||(n[14]=c=>V.value=c),title:s(o)("config.promptConfig.deleteConfirm")},{footer:X(()=>[e("button",{class:"cancel-btn",onClick:n[13]||(n[13]=c=>V.value=!1)},t(s(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:O},t(s(o)("common.delete")),1)]),default:X(()=>{var c;return[e("div",Jl,[y(s(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(t(s(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,t((c=d.value)==null?void 0:c.promptName),1),w(" "+t(s(o)("common.confirm"))+"？ ",1)]),e("p",zl,t(s(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]))}}),Yl=ie(Hl,[["__scopeId","data-v-8426fa4c"]]),Xl={class:"config-container"},Wl={class:"config-header"},Ql={class:"header-actions"},Zl={class:"config-content"},ei={class:"config-nav"},oi=["onClick"],ti={class:"config-details"},si=le({__name:"index",setup(B){const{t:o}=ye(),a=Ie(),g=qe(),m=M(a.params.category||"basic"),p=ae(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"}]),d=v=>{m.value=v,g.push({name:a.name,params:{...a.params,category:v},query:a.query})};return(v,V)=>(i(),r("div",Xl,[e("div",Wl,[e("div",Ql,[e("button",{class:"action-btn",onClick:V[0]||(V[0]=P=>v.$router.push("/"))},[y(s(x),{icon:"carbon:arrow-left"}),w(" "+t(v.$t("backHome")),1)]),y(Oe)])]),e("div",Zl,[e("nav",ei,[(i(!0),r(H,null,Y(p.value,(P,b)=>(i(),r("div",{key:b,class:W(["nav-item",{active:m.value===P.key}]),onClick:S=>d(P.key)},[y(s(x),{icon:P.icon,width:"20"},null,8,["icon"]),e("span",null,t(P.label),1)],10,oi))),128))]),e("div",ti,[m.value==="basic"?(i(),ee(yt,{key:0})):E("",!0),m.value==="agent"?(i(),ee(Qs,{key:1})):E("",!0),m.value==="model"?(i(),ee(Zn,{key:2})):E("",!0),m.value==="mcp"?(i(),ee(Wa,{key:3})):E("",!0),m.value==="prompt"?(i(),ee(Yl,{key:4})):E("",!0)])])]))}}),ci=ie(si,[["__scopeId","data-v-ea3bfe45"]]);export{ci as default};
