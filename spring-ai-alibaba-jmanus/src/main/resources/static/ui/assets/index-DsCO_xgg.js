var Le=Object.defineProperty;var Be=(B,o,n)=>o in B?Le(B,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):B[o]=n;var ge=(B,o,n)=>Be(B,typeof o!="symbol"?o+"":o,n);import{d as le,c as u,o as d,e,t as s,f as fe,r as M,s as oe,g as ne,h as _e,i as y,b as D,p as $,w as O,v as J,F as H,j as Y,m as ee,B as xe,a as ae,y as G,T as $e,G as Ce,A as Ie,u as t,q as ye,z as Ve,H as qe,l as Oe,D as Ge,n as je,I as Ae,J as Ke,C as Je,K as ze,k as He}from"./index-Chm8hIxO.js";import{_ as ie,I as V}from"./_plugin-vue_export-helper-BQTCB3nq.js";import{u as Me}from"./useToast-B_3dgMnd.js";import{L as Ye}from"./index-C6TSaCcs.js";const We={class:"switch"},Xe=["checked"],Qe={class:"switch-label"},Ze=le({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(B,{emit:o}){const n=o,p=v=>{const m=v.target.checked;n("update:switchValue",m)};return(v,m)=>(d(),u("label",We,[e("input",{type:"checkbox",checked:v.enabled,onChange:p},null,40,Xe),m[0]||(m[0]=e("span",{class:"slider"},null,-1)),e("span",Qe,s(v.label),1)]))}}),eo=ie(Ze,[["__scopeId","data-v-d484b4a3"]]);class be{static async getConfigsByGroup(o){try{const n=await fetch(`${this.BASE_URL}/group/${o}`);if(!n.ok)throw new Error(`Failed to get ${o} group configuration: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get ${o} group configuration:`,n),n}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const n=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Batch update configuration failed: ${n.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(n){return console.error("Batch update configuration failed:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}static async getConfigById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);if(!n.ok)throw new Error(`Failed to get configuration item: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get configuration item[${o}]:`,n),n}}static async updateConfig(o){try{const n=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to update configuration item: ${n.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(n){return console.error("Failed to update configuration item:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}}ge(be,"BASE_URL","/api/config");const oo={class:"config-panel"},to={class:"config-header"},so={class:"header-left"},no={class:"config-stats"},ao={class:"stat-item"},lo={class:"stat-label"},io={class:"stat-value"},co={key:0,class:"stat-item"},ro={class:"stat-label"},uo={class:"stat-value modified"},po={class:"header-right"},fo={class:"import-export-actions"},go=["title"],mo=["title"],ho={class:"search-box"},vo=["placeholder"],yo={key:0,class:"loading-container"},_o={key:1,class:"config-groups"},bo={class:"group-header"},Co={class:"group-info"},$o={class:"group-icon"},wo={class:"group-actions"},ko=["onClick","disabled","title"],So={class:"sub-groups"},To=["onClick"],No={class:"sub-group-info"},Vo={class:"sub-group-title"},Ao={class:"item-count"},Uo={class:"config-items"},xo={key:0,class:"config-item-content vertical-layout"},Po={class:"config-item-info"},Eo={class:"config-item-header"},Do={class:"config-label"},Mo={class:"type-badge boolean"},Fo={key:0,class:"modified-badge"},Ro=["title"],Lo={class:"config-control"},Bo=["value","onChange"],Io=["value"],qo={key:1,class:"config-item-content vertical-layout"},Oo={class:"config-item-info"},Go={class:"config-item-header"},jo={class:"config-label"},Ko={class:"type-badge select"},Jo={key:0,class:"modified-badge"},zo=["title"],Ho={class:"config-control"},Yo=["value","onChange"],Wo=["value"],Xo={key:2,class:"config-item-content vertical-layout"},Qo={class:"config-item-info"},Zo={class:"config-item-header"},et={class:"config-label"},ot={class:"type-badge textarea"},tt={key:0,class:"modified-badge"},st=["title"],nt={class:"config-control"},at=["value","onInput"],lt={key:3,class:"config-item-content vertical-layout"},it={class:"config-item-info"},ct={class:"config-item-header"},rt={class:"config-label"},dt={class:"type-badge number"},ut={key:0,class:"modified-badge"},pt=["title"],ft={key:0,class:"config-meta"},gt={class:"range-info"},mt={class:"config-control"},ht=["value","onInput","min","max"],vt={key:4,class:"config-item-content vertical-layout"},yt={class:"config-item-info"},_t={class:"config-item-header"},bt={class:"config-label"},Ct={class:"type-badge string"},$t={key:0,class:"modified-badge"},wt=["title"],kt={class:"config-control"},St=["value","onInput"],Tt={key:2,class:"empty-state"},Nt=le({__name:"basicConfig",setup(B){const{t:o}=fe(),n=M(!0),p=M(!1),v=M([]),m=M(new Map),h=M(new Set),r=oe({show:!1,text:"",type:"success"}),k=M(""),A={headless:"config.basicConfig.browserSettings.headless",requestTimeout:"config.basicConfig.browserSettings.requestTimeout",debugDetail:"config.basicConfig.general.debugDetail",baseDir:"config.basicConfig.general.baseDir",openBrowser:"config.basicConfig.interactionSettings.openBrowser",maxSteps:"config.basicConfig.agentSettings.maxSteps",userInputTimeout:"config.basicConfig.agentSettings.userInputTimeout",maxMemory:"config.basicConfig.agentSettings.maxMemory",parallelToolCalls:"config.basicConfig.agentSettings.parallelToolCalls",forceOverrideFromYaml:"config.basicConfig.agents.forceOverrideFromYaml",enabled:"config.basicConfig.infiniteContext.enabled",parallelThreads:"config.basicConfig.infiniteContext.parallelThreads",taskContextSize:"config.basicConfig.infiniteContext.taskContextSize",allowExternalAccess:"config.basicConfig.fileSystem.allowExternalAccess"},C={manus:"config.basicConfig.groupDisplayNames.manus"},T={manus:"ðŸ¤–",browser:"ðŸŒ",interaction:"ðŸ–¥ï¸",system:"âš™ï¸",performance:"âš¡"},j={agent:"config.subGroupDisplayNames.agent",browser:"config.subGroupDisplayNames.browser",interaction:"config.subGroupDisplayNames.interaction",agents:"config.subGroupDisplayNames.agents",infiniteContext:"config.subGroupDisplayNames.infiniteContext",general:"config.subGroupDisplayNames.general",filesystem:"config.subGroupDisplayNames.filesystem"},F=ne(()=>v.value.some(l=>l.subGroups.some(w=>w.items.some(N=>m.value.get(N.id)!==N.configValue)))),W=l=>l==="true",I=l=>parseFloat(l)||0,U=l=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[l]||1,E=l=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[l]||1e4,X=l=>typeof l=="string"?l:l.value,te=l=>typeof l=="string"?l:l.label,x=(l,w)=>{if(typeof w=="boolean")return w.toString();if(typeof w=="string"){if(l.options&&l.options.length>0){const N=l.options.find(S=>(typeof S=="string"?S:S.label)===w||(typeof S=="string"?S:S.value)===w);if(N)return typeof N=="string"?N:N.value}return w}return String(w)},g=(l,w,N=!1)=>{let S;l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"?S=x(l,w):S=String(w),l.configValue!==S&&(l.configValue=S,l._modified=!0,(N||l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"||l.inputType==="SELECT")&&a())};let i=null;const a=()=>{i&&clearTimeout(i),i=window.setTimeout(()=>{R()},500)},c=(l,w="success")=>{r.text=l,r.type=w,r.show=!0,setTimeout(()=>{r.show=!1},3e3)},_=async()=>{try{n.value=!0;const w=["manus"].map(async S=>{try{const f=await be.getConfigsByGroup(S);if(f.length===0)return null;const L=f.map(Z=>({...Z,displayName:A[Z.configKey]||Z.configKey,min:U(Z.configKey),max:E(Z.configKey)}));L.forEach(Z=>{m.value.set(Z.id,Z.configValue)});const q=new Map;L.forEach(Z=>{const ce=Z.configSubGroup??"general";q.has(ce)||q.set(ce,[]),q.get(ce).push(Z)});const Q=Array.from(q.entries()).map(([Z,ce])=>({name:Z,displayName:j[Z]||Z,items:ce}));return{name:S,displayName:C[S]||S,subGroups:Q}}catch(f){return console.warn(`åŠ è½½é…ç½®ç»„ ${S} å¤±è´¥ï¼Œè·³è¿‡:`,f),null}}),N=await Promise.all(w);v.value=N.filter(S=>S!==null),console.log(o("config.basicConfig.loadConfigSuccess"),v.value)}catch(l){console.error(o("config.basicConfig.loadConfigFailed"),l),c(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},R=async()=>{if(!(p.value||!F.value))try{p.value=!0;const l=[];if(v.value.forEach(N=>{N.subGroups.forEach(S=>{const f=S.items.filter(L=>L._modified);l.push(...f)})}),l.length===0){c(o("config.basicConfig.noModified"));return}const w=await be.batchUpdateConfigs(l);w.success?(l.forEach(N=>{m.value.set(N.id,N.configValue),N._modified=!1}),c(o("config.basicConfig.saveSuccess"))):c(w.message||o("config.basicConfig.saveFailed"),"error")}catch(l){console.error(o("config.basicConfig.saveFailed"),l),c(o("config.basicConfig.saveFailed"),"error")}finally{p.value=!1}},z=async l=>{if(confirm(o("config.basicConfig.resetGroupConfirm",C[l]||l)))try{p.value=!0;const N=v.value.find(L=>L.name===l);if(!N)return;const S=[];if(N.subGroups.forEach(L=>{L.items.forEach(q=>{const Q=se(q.configKey);Q!==q.configValue&&S.push({...q,configValue:Q})})}),S.length===0){c(o("config.basicConfig.isDefault"));return}const f=await be.batchUpdateConfigs(S);f.success?(await _(),c(o("config.basicConfig.resetSuccess",S.length))):c(f.message||o("config.basicConfig.resetFailed"),"error")}catch(N){console.error(o("config.basicConfig.resetFailed"),N),c(o("config.basicConfig.resetFailed"),"error")}finally{p.value=!1}},se=l=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[l]||"",we=(l,w)=>{const N=`${l}-${w}`;h.value.has(N)?h.value.delete(N):h.value.add(N)},me=(l,w)=>h.value.has(`${l}-${w}`),ue=ne(()=>{const l=v.value.reduce((N,S)=>N+S.subGroups.reduce((f,L)=>f+L.items.length,0),0),w=v.value.reduce((N,S)=>N+S.subGroups.reduce((f,L)=>f+L.items.filter(q=>m.value.get(q.id)!==q.configValue).length,0),0);return{total:l,modified:w}}),P=ne(()=>{if(!k.value.trim())return v.value;const l=k.value.toLowerCase();return v.value.map(w=>({...w,subGroups:w.subGroups.map(N=>({...N,items:N.items.filter(S=>S.displayName.toLowerCase().includes(l)||S.configKey.toLowerCase().includes(l)||S.description&&S.description.toLowerCase().includes(l))})).filter(N=>N.items.length>0)})).filter(w=>w.subGroups.length>0)}),b=()=>{try{const l={timestamp:new Date().toISOString(),version:"1.0",configs:v.value.reduce((f,L)=>(L.subGroups.forEach(q=>{q.items.forEach(Q=>{f[Q.configKey]=Q.configValue})}),f),{})},w=JSON.stringify(l,null,2),N=new Blob([w],{type:"application/json"}),S=document.createElement("a");S.href=URL.createObjectURL(N),S.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,S.click(),c(o("config.basicConfig.exportSuccess"))}catch(l){console.error(o("config.basicConfig.exportFailed"),l),c(o("config.basicConfig.exportFailed"),"error")}},K=l=>{var f;const w=l.target,N=(f=w.files)==null?void 0:f[0];if(!N)return;const S=new FileReader;S.onload=async L=>{var q;try{const Q=JSON.parse((q=L.target)==null?void 0:q.result);if(!Q.configs)throw new Error(o("config.basicConfig.invalidFormat"));if(!confirm(o("config.importConfirm")))return;p.value=!0;const ce=[];if(v.value.forEach(Fe=>{Fe.subGroups.forEach(Re=>{Re.items.forEach(Ne=>{Object.prototype.hasOwnProperty.call(Q.configs,Ne.configKey)&&ce.push({...Ne,configValue:Q.configs[Ne.configKey]})})})}),ce.length===0){c(o("config.basicConfig.notFound"));return}const Ee=await be.batchUpdateConfigs(ce);Ee.success?(await _(),c(o("config.basicConfig.importSuccess"))):c(Ee.message||o("config.basicConfig.importFailed"),"error")}catch(Q){console.error(o("config.basicConfig.importFailed"),Q),c(o("config.basicConfig.importFailed"),"error")}finally{p.value=!1,w.value=""}},S.readAsText(N)};return _e(()=>{_()}),(l,w)=>(d(),u("div",oo,[e("div",to,[e("div",so,[e("h2",null,s(l.$t("config.basicConfig.title")),1),e("div",no,[e("span",ao,[e("span",lo,s(l.$t("config.basicConfig.totalConfigs"))+":",1),e("span",io,s(ue.value.total),1)]),ue.value.modified>0?(d(),u("span",co,[e("span",ro,s(l.$t("config.basicConfig.modified"))+":",1),e("span",uo,s(ue.value.modified),1)])):D("",!0)])]),e("div",po,[e("div",fo,[e("button",{onClick:b,class:"action-btn",title:l.$t("config.basicConfig.exportConfigs")}," ðŸ“¤ ",8,go),e("label",{class:"action-btn",title:l.$t("config.basicConfig.importConfigs")},[w[1]||(w[1]=$(" ðŸ“¥ ")),e("input",{type:"file",accept:".json",onChange:K,style:{display:"none"}},null,32)],8,mo)]),e("div",ho,[O(e("input",{"onUpdate:modelValue":w[0]||(w[0]=N=>k.value=N),type:"text",placeholder:l.$t("config.search"),class:"search-input"},null,8,vo),[[J,k.value]]),w[2]||(w[2]=e("span",{class:"search-icon"},"ðŸ”",-1))])])]),n.value?(d(),u("div",yo,[w[3]||(w[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(l.$t("config.loading")),1)])):P.value.length>0?(d(),u("div",_o,[(d(!0),u(H,null,Y(P.value,N=>(d(),u("div",{key:N.name,class:"config-group"},[e("div",bo,[e("div",Co,[e("span",$o,s(T[N.name]||"âš™ï¸"),1)]),e("div",wo,[e("button",{onClick:S=>z(N.name),class:"reset-btn",disabled:p.value,title:l.$t("config.resetGroupConfirm")},s(l.$t("config.reset")),9,ko)]),w[4]||(w[4]=e("div",{class:"group-divider"},null,-1))]),e("div",So,[(d(!0),u(H,null,Y(N.subGroups,S=>(d(),u("div",{key:S.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:f=>we(N.name,S.name)},[e("div",No,[w[5]||(w[5]=e("span",{class:"sub-group-icon"},"ðŸ“",-1)),e("h4",Vo,s(l.$t(S.displayName)),1),e("span",Ao,"("+s(S.items.length)+")",1)]),e("span",{class:ee(["collapse-icon",{collapsed:me(N.name,S.name)}])}," â–¼ ",2)],8,To),O(e("div",Uo,[(d(!0),u(H,null,Y(S.items,f=>(d(),u("div",{key:f.id,class:ee(["config-item",{modified:m.value.get(f.id)!==f.configValue}])},[f.inputType==="BOOLEAN"||f.inputType==="CHECKBOX"?(d(),u("div",xo,[e("div",Po,[e("div",Eo,[e("label",Do,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",Mo,s(f.inputType==="CHECKBOX"?l.$t("config.types.checkbox"):l.$t("config.types.boolean")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Fo,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,Ro)])]),e("div",Lo,[f.options&&f.options.length>0?(d(),u("select",{key:0,class:"config-input select-input",value:f.configValue,onChange:L=>{var q;return g(f,((q=L.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options,L=>(d(),u("option",{key:X(L),value:X(L)},s(te(L)),9,Io))),128))],40,Bo)):(d(),ae(eo,{key:1,enabled:W(f.configValue),label:"","onUpdate:switchValue":L=>g(f,L)},null,8,["enabled","onUpdate:switchValue"]))])])):f.inputType==="SELECT"?(d(),u("div",qo,[e("div",Oo,[e("div",Go,[e("label",jo,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",Ko,s(l.$t("config.types.select")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Jo,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,zo)])]),e("div",Ho,[e("select",{class:"config-input select-input",value:f.configValue,onChange:L=>{var q;return g(f,((q=L.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options||[],L=>(d(),u("option",{key:X(L),value:X(L)},s(te(L)),9,Wo))),128))],40,Yo)])])):f.inputType==="TEXTAREA"?(d(),u("div",Xo,[e("div",Qo,[e("div",Zo,[e("label",et,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",ot,s(l.$t("config.types.textarea")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",tt,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,st)])]),e("div",nt,[e("textarea",{class:"config-input textarea-input",value:f.configValue,onInput:L=>{var q;return g(f,((q=L.target)==null?void 0:q.value)||"")},onBlur:a,rows:"3"},null,40,at)])])):f.inputType==="NUMBER"?(d(),u("div",lt,[e("div",it,[e("div",ct,[e("label",rt,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",dt,s(l.$t("config.types.number")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",ut,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,pt),f.min||f.max?(d(),u("div",ft,[e("span",gt,s(l.$t("config.range"))+": "+s(f.min||0)+" - "+s(f.max||"âˆž"),1)])):D("",!0)])]),e("div",mt,[e("input",{type:"number",class:"config-input number-input",value:I(f.configValue),onInput:L=>{var q;return g(f,((q=L.target)==null?void 0:q.value)||"")},onBlur:a,min:f.min||1,max:f.max||1e4},null,40,ht)])])):(d(),u("div",vt,[e("div",yt,[e("div",_t,[e("label",bt,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",Ct,s(f.inputType==="TEXT"?l.$t("config.types.text"):l.$t("config.types.string")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",$t,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,wt)])]),e("div",kt,[e("input",{type:"text",class:"config-input text-input",value:f.configValue,onInput:L=>{var q;return g(f,((q=L.target)==null?void 0:q.value)||"")},onBlur:a},null,40,St)])]))],2))),128))],512),[[xe,!me(N.name,S.name)]])]))),128))])]))),128))])):(d(),u("div",Tt,[e("p",null,s(l.$t("config.notFound")),1)])),y($e,{name:"message-fade"},{default:G(()=>[r.show?(d(),u("div",{key:0,class:ee(["message-toast",r.type])},s(r.text),3)):D("",!0)]),_:1})]))}}),De=ie(Nt,[["__scopeId","data-v-bb27f059"]]),Vt={},At={class:"config-config"},Ut={class:"panel-header"},xt={class:"panel-actions"};function Pt(B,o){return d(),u("div",At,[e("div",Ut,[Ce(B.$slots,"title",{},void 0),e("div",xt,[Ce(B.$slots,"actions",{},void 0)])]),Ce(B.$slots,"default",{},void 0)])}const Te=ie(Vt,[["render",Pt],["__scopeId","data-v-c91688e7"]]),Et={class:"modal-header"},Dt={class:"modal-content"},Mt={class:"modal-footer"},Ft=le({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(B){const o=n=>{n.target===n.currentTarget&&(n.stopPropagation(),n.preventDefault())};return(n,p)=>(d(),ae(Ie,{to:"body"},[y($e,{name:"modal"},{default:G(()=>[B.modelValue?(d(),u("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:p[3]||(p[3]=ye(()=>{},["stop"]))},[e("div",Et,[e("h3",null,s(B.title),1),e("button",{class:"close-btn",onClick:p[0]||(p[0]=v=>n.$emit("update:modelValue",!1))},[y(t(V),{icon:"carbon:close"})])]),e("div",Dt,[Ce(n.$slots,"default",{},void 0,!0)]),e("div",Mt,[Ce(n.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:p[1]||(p[1]=v=>n.$emit("update:modelValue",!1))},s(n.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:p[2]||(p[2]=v=>n.$emit("confirm"))},s(n.$t("common.confirm")),1)],!0)])])])):D("",!0)]),_:3})]))}}),de=ie(Ft,[["__scopeId","data-v-baaf1c89"]]),Rt={class:"tool-selection-content"},Lt={class:"tool-controls"},Bt={class:"search-container"},It={class:"sort-container"},qt={class:"tool-summary"},Ot={class:"summary-text"},Gt={key:0,class:"tool-groups"},jt=["onClick"],Kt={class:"group-title-area"},Jt={class:"group-name"},zt={class:"group-count"},Ht={class:"group-enable-all"},Yt=["checked","onChange","data-group"],Wt={class:"tool-info"},Xt={class:"tool-selection-name"},Qt={key:0,class:"tool-selection-desc"},Zt={class:"tool-actions"},es=["checked","onChange"],os={key:1,class:"empty-state"},ts=le({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(B,{emit:o}){const n=B,p=o,v=ne({get:()=>n.modelValue,set:i=>p("update:modelValue",i)}),m=M(""),h=M("group"),r=M(new Set),k=M([]),A=(i,a)=>{const c=document.querySelector(`input[data-group="${i}"]`);c&&(c.indeterminate=E(a))};Ve(()=>n.selectedToolIds,i=>{k.value=[...i]},{immediate:!0});const C=ne(()=>{let i=n.tools.filter(a=>a.key);if(m.value){const a=m.value.toLowerCase();i=i.filter(c=>{var _;return c.name.toLowerCase().includes(a)||c.description.toLowerCase().includes(a)||(((_=c.serviceGroup)==null?void 0:_.toLowerCase().includes(a))??!1)})}switch(h.value){case"name":i=[...i].sort((a,c)=>a.name.localeCompare(c.name));break;case"enabled":i=[...i].sort((a,c)=>{const _=k.value.includes(a.key),R=k.value.includes(c.key);return _&&!R?-1:!_&&R?1:a.name.localeCompare(c.name)});break;case"group":default:i=[...i].sort((a,c)=>{const _=a.serviceGroup??"æœªåˆ†ç»„",R=c.serviceGroup??"æœªåˆ†ç»„";return _!==R?_.localeCompare(R):a.name.localeCompare(c.name)});break}return i}),T=ne(()=>{const i=new Map;return C.value.forEach(a=>{const c=a.serviceGroup??"æœªåˆ†ç»„";i.has(c)||i.set(c,[]),i.get(c).push(a)}),new Map([...i.entries()].sort())}),j=ne(()=>C.value.length);Ve([k,T],()=>{Oe(()=>{for(const[i,a]of T.value)A(i,a)})},{flush:"post",deep:!1});const F=i=>k.value.includes(i),W=(i,a)=>{a.stopPropagation();const _=a.target.checked;if(!i){console.error("toolKey is undefined, cannot proceed");return}_?k.value.includes(i)||(k.value=[...k.value,i]):k.value=k.value.filter(R=>R!==i)},I=i=>i.filter(a=>k.value.includes(a.key)),U=i=>i.length>0&&i.every(a=>k.value.includes(a.key)),E=i=>{const a=I(i).length;return a>0&&a<i.length},X=(i,a)=>{a.stopPropagation();const _=a.target.checked,R=i.map(z=>z.key);if(_){const z=[...k.value];R.forEach(se=>{z.includes(se)||z.push(se)}),k.value=z}else k.value=k.value.filter(z=>!R.includes(z))},te=i=>{r.value.has(i)?r.value.delete(i):r.value.add(i)},x=()=>{p("confirm",[...k.value]),p("update:modelValue",!1)},g=()=>{k.value=[...n.selectedToolIds],p("update:modelValue",!1)};return Ve(v,i=>{if(i){r.value.clear();const a=Array.from(T.value.keys());a.length>1&&a.slice(1).forEach(c=>{r.value.add(c)})}}),(i,a)=>(d(),ae(de,{modelValue:v.value,"onUpdate:modelValue":[a[4]||(a[4]=c=>v.value=c),g],title:"é€‰æ‹©å·¥å…·",onConfirm:x},{default:G(()=>[e("div",Rt,[e("div",Lt,[e("div",Bt,[O(e("input",{"onUpdate:modelValue":a[0]||(a[0]=c=>m.value=c),type:"text",class:"search-input",placeholder:"æœç´¢å·¥å…·..."},null,512),[[J,m.value]])]),e("div",It,[O(e("select",{"onUpdate:modelValue":a[1]||(a[1]=c=>h.value=c),class:"sort-select"},a[5]||(a[5]=[e("option",{value:"group"},"æŒ‰æœåŠ¡ç»„æŽ’åº",-1),e("option",{value:"name"},"æŒ‰åç§°æŽ’åº",-1),e("option",{value:"enabled"},"æŒ‰å¯ç”¨çŠ¶æ€æŽ’åº",-1)]),512),[[qe,h.value]])])]),e("div",qt,[e("span",Ot," å…± "+s(T.value.size)+" ä¸ªæœåŠ¡ç»„ï¼Œ"+s(j.value)+" ä¸ªå·¥å…· (å·²é€‰æ‹© "+s(k.value.length)+" ä¸ª) ",1)]),T.value.size>0?(d(),u("div",Gt,[(d(!0),u(H,null,Y(T.value,([c,_])=>(d(),u("div",{key:c,class:"tool-group"},[e("div",{class:ee(["tool-group-header",{collapsed:r.value.has(c)}]),onClick:R=>te(c)},[e("div",Kt,[y(t(V),{icon:r.value.has(c)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),y(t(V),{icon:"carbon:folder",class:"group-icon"}),e("span",Jt,s(c),1),e("span",zt," ("+s(I(_).length)+"/"+s(_.length)+") ",1)]),e("div",{class:"group-actions",onClick:a[2]||(a[2]=ye(()=>{},["stop"]))},[e("label",Ht,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:U(_),onChange:R=>X(_,R),"data-group":c},null,40,Yt),a[6]||(a[6]=e("span",{class:"enable-label"},"å¯ç”¨å…¨éƒ¨",-1))])])],10,jt),e("div",{class:ee(["tool-group-content",{collapsed:r.value.has(c)}])},[(d(!0),u(H,null,Y(_.filter(R=>R&&R.key),R=>(d(),u("div",{key:R.key,class:"tool-selection-item"},[e("div",Wt,[e("div",Xt,s(R.name),1),R.description?(d(),u("div",Qt,s(R.description),1)):D("",!0)]),e("div",Zt,[e("label",{class:"tool-enable-switch",onClick:a[3]||(a[3]=ye(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:F(R.key),onChange:z=>W(R.key,z)},null,40,es),a[7]||(a[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(d(),u("div",os,[y(t(V),{icon:"carbon:tools",class:"empty-icon"}),a[8]||(a[8]=e("p",null,"æ²¡æœ‰æ‰¾åˆ°å·¥å…·",-1))]))])]),_:1},8,["modelValue"]))}}),ss=ie(ts,[["__scopeId","data-v-79f6a572"]]);class pe{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}else{const n=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(n)).json()}}catch(n){throw console.error("Failed to get Agent list:",n),n}}static async getAgentById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Agent[${o}] details:`,n),n}}static async createAgent(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Agent:",n),n}}static async updateAgent(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Agent[${o}]:`,p),p}}static async deleteAgent(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Agent[${o}]:`,n),n}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}ge(pe,"BASE_URL","/api/agents");class re{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Model[${o}] details:`,n),n}}static async createModel(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Model:",n),n}}static async updateModel(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Model[${o}]:`,p),p}}static async deleteModel(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Model[${o}]:`,n),n}}}ge(re,"BASE_URL","/api/models");const Pe=Ge("namespace",()=>{const B=M("default");function o(v){B.value=v}const n=M([{name:"Default",id:"default"}]);function p(v){n.value=v}return{namespace:B,db:n,setNamespace:o,setDb:p}}),ns=["disabled"],as={class:"agent-layout"},ls={class:"agent-list"},is={class:"list-header"},cs={class:"agent-count"},rs={key:0,class:"agents-container"},ds=["onClick"],us={class:"agent-card-header"},ps={class:"agent-name"},fs={class:"agent-desc"},gs={key:0,class:"agent-model"},ms={class:"model-tag"},hs={class:"model-tag"},vs={key:1,class:"agent-tools"},ys={key:0,class:"tool-more"},_s={key:1,class:"loading-state"},bs={key:2,class:"empty-state"},Cs={key:0,class:"agent-detail"},$s={class:"detail-header"},ws={class:"detail-actions"},ks={class:"form-item"},Ss=["placeholder"],Ts={class:"form-item"},Ns=["placeholder"],Vs={class:"form-item"},As=["value","placeholder"],Us={class:"model-section"},xs={class:"form-item"},Ps={class:"model-chooser"},Es=["title"],Ds={key:0,class:"current-model"},Ms={class:"model-type"},Fs={class:"model-name"},Rs={key:1,class:"current-model"},Ls={class:"current-model"},Bs={class:"dropdown-header"},Is={class:"model-options"},qs=["onClick"],Os={class:"model-type"},Gs={class:"model-name"},js={class:"tools-section"},Ks={class:"assigned-tools"},Js={class:"section-header"},zs={class:"tools-grid"},Hs={class:"tool-info"},Ys={class:"tool-name"},Ws={class:"tool-desc"},Xs={key:0,class:"no-tools"},Qs={key:1,class:"no-selection"},Zs={class:"modal-form"},en={class:"form-item"},on=["placeholder"],tn={class:"form-item"},sn=["placeholder"],nn={class:"form-item"},an=["value","placeholder"],ln={class:"delete-confirm"},cn={class:"warning-text"},rn=le({__name:"agentConfig",setup(B){const{t:o}=fe(),n=Pe(),p=M(!1),v=M(""),m=M(""),h=oe([]),r=M(null),k=oe([]),A=M(!1),C=M(!1),T=M(!1),j=M(!1),F=M(null),W=oe([]),I=()=>{j.value=!j.value},U=P=>{F.value=P,j.value=!1},E=oe({name:"",description:"",nextStepPrompt:""}),X=P=>{const b=k.find(K=>K.key===P);return b?b.name:P},te=P=>{const b=k.find(K=>K.key===P);return b?b.description:""},x=(P,b)=>{b==="success"?(m.value=P,setTimeout(()=>{m.value=""},3e3)):(v.value=P,setTimeout(()=>{v.value=""},5e3))},g=async()=>{p.value=!0;try{const[P,b,K]=await Promise.all([pe.getAllAgents(n.namespace),pe.getAvailableTools(),re.getAllModels()]),l=P.map(w=>({...w,availableTools:w.availableTools,...K}));h.splice(0,h.length,...l),k.splice(0,k.length,...b),W.splice(0,W.length,...K),l.length>0&&await i(l[0])}catch(P){console.error("åŠ è½½æ•°æ®å¤±è´¥:",P),x(o("config.agentConfig.loadDataFailed")+": "+P.message,"error");const b=[{key:"search-web",name:"ç½‘ç»œæœç´¢",description:"åœ¨äº’è”ç½‘ä¸Šæœç´¢ä¿¡æ¯",enabled:!0,serviceGroup:"æœç´¢æœåŠ¡"},{key:"search-local",name:"æœ¬åœ°æœç´¢",description:"åœ¨æœ¬åœ°æ–‡ä»¶ä¸­æœç´¢å†…å®¹",enabled:!0,serviceGroup:"æœç´¢æœåŠ¡"},{key:"file-read",name:"è¯»å–æ–‡ä»¶",description:"è¯»å–æœ¬åœ°æˆ–è¿œç¨‹æ–‡ä»¶å†…å®¹",enabled:!0,serviceGroup:"æ–‡ä»¶æœåŠ¡"},{key:"file-write",name:"å†™å…¥æ–‡ä»¶",description:"åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶å†…å®¹",enabled:!0,serviceGroup:"æ–‡ä»¶æœåŠ¡"},{key:"file-delete",name:"åˆ é™¤æ–‡ä»¶",description:"åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶",enabled:!1,serviceGroup:"æ–‡ä»¶æœåŠ¡"},{key:"calculator",name:"è®¡ç®—å™¨",description:"æ‰§è¡Œæ•°å­¦è®¡ç®—",enabled:!0,serviceGroup:"è®¡ç®—æœåŠ¡"},{key:"code-execute",name:"ä»£ç æ‰§è¡Œ",description:"æ‰§è¡ŒPythonæˆ–JavaScriptä»£ç ",enabled:!0,serviceGroup:"è®¡ç®—æœåŠ¡"},{key:"weather",name:"å¤©æ°”æŸ¥è¯¢",description:"èŽ·å–æŒ‡å®šåœ°åŒºçš„å¤©æ°”ä¿¡æ¯",enabled:!0,serviceGroup:"ä¿¡æ¯æœåŠ¡"},{key:"currency",name:"æ±‡çŽ‡æŸ¥è¯¢",description:"æŸ¥è¯¢è´§å¸æ±‡çŽ‡ä¿¡æ¯",enabled:!0,serviceGroup:"ä¿¡æ¯æœåŠ¡"},{key:"email",name:"å‘é€é‚®ä»¶",description:"å‘é€ç”µå­é‚®ä»¶",enabled:!1,serviceGroup:"é€šä¿¡æœåŠ¡"},{key:"sms",name:"å‘é€çŸ­ä¿¡",description:"å‘é€çŸ­ä¿¡æ¶ˆæ¯",enabled:!1,serviceGroup:"é€šä¿¡æœåŠ¡"}],K=[{id:"demo-1",name:"é€šç”¨åŠ©æ‰‹",description:"ä¸€ä¸ªèƒ½å¤Ÿå¤„ç†å„ç§ä»»åŠ¡çš„æ™ºèƒ½åŠ©æ‰‹",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"æ•°æ®åˆ†æžå¸ˆ",description:"ä¸“é—¨ç”¨äºŽæ•°æ®åˆ†æžå’Œå¯è§†åŒ–çš„Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];k.splice(0,k.length,...b),h.splice(0,h.length,...K),K.length>0&&(r.value=K[0])}finally{p.value=!1}},i=async P=>{try{const b=await pe.getAgentById(P.id);r.value={...b,availableTools:b.availableTools},F.value=b.model??null}catch(b){console.error("åŠ è½½Agentè¯¦æƒ…å¤±è´¥:",b),x(o("config.agentConfig.loadDetailsFailed")+": "+b.message,"error"),r.value={...P,availableTools:P.availableTools}}},a=()=>{E.name="",E.description="",E.nextStepPrompt="",A.value=!0},c=async()=>{var P;if(!E.name.trim()||!E.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{const b={name:E.name.trim(),description:E.description.trim(),nextStepPrompt:((P=E.nextStepPrompt)==null?void 0:P.trim())??"",availableTools:[]},K=await pe.createAgent(b);h.push(K),r.value=K,A.value=!1,x(o("config.agentConfig.createSuccess"),"success")}catch(b){x(o("config.agentConfig.createFailed")+": "+b.message,"error")}},_=()=>{T.value=!0},R=P=>{r.value&&(r.value.availableTools=[...P])},z=async()=>{if(r.value){if(!r.value.name.trim()||!r.value.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{r.value.model=F.value;const P=await pe.updateAgent(r.value.id,r.value),b=h.findIndex(K=>K.id===P.id);b!==-1&&(h[b]=P),r.value=P,r.value.model=F.value,x(o("config.agentConfig.saveSuccess"),"success")}catch(P){x(o("config.agentConfig.saveFailed")+": "+P.message,"error")}}},se=()=>{C.value=!0},we=async()=>{if(r.value)try{await pe.deleteAgent(r.value.id);const P=h.findIndex(b=>b.id===r.value.id);P!==-1&&h.splice(P,1),r.value=h.length>0?h[0]:null,C.value=!1,x(o("config.agentConfig.deleteSuccess"),"success")}catch(P){x(o("config.agentConfig.deleteFailed")+": "+P.message,"error")}},me=()=>{const P=document.createElement("input");P.type="file",P.accept=".json",P.onchange=b=>{var l;const K=(l=b.target.files)==null?void 0:l[0];if(K){const w=new FileReader;w.onload=async N=>{var S;try{const f=JSON.parse((S=N.target)==null?void 0:S.result);if(!f.name||!f.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:L,...q}=f,Q=await pe.createAgent(q);h.push(Q),r.value=Q,x(o("config.agentConfig.importSuccess"),"success")}catch(f){x(o("config.agentConfig.importFailed")+": "+f.message,"error")}},w.readAsText(K)}},P.click()},ue=()=>{if(r.value)try{const P=JSON.stringify(r.value,null,2),b=new Blob([P],{type:"application/json"}),K=URL.createObjectURL(b),l=document.createElement("a");l.href=K,l.download=`agent-${r.value.name}-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(K),x(o("config.agentConfig.exportSuccess"),"success")}catch(P){x(o("config.agentConfig.exportFailed")+": "+P.message,"error")}};return _e(()=>{g()}),(P,b)=>(d(),ae(Te,null,{title:G(()=>[e("h2",null,s(t(o)("config.agentConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:me},[y(t(V),{icon:"carbon:upload"}),$(" "+s(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ue,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),$(" "+s(t(o)("config.agentConfig.export")),1)],8,ns)]),default:G(()=>{var K;return[e("div",as,[e("div",ls,[e("div",is,[e("h3",null,s(t(o)("config.agentConfig.configuredAgents")),1),e("span",cs,"("+s(h.length)+s(t(o)("config.agentConfig.agentCount"))+")",1)]),p.value?D("",!0):(d(),u("div",rs,[(d(!0),u(H,null,Y(h,l=>{var w,N;return d(),u("div",{key:l.id,class:ee(["agent-card",{active:((w=r.value)==null?void 0:w.id)===l.id}]),onClick:S=>i(l)},[e("div",us,[e("span",ps,s(l.name),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",fs,s(l.description),1),l.model?(d(),u("div",gs,[e("span",ms,s(l.model.type),1),e("span",hs,s(l.model.modelName),1)])):D("",!0),((N=l.availableTools)==null?void 0:N.length)>0?(d(),u("div",vs,[(d(!0),u(H,null,Y(l.availableTools.slice(0,3),S=>(d(),u("span",{key:S,class:"tool-tag"},s(X(S)),1))),128)),l.availableTools.length>3?(d(),u("span",ys," +"+s(l.availableTools.length-3),1)):D("",!0)])):D("",!0)],10,ds)}),128))])),p.value?(d(),u("div",_s,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!p.value&&h.length===0?(d(),u("div",bs,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.agentConfig.noAgent")),1)])):D("",!0),e("button",{class:"add-btn",onClick:a},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.agentConfig.createNew")),1)])]),r.value?(d(),u("div",Cs,[e("div",$s,[e("h3",null,s(r.value.name),1),e("div",ws,[e("button",{class:"action-btn primary",onClick:z},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:se},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",ks,[e("label",null,[$(s(t(o)("config.agentConfig.agentName"))+" ",1),b[15]||(b[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=l=>r.value.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Ss),[[J,r.value.name]])]),e("div",Ts,[e("label",null,[$(s(t(o)("config.agentConfig.description"))+" ",1),b[16]||(b[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[1]||(b[1]=l=>r.value.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,Ns),[[J,r.value.description]])]),e("div",Vs,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:r.value.nextStepPrompt||"",onInput:b[2]||(b[2]=l=>r.value.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,As)]),e("div",Us,[e("h4",null,s(t(o)("config.agentConfig.modelConfiguration")),1),e("div",xs,[e("div",Ps,[e("button",{class:"model-btn",onClick:I,title:P.$t("model.switch")},[y(t(V),{icon:"carbon:build-run",width:"18"}),F.value?(d(),u("span",Ds,[e("span",Ms,s(F.value.type),1),b[17]||(b[17]=e("span",{class:"spacer"},null,-1)),e("span",Fs,s(F.value.modelName),1)])):(d(),u("span",Rs,[e("span",Ls,s(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),y(t(V),{icon:j.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Es),j.value?(d(),u("div",{key:0,class:"model-dropdown",onClick:b[4]||(b[4]=ye(()=>{},["stop"]))},[e("div",Bs,[e("span",null,s(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:b[3]||(b[3]=l=>j.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",Is,[(d(!0),u(H,null,Y(W,l=>{var w,N;return d(),u("button",{key:l.id,class:ee(["model-option",{active:((w=F.value)==null?void 0:w.id)===l.id}]),onClick:S=>U(l)},[e("span",Os,s(l.type),1),e("span",Gs,s(l.modelName),1),((N=F.value)==null?void 0:N.id)===l.id?(d(),ae(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,qs)}),128))])])):D("",!0),j.value?(d(),u("div",{key:1,class:"backdrop",onClick:b[5]||(b[5]=l=>j.value=!1)})):D("",!0)])])]),e("div",js,[e("h4",null,s(t(o)("config.agentConfig.toolConfiguration")),1),e("div",Ks,[e("div",Js,[e("span",null,s(t(o)("config.agentConfig.assignedTools"))+" ("+s((r.value.availableTools||[]).length)+")",1),k.length>0?(d(),u("button",{key:0,class:"action-btn small",onClick:_},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.agentConfig.addRemoveTools")),1)])):D("",!0)]),e("div",zs,[(d(!0),u(H,null,Y(r.value.availableTools||[],l=>(d(),u("div",{key:l,class:"tool-item assigned"},[e("div",Hs,[e("span",Ys,s(X(l)),1),e("span",Ws,s(te(l)),1)])]))),128)),r.value.availableTools.length===0?(d(),u("div",Xs,[y(t(V),{icon:"carbon:tool-box"}),e("span",null,s(t(o)("config.agentConfig.noAssignedTools")),1)])):D("",!0)])])])])):(d(),u("div",Qs,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.agentConfig.selectAgentHint")),1)]))]),y(de,{modelValue:A.value,"onUpdate:modelValue":b[9]||(b[9]=l=>A.value=l),title:t(o)("config.agentConfig.newAgent"),onConfirm:c},{default:G(()=>[e("div",Zs,[e("div",en,[e("label",null,[$(s(t(o)("config.agentConfig.agentName"))+" ",1),b[18]||(b[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[6]||(b[6]=l=>E.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,on),[[J,E.name]])]),e("div",tn,[e("label",null,[$(s(t(o)("config.agentConfig.description"))+" ",1),b[19]||(b[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[7]||(b[7]=l=>E.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,sn),[[J,E.description]])]),e("div",nn,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:E.nextStepPrompt||"",onInput:b[8]||(b[8]=l=>E.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,an)])])]),_:1},8,["modelValue","title"]),y(ss,{modelValue:T.value,"onUpdate:modelValue":b[10]||(b[10]=l=>T.value=l),tools:k,"selected-tool-ids":((K=r.value)==null?void 0:K.availableTools)||[],onConfirm:R},null,8,["modelValue","tools","selected-tool-ids"]),y(de,{modelValue:C.value,"onUpdate:modelValue":b[12]||(b[12]=l=>C.value=l),title:t(o)("config.agentConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:b[11]||(b[11]=l=>C.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:we},s(t(o)("common.delete")),1)]),default:G(()=>{var l;return[e("div",ln,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s((l=r.value)==null?void 0:l.name),1),$(" "+s(t(o)("common.confirm"))+"ï¼Ÿ ",1)]),e("p",cn,s(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),v.value?(d(),u("div",{key:0,class:"error-toast",onClick:b[13]||(b[13]=l=>v.value="")},[y(t(V),{icon:"carbon:error"}),$(" "+s(v.value),1)])):D("",!0),m.value?(d(),u("div",{key:1,class:"success-toast",onClick:b[14]||(b[14]=l=>m.value="")},[y(t(V),{icon:"carbon:checkmark"}),$(" "+s(m.value),1)])):D("",!0)]}),_:1}))}}),dn=ie(rn,[["__scopeId","data-v-9e905dc6"]]),un={class:"custom-select"},pn=["title"],fn={key:0,class:"current-option"},gn={class:"option-name"},mn={key:1,class:"current-option"},hn={class:"dropdown-header"},vn={class:"select-options"},yn=["onClick"],_n={class:"option-name"},bn=le({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{}},emits:["update:modelValue"],setup(B,{emit:o}){const n=B,p=o,v=M(!1),m=ne(()=>n.options.find(A=>A.id===n.modelValue)),h=A=>A.id===n.modelValue,r=()=>{v.value=!v.value},k=A=>{p("update:modelValue",A.id),v.value=!1};return(A,C)=>(d(),u("div",un,[e("button",{class:"select-btn",onClick:r,title:A.placeholder},[y(t(V),{icon:n.icon||"carbon:select-01",width:"18"},null,8,["icon"]),m.value?(d(),u("span",fn,[e("span",gn,s(m.value.name),1)])):(d(),u("span",mn,s(A.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,pn),y($e,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",style:je({...A.dropStyles,...n.direction==="right"?{right:0}:{left:0}}),onClick:C[1]||(C[1]=ye(()=>{},["stop"]))},[e("div",hn,[e("span",null,s(A.dropdownTitle),1),e("button",{class:"close-btn",onClick:C[0]||(C[0]=T=>v.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",vn,[(d(!0),u(H,null,Y(A.options,T=>(d(),u("button",{key:T.id,class:ee(["select-option",{active:h(T)}]),onClick:j=>k(T)},[e("span",_n,s(T.name),1),h(T)?(d(),ae(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,yn))),128))])],4),[[xe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[2]||(C[2]=T=>v.value=!1)})):D("",!0)]))}}),Ue=ie(bn,[["__scopeId","data-v-138e90e7"]]),Cn=["disabled"],$n={class:"model-layout"},wn={class:"model-list"},kn={class:"list-header"},Sn={class:"model-count"},Tn={key:0,class:"models-container"},Nn=["onClick"],Vn={class:"model-card-header"},An={class:"model-name"},Un={class:"model-desc"},xn={key:0,class:"model-type"},Pn={class:"model-tag"},En={key:1,class:"loading-state"},Dn={key:2,class:"empty-state"},Mn={key:0,class:"model-detail"},Fn={class:"detail-header"},Rn={class:"detail-actions"},Ln={class:"form-item"},Bn={class:"form-item"},In=["placeholder"],qn={class:"form-item"},On=["placeholder"],Gn={class:"form-item"},jn=["placeholder"],Kn={class:"form-item"},Jn=["placeholder"],zn={key:1,class:"no-selection"},Hn={class:"modal-form"},Yn={class:"form-item"},Wn={class:"form-item"},Xn=["placeholder"],Qn={class:"form-item"},Zn=["placeholder"],ea={class:"form-item"},oa=["placeholder"],ta={class:"form-item"},sa=["placeholder"],na={class:"delete-confirm"},aa={class:"warning-text"},la=le({__name:"modelConfig",setup(B){const{t:o}=fe(),n=M(!1),p=M(""),v=M(""),m=oe([]),h=oe([]),r=M(null),k=M(!1),A=M(!1),C=oe({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),T=(g,i)=>{i==="success"?(v.value=g,setTimeout(()=>{v.value=""},3e3)):(p.value=g,setTimeout(()=>{p.value=""},5e3))},j=async()=>{n.value=!0;try{const[g,i]=await Promise.all([re.getAllModels(),re.getAllTypes()]),a=g.map(c=>({...c}));m.splice(0,m.length,...a),h.splice(0,h.length,...i),a.length>0&&await F(a[0])}catch(g){console.error("åŠ è½½æ•°æ®å¤±è´¥:",g),T(o("config.modelConfig.loadDataFailed")+": "+g.message,"error")}finally{n.value=!1}},F=async g=>{try{const i=await re.getModelById(g.id);r.value={...i}}catch(i){console.error("åŠ è½½Modelè¯¦æƒ…å¤±è´¥:",i),T(o("config.modelConfig.loadDetailsFailed")+": "+i.message,"error"),r.value={...g}}},W=()=>{C.baseUrl="",C.apiKey="",C.modelName="",C.modelDescription="",C.type="",k.value=!0},I=async()=>{if(!C.modelName.trim()||!C.modelDescription.trim()){T(o("config.modelConfig.requiredFields"),"error");return}try{const g={baseUrl:C.baseUrl.trim(),apiKey:C.apiKey.trim(),modelName:C.modelName.trim(),modelDescription:C.modelDescription.trim(),type:C.type.trim()},i=await re.createModel(g);m.push(i),r.value=i,k.value=!1,T(o("config.modelConfig.createSuccess"),"success")}catch(g){T(o("config.modelConfig.createFailed")+": "+g.message,"error")}},U=async()=>{if(r.value){if(!r.value.modelName.trim()||!r.value.modelDescription.trim()){T(o("config.modelConfig.requiredFields"),"error");return}try{const g=await re.updateModel(r.value.id,r.value),i=m.findIndex(a=>a.id===g.id);i!==-1&&(m[i]=g),r.value=g,T(o("config.modelConfig.saveSuccess"),"success")}catch(g){T(o("config.modelConfig.saveFailed")+": "+g.message,"error")}}},E=()=>{A.value=!0},X=async()=>{if(r.value)try{await re.deleteModel(r.value.id);const g=m.findIndex(i=>i.id===r.value.id);g!==-1&&m.splice(g,1),r.value=m.length>0?m[0]:null,A.value=!1,T(o("config.modelConfig.deleteSuccess"),"success")}catch(g){T(o("config.modelConfig.deleteFailed")+": "+g.message,"error")}},te=()=>{const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=i=>{var c;const a=(c=i.target.files)==null?void 0:c[0];if(a){const _=new FileReader;_.onload=async R=>{var z;try{const se=JSON.parse((z=R.target)==null?void 0:z.result);if(!se.modelName||!se.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:we,...me}=se,ue=await re.createModel(me);m.push(ue),r.value=ue,T(o("config.modelConfig.importSuccess"),"success")}catch(se){T(o("config.modelConfig.importFailed")+": "+se.message,"error")}},_.readAsText(a)}},g.click()},x=()=>{if(r.value)try{const g=JSON.stringify(r.value,null,2),i=new Blob([g],{type:"application/json"}),a=URL.createObjectURL(i),c=document.createElement("a");c.href=a,c.download=`model-${r.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(a),T(o("config.modelConfig.exportSuccess"),"success")}catch(g){T(o("config.modelConfig.exportFailed")+": "+g.message,"error")}};return _e(()=>{j()}),(g,i)=>(d(),ae(Te,null,{title:G(()=>[e("h2",null,s(t(o)("config.modelConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:te},[y(t(V),{icon:"carbon:upload"}),$(" "+s(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:x,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),$(" "+s(t(o)("config.modelConfig.export")),1)],8,Cn)]),default:G(()=>[e("div",$n,[e("div",wn,[e("div",kn,[e("h3",null,s(t(o)("config.modelConfig.configuredModels")),1),e("span",Sn,"("+s(m.length)+")",1)]),n.value?D("",!0):(d(),u("div",Tn,[(d(!0),u(H,null,Y(m,a=>{var c;return d(),u("div",{key:a.id,class:ee(["model-card",{active:((c=r.value)==null?void 0:c.id)===a.id}]),onClick:_=>F(a)},[e("div",Vn,[e("span",An,s(a.modelName),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",Un,s(a.modelDescription),1),a.type?(d(),u("div",xn,[e("span",Pn,s(a.type),1)])):D("",!0)],10,Nn)}),128))])),n.value?(d(),u("div",En,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!n.value&&m.length===0?(d(),u("div",Dn,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.modelConfig.noModel")),1)])):D("",!0),e("button",{class:"add-btn",onClick:W},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.modelConfig.createNew")),1)])]),r.value?(d(),u("div",Mn,[e("div",Fn,[e("h3",null,s(r.value.modelName),1),e("div",Rn,[e("button",{class:"action-btn primary",onClick:U},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:E},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",Ln,[e("label",null,[$(s(t(o)("config.modelConfig.type"))+" ",1),i[15]||(i[15]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:r.value.type,"onUpdate:modelValue":i[0]||(i[0]=a=>r.value.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Bn,[e("label",null,[$(s(t(o)("config.modelConfig.baseUrl"))+" ",1),i[16]||(i[16]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=a=>r.value.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,In),[[J,r.value.baseUrl]])]),e("div",qn,[e("label",null,[$(s(t(o)("config.modelConfig.apiKey"))+" ",1),i[17]||(i[17]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[2]||(i[2]=a=>r.value.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,On),[[J,r.value.apiKey]])]),e("div",Gn,[e("label",null,[$(s(t(o)("config.modelConfig.modelName"))+" ",1),i[18]||(i[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[3]||(i[3]=a=>r.value.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,jn),[[J,r.value.modelName]])]),e("div",Kn,[e("label",null,[$(s(t(o)("config.modelConfig.description"))+" ",1),i[19]||(i[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=a=>r.value.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Jn),[[J,r.value.modelDescription]])])])):(d(),u("div",zn,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.modelConfig.selectModelHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":i[10]||(i[10]=a=>k.value=a),title:t(o)("config.modelConfig.newModel"),onConfirm:I},{default:G(()=>[e("div",Hn,[e("div",Yn,[e("label",null,[$(s(t(o)("config.modelConfig.type"))+" ",1),i[20]||(i[20]=e("span",{class:"required"},"*",-1))]),y(Ue,{modelValue:C.type,"onUpdate:modelValue":i[5]||(i[5]=a=>C.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Wn,[e("label",null,[$(s(t(o)("config.modelConfig.baseUrl"))+" ",1),i[21]||(i[21]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[6]||(i[6]=a=>C.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Xn),[[J,C.baseUrl]])]),e("div",Qn,[e("label",null,[$(s(t(o)("config.modelConfig.apiKey"))+" ",1),i[22]||(i[22]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[7]||(i[7]=a=>C.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Zn),[[J,C.apiKey]])]),e("div",ea,[e("label",null,[$(s(t(o)("config.modelConfig.modelName"))+" ",1),i[23]||(i[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[8]||(i[8]=a=>C.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,oa),[[J,C.modelName]])]),e("div",ta,[e("label",null,[$(s(t(o)("config.modelConfig.description"))+" ",1),i[24]||(i[24]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=a=>C.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,sa),[[J,C.modelDescription]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:A.value,"onUpdate:modelValue":i[12]||(i[12]=a=>A.value=a),title:"Delete confirmation"},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:i[11]||(i[11]=a=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},s(t(o)("common.delete")),1)]),default:G(()=>{var a;return[e("div",na,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((a=r.value)==null?void 0:a.modelName),1),$(" "+s(t(o)("common.confirm"))+"ï¼Ÿ ",1)]),e("p",aa,s(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),p.value?(d(),u("div",{key:0,class:"error-toast",onClick:i[13]||(i[13]=a=>p.value="")},[y(t(V),{icon:"carbon:error"}),$(" "+s(p.value),1)])):D("",!0),v.value?(d(),u("div",{key:1,class:"success-toast",onClick:i[14]||(i[14]=a=>v.value="")},[y(t(V),{icon:"carbon:checkmark"}),$(" "+s(v.value),1)])):D("",!0)]),_:1}))}}),ia=ie(la,[["__scopeId","data-v-2ee2eba1"]]);class Se{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to add MCP server: ${n.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(n){return console.error("Failed to add MCP server:",n),{success:!1,message:n instanceof Error?n.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!n.ok)throw new Error(`Failed to delete MCP server: ${n.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(n){return console.error(`Failed to delete MCP server[${o}]:`,n),{success:!1,message:n instanceof Error?n.message:"Failed to delete, please retry"}}}}ge(Se,"BASE_URL","/api/mcp");const ca={class:"mcp-config-panel"},ra={class:"mcp-header"},da={class:"header-left"},ua={class:"mcp-stats"},pa={class:"stat-item"},fa={class:"stat-label"},ga={class:"stat-value"},ma={class:"header-right"},ha={class:"search-box"},va=["placeholder"],ya={key:0,class:"loading-container"},_a={key:1,class:"mcp-layout"},ba={class:"mcp-table-container"},Ca={class:"section-title"},$a={key:0,class:"empty-state"},wa={class:"empty-state-text"},ka={key:1,class:"mcp-table-wrapper"},Sa={class:"mcp-table"},Ta={class:"mcp-id"},Na={class:"mcp-server-name"},Va={class:"server-name-content"},Aa={class:"mcp-connection-type"},Ua={class:"mcp-config"},xa=["title"],Pa={class:"mcp-actions"},Ea=["onClick","disabled"],Da={class:"add-mcp-container"},Ma={class:"add-mcp-header"},Fa={class:"add-mcp-title"},Ra={class:"mcp-form"},La={class:"mcp-form-group"},Ba={class:"form-label"},Ia={class:"connection-type-options"},qa={class:"connection-type-option"},Oa={for:"mcp-connection-type-studio",class:"radio-label"},Ga={class:"connection-type-desc"},ja={class:"connection-type-option"},Ka={for:"mcp-connection-type-sse",class:"radio-label"},Ja={class:"connection-type-desc"},za={class:"connection-type-option"},Ha={for:"mcp-connection-type-streaming",class:"radio-label"},Ya={class:"connection-type-desc"},Wa={class:"mcp-form-group"},Xa={class:"form-label"},Qa=["placeholder"],Za={class:"mcp-form-actions"},el=["disabled"],ol=["disabled"],tl={class:"mcp-form-instructions"},sl={class:"indented-list"},nl=le({__name:"mcpConfig",setup(B){const{t:o}=fe(),n=M(!1),p=M([]),v=M(""),m=oe({connectionType:"STUDIO",configJson:""}),h=oe({show:!1,text:"",type:"success"}),r=ne(()=>m.configJson.trim().length>0),k=ne(()=>{if(!v.value.trim())return p.value;const I=v.value.toLowerCase();return p.value.filter(U=>U.mcpServerName.toLowerCase().includes(I)||U.connectionType.toLowerCase().includes(I)||U.connectionConfig.toLowerCase().includes(I))}),A=I=>I?I.length>50?I.substring(0,50)+"...":I:"",C=(I,U="success")=>{h.text=I,h.type=U,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},T=async()=>{try{n.value=!0,p.value=await Se.getAllMcpServers()}catch(I){console.error("åŠ è½½MCPæœåŠ¡å™¨åˆ—è¡¨å¤±è´¥:",I),C(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},j=async()=>{if(!r.value){C(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(m.configJson)}catch{C(o("config.mcpConfig.invalidJson"),"error");return}try{n.value=!0;const I={connectionType:m.connectionType,configJson:m.configJson},U=await Se.addMcpServer(I);U.success?(C(o("config.mcpConfig.addSuccess")),W(),await T()):C(U.message||o("config.mcpConfig.addFailed"),"error")}catch(I){console.error("æ·»åŠ MCPæœåŠ¡å™¨å¤±è´¥:",I),C(o("config.mcpConfig.addFailed"),"error")}finally{n.value=!1}},F=async I=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{n.value=!0;const U=await Se.removeMcpServer(I);U.success?(C(o("config.mcpConfig.deleteSuccess")),await T()):C(U.message||o("config.mcpConfig.deleteFailed"),"error")}catch(U){console.error("åˆ é™¤MCPæœåŠ¡å™¨å¤±è´¥:",U),C(o("config.mcpConfig.deleteFailed"),"error")}finally{n.value=!1}},W=()=>{m.connectionType="STUDIO",m.configJson=""};return _e(()=>{T()}),(I,U)=>(d(),u("div",ca,[e("div",ra,[e("div",da,[e("h2",null,s(t(o)("config.mcpConfig.title")),1),e("div",ua,[e("span",pa,[e("span",fa,s(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",ga,s(p.value.length),1)])])]),e("div",ma,[e("div",ha,[O(e("input",{"onUpdate:modelValue":U[0]||(U[0]=E=>v.value=E),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,va),[[J,v.value]]),U[5]||(U[5]=e("span",{class:"search-icon"},"ðŸ”",-1))])])]),n.value?(d(),u("div",ya,[U[6]||(U[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(t(o)("config.loading")),1)])):(d(),u("div",_a,[e("div",ba,[e("h3",Ca,s(t(o)("config.mcpConfig.serverList")),1),k.value.length===0?(d(),u("div",$a,[U[7]||(U[7]=e("div",{class:"empty-state-icon"},"ðŸ“‚",-1)),e("div",wa,s(v.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(d(),u("div",ka,[e("table",Sa,[e("thead",null,[e("tr",null,[U[8]||(U[8]=e("th",null,"ID",-1)),e("th",null,s(t(o)("agent.name")),1),e("th",null,s(t(o)("config.mcpConfig.connectionType")),1),e("th",null,s(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,s(t(o)("common.actions")),1)])]),e("tbody",null,[(d(!0),u(H,null,Y(k.value,E=>(d(),u("tr",{key:E.id,class:"mcp-row"},[e("td",Ta,s(E.id),1),e("td",Na,[e("div",Va,[U[9]||(U[9]=e("span",{class:"server-icon"},"ðŸ”Œ",-1)),$(" "+s(E.mcpServerName),1)])]),e("td",Aa,[e("span",{class:ee(["connection-type-badge",E.connectionType.toLowerCase()])},s(E.connectionType),3)]),e("td",Ua,[e("div",{class:"config-preview",title:E.connectionConfig},s(A(E.connectionConfig)),9,xa)]),e("td",Pa,[e("button",{onClick:X=>F(E.id),class:"action-btn delete-btn",disabled:n.value},s(t(o)("common.delete")),9,Ea)])]))),128))])])]))]),e("div",Da,[e("div",Ma,[e("h3",Fa,s(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",Ra,[e("div",La,[e("label",Ba,s(t(o)("config.mcpConfig.connectionType"))+"ï¼š",1),e("div",Ia,[e("div",qa,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":U[1]||(U[1]=E=>m.connectionType=E),value:"STUDIO"},null,512),[[Ae,m.connectionType]]),e("label",Oa,[U[10]||(U[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",Ga,s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",ja,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":U[2]||(U[2]=E=>m.connectionType=E),value:"SSE"},null,512),[[Ae,m.connectionType]]),e("label",Ka,[U[11]||(U[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Ja,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",za,[O(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":U[3]||(U[3]=E=>m.connectionType=E),value:"STREAMING"},null,512),[[Ae,m.connectionType]]),e("label",Ha,[U[12]||(U[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",Ya,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",Wa,[e("label",Xa,s(t(o)("config.mcpConfig.configJsonLabel")),1),O(e("textarea",{"onUpdate:modelValue":U[4]||(U[4]=E=>m.configJson=E),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,Qa),[[J,m.configJson]])]),e("div",Za,[e("button",{onClick:j,class:"action-btn add-btn",disabled:n.value},s(t(o)("common.add")),9,el),e("button",{onClick:W,class:"action-btn reset-btn",disabled:n.value},s(t(o)("common.reset")),9,ol)])]),e("div",tl,[e("h4",null,s(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[$(s(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",sl,[e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Local")),1),$("ï¼š"+s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Remote")),1),$("ï¼š"+s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,s(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),y($e,{name:"message-fade"},{default:G(()=>[h.show?(d(),u("div",{key:0,class:ee(["message-toast",h.type])},s(h.text),3)):D("",!0)]),_:1})]))}}),al=ie(nl,[["__scopeId","data-v-355da8bb"]]);class he{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to get Prompt list:",n),n}}static async getPromptById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,n),n}}static async createPrompt(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Prompt:",n),n}}static async updatePrompt(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Prompt[${o}]:`,p),p}}static async deletePrompt(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Prompt[${o}]:`,n),n}}}ge(he,"BASE_URL","/api/prompt");const ll={class:"custom-select"},il=["title"],cl={key:0,class:"current-option"},rl={class:"option-name"},dl={key:1,class:"current-option"},ul={class:"select-options"},pl=["onClick"],fl={class:"option-name"},gl=le({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(B,{emit:o}){const n=B,p=o,v=M(!1),m=ne(()=>n.options.find(A=>A.id===n.modelValue)),h=A=>A.id===n.modelValue,r=()=>{v.value=!v.value},k=A=>{p("update:modelValue",A.id),v.value=!1};return(A,C)=>(d(),u("div",ll,[e("button",{class:"select-btn",onClick:r,title:A.placeholder},[m.value?(d(),u("span",cl,[e("span",rl,s(m.value.name),1)])):(d(),u("span",dl,s(A.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,il),y($e,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",onClick:C[0]||(C[0]=ye(()=>{},["stop"]))},[e("div",ul,[(d(!0),u(H,null,Y(A.options,T=>(d(),u("button",{key:T.id,class:ee(["select-option",{active:h(T)}]),onClick:j=>k(T)},[e("span",fl,s(T.name),1),h(T)?(d(),ae(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,pl))),128))])],512),[[xe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[1]||(C[1]=T=>v.value=!1)})):D("",!0)]))}}),ke=ie(gl,[["__scopeId","data-v-4c6d676f"]]),ml={class:"prompt-layout"},hl={class:"prompt-list"},vl={class:"list-header"},yl={class:"prompt-count"},_l={key:0,class:"prompts-container"},bl=["onClick"],Cl={class:"prompt-card-header"},$l={class:"prompt-name"},wl={key:0,class:"prompt-desc"},kl={class:"tags"},Sl={class:"tag"},Tl={key:1,class:"loading-state"},Nl={key:2,class:"empty-state"},Vl={key:0,class:"prompt-detail"},Al={class:"detail-header"},Ul={class:"detail-actions"},xl={class:"form-item"},Pl=["placeholder"],El={class:"form-item"},Dl={class:"form-item"},Ml={class:"form-item"},Fl=["placeholder"],Rl={class:"form-item"},Ll=["placeholder"],Bl={key:1,class:"no-selection"},Il={class:"modal-form"},ql={class:"form-item"},Ol=["placeholder"],Gl={class:"form-item"},jl={class:"form-item"},Kl={class:"form-item"},Jl=["placeholder"],zl={class:"form-item"},Hl=["placeholder"],Yl={class:"delete-confirm"},Wl={class:"warning-text"},Xl=le({__name:"dynamicPromptConfig",setup(B){const{t:o}=fe(),{success:n,error:p}=Me(),v=Pe(),m=M(!1),h=oe([]),r=M(null),k=M(!1),A=M(!1),C=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],T=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],j={promptName:"",messageType:"",type:"",promptDescription:""},F=oe({...j}),W=async()=>{m.value=!0;try{const a=await he.getAllPrompts(v.namespace);a.length>0&&await I(a[0]),h.splice(0,h.length,...a)}catch(a){console.error("åŠ è½½æ•°æ®å¤±è´¥:",a),p(o("config.promptConfig.loadDataFailed")+": "+a.message)}finally{m.value=!1}},I=async a=>{try{const c=await he.getPromptById(a.id);r.value={...c}}catch(c){console.error("åŠ è½½Promptè¯¦æƒ…å¤±è´¥:",c),p(o("config.promptConfig.loadDetailsFailed")+": "+c.message),r.value={...a}}},U=async()=>{if(te(F))try{const a={...F,builtIn:!1},c=await he.createPrompt(a);h.push(c),r.value=c,k.value=!1,n(o("config.promptConfig.createSuccess"))}catch(a){p(o("config.promptConfig.createFailed")+": "+a.message)}},E=async()=>{if(r.value&&te(r.value))try{const a=await he.updatePrompt(r.value.id,r.value),c=h.findIndex(_=>_.id===a.id);c!==-1&&(h[c]=a),r.value={...a},n(o("config.promptConfig.saveSuccess"))}catch(a){p(o("config.promptConfig.saveFailed")+": "+a.message)}},X=async()=>{if(r.value)try{await he.deletePrompt(r.value.id);const a=h.findIndex(c=>c.id===r.value.id);a!==-1&&h.splice(a,1),r.value=h.length>0?h[0]:null,A.value=!1,n(o("config.promptConfig.deleteSuccess"))}catch(a){p(o("config.promptConfig.deleteFailed")+": "+a.message)}};function te(a){const c=["promptName","messageType","type","promptContent"];for(const R of c){const z=a[R];if(z==null||typeof z=="string"&&z.trim()==="")return p(`${R} is required and cannot be empty`),!1}return!!x(h,a)}function x(a,c){const _=a.find(R=>R.promptName===c.promptName);return _&&c.id&&_.id!==c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):_&&!c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):!0}const g=()=>{F.promptName="",F.promptDescription="",F.promptContent="",Object.assign(F,j),k.value=!0},i=()=>{A.value=!0};return _e(()=>{W()}),(a,c)=>(d(),ae(Te,null,{title:G(()=>[e("h2",null,s(t(o)("config.promptConfig.title")),1)]),default:G(()=>[e("div",ml,[e("div",hl,[e("div",vl,[e("h3",null,s(t(o)("config.promptConfig.configuredprompts")),1),e("span",yl,"("+s(h.length)+s(t(o)("config.promptConfig.promptCount"))+")",1)]),m.value?D("",!0):(d(),u("div",_l,[(d(!0),u(H,null,Y(h,_=>{var R,z;return d(),u("div",{key:_.id,class:ee(["prompt-card",{active:((R=r.value)==null?void 0:R.id)===_.id}]),onClick:se=>I(_)},[e("div",Cl,[e("span",$l,s(_.promptName),1),y(t(V),{icon:"carbon:chevron-right"})]),(z=_.promptDescription)!=null&&z.trim()?(d(),u("p",wl,s(_.promptDescription),1)):D("",!0),e("div",kl,[e("span",Sl,s(_.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,bl)}),128))])),m.value?(d(),u("div",Tl,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!m.value&&h.length===0?(d(),u("div",Nl,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.promptConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:g},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.promptConfig.createNew")),1)])]),r.value?(d(),u("div",Vl,[e("div",Al,[e("h3",null,s(r.value.promptName),1),e("div",Ul,[e("button",{class:"action-btn primary",onClick:E},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),r.value.builtIn?D("",!0):(d(),u("button",{key:0,class:"action-btn danger",onClick:i},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)]))])]),e("div",xl,[e("label",null,[$(s(t(o)("config.promptConfig.promptName"))+" ",1),c[15]||(c[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":c[0]||(c[0]=_=>r.value.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Pl),[[J,r.value.promptName]])]),e("div",El,[e("label",null,[$(s(t(o)("config.promptConfig.messageType"))+" ",1),c[16]||(c[16]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[2]||(c[2]=_=>r.value.messageType=_),disabled:!0},null,512)),[[J,r.value.messageType]]):(d(),ae(ke,{key:0,modelValue:r.value.messageType,"onUpdate:modelValue":c[1]||(c[1]=_=>r.value.messageType=_),options:C,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Dl,[e("label",null,[$(s(t(o)("config.promptConfig.type"))+" ",1),c[17]||(c[17]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[4]||(c[4]=_=>r.value.type=_),disabled:!0,required:""},null,512)),[[J,r.value.type]]):(d(),ae(ke,{key:0,modelValue:r.value.type,"onUpdate:modelValue":c[3]||(c[3]=_=>r.value.type=_),options:T,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Ml,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=_=>r.value.promptDescription=_),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Fl),[[J,r.value.promptDescription]])]),e("div",Rl,[e("label",null,[$(s(t(o)("config.promptConfig.promptContent"))+" ",1),c[18]||(c[18]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[6]||(c[6]=_=>r.value.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Ll),[[J,r.value.promptContent]])])])):(d(),u("div",Bl,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.promptConfig.selectPromptHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":c[12]||(c[12]=_=>k.value=_),title:t(o)("config.promptConfig.newPrompt"),onConfirm:U},{default:G(()=>[e("div",Il,[e("div",ql,[e("label",null,[$(s(t(o)("config.promptConfig.promptName"))+" ",1),c[19]||(c[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[7]||(c[7]=_=>F.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Ol),[[J,F.promptName]])]),e("div",Gl,[e("label",null,[$(s(t(o)("config.promptConfig.messageType"))+" ",1),c[20]||(c[20]=e("span",{class:"required"},"*",-1))]),y(ke,{modelValue:F.messageType,"onUpdate:modelValue":c[8]||(c[8]=_=>F.messageType=_),options:C,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",jl,[e("label",null,[$(s(t(o)("config.promptConfig.type"))+" ",1),c[21]||(c[21]=e("span",{class:"required"},"*",-1))]),y(ke,{modelValue:F.type,"onUpdate:modelValue":c[9]||(c[9]=_=>F.type=_),options:T,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Kl,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[10]||(c[10]=_=>F.promptDescription=_),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,Jl),[[J,F.promptDescription]])]),e("div",zl,[e("label",null,[$(s(t(o)("config.promptConfig.promptContent"))+" ",1),c[22]||(c[22]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[11]||(c[11]=_=>F.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Hl),[[J,F.promptContent]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:A.value,"onUpdate:modelValue":c[14]||(c[14]=_=>A.value=_),title:t(o)("config.promptConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:c[13]||(c[13]=_=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},s(t(o)("common.delete")),1)]),default:G(()=>{var _;return[e("div",Yl,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,s((_=r.value)==null?void 0:_.promptName),1),$(" "+s(t(o)("common.confirm"))+"ï¼Ÿ ",1)]),e("p",Wl,s(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),Ql=ie(Xl,[["__scopeId","data-v-697ad7ba"]]);class ve{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Namespace[${o}] details:`,n),n}}static async createNamespace(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Namespace:",n),n}}static async updateNamespace(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Namespace[${o}]:`,p),p}}static async deleteNamespace(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Namespace[${o}]:`,n),n}}}ge(ve,"BASE_URL","/api/namespace");const Zl={class:"namespace-layout"},ei={class:"namespace-list"},oi={class:"list-header"},ti={key:0,class:"namespaces-container"},si=["onClick"],ni={class:"namespace-card-header"},ai={class:"namespace-name"},li={key:0,class:"loading-state"},ii={key:1,class:"empty-state"},ci={key:0,class:"namespace-detail"},ri={class:"detail-header"},di={class:"detail-actions"},ui={class:"form-item"},pi=["placeholder"],fi={key:1,class:"no-selection"},gi={class:"modal-form"},mi={class:"form-item"},hi=["placeholder"],vi={class:"delete-confirm"},yi={class:"warning-text"},_i=le({__name:"namespaceConfig",setup(B){const{t:o}=fe(),{success:n,error:p}=Me(),v=M(!1),m=oe([]),h=M(null),r=M(!1),k=M(!1),A={name:""},C=oe({...A}),T=async()=>{v.value=!0;try{const x=await ve.getAllNamespaces();x.length>0&&await j(x[0]),m.splice(0,m.length,...x)}catch(x){console.error("åŠ è½½æ•°æ®å¤±è´¥:",x),p(o("config.namespaceConfig.loadDataFailed")+": "+x.message)}finally{v.value=!1}},j=async x=>{try{const g=await ve.getNamespaceById(x.id);h.value={...g}}catch(g){console.error("åŠ è½½Promptè¯¦æƒ…å¤±è´¥:",g),p(o("config.namespaceConfig.loadDetailsFailed")+": "+g.message),h.value={...x}}},F=async()=>{if(U(C))try{const x={...C},g=await ve.createNamespace(x);m.push(g),h.value=g,r.value=!1,n(o("config.namespaceConfig.createSuccess"))}catch(x){p(o("config.namespaceConfig.createFailed")+": "+x.message)}},W=async()=>{if(h.value&&U(h.value))try{const x=await ve.updateNamespace(h.value.id,h.value),g=m.findIndex(i=>i.id===x.id);g!==-1&&(m[g]=x),h.value={...x},n(o("config.namespaceConfig.saveSuccess"))}catch(x){p(o("config.namespaceConfig.saveFailed")+": "+x.message)}},I=async()=>{if(h.value)try{await ve.deleteNamespace(h.value.id);const x=m.findIndex(g=>g.id===h.value.id);x!==-1&&m.splice(x,1),h.value=m.length>0?m[0]:null,k.value=!1,n(o("config.namespaceConfig.deleteSuccess"))}catch(x){p(o("config.namespaceConfig.deleteFailed")+": "+x.message)}};function U(x){const g=["name"];for(const a of g){const c=x[a];if(c==null||typeof c=="string"&&c.trim()==="")return p(`${a} is required and cannot be empty`),!1}return!!E(m,x)}function E(x,g){const i=x.find(a=>a.name===g.name);return i&&g.id&&i.id!==g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):i&&!g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):!0}const X=()=>{C.name="",Object.assign(C,A),r.value=!0},te=()=>{k.value=!0};return _e(()=>{T()}),(x,g)=>(d(),ae(Te,null,{title:G(()=>[e("h2",null,s(t(o)("config.namespaceConfig.title")),1)]),default:G(()=>[e("div",Zl,[e("div",ei,[e("div",oi,[e("h3",null,s(t(o)("config.namespaceConfig.configured")),1)]),v.value?D("",!0):(d(),u("div",ti,[(d(!0),u(H,null,Y(m,i=>{var a;return d(),u("div",{key:i.id,class:ee(["namespace-card",{active:((a=h.value)==null?void 0:a.id)===i.id}]),onClick:c=>j(i)},[e("div",ni,[e("span",ai,s(i.name),1),y(t(V),{icon:"carbon:chevron-right"})])],10,si)}),128))]))]),v.value?(d(),u("div",li,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!v.value&&m.length===0?(d(),u("div",ii,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.namespaceConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:X},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.namespaceConfig.createNew")),1)])]),h.value?(d(),u("div",ci,[e("div",ri,[e("h3",null,s(h.value.name),1),e("div",di,[e("button",{class:"action-btn primary",onClick:W},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:te},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",ui,[e("label",null,[$(s(t(o)("config.namespaceConfig.name"))+" ",1),g[5]||(g[5]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":g[0]||(g[0]=i=>h.value.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,pi),[[J,h.value.name]])])])):(d(),u("div",fi,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.namespaceConfig.selectPromptHint")),1)])),y(de,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=i=>r.value=i),title:t(o)("config.namespaceConfig.newPrompt"),onConfirm:F},{default:G(()=>[e("div",gi,[e("div",mi,[e("label",null,[$(s(t(o)("config.namespaceConfig.name"))+" ",1),g[6]||(g[6]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":g[1]||(g[1]=i=>C.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,hi),[[J,C.name]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:k.value,"onUpdate:modelValue":g[4]||(g[4]=i=>k.value=i),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:g[3]||(g[3]=i=>k.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:I},s(t(o)("common.delete")),1)]),default:G(()=>{var i;return[e("div",vi,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((i=h.value)==null?void 0:i.name),1),$(" "+s(t(o)("common.confirm"))+"ï¼Ÿ ",1)]),e("p",yi,s(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),bi=ie(_i,[["__scopeId","data-v-d0b2912a"]]),Ci=le({__name:"namespaceSwitch",setup(B){const{t:o}=fe(),{namespace:n,setNamespace:p,db:v}=Pe(),m=h=>{p(h)};return(h,r)=>(d(),u("div",null,[y(Ue,{modelValue:t(n),"onUpdate:modelValue":r[0]||(r[0]=k=>Ke(n)?n.value=k:null),options:t(v),"dropdown-title":t(o)("config.promptConfig.namespace"),onChange:m,placeholder:t(o)("config.promptConfig.selectNamespace"),direction:"right",dropStyles:{minWidth:"180px"}},null,8,["modelValue","options","dropdown-title","placeholder"])]))}}),$i={class:"config-container"},wi={class:"config-header"},ki={class:"header-actions"},Si={class:"header-actions-left"},Ti={class:"header-actions-right"},Ni={class:"config-content"},Vi={class:"config-nav"},Ai=["onClick"],Ui={class:"config-details"},xi=le({__name:"index",setup(B){const{t:o}=fe(),n=Je(),p=He(),v=M(n.params.category||"basic"),m={basic:De,agent:dn,model:ia,mcp:al,prompt:Ql,namespace:bi},h=ne(()=>{const A=v.value;return m[A]||De}),r=ne(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",disabled:!0,icon:"carbon:repo-artifact"}]),k=A=>{v.value=A,p.push({name:n.name,params:{...n.params,category:A},query:n.query})};return(A,C)=>(d(),u("div",$i,[e("div",wi,[e("div",ki,[e("div",Si,[e("button",{class:"action-btn",onClick:C[0]||(C[0]=T=>A.$router.push("/"))},[y(t(V),{icon:"carbon:arrow-left"}),$(" "+s(A.$t("backHome")),1)]),y(Ye)]),e("div",Ti,[y(Ci)])])]),e("div",Ni,[e("nav",Vi,[(d(!0),u(H,null,Y(r.value,(T,j)=>(d(),u(H,null,[T.disabled?D("",!0):(d(),u("div",{key:j,class:ee(["nav-item",{active:v.value===T.key}]),onClick:F=>k(T.key)},[y(t(V),{icon:T.icon,width:"20"},null,8,["icon"]),e("span",null,s(T.label),1)],10,Ai))],64))),256))]),e("div",Ui,[(d(),ae(ze(h.value)))])])]))}}),Ri=ie(xi,[["__scopeId","data-v-5d4a51b7"]]);export{Ri as default};
