var Ie=Object.defineProperty;var qe=(M,o,n)=>o in M?Ie(M,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):M[o]=n;var me=(M,o,n)=>qe(M,typeof o!="symbol"?o+"":o,n);import{d as se,c as u,o as d,e,t as s,f as ge,r as E,m as oe,g as ie,h as be,i as y,b as D,s as $,w as O,v as J,F as H,j as Y,q as ee,D as Pe,a as te,z as G,T as Ce,E as we,G as Re,u as t,x as _e,A as Ae,H as Oe,k as Ge,C as je,n as Ke,I as Ue,J as Je,K as ze,B as He,L as Ye,l as We}from"./index-BVtxQ7hh.js";import{_ as ne,I as V}from"./_plugin-vue_export-helper-DZwTQR-U.js";import{L as Xe}from"./index-nKWQuIMN.js";const Qe={class:"switch"},Ze=["checked"],eo={class:"switch-label"},oo=se({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(M,{emit:o}){const n=o,p=v=>{const m=v.target.checked;n("update:switchValue",m)};return(v,m)=>(d(),u("label",Qe,[e("input",{type:"checkbox",checked:v.enabled,onChange:p},null,40,Ze),m[0]||(m[0]=e("span",{class:"slider"},null,-1)),e("span",eo,s(v.label),1)]))}}),to=ne(oo,[["__scopeId","data-v-d484b4a3"]]);class $e{static async getConfigsByGroup(o){try{const n=await fetch(`${this.BASE_URL}/group/${o}`);if(!n.ok)throw new Error(`Failed to get ${o} group configuration: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get ${o} group configuration:`,n),n}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const n=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Batch update configuration failed: ${n.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(n){return console.error("Batch update configuration failed:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}static async getConfigById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);if(!n.ok)throw new Error(`Failed to get configuration item: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get configuration item[${o}]:`,n),n}}static async updateConfig(o){try{const n=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to update configuration item: ${n.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(n){return console.error("Failed to update configuration item:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}}me($e,"BASE_URL","/api/config");const so={class:"config-panel"},no={class:"config-header"},ao={class:"header-left"},lo={class:"config-stats"},io={class:"stat-item"},co={class:"stat-label"},ro={class:"stat-value"},uo={key:0,class:"stat-item"},po={class:"stat-label"},fo={class:"stat-value modified"},mo={class:"header-right"},go={class:"import-export-actions"},ho=["title"],vo=["title"],yo={class:"search-box"},_o=["placeholder"],bo={key:0,class:"loading-container"},Co={key:1,class:"config-groups"},$o={class:"group-header"},wo={class:"group-info"},ko={class:"group-icon"},So={class:"group-actions"},To=["onClick","disabled","title"],Vo={class:"sub-groups"},No=["onClick"],Ao={class:"sub-group-info"},Uo={class:"sub-group-title"},xo={class:"item-count"},Po={class:"config-items"},Eo={key:0,class:"config-item-content vertical-layout"},Do={class:"config-item-info"},Mo={class:"config-item-header"},Ro={class:"config-label"},Lo={class:"type-badge boolean"},Fo={key:0,class:"modified-badge"},Bo=["title"],Io={class:"config-control"},qo=["value","onChange"],Oo=["value"],Go={key:1,class:"config-item-content vertical-layout"},jo={class:"config-item-info"},Ko={class:"config-item-header"},Jo={class:"config-label"},zo={class:"type-badge select"},Ho={key:0,class:"modified-badge"},Yo=["title"],Wo={class:"config-control"},Xo=["value","onChange"],Qo=["value"],Zo={key:2,class:"config-item-content vertical-layout"},et={class:"config-item-info"},ot={class:"config-item-header"},tt={class:"config-label"},st={class:"type-badge textarea"},nt={key:0,class:"modified-badge"},at=["title"],lt={class:"config-control"},it=["value","onInput"],ct={key:3,class:"config-item-content vertical-layout"},rt={class:"config-item-info"},dt={class:"config-item-header"},ut={class:"config-label"},pt={class:"type-badge number"},ft={key:0,class:"modified-badge"},mt=["title"],gt={key:0,class:"config-meta"},ht={class:"range-info"},vt={class:"config-control"},yt=["value","onInput","min","max"],_t={key:4,class:"config-item-content vertical-layout"},bt={class:"config-item-info"},Ct={class:"config-item-header"},$t={class:"config-label"},wt={class:"type-badge string"},kt={key:0,class:"modified-badge"},St=["title"],Tt={class:"config-control"},Vt=["value","onInput"],Nt={key:2,class:"empty-state"},At=se({__name:"basicConfig",setup(M){const{t:o}=ge(),n=E(!0),p=E(!1),v=E([]),m=E(new Map),h=E(new Set),r=oe({show:!1,text:"",type:"success"}),k=E(""),N={headless:"config.basicConfig.browserSettings.headless",requestTimeout:"config.basicConfig.browserSettings.requestTimeout",debugDetail:"config.basicConfig.general.debugDetail",baseDir:"config.basicConfig.general.baseDir",openBrowser:"config.basicConfig.interactionSettings.openBrowser",maxSteps:"config.basicConfig.agentSettings.maxSteps",userInputTimeout:"config.basicConfig.agentSettings.userInputTimeout",maxMemory:"config.basicConfig.agentSettings.maxMemory",parallelToolCalls:"config.basicConfig.agentSettings.parallelToolCalls",forceOverrideFromYaml:"config.basicConfig.agents.forceOverrideFromYaml",enabled:"config.basicConfig.infiniteContext.enabled",parallelThreads:"config.basicConfig.infiniteContext.parallelThreads",taskContextSize:"config.basicConfig.infiniteContext.taskContextSize",allowExternalAccess:"config.basicConfig.fileSystem.allowExternalAccess"},C={manus:"config.basicConfig.groupDisplayNames.manus"},S={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},j={agent:"config.subGroupDisplayNames.agent",browser:"config.subGroupDisplayNames.browser",interaction:"config.subGroupDisplayNames.interaction",agents:"config.subGroupDisplayNames.agents",infiniteContext:"config.subGroupDisplayNames.infiniteContext",general:"config.subGroupDisplayNames.general",filesystem:"config.subGroupDisplayNames.filesystem"},L=ie(()=>v.value.some(l=>l.subGroups.some(w=>w.items.some(A=>m.value.get(A.id)!==A.configValue)))),W=l=>l==="true",I=l=>parseFloat(l)||0,U=l=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[l]||1,R=l=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[l]||1e4,X=l=>typeof l=="string"?l:l.value,ae=l=>typeof l=="string"?l:l.label,x=(l,w)=>{if(typeof w=="boolean")return w.toString();if(typeof w=="string"){if(l.options&&l.options.length>0){const A=l.options.find(T=>(typeof T=="string"?T:T.label)===w||(typeof T=="string"?T:T.value)===w);if(A)return typeof A=="string"?A:A.value}return w}return String(w)},g=(l,w,A=!1)=>{let T;l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"?T=x(l,w):T=String(w),l.configValue!==T&&(l.configValue=T,l._modified=!0,(A||l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"||l.inputType==="SELECT")&&a())};let i=null;const a=()=>{i&&clearTimeout(i),i=window.setTimeout(()=>{F()},500)},c=(l,w="success")=>{r.text=l,r.type=w,r.show=!0,setTimeout(()=>{r.show=!1},3e3)},_=async()=>{try{n.value=!0;const w=["manus"].map(async T=>{try{const f=await $e.getConfigsByGroup(T);if(console.log("加载配置组:",T,f),f.length===0)return null;const B=f.map(Z=>({...Z,displayName:N[Z.configKey]||Z.configKey,min:U(Z.configKey),max:R(Z.configKey)}));B.forEach(Z=>{m.value.set(Z.id,Z.configValue)});const q=new Map;B.forEach(Z=>{const ce=Z.configSubGroup??"general";q.has(ce)||q.set(ce,[]),q.get(ce).push(Z)});const Q=Array.from(q.entries()).map(([Z,ce])=>({name:Z,displayName:j[Z]||Z,items:ce}));return{name:T,displayName:C[T]||T,subGroups:Q}}catch(f){return console.warn(`加载配置组 ${T} 失败，跳过:`,f),null}}),A=await Promise.all(w);v.value=A.filter(T=>T!==null),console.log("配置加载完成:",v.value)}catch(l){console.error("加载配置失败:",l),c(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},F=async()=>{if(!(p.value||!L.value))try{p.value=!0;const l=[];if(v.value.forEach(A=>{A.subGroups.forEach(T=>{const f=T.items.filter(B=>B._modified);l.push(...f)})}),l.length===0){c("没有需要保存的修改");return}const w=await $e.batchUpdateConfigs(l);w.success?(l.forEach(A=>{m.value.set(A.id,A.configValue),A._modified=!1}),c("配置保存成功")):c(w.message||"保存失败","error")}catch(l){console.error("保存配置失败:",l),c(o("config.basicConfig.saveFailed"),"error")}finally{p.value=!1}},z=async l=>{if(confirm(`确定要重置 "${C[l]||l}" 组的所有配置吗？`))try{p.value=!0;const A=v.value.find(B=>B.name===l);if(!A)return;const T=[];if(A.subGroups.forEach(B=>{B.items.forEach(q=>{const Q=le(q.configKey);Q!==q.configValue&&T.push({...q,configValue:Q})})}),T.length===0){c("该组配置已是默认值");return}const f=await $e.batchUpdateConfigs(T);f.success?(await _(),c(`成功重置 ${T.length} 项配置`)):c(f.message||"重置失败","error")}catch(A){console.error("重置组配置失败:",A),c(o("config.basicConfig.resetFailed"),"error")}finally{p.value=!1}},le=l=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[l]||"",ke=(l,w)=>{const A=`${l}-${w}`;h.value.has(A)?h.value.delete(A):h.value.add(A)},he=(l,w)=>h.value.has(`${l}-${w}`),ue=ie(()=>{const l=v.value.reduce((A,T)=>A+T.subGroups.reduce((f,B)=>f+B.items.length,0),0),w=v.value.reduce((A,T)=>A+T.subGroups.reduce((f,B)=>f+B.items.filter(q=>m.value.get(q.id)!==q.configValue).length,0),0);return{total:l,modified:w}}),P=ie(()=>{if(!k.value.trim())return v.value;const l=k.value.toLowerCase();return v.value.map(w=>({...w,subGroups:w.subGroups.map(A=>({...A,items:A.items.filter(T=>T.displayName.toLowerCase().includes(l)||T.configKey.toLowerCase().includes(l)||T.description&&T.description.toLowerCase().includes(l))})).filter(A=>A.items.length>0)})).filter(w=>w.subGroups.length>0)}),b=()=>{try{const l={timestamp:new Date().toISOString(),version:"1.0",configs:v.value.reduce((f,B)=>(B.subGroups.forEach(q=>{q.items.forEach(Q=>{f[Q.configKey]=Q.configValue})}),f),{})},w=JSON.stringify(l,null,2),A=new Blob([w],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(A),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),c("配置导出成功")}catch(l){console.error("导出配置失败:",l),c("导出失败","error")}},K=l=>{var f;const w=l.target,A=(f=w.files)==null?void 0:f[0];if(!A)return;const T=new FileReader;T.onload=async B=>{var q;try{const Q=JSON.parse((q=B.target)==null?void 0:q.result);if(!Q.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;p.value=!0;const ce=[];if(v.value.forEach(Fe=>{Fe.subGroups.forEach(Be=>{Be.items.forEach(Ne=>{Object.prototype.hasOwnProperty.call(Q.configs,Ne.configKey)&&ce.push({...Ne,configValue:Q.configs[Ne.configKey]})})})}),ce.length===0){c("没有找到可导入的配置项");return}const De=await $e.batchUpdateConfigs(ce);De.success?(await _(),c(`成功导入 ${ce.length} 项配置`)):c(De.message||"导入失败","error")}catch(Q){console.error("导入配置失败:",Q),c(o("config.basicConfig.importFailed"),"error")}finally{p.value=!1,w.value=""}},T.readAsText(A)};return be(()=>{_()}),(l,w)=>(d(),u("div",so,[e("div",no,[e("div",ao,[e("h2",null,s(l.$t("config.basicConfig.title")),1),e("div",lo,[e("span",io,[e("span",co,s(l.$t("config.basicConfig.totalConfigs"))+":",1),e("span",ro,s(ue.value.total),1)]),ue.value.modified>0?(d(),u("span",uo,[e("span",po,s(l.$t("config.basicConfig.modified"))+":",1),e("span",fo,s(ue.value.modified),1)])):D("",!0)])]),e("div",mo,[e("div",go,[e("button",{onClick:b,class:"action-btn",title:l.$t("config.basicConfig.exportConfigs")}," 📤 ",8,ho),e("label",{class:"action-btn",title:l.$t("config.basicConfig.importConfigs")},[w[1]||(w[1]=$(" 📥 ")),e("input",{type:"file",accept:".json",onChange:K,style:{display:"none"}},null,32)],8,vo)]),e("div",yo,[O(e("input",{"onUpdate:modelValue":w[0]||(w[0]=A=>k.value=A),type:"text",placeholder:l.$t("config.search"),class:"search-input"},null,8,_o),[[J,k.value]]),w[2]||(w[2]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(d(),u("div",bo,[w[3]||(w[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(l.$t("config.loading")),1)])):P.value.length>0?(d(),u("div",Co,[(d(!0),u(H,null,Y(P.value,A=>(d(),u("div",{key:A.name,class:"config-group"},[e("div",$o,[e("div",wo,[e("span",ko,s(S[A.name]||"⚙️"),1)]),e("div",So,[e("button",{onClick:T=>z(A.name),class:"reset-btn",disabled:p.value,title:l.$t("config.resetGroupConfirm")},s(l.$t("config.reset")),9,To)]),w[4]||(w[4]=e("div",{class:"group-divider"},null,-1))]),e("div",Vo,[(d(!0),u(H,null,Y(A.subGroups,T=>(d(),u("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:f=>ke(A.name,T.name)},[e("div",Ao,[w[5]||(w[5]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",Uo,s(l.$t(T.displayName)),1),e("span",xo,"("+s(T.items.length)+")",1)]),e("span",{class:ee(["collapse-icon",{collapsed:he(A.name,T.name)}])}," ▼ ",2)],8,No),O(e("div",Po,[(d(!0),u(H,null,Y(T.items,f=>(d(),u("div",{key:f.id,class:ee(["config-item",{modified:m.value.get(f.id)!==f.configValue}])},[f.inputType==="BOOLEAN"||f.inputType==="CHECKBOX"?(d(),u("div",Eo,[e("div",Do,[e("div",Mo,[e("label",Ro,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",Lo,s(f.inputType==="CHECKBOX"?l.$t("config.types.checkbox"):l.$t("config.types.boolean")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Fo,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,Bo)])]),e("div",Io,[f.options&&f.options.length>0?(d(),u("select",{key:0,class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options,B=>(d(),u("option",{key:X(B),value:X(B)},s(ae(B)),9,Oo))),128))],40,qo)):(d(),te(to,{key:1,enabled:W(f.configValue),label:"","onUpdate:switchValue":B=>g(f,B)},null,8,["enabled","onUpdate:switchValue"]))])])):f.inputType==="SELECT"?(d(),u("div",Go,[e("div",jo,[e("div",Ko,[e("label",Jo,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",zo,s(l.$t("config.types.select")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Ho,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,Yo)])]),e("div",Wo,[e("select",{class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options||[],B=>(d(),u("option",{key:X(B),value:X(B)},s(ae(B)),9,Qo))),128))],40,Xo)])])):f.inputType==="TEXTAREA"?(d(),u("div",Zo,[e("div",et,[e("div",ot,[e("label",tt,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",st,s(l.$t("config.types.textarea")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",nt,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,at)])]),e("div",lt,[e("textarea",{class:"config-input textarea-input",value:f.configValue,onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,rows:"3"},null,40,it)])])):f.inputType==="NUMBER"?(d(),u("div",ct,[e("div",rt,[e("div",dt,[e("label",ut,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",pt,s(l.$t("config.types.number")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",ft,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,mt),f.min||f.max?(d(),u("div",gt,[e("span",ht,s(l.$t("config.range"))+": "+s(f.min||0)+" - "+s(f.max||"∞"),1)])):D("",!0)])]),e("div",vt,[e("input",{type:"number",class:"config-input number-input",value:I(f.configValue),onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,min:f.min||1,max:f.max||1e4},null,40,yt)])])):(d(),u("div",_t,[e("div",bt,[e("div",Ct,[e("label",$t,[$(s(l.$t(f.displayName)||f.description)+" ",1),e("span",wt,s(f.inputType==="TEXT"?l.$t("config.types.text"):l.$t("config.types.string")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",kt,s(l.$t("config.modified")),1)):D("",!0)]),e("span",{class:"config-key",title:f.configKey},s(f.configKey),9,St)])]),e("div",Tt,[e("input",{type:"text",class:"config-input text-input",value:f.configValue,onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a},null,40,Vt)])]))],2))),128))],512),[[Pe,!he(A.name,T.name)]])]))),128))])]))),128))])):(d(),u("div",Nt,[e("p",null,s(l.$t("config.notFound")),1)])),y(Ce,{name:"message-fade"},{default:G(()=>[r.show?(d(),u("div",{key:0,class:ee(["message-toast",r.type])},s(r.text),3)):D("",!0)]),_:1})]))}}),Me=ne(At,[["__scopeId","data-v-8f028e7e"]]),Ut={},xt={class:"config-config"},Pt={class:"panel-header"},Et={class:"panel-actions"};function Dt(M,o){return d(),u("div",xt,[e("div",Pt,[we(M.$slots,"title",{},void 0),e("div",Et,[we(M.$slots,"actions",{},void 0)])]),we(M.$slots,"default",{},void 0)])}const Ve=ne(Ut,[["render",Dt],["__scopeId","data-v-c91688e7"]]),Mt={class:"modal-header"},Rt={class:"modal-content"},Lt={class:"modal-footer"},Ft=se({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(M){const o=n=>{n.target===n.currentTarget&&(n.stopPropagation(),n.preventDefault())};return(n,p)=>(d(),te(Re,{to:"body"},[y(Ce,{name:"modal"},{default:G(()=>[M.modelValue?(d(),u("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:p[3]||(p[3]=_e(()=>{},["stop"]))},[e("div",Mt,[e("h3",null,s(M.title),1),e("button",{class:"close-btn",onClick:p[0]||(p[0]=v=>n.$emit("update:modelValue",!1))},[y(t(V),{icon:"carbon:close"})])]),e("div",Rt,[we(n.$slots,"default",{},void 0,!0)]),e("div",Lt,[we(n.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:p[1]||(p[1]=v=>n.$emit("update:modelValue",!1))},s(n.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:p[2]||(p[2]=v=>n.$emit("confirm"))},s(n.$t("common.confirm")),1)],!0)])])])):D("",!0)]),_:3})]))}}),de=ne(Ft,[["__scopeId","data-v-baaf1c89"]]),Bt={class:"tool-selection-content"},It={class:"tool-controls"},qt={class:"search-container"},Ot={class:"sort-container"},Gt={class:"tool-summary"},jt={class:"summary-text"},Kt={key:0,class:"tool-groups"},Jt=["onClick"],zt={class:"group-title-area"},Ht={class:"group-name"},Yt={class:"group-count"},Wt={class:"group-enable-all"},Xt=["checked","onChange","data-group"],Qt={class:"tool-info"},Zt={class:"tool-selection-name"},es={key:0,class:"tool-selection-desc"},os={class:"tool-actions"},ts=["checked","onChange"],ss={key:1,class:"empty-state"},ns=se({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(M,{emit:o}){const n=M,p=o,v=ie({get:()=>n.modelValue,set:i=>p("update:modelValue",i)}),m=E(""),h=E("group"),r=E(new Set),k=E([]),N=(i,a)=>{const c=document.querySelector(`input[data-group="${i}"]`);c&&(c.indeterminate=R(a))};Ae(()=>n.selectedToolIds,i=>{k.value=[...i]},{immediate:!0});const C=ie(()=>{let i=n.tools.filter(a=>a.key);if(m.value){const a=m.value.toLowerCase();i=i.filter(c=>{var _;return c.name.toLowerCase().includes(a)||c.description.toLowerCase().includes(a)||(((_=c.serviceGroup)==null?void 0:_.toLowerCase().includes(a))??!1)})}switch(h.value){case"name":i=[...i].sort((a,c)=>a.name.localeCompare(c.name));break;case"enabled":i=[...i].sort((a,c)=>{const _=k.value.includes(a.key),F=k.value.includes(c.key);return _&&!F?-1:!_&&F?1:a.name.localeCompare(c.name)});break;case"group":default:i=[...i].sort((a,c)=>{const _=a.serviceGroup??"未分组",F=c.serviceGroup??"未分组";return _!==F?_.localeCompare(F):a.name.localeCompare(c.name)});break}return i}),S=ie(()=>{const i=new Map;return C.value.forEach(a=>{const c=a.serviceGroup??"未分组";i.has(c)||i.set(c,[]),i.get(c).push(a)}),new Map([...i.entries()].sort())}),j=ie(()=>C.value.length);Ae([k,S],()=>{Ge(()=>{for(const[i,a]of S.value)N(i,a)})},{flush:"post",deep:!1});const L=i=>k.value.includes(i),W=(i,a)=>{a.stopPropagation();const _=a.target.checked;if(!i){console.error("toolKey is undefined, cannot proceed");return}_?k.value.includes(i)||(k.value=[...k.value,i]):k.value=k.value.filter(F=>F!==i)},I=i=>i.filter(a=>k.value.includes(a.key)),U=i=>i.length>0&&i.every(a=>k.value.includes(a.key)),R=i=>{const a=I(i).length;return a>0&&a<i.length},X=(i,a)=>{a.stopPropagation();const _=a.target.checked,F=i.map(z=>z.key);if(_){const z=[...k.value];F.forEach(le=>{z.includes(le)||z.push(le)}),k.value=z}else k.value=k.value.filter(z=>!F.includes(z))},ae=i=>{r.value.has(i)?r.value.delete(i):r.value.add(i)},x=()=>{p("confirm",[...k.value]),p("update:modelValue",!1)},g=()=>{k.value=[...n.selectedToolIds],p("update:modelValue",!1)};return Ae(v,i=>{if(i){r.value.clear();const a=Array.from(S.value.keys());a.length>1&&a.slice(1).forEach(c=>{r.value.add(c)})}}),(i,a)=>(d(),te(de,{modelValue:v.value,"onUpdate:modelValue":[a[4]||(a[4]=c=>v.value=c),g],title:"选择工具",onConfirm:x},{default:G(()=>[e("div",Bt,[e("div",It,[e("div",qt,[O(e("input",{"onUpdate:modelValue":a[0]||(a[0]=c=>m.value=c),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[J,m.value]])]),e("div",Ot,[O(e("select",{"onUpdate:modelValue":a[1]||(a[1]=c=>h.value=c),class:"sort-select"},a[5]||(a[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Oe,h.value]])])]),e("div",Gt,[e("span",jt," 共 "+s(S.value.size)+" 个服务组，"+s(j.value)+" 个工具 (已选择 "+s(k.value.length)+" 个) ",1)]),S.value.size>0?(d(),u("div",Kt,[(d(!0),u(H,null,Y(S.value,([c,_])=>(d(),u("div",{key:c,class:"tool-group"},[e("div",{class:ee(["tool-group-header",{collapsed:r.value.has(c)}]),onClick:F=>ae(c)},[e("div",zt,[y(t(V),{icon:r.value.has(c)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),y(t(V),{icon:"carbon:folder",class:"group-icon"}),e("span",Ht,s(c),1),e("span",Yt," ("+s(I(_).length)+"/"+s(_.length)+") ",1)]),e("div",{class:"group-actions",onClick:a[2]||(a[2]=_e(()=>{},["stop"]))},[e("label",Wt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:U(_),onChange:F=>X(_,F),"data-group":c},null,40,Xt),a[6]||(a[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Jt),e("div",{class:ee(["tool-group-content",{collapsed:r.value.has(c)}])},[(d(!0),u(H,null,Y(_.filter(F=>F&&F.key),F=>(d(),u("div",{key:F.key,class:"tool-selection-item"},[e("div",Qt,[e("div",Zt,s(F.name),1),F.description?(d(),u("div",es,s(F.description),1)):D("",!0)]),e("div",os,[e("label",{class:"tool-enable-switch",onClick:a[3]||(a[3]=_e(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:L(F.key),onChange:z=>W(F.key,z)},null,40,ts),a[7]||(a[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(d(),u("div",ss,[y(t(V),{icon:"carbon:tools",class:"empty-icon"}),a[8]||(a[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),as=ne(ns,[["__scopeId","data-v-79f6a572"]]);class fe{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}else{const n=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(n)).json()}}catch(n){throw console.error("Failed to get Agent list:",n),n}}static async getAgentById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Agent[${o}] details:`,n),n}}static async createAgent(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Agent:",n),n}}static async updateAgent(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Agent[${o}]:`,p),p}}static async deleteAgent(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Agent[${o}]:`,n),n}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}me(fe,"BASE_URL","/api/agents");class re{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Model[${o}] details:`,n),n}}static async createModel(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Model:",n),n}}static async updateModel(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Model[${o}]:`,p),p}}static async deleteModel(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Model[${o}]:`,n),n}}}me(re,"BASE_URL","/api/models");const Ee=je("namespace",()=>{const M=E("default");function o(v){M.value=v}const n=E([{name:"Default",id:"default"}]);function p(v){n.value=v}return{namespace:M,db:n,setNamespace:o,setDb:p}}),ls=["disabled"],is={class:"agent-layout"},cs={class:"agent-list"},rs={class:"list-header"},ds={class:"agent-count"},us={key:0,class:"agents-container"},ps=["onClick"],fs={class:"agent-card-header"},ms={class:"agent-name"},gs={class:"agent-desc"},hs={key:0,class:"agent-model"},vs={class:"model-tag"},ys={class:"model-tag"},_s={key:1,class:"agent-tools"},bs={key:0,class:"tool-more"},Cs={key:1,class:"loading-state"},$s={key:2,class:"empty-state"},ws={key:0,class:"agent-detail"},ks={class:"detail-header"},Ss={class:"detail-actions"},Ts={class:"form-item"},Vs=["placeholder"],Ns={class:"form-item"},As=["placeholder"],Us={class:"form-item"},xs=["value","placeholder"],Ps={class:"model-section"},Es={class:"form-item"},Ds={class:"model-chooser"},Ms=["title"],Rs={key:0,class:"current-model"},Ls={class:"model-type"},Fs={class:"model-name"},Bs={key:1,class:"current-model"},Is={class:"current-model"},qs={class:"dropdown-header"},Os={class:"model-options"},Gs=["onClick"],js={class:"model-type"},Ks={class:"model-name"},Js={class:"tools-section"},zs={class:"assigned-tools"},Hs={class:"section-header"},Ys={class:"tools-grid"},Ws={class:"tool-info"},Xs={class:"tool-name"},Qs={class:"tool-desc"},Zs={key:0,class:"no-tools"},en={key:1,class:"no-selection"},on={class:"modal-form"},tn={class:"form-item"},sn=["placeholder"],nn={class:"form-item"},an=["placeholder"],ln={class:"form-item"},cn=["value","placeholder"],rn={class:"delete-confirm"},dn={class:"warning-text"},un=se({__name:"agentConfig",setup(M){const{t:o}=ge(),n=Ee(),p=E(!1),v=E(""),m=E(""),h=oe([]),r=E(null),k=oe([]),N=E(!1),C=E(!1),S=E(!1),j=E(!1),L=E(null),W=oe([]),I=()=>{j.value=!j.value},U=P=>{L.value=P,j.value=!1},R=oe({name:"",description:"",nextStepPrompt:""}),X=P=>{const b=k.find(K=>K.key===P);return b?b.name:P},ae=P=>{const b=k.find(K=>K.key===P);return b?b.description:""},x=(P,b)=>{b==="success"?(m.value=P,setTimeout(()=>{m.value=""},3e3)):(v.value=P,setTimeout(()=>{v.value=""},5e3))},g=async()=>{p.value=!0;try{const[P,b,K]=await Promise.all([fe.getAllAgents(n.namespace),fe.getAvailableTools(),re.getAllModels()]),l=P.map(w=>({...w,availableTools:w.availableTools,...K}));h.splice(0,h.length,...l),k.splice(0,k.length,...b),W.splice(0,W.length,...K),l.length>0&&await i(l[0])}catch(P){console.error("加载数据失败:",P),x(o("config.agentConfig.loadDataFailed")+": "+P.message,"error");const b=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],K=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];k.splice(0,k.length,...b),h.splice(0,h.length,...K),K.length>0&&(r.value=K[0])}finally{p.value=!1}},i=async P=>{try{const b=await fe.getAgentById(P.id);r.value={...b,availableTools:b.availableTools},L.value=b.model??null}catch(b){console.error("加载Agent详情失败:",b),x(o("config.agentConfig.loadDetailsFailed")+": "+b.message,"error"),r.value={...P,availableTools:P.availableTools}}},a=()=>{R.name="",R.description="",R.nextStepPrompt="",N.value=!0},c=async()=>{var P;if(!R.name.trim()||!R.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{const b={name:R.name.trim(),description:R.description.trim(),nextStepPrompt:((P=R.nextStepPrompt)==null?void 0:P.trim())??"",availableTools:[]},K=await fe.createAgent(b);h.push(K),r.value=K,N.value=!1,x(o("config.agentConfig.createSuccess"),"success")}catch(b){x(o("config.agentConfig.createFailed")+": "+b.message,"error")}},_=()=>{S.value=!0},F=P=>{r.value&&(r.value.availableTools=[...P])},z=async()=>{if(r.value){if(!r.value.name.trim()||!r.value.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{r.value.model=L.value;const P=await fe.updateAgent(r.value.id,r.value),b=h.findIndex(K=>K.id===P.id);b!==-1&&(h[b]=P),r.value=P,r.value.model=L.value,x(o("config.agentConfig.saveSuccess"),"success")}catch(P){x(o("config.agentConfig.saveFailed")+": "+P.message,"error")}}},le=()=>{C.value=!0},ke=async()=>{if(r.value)try{await fe.deleteAgent(r.value.id);const P=h.findIndex(b=>b.id===r.value.id);P!==-1&&h.splice(P,1),r.value=h.length>0?h[0]:null,C.value=!1,x(o("config.agentConfig.deleteSuccess"),"success")}catch(P){x(o("config.agentConfig.deleteFailed")+": "+P.message,"error")}},he=()=>{const P=document.createElement("input");P.type="file",P.accept=".json",P.onchange=b=>{var l;const K=(l=b.target.files)==null?void 0:l[0];if(K){const w=new FileReader;w.onload=async A=>{var T;try{const f=JSON.parse((T=A.target)==null?void 0:T.result);if(!f.name||!f.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:B,...q}=f,Q=await fe.createAgent(q);h.push(Q),r.value=Q,x(o("config.agentConfig.importSuccess"),"success")}catch(f){x(o("config.agentConfig.importFailed")+": "+f.message,"error")}},w.readAsText(K)}},P.click()},ue=()=>{if(r.value)try{const P=JSON.stringify(r.value,null,2),b=new Blob([P],{type:"application/json"}),K=URL.createObjectURL(b),l=document.createElement("a");l.href=K,l.download=`agent-${r.value.name}-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(K),x(o("config.agentConfig.exportSuccess"),"success")}catch(P){x(o("config.agentConfig.exportFailed")+": "+P.message,"error")}};return be(()=>{g()}),(P,b)=>(d(),te(Ve,null,{title:G(()=>[e("h2",null,s(t(o)("config.agentConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:he},[y(t(V),{icon:"carbon:upload"}),$(" "+s(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ue,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),$(" "+s(t(o)("config.agentConfig.export")),1)],8,ls)]),default:G(()=>{var K;return[e("div",is,[e("div",cs,[e("div",rs,[e("h3",null,s(t(o)("config.agentConfig.configuredAgents")),1),e("span",ds,"("+s(h.length)+s(t(o)("config.agentConfig.agentCount"))+")",1)]),p.value?D("",!0):(d(),u("div",us,[(d(!0),u(H,null,Y(h,l=>{var w,A;return d(),u("div",{key:l.id,class:ee(["agent-card",{active:((w=r.value)==null?void 0:w.id)===l.id}]),onClick:T=>i(l)},[e("div",fs,[e("span",ms,s(l.name),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",gs,s(l.description),1),l.model?(d(),u("div",hs,[e("span",vs,s(l.model.type),1),e("span",ys,s(l.model.modelName),1)])):D("",!0),((A=l.availableTools)==null?void 0:A.length)>0?(d(),u("div",_s,[(d(!0),u(H,null,Y(l.availableTools.slice(0,3),T=>(d(),u("span",{key:T,class:"tool-tag"},s(X(T)),1))),128)),l.availableTools.length>3?(d(),u("span",bs," +"+s(l.availableTools.length-3),1)):D("",!0)])):D("",!0)],10,ps)}),128))])),p.value?(d(),u("div",Cs,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!p.value&&h.length===0?(d(),u("div",$s,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.agentConfig.noAgent")),1)])):D("",!0),e("button",{class:"add-btn",onClick:a},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.agentConfig.createNew")),1)])]),r.value?(d(),u("div",ws,[e("div",ks,[e("h3",null,s(r.value.name),1),e("div",Ss,[e("button",{class:"action-btn primary",onClick:z},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:le},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",Ts,[e("label",null,[$(s(t(o)("config.agentConfig.agentName"))+" ",1),b[15]||(b[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=l=>r.value.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Vs),[[J,r.value.name]])]),e("div",Ns,[e("label",null,[$(s(t(o)("config.agentConfig.description"))+" ",1),b[16]||(b[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[1]||(b[1]=l=>r.value.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,As),[[J,r.value.description]])]),e("div",Us,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:r.value.nextStepPrompt||"",onInput:b[2]||(b[2]=l=>r.value.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,xs)]),e("div",Ps,[e("h4",null,s(t(o)("config.agentConfig.modelConfiguration")),1),e("div",Es,[e("div",Ds,[e("button",{class:"model-btn",onClick:I,title:P.$t("model.switch")},[y(t(V),{icon:"carbon:build-run",width:"18"}),L.value?(d(),u("span",Rs,[e("span",Ls,s(L.value.type),1),b[17]||(b[17]=e("span",{class:"spacer"},null,-1)),e("span",Fs,s(L.value.modelName),1)])):(d(),u("span",Bs,[e("span",Is,s(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),y(t(V),{icon:j.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ms),j.value?(d(),u("div",{key:0,class:"model-dropdown",onClick:b[4]||(b[4]=_e(()=>{},["stop"]))},[e("div",qs,[e("span",null,s(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:b[3]||(b[3]=l=>j.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",Os,[(d(!0),u(H,null,Y(W,l=>{var w,A;return d(),u("button",{key:l.id,class:ee(["model-option",{active:((w=L.value)==null?void 0:w.id)===l.id}]),onClick:T=>U(l)},[e("span",js,s(l.type),1),e("span",Ks,s(l.modelName),1),((A=L.value)==null?void 0:A.id)===l.id?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,Gs)}),128))])])):D("",!0),j.value?(d(),u("div",{key:1,class:"backdrop",onClick:b[5]||(b[5]=l=>j.value=!1)})):D("",!0)])])]),e("div",Js,[e("h4",null,s(t(o)("config.agentConfig.toolConfiguration")),1),e("div",zs,[e("div",Hs,[e("span",null,s(t(o)("config.agentConfig.assignedTools"))+" ("+s((r.value.availableTools||[]).length)+")",1),k.length>0?(d(),u("button",{key:0,class:"action-btn small",onClick:_},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.agentConfig.addRemoveTools")),1)])):D("",!0)]),e("div",Ys,[(d(!0),u(H,null,Y(r.value.availableTools||[],l=>(d(),u("div",{key:l,class:"tool-item assigned"},[e("div",Ws,[e("span",Xs,s(X(l)),1),e("span",Qs,s(ae(l)),1)])]))),128)),r.value.availableTools.length===0?(d(),u("div",Zs,[y(t(V),{icon:"carbon:tool-box"}),e("span",null,s(t(o)("config.agentConfig.noAssignedTools")),1)])):D("",!0)])])])])):(d(),u("div",en,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.agentConfig.selectAgentHint")),1)]))]),y(de,{modelValue:N.value,"onUpdate:modelValue":b[9]||(b[9]=l=>N.value=l),title:t(o)("config.agentConfig.newAgent"),onConfirm:c},{default:G(()=>[e("div",on,[e("div",tn,[e("label",null,[$(s(t(o)("config.agentConfig.agentName"))+" ",1),b[18]||(b[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[6]||(b[6]=l=>R.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,sn),[[J,R.name]])]),e("div",nn,[e("label",null,[$(s(t(o)("config.agentConfig.description"))+" ",1),b[19]||(b[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[7]||(b[7]=l=>R.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,an),[[J,R.description]])]),e("div",ln,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:R.nextStepPrompt||"",onInput:b[8]||(b[8]=l=>R.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,cn)])])]),_:1},8,["modelValue","title"]),y(as,{modelValue:S.value,"onUpdate:modelValue":b[10]||(b[10]=l=>S.value=l),tools:k,"selected-tool-ids":((K=r.value)==null?void 0:K.availableTools)||[],onConfirm:F},null,8,["modelValue","tools","selected-tool-ids"]),y(de,{modelValue:C.value,"onUpdate:modelValue":b[12]||(b[12]=l=>C.value=l),title:t(o)("config.agentConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:b[11]||(b[11]=l=>C.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:ke},s(t(o)("common.delete")),1)]),default:G(()=>{var l;return[e("div",rn,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s((l=r.value)==null?void 0:l.name),1),$(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",dn,s(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),v.value?(d(),u("div",{key:0,class:"error-toast",onClick:b[13]||(b[13]=l=>v.value="")},[y(t(V),{icon:"carbon:error"}),$(" "+s(v.value),1)])):D("",!0),m.value?(d(),u("div",{key:1,class:"success-toast",onClick:b[14]||(b[14]=l=>m.value="")},[y(t(V),{icon:"carbon:checkmark"}),$(" "+s(m.value),1)])):D("",!0)]}),_:1}))}}),pn=ne(un,[["__scopeId","data-v-9e905dc6"]]),fn={class:"custom-select"},mn=["title"],gn={key:0,class:"current-option"},hn={class:"option-name"},vn={key:1,class:"current-option"},yn={class:"dropdown-header"},_n={class:"select-options"},bn=["onClick"],Cn={class:"option-name"},$n=se({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{}},emits:["update:modelValue"],setup(M,{emit:o}){const n=M,p=o,v=E(!1),m=ie(()=>n.options.find(N=>N.id===n.modelValue)),h=N=>N.id===n.modelValue,r=()=>{v.value=!v.value},k=N=>{p("update:modelValue",N.id),v.value=!1};return(N,C)=>(d(),u("div",fn,[e("button",{class:"select-btn",onClick:r,title:N.placeholder},[y(t(V),{icon:n.icon||"carbon:select-01",width:"18"},null,8,["icon"]),m.value?(d(),u("span",gn,[e("span",hn,s(m.value.name),1)])):(d(),u("span",vn,s(N.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,mn),y(Ce,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",style:Ke({...N.dropStyles,...n.direction==="right"?{right:0}:{left:0}}),onClick:C[1]||(C[1]=_e(()=>{},["stop"]))},[e("div",yn,[e("span",null,s(N.dropdownTitle),1),e("button",{class:"close-btn",onClick:C[0]||(C[0]=S=>v.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",_n,[(d(!0),u(H,null,Y(N.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:j=>k(S)},[e("span",Cn,s(S.name),1),h(S)?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,bn))),128))])],4),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[2]||(C[2]=S=>v.value=!1)})):D("",!0)]))}}),xe=ne($n,[["__scopeId","data-v-138e90e7"]]),wn=["disabled"],kn={class:"model-layout"},Sn={class:"model-list"},Tn={class:"list-header"},Vn={class:"model-count"},Nn={key:0,class:"models-container"},An=["onClick"],Un={class:"model-card-header"},xn={class:"model-name"},Pn={class:"model-desc"},En={key:0,class:"model-type"},Dn={class:"model-tag"},Mn={key:1,class:"loading-state"},Rn={key:2,class:"empty-state"},Ln={key:0,class:"model-detail"},Fn={class:"detail-header"},Bn={class:"detail-actions"},In={class:"form-item"},qn={class:"form-item"},On=["placeholder"],Gn={class:"form-item"},jn=["placeholder"],Kn={class:"form-item"},Jn=["placeholder"],zn={class:"form-item"},Hn=["placeholder"],Yn={key:1,class:"no-selection"},Wn={class:"modal-form"},Xn={class:"form-item"},Qn={class:"form-item"},Zn=["placeholder"],ea={class:"form-item"},oa=["placeholder"],ta={class:"form-item"},sa=["placeholder"],na={class:"form-item"},aa=["placeholder"],la={class:"delete-confirm"},ia={class:"warning-text"},ca=se({__name:"modelConfig",setup(M){const{t:o}=ge(),n=E(!1),p=E(""),v=E(""),m=oe([]),h=oe([]),r=E(null),k=E(!1),N=E(!1),C=oe({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),S=(g,i)=>{i==="success"?(v.value=g,setTimeout(()=>{v.value=""},3e3)):(p.value=g,setTimeout(()=>{p.value=""},5e3))},j=async()=>{n.value=!0;try{const[g,i]=await Promise.all([re.getAllModels(),re.getAllTypes()]),a=g.map(c=>({...c}));m.splice(0,m.length,...a),h.splice(0,h.length,...i),a.length>0&&await L(a[0])}catch(g){console.error("加载数据失败:",g),S(o("config.modelConfig.loadDataFailed")+": "+g.message,"error")}finally{n.value=!1}},L=async g=>{try{const i=await re.getModelById(g.id);r.value={...i}}catch(i){console.error("加载Model详情失败:",i),S(o("config.modelConfig.loadDetailsFailed")+": "+i.message,"error"),r.value={...g}}},W=()=>{C.baseUrl="",C.apiKey="",C.modelName="",C.modelDescription="",C.type="",k.value=!0},I=async()=>{if(!C.modelName.trim()||!C.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const g={baseUrl:C.baseUrl.trim(),apiKey:C.apiKey.trim(),modelName:C.modelName.trim(),modelDescription:C.modelDescription.trim(),type:C.type.trim()},i=await re.createModel(g);m.push(i),r.value=i,k.value=!1,S(o("config.modelConfig.createSuccess"),"success")}catch(g){S(o("config.modelConfig.createFailed")+": "+g.message,"error")}},U=async()=>{if(r.value){if(!r.value.modelName.trim()||!r.value.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const g=await re.updateModel(r.value.id,r.value),i=m.findIndex(a=>a.id===g.id);i!==-1&&(m[i]=g),r.value=g,S(o("config.modelConfig.saveSuccess"),"success")}catch(g){S(o("config.modelConfig.saveFailed")+": "+g.message,"error")}}},R=()=>{N.value=!0},X=async()=>{if(r.value)try{await re.deleteModel(r.value.id);const g=m.findIndex(i=>i.id===r.value.id);g!==-1&&m.splice(g,1),r.value=m.length>0?m[0]:null,N.value=!1,S(o("config.modelConfig.deleteSuccess"),"success")}catch(g){S(o("config.modelConfig.deleteFailed")+": "+g.message,"error")}},ae=()=>{const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=i=>{var c;const a=(c=i.target.files)==null?void 0:c[0];if(a){const _=new FileReader;_.onload=async F=>{var z;try{const le=JSON.parse((z=F.target)==null?void 0:z.result);if(!le.modelName||!le.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:ke,...he}=le,ue=await re.createModel(he);m.push(ue),r.value=ue,S(o("config.modelConfig.importSuccess"),"success")}catch(le){S(o("config.modelConfig.importFailed")+": "+le.message,"error")}},_.readAsText(a)}},g.click()},x=()=>{if(r.value)try{const g=JSON.stringify(r.value,null,2),i=new Blob([g],{type:"application/json"}),a=URL.createObjectURL(i),c=document.createElement("a");c.href=a,c.download=`model-${r.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(a),S(o("config.modelConfig.exportSuccess"),"success")}catch(g){S(o("config.modelConfig.exportFailed")+": "+g.message,"error")}};return be(()=>{j()}),(g,i)=>(d(),te(Ve,null,{title:G(()=>[e("h2",null,s(t(o)("config.modelConfig.title")),1)]),actions:G(()=>[e("button",{class:"action-btn",onClick:ae},[y(t(V),{icon:"carbon:upload"}),$(" "+s(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:x,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),$(" "+s(t(o)("config.modelConfig.export")),1)],8,wn)]),default:G(()=>[e("div",kn,[e("div",Sn,[e("div",Tn,[e("h3",null,s(t(o)("config.modelConfig.configuredModels")),1),e("span",Vn,"("+s(m.length)+")",1)]),n.value?D("",!0):(d(),u("div",Nn,[(d(!0),u(H,null,Y(m,a=>{var c;return d(),u("div",{key:a.id,class:ee(["model-card",{active:((c=r.value)==null?void 0:c.id)===a.id}]),onClick:_=>L(a)},[e("div",Un,[e("span",xn,s(a.modelName),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",Pn,s(a.modelDescription),1),a.type?(d(),u("div",En,[e("span",Dn,s(a.type),1)])):D("",!0)],10,An)}),128))])),n.value?(d(),u("div",Mn,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!n.value&&m.length===0?(d(),u("div",Rn,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.modelConfig.noModel")),1)])):D("",!0),e("button",{class:"add-btn",onClick:W},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.modelConfig.createNew")),1)])]),r.value?(d(),u("div",Ln,[e("div",Fn,[e("h3",null,s(r.value.modelName),1),e("div",Bn,[e("button",{class:"action-btn primary",onClick:U},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:R},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",In,[e("label",null,[$(s(t(o)("config.modelConfig.type"))+" ",1),i[15]||(i[15]=e("span",{class:"required"},"*",-1))]),y(xe,{modelValue:r.value.type,"onUpdate:modelValue":i[0]||(i[0]=a=>r.value.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",qn,[e("label",null,[$(s(t(o)("config.modelConfig.baseUrl"))+" ",1),i[16]||(i[16]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=a=>r.value.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,On),[[J,r.value.baseUrl]])]),e("div",Gn,[e("label",null,[$(s(t(o)("config.modelConfig.apiKey"))+" ",1),i[17]||(i[17]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[2]||(i[2]=a=>r.value.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,jn),[[J,r.value.apiKey]])]),e("div",Kn,[e("label",null,[$(s(t(o)("config.modelConfig.modelName"))+" ",1),i[18]||(i[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[3]||(i[3]=a=>r.value.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Jn),[[J,r.value.modelName]])]),e("div",zn,[e("label",null,[$(s(t(o)("config.modelConfig.description"))+" ",1),i[19]||(i[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=a=>r.value.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Hn),[[J,r.value.modelDescription]])])])):(d(),u("div",Yn,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.modelConfig.selectModelHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":i[10]||(i[10]=a=>k.value=a),title:t(o)("config.modelConfig.newModel"),onConfirm:I},{default:G(()=>[e("div",Wn,[e("div",Xn,[e("label",null,[$(s(t(o)("config.modelConfig.type"))+" ",1),i[20]||(i[20]=e("span",{class:"required"},"*",-1))]),y(xe,{modelValue:C.type,"onUpdate:modelValue":i[5]||(i[5]=a=>C.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Qn,[e("label",null,[$(s(t(o)("config.modelConfig.baseUrl"))+" ",1),i[21]||(i[21]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[6]||(i[6]=a=>C.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Zn),[[J,C.baseUrl]])]),e("div",ea,[e("label",null,[$(s(t(o)("config.modelConfig.apiKey"))+" ",1),i[22]||(i[22]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[7]||(i[7]=a=>C.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,oa),[[J,C.apiKey]])]),e("div",ta,[e("label",null,[$(s(t(o)("config.modelConfig.modelName"))+" ",1),i[23]||(i[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":i[8]||(i[8]=a=>C.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,sa),[[J,C.modelName]])]),e("div",na,[e("label",null,[$(s(t(o)("config.modelConfig.description"))+" ",1),i[24]||(i[24]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=a=>C.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,aa),[[J,C.modelDescription]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:N.value,"onUpdate:modelValue":i[12]||(i[12]=a=>N.value=a),title:"Delete confirmation"},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:i[11]||(i[11]=a=>N.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},s(t(o)("common.delete")),1)]),default:G(()=>{var a;return[e("div",la,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((a=r.value)==null?void 0:a.modelName),1),$(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",ia,s(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),p.value?(d(),u("div",{key:0,class:"error-toast",onClick:i[13]||(i[13]=a=>p.value="")},[y(t(V),{icon:"carbon:error"}),$(" "+s(p.value),1)])):D("",!0),v.value?(d(),u("div",{key:1,class:"success-toast",onClick:i[14]||(i[14]=a=>v.value="")},[y(t(V),{icon:"carbon:checkmark"}),$(" "+s(v.value),1)])):D("",!0)]),_:1}))}}),ra=ne(ca,[["__scopeId","data-v-2ee2eba1"]]);class Te{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to add MCP server: ${n.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(n){return console.error("Failed to add MCP server:",n),{success:!1,message:n instanceof Error?n.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!n.ok)throw new Error(`Failed to delete MCP server: ${n.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(n){return console.error(`Failed to delete MCP server[${o}]:`,n),{success:!1,message:n instanceof Error?n.message:"Failed to delete, please retry"}}}}me(Te,"BASE_URL","/api/mcp");const da={class:"mcp-config-panel"},ua={class:"mcp-header"},pa={class:"header-left"},fa={class:"mcp-stats"},ma={class:"stat-item"},ga={class:"stat-label"},ha={class:"stat-value"},va={class:"header-right"},ya={class:"search-box"},_a=["placeholder"],ba={key:0,class:"loading-container"},Ca={key:1,class:"mcp-layout"},$a={class:"mcp-table-container"},wa={class:"section-title"},ka={key:0,class:"empty-state"},Sa={class:"empty-state-text"},Ta={key:1,class:"mcp-table-wrapper"},Va={class:"mcp-table"},Na={class:"mcp-id"},Aa={class:"mcp-server-name"},Ua={class:"server-name-content"},xa={class:"mcp-connection-type"},Pa={class:"mcp-config"},Ea=["title"],Da={class:"mcp-actions"},Ma=["onClick","disabled"],Ra={class:"add-mcp-container"},La={class:"add-mcp-header"},Fa={class:"add-mcp-title"},Ba={class:"mcp-form"},Ia={class:"mcp-form-group"},qa={class:"form-label"},Oa={class:"connection-type-options"},Ga={class:"connection-type-option"},ja={for:"mcp-connection-type-studio",class:"radio-label"},Ka={class:"connection-type-desc"},Ja={class:"connection-type-option"},za={for:"mcp-connection-type-sse",class:"radio-label"},Ha={class:"connection-type-desc"},Ya={class:"connection-type-option"},Wa={for:"mcp-connection-type-streaming",class:"radio-label"},Xa={class:"connection-type-desc"},Qa={class:"mcp-form-group"},Za={class:"form-label"},el=["placeholder"],ol={class:"mcp-form-actions"},tl=["disabled"],sl=["disabled"],nl={class:"mcp-form-instructions"},al={class:"indented-list"},ll=se({__name:"mcpConfig",setup(M){const{t:o}=ge(),n=E(!1),p=E([]),v=E(""),m=oe({connectionType:"STUDIO",configJson:""}),h=oe({show:!1,text:"",type:"success"}),r=ie(()=>m.configJson.trim().length>0),k=ie(()=>{if(!v.value.trim())return p.value;const I=v.value.toLowerCase();return p.value.filter(U=>U.mcpServerName.toLowerCase().includes(I)||U.connectionType.toLowerCase().includes(I)||U.connectionConfig.toLowerCase().includes(I))}),N=I=>I?I.length>50?I.substring(0,50)+"...":I:"",C=(I,U="success")=>{h.text=I,h.type=U,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},S=async()=>{try{n.value=!0,p.value=await Te.getAllMcpServers()}catch(I){console.error("加载MCP服务器列表失败:",I),C(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},j=async()=>{if(!r.value){C(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(m.configJson)}catch{C(o("config.mcpConfig.invalidJson"),"error");return}try{n.value=!0;const I={connectionType:m.connectionType,configJson:m.configJson},U=await Te.addMcpServer(I);U.success?(C(o("config.mcpConfig.addSuccess")),W(),await S()):C(U.message||o("config.mcpConfig.addFailed"),"error")}catch(I){console.error("添加MCP服务器失败:",I),C(o("config.mcpConfig.addFailed"),"error")}finally{n.value=!1}},L=async I=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{n.value=!0;const U=await Te.removeMcpServer(I);U.success?(C(o("config.mcpConfig.deleteSuccess")),await S()):C(U.message||o("config.mcpConfig.deleteFailed"),"error")}catch(U){console.error("删除MCP服务器失败:",U),C(o("config.mcpConfig.deleteFailed"),"error")}finally{n.value=!1}},W=()=>{m.connectionType="STUDIO",m.configJson=""};return be(()=>{S()}),(I,U)=>(d(),u("div",da,[e("div",ua,[e("div",pa,[e("h2",null,s(t(o)("config.mcpConfig.title")),1),e("div",fa,[e("span",ma,[e("span",ga,s(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",ha,s(p.value.length),1)])])]),e("div",va,[e("div",ya,[O(e("input",{"onUpdate:modelValue":U[0]||(U[0]=R=>v.value=R),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,_a),[[J,v.value]]),U[5]||(U[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(d(),u("div",ba,[U[6]||(U[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(t(o)("config.loading")),1)])):(d(),u("div",Ca,[e("div",$a,[e("h3",wa,s(t(o)("config.mcpConfig.serverList")),1),k.value.length===0?(d(),u("div",ka,[U[7]||(U[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Sa,s(v.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(d(),u("div",Ta,[e("table",Va,[e("thead",null,[e("tr",null,[U[8]||(U[8]=e("th",null,"ID",-1)),e("th",null,s(t(o)("agent.name")),1),e("th",null,s(t(o)("config.mcpConfig.connectionType")),1),e("th",null,s(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,s(t(o)("common.actions")),1)])]),e("tbody",null,[(d(!0),u(H,null,Y(k.value,R=>(d(),u("tr",{key:R.id,class:"mcp-row"},[e("td",Na,s(R.id),1),e("td",Aa,[e("div",Ua,[U[9]||(U[9]=e("span",{class:"server-icon"},"🔌",-1)),$(" "+s(R.mcpServerName),1)])]),e("td",xa,[e("span",{class:ee(["connection-type-badge",R.connectionType.toLowerCase()])},s(R.connectionType),3)]),e("td",Pa,[e("div",{class:"config-preview",title:R.connectionConfig},s(N(R.connectionConfig)),9,Ea)]),e("td",Da,[e("button",{onClick:X=>L(R.id),class:"action-btn delete-btn",disabled:n.value},s(t(o)("common.delete")),9,Ma)])]))),128))])])]))]),e("div",Ra,[e("div",La,[e("h3",Fa,s(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",Ba,[e("div",Ia,[e("label",qa,s(t(o)("config.mcpConfig.connectionType"))+"：",1),e("div",Oa,[e("div",Ga,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":U[1]||(U[1]=R=>m.connectionType=R),value:"STUDIO"},null,512),[[Ue,m.connectionType]]),e("label",ja,[U[10]||(U[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",Ka,s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",Ja,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":U[2]||(U[2]=R=>m.connectionType=R),value:"SSE"},null,512),[[Ue,m.connectionType]]),e("label",za,[U[11]||(U[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Ha,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Ya,[O(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":U[3]||(U[3]=R=>m.connectionType=R),value:"STREAMING"},null,512),[[Ue,m.connectionType]]),e("label",Wa,[U[12]||(U[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",Xa,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",Qa,[e("label",Za,s(t(o)("config.mcpConfig.configJsonLabel")),1),O(e("textarea",{"onUpdate:modelValue":U[4]||(U[4]=R=>m.configJson=R),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,el),[[J,m.configJson]])]),e("div",ol,[e("button",{onClick:j,class:"action-btn add-btn",disabled:n.value},s(t(o)("common.add")),9,tl),e("button",{onClick:W,class:"action-btn reset-btn",disabled:n.value},s(t(o)("common.reset")),9,sl)])]),e("div",nl,[e("h4",null,s(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[$(s(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",al,[e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Local")),1),$("："+s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Remote")),1),$("："+s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,s(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),y(Ce,{name:"message-fade"},{default:G(()=>[h.show?(d(),u("div",{key:0,class:ee(["message-toast",h.type])},s(h.text),3)):D("",!0)]),_:1})]))}}),il=ne(ll,[["__scopeId","data-v-355da8bb"]]);class ve{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to get Prompt list:",n),n}}static async getPromptById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,n),n}}static async createPrompt(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Prompt:",n),n}}static async updatePrompt(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Prompt[${o}]:`,p),p}}static async deletePrompt(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Prompt[${o}]:`,n),n}}}me(ve,"BASE_URL","/api/prompt");const cl=se({__name:"Toast",setup(M,{expose:o}){const n=E(!1),p=E(""),v=E("success"),m=E("carbon:checkmark"),h=E(3e3),r=(N,C="success",S=3e3)=>{p.value=N,v.value=C,m.value=C==="success"?"carbon:checkmark":"carbon:error",h.value=S,n.value=!0,setTimeout(()=>{n.value=!1},h.value)},k=()=>{n.value=!1};return o({show:r}),(N,C)=>(d(),te(Re,{to:"body"},[y(Ce,{name:"slide"},{default:G(()=>[n.value?(d(),u("div",{key:0,class:ee(["toast",`toast--${v.value}`]),onClick:k},[y(t(V),{icon:m.value,class:"toast-icon"},null,8,["icon"]),e("span",null,s(p.value),1)],2)):D("",!0)]),_:1})]))}}),rl=ne(cl,[["__scopeId","data-v-581895ae"]]);let pe=null;const Le=()=>{if(!pe){const M=Je(rl),o=document.createElement("div");document.body.appendChild(o),pe=M.mount(o)}return{success:(M,o)=>{pe==null||pe.show(M,"success",o)},error:(M,o)=>{pe==null||pe.show(M,"error",o)}}},dl={class:"custom-select"},ul=["title"],pl={key:0,class:"current-option"},fl={class:"option-name"},ml={key:1,class:"current-option"},gl={class:"select-options"},hl=["onClick"],vl={class:"option-name"},yl=se({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(M,{emit:o}){const n=M,p=o,v=E(!1),m=ie(()=>n.options.find(N=>N.id===n.modelValue)),h=N=>N.id===n.modelValue,r=()=>{v.value=!v.value},k=N=>{p("update:modelValue",N.id),v.value=!1};return(N,C)=>(d(),u("div",dl,[e("button",{class:"select-btn",onClick:r,title:N.placeholder},[m.value?(d(),u("span",pl,[e("span",fl,s(m.value.name),1)])):(d(),u("span",ml,s(N.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,ul),y(Ce,{name:"slideDown"},{default:G(()=>[O(e("div",{class:"select-dropdown",onClick:C[0]||(C[0]=_e(()=>{},["stop"]))},[e("div",gl,[(d(!0),u(H,null,Y(N.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:j=>k(S)},[e("span",vl,s(S.name),1),h(S)?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):D("",!0)],10,hl))),128))])],512),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[1]||(C[1]=S=>v.value=!1)})):D("",!0)]))}}),Se=ne(yl,[["__scopeId","data-v-4c6d676f"]]),_l={class:"prompt-layout"},bl={class:"prompt-list"},Cl={class:"list-header"},$l={class:"prompt-count"},wl={key:0,class:"prompts-container"},kl=["onClick"],Sl={class:"prompt-card-header"},Tl={class:"prompt-name"},Vl={key:0,class:"prompt-desc"},Nl={class:"tags"},Al={class:"tag"},Ul={key:1,class:"loading-state"},xl={key:2,class:"empty-state"},Pl={key:0,class:"prompt-detail"},El={class:"detail-header"},Dl={class:"detail-actions"},Ml={class:"form-item"},Rl=["placeholder"],Ll={class:"form-item"},Fl={class:"form-item"},Bl={class:"form-item"},Il=["placeholder"],ql={class:"form-item"},Ol=["placeholder"],Gl={key:1,class:"no-selection"},jl={class:"modal-form"},Kl={class:"form-item"},Jl=["placeholder"],zl={class:"form-item"},Hl={class:"form-item"},Yl={class:"form-item"},Wl=["placeholder"],Xl={class:"form-item"},Ql=["placeholder"],Zl={class:"delete-confirm"},ei={class:"warning-text"},oi=se({__name:"dynamicPromptConfig",setup(M){const{t:o}=ge(),{success:n,error:p}=Le(),v=Ee(),m=E(!1),h=oe([]),r=E(null),k=E(!1),N=E(!1),C=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],S=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],j={promptName:"",messageType:"",type:"",promptDescription:""},L=oe({...j}),W=async()=>{m.value=!0;try{const a=await ve.getAllPrompts(v.namespace);a.length>0&&await I(a[0]),h.splice(0,h.length,...a)}catch(a){console.error("加载数据失败:",a),p(o("config.promptConfig.loadDataFailed")+": "+a.message)}finally{m.value=!1}},I=async a=>{try{const c=await ve.getPromptById(a.id);r.value={...c}}catch(c){console.error("加载Prompt详情失败:",c),p(o("config.promptConfig.loadDetailsFailed")+": "+c.message),r.value={...a}}},U=async()=>{if(ae(L))try{const a={...L,builtIn:!1},c=await ve.createPrompt(a);h.push(c),r.value=c,k.value=!1,n(o("config.promptConfig.createSuccess"))}catch(a){p(o("config.promptConfig.createFailed")+": "+a.message)}},R=async()=>{if(r.value&&ae(r.value))try{const a=await ve.updatePrompt(r.value.id,r.value),c=h.findIndex(_=>_.id===a.id);c!==-1&&(h[c]=a),r.value={...a},n(o("config.promptConfig.saveSuccess"))}catch(a){p(o("config.promptConfig.saveFailed")+": "+a.message)}},X=async()=>{if(r.value)try{await ve.deletePrompt(r.value.id);const a=h.findIndex(c=>c.id===r.value.id);a!==-1&&h.splice(a,1),r.value=h.length>0?h[0]:null,N.value=!1,n(o("config.promptConfig.deleteSuccess"))}catch(a){p(o("config.promptConfig.deleteFailed")+": "+a.message)}};function ae(a){const c=["promptName","messageType","type","promptContent"];for(const F of c){const z=a[F];if(z==null||typeof z=="string"&&z.trim()==="")return p(`${F} is required and cannot be empty`),!1}return!!x(h,a)}function x(a,c){const _=a.find(F=>F.promptName===c.promptName);return _&&c.id&&_.id!==c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):_&&!c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):!0}const g=()=>{L.promptName="",L.promptDescription="",L.promptContent="",Object.assign(L,j),k.value=!0},i=()=>{N.value=!0};return be(()=>{W()}),(a,c)=>(d(),te(Ve,null,{title:G(()=>[e("h2",null,s(t(o)("config.promptConfig.title")),1)]),default:G(()=>[e("div",_l,[e("div",bl,[e("div",Cl,[e("h3",null,s(t(o)("config.promptConfig.configuredprompts")),1),e("span",$l,"("+s(h.length)+s(t(o)("config.promptConfig.promptCount"))+")",1)]),m.value?D("",!0):(d(),u("div",wl,[(d(!0),u(H,null,Y(h,_=>{var F,z;return d(),u("div",{key:_.id,class:ee(["prompt-card",{active:((F=r.value)==null?void 0:F.id)===_.id}]),onClick:le=>I(_)},[e("div",Sl,[e("span",Tl,s(_.promptName),1),y(t(V),{icon:"carbon:chevron-right"})]),(z=_.promptDescription)!=null&&z.trim()?(d(),u("p",Vl,s(_.promptDescription),1)):D("",!0),e("div",Nl,[e("span",Al,s(_.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,kl)}),128))])),m.value?(d(),u("div",Ul,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!m.value&&h.length===0?(d(),u("div",xl,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.promptConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:g},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.promptConfig.createNew")),1)])]),r.value?(d(),u("div",Pl,[e("div",El,[e("h3",null,s(r.value.promptName),1),e("div",Dl,[e("button",{class:"action-btn primary",onClick:R},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),r.value.builtIn?D("",!0):(d(),u("button",{key:0,class:"action-btn danger",onClick:i},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)]))])]),e("div",Ml,[e("label",null,[$(s(t(o)("config.promptConfig.promptName"))+" ",1),c[15]||(c[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":c[0]||(c[0]=_=>r.value.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Rl),[[J,r.value.promptName]])]),e("div",Ll,[e("label",null,[$(s(t(o)("config.promptConfig.messageType"))+" ",1),c[16]||(c[16]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[2]||(c[2]=_=>r.value.messageType=_),disabled:!0},null,512)),[[J,r.value.messageType]]):(d(),te(Se,{key:0,modelValue:r.value.messageType,"onUpdate:modelValue":c[1]||(c[1]=_=>r.value.messageType=_),options:C,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Fl,[e("label",null,[$(s(t(o)("config.promptConfig.type"))+" ",1),c[17]||(c[17]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[4]||(c[4]=_=>r.value.type=_),disabled:!0,required:""},null,512)),[[J,r.value.type]]):(d(),te(Se,{key:0,modelValue:r.value.type,"onUpdate:modelValue":c[3]||(c[3]=_=>r.value.type=_),options:S,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Bl,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=_=>r.value.promptDescription=_),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Il),[[J,r.value.promptDescription]])]),e("div",ql,[e("label",null,[$(s(t(o)("config.promptConfig.promptContent"))+" ",1),c[18]||(c[18]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[6]||(c[6]=_=>r.value.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Ol),[[J,r.value.promptContent]])])])):(d(),u("div",Gl,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.promptConfig.selectPromptHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":c[12]||(c[12]=_=>k.value=_),title:t(o)("config.promptConfig.newPrompt"),onConfirm:U},{default:G(()=>[e("div",jl,[e("div",Kl,[e("label",null,[$(s(t(o)("config.promptConfig.promptName"))+" ",1),c[19]||(c[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[7]||(c[7]=_=>L.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,Jl),[[J,L.promptName]])]),e("div",zl,[e("label",null,[$(s(t(o)("config.promptConfig.messageType"))+" ",1),c[20]||(c[20]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:L.messageType,"onUpdate:modelValue":c[8]||(c[8]=_=>L.messageType=_),options:C,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Hl,[e("label",null,[$(s(t(o)("config.promptConfig.type"))+" ",1),c[21]||(c[21]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:L.type,"onUpdate:modelValue":c[9]||(c[9]=_=>L.type=_),options:S,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Yl,[e("label",null,s(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[10]||(c[10]=_=>L.promptDescription=_),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,Wl),[[J,L.promptDescription]])]),e("div",Xl,[e("label",null,[$(s(t(o)("config.promptConfig.promptContent"))+" ",1),c[22]||(c[22]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[11]||(c[11]=_=>L.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Ql),[[J,L.promptContent]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:N.value,"onUpdate:modelValue":c[14]||(c[14]=_=>N.value=_),title:t(o)("config.promptConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:c[13]||(c[13]=_=>N.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:X},s(t(o)("common.delete")),1)]),default:G(()=>{var _;return[e("div",Zl,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,s((_=r.value)==null?void 0:_.promptName),1),$(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",ei,s(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),ti=ne(oi,[["__scopeId","data-v-697ad7ba"]]);class ye{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Namespace[${o}] details:`,n),n}}static async createNamespace(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Namespace:",n),n}}static async updateNamespace(o,n){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Namespace[${o}]:`,p),p}}static async deleteNamespace(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Namespace[${o}]:`,n),n}}}me(ye,"BASE_URL","/api/namespace");const si={class:"namespace-layout"},ni={class:"namespace-list"},ai={class:"list-header"},li={key:0,class:"namespaces-container"},ii=["onClick"],ci={class:"namespace-card-header"},ri={class:"namespace-name"},di={key:0,class:"loading-state"},ui={key:1,class:"empty-state"},pi={key:0,class:"namespace-detail"},fi={class:"detail-header"},mi={class:"detail-actions"},gi={class:"form-item"},hi=["placeholder"],vi={key:1,class:"no-selection"},yi={class:"modal-form"},_i={class:"form-item"},bi=["placeholder"],Ci={class:"delete-confirm"},$i={class:"warning-text"},wi=se({__name:"namespaceConfig",setup(M){const{t:o}=ge(),{success:n,error:p}=Le(),v=E(!1),m=oe([]),h=E(null),r=E(!1),k=E(!1),N={name:""},C=oe({...N}),S=async()=>{v.value=!0;try{const x=await ye.getAllNamespaces();x.length>0&&await j(x[0]),m.splice(0,m.length,...x)}catch(x){console.error("加载数据失败:",x),p(o("config.namespaceConfig.loadDataFailed")+": "+x.message)}finally{v.value=!1}},j=async x=>{try{const g=await ye.getNamespaceById(x.id);h.value={...g}}catch(g){console.error("加载Prompt详情失败:",g),p(o("config.namespaceConfig.loadDetailsFailed")+": "+g.message),h.value={...x}}},L=async()=>{if(U(C))try{const x={...C},g=await ye.createNamespace(x);m.push(g),h.value=g,r.value=!1,n(o("config.namespaceConfig.createSuccess"))}catch(x){p(o("config.namespaceConfig.createFailed")+": "+x.message)}},W=async()=>{if(h.value&&U(h.value))try{const x=await ye.updateNamespace(h.value.id,h.value),g=m.findIndex(i=>i.id===x.id);g!==-1&&(m[g]=x),h.value={...x},n(o("config.namespaceConfig.saveSuccess"))}catch(x){p(o("config.namespaceConfig.saveFailed")+": "+x.message)}},I=async()=>{if(h.value)try{await ye.deleteNamespace(h.value.id);const x=m.findIndex(g=>g.id===h.value.id);x!==-1&&m.splice(x,1),h.value=m.length>0?m[0]:null,k.value=!1,n(o("config.namespaceConfig.deleteSuccess"))}catch(x){p(o("config.namespaceConfig.deleteFailed")+": "+x.message)}};function U(x){const g=["name"];for(const a of g){const c=x[a];if(c==null||typeof c=="string"&&c.trim()==="")return p(`${a} is required and cannot be empty`),!1}return!!R(m,x)}function R(x,g){const i=x.find(a=>a.name===g.name);return i&&g.id&&i.id!==g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):i&&!g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):!0}const X=()=>{C.name="",Object.assign(C,N),r.value=!0},ae=()=>{k.value=!0};return be(()=>{S()}),(x,g)=>(d(),te(Ve,null,{title:G(()=>[e("h2",null,s(t(o)("config.namespaceConfig.title")),1)]),default:G(()=>[e("div",si,[e("div",ni,[e("div",ai,[e("h3",null,s(t(o)("config.namespaceConfig.configured")),1)]),v.value?D("",!0):(d(),u("div",li,[(d(!0),u(H,null,Y(m,i=>{var a;return d(),u("div",{key:i.id,class:ee(["namespace-card",{active:((a=h.value)==null?void 0:a.id)===i.id}]),onClick:c=>j(i)},[e("div",ci,[e("span",ri,s(i.name),1),y(t(V),{icon:"carbon:chevron-right"})])],10,ii)}),128))]))]),v.value?(d(),u("div",di,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),$(" "+s(t(o)("common.loading")),1)])):D("",!0),!v.value&&m.length===0?(d(),u("div",ui,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.namespaceConfig.noPrompts")),1)])):D("",!0),e("button",{class:"add-btn",onClick:X},[y(t(V),{icon:"carbon:add"}),$(" "+s(t(o)("config.namespaceConfig.createNew")),1)])]),h.value?(d(),u("div",pi,[e("div",fi,[e("h3",null,s(h.value.name),1),e("div",mi,[e("button",{class:"action-btn primary",onClick:W},[y(t(V),{icon:"carbon:save"}),$(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:ae},[y(t(V),{icon:"carbon:trash-can"}),$(" "+s(t(o)("common.delete")),1)])])]),e("div",gi,[e("label",null,[$(s(t(o)("config.namespaceConfig.name"))+" ",1),g[5]||(g[5]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":g[0]||(g[0]=i=>h.value.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,hi),[[J,h.value.name]])])])):(d(),u("div",vi,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.namespaceConfig.selectPromptHint")),1)])),y(de,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=i=>r.value=i),title:t(o)("config.namespaceConfig.newPrompt"),onConfirm:L},{default:G(()=>[e("div",yi,[e("div",_i,[e("label",null,[$(s(t(o)("config.namespaceConfig.name"))+" ",1),g[6]||(g[6]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":g[1]||(g[1]=i=>C.name=i),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,bi),[[J,C.name]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:k.value,"onUpdate:modelValue":g[4]||(g[4]=i=>k.value=i),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:G(()=>[e("button",{class:"cancel-btn",onClick:g[3]||(g[3]=i=>k.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:I},s(t(o)("common.delete")),1)]),default:G(()=>{var i;return[e("div",Ci,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[$(s(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((i=h.value)==null?void 0:i.name),1),$(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",$i,s(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),ki=ne(wi,[["__scopeId","data-v-d0b2912a"]]),Si=se({__name:"namespaceSwitch",setup(M){const{namespace:o,setNamespace:n,db:p}=Ee(),v=m=>{n(m)};return(m,h)=>(d(),u("div",null,[y(xe,{modelValue:t(o),"onUpdate:modelValue":h[0]||(h[0]=r=>ze(o)?o.value=r:null),options:t(p),"dropdown-title":"命名空间",onChange:v,placeholder:"请选择命名空间",direction:"right",dropStyles:{minWidth:"180px"}},null,8,["modelValue","options"])]))}}),Ti={class:"config-container"},Vi={class:"config-header"},Ni={class:"header-actions"},Ai={class:"header-actions-left"},Ui={class:"header-actions-right"},xi={class:"config-content"},Pi={class:"config-nav"},Ei=["onClick"],Di={class:"config-details"},Mi=se({__name:"index",setup(M){const{t:o}=ge(),n=He(),p=We(),v=E(n.params.category||"basic"),m={basic:Me,agent:pn,model:ra,mcp:il,prompt:ti,namespace:ki},h=ie(()=>{const N=v.value;return m[N]||Me}),r=ie(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",disabled:!0,icon:"carbon:repo-artifact"}]),k=N=>{v.value=N,p.push({name:n.name,params:{...n.params,category:N},query:n.query})};return(N,C)=>(d(),u("div",Ti,[e("div",Vi,[e("div",Ni,[e("div",Ai,[e("button",{class:"action-btn",onClick:C[0]||(C[0]=S=>N.$router.push("/"))},[y(t(V),{icon:"carbon:arrow-left"}),$(" "+s(N.$t("backHome")),1)]),y(Xe)]),e("div",Ui,[y(Si)])])]),e("div",xi,[e("nav",Pi,[(d(!0),u(H,null,Y(r.value,(S,j)=>(d(),u(H,null,[S.disabled?D("",!0):(d(),u("div",{key:j,class:ee(["nav-item",{active:v.value===S.key}]),onClick:L=>k(S.key)},[y(t(V),{icon:S.icon,width:"20"},null,8,["icon"]),e("span",null,s(S.label),1)],10,Ei))],64))),256))]),e("div",Di,[(d(),te(Ye(h.value)))])])]))}}),Ii=ne(Mi,[["__scopeId","data-v-5d4a51b7"]]);export{Ii as default};
