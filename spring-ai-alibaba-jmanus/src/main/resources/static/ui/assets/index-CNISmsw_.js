import{d as w,u as D,r as f,c as C,o as V,a as d,b as r,e,f as g,t as l,w as S,g as p,n as _,h as u,v as N,i as c,j as v,k as M,T as $,F as L,l as I,m as T}from"./index-CAWKw5pS.js";import{L as R}from"./llm-check-D2idVWhZ.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"init-container"},F={class:"init-card"},j={class:"init-header"},z={class:"description"},B={class:"init-form"},H={class:"form-group"},E={class:"form-label"},J={class:"config-mode-selection"},O={class:"radio-text"},G={class:"radio-text"},Q={key:0,class:"form-group"},W={for:"apiKey",class:"form-label"},X=["placeholder","disabled"],Y={class:"form-hint"},Z={href:"https://bailian.console.aliyun.com/?tab=model#/api-key",target:"_blank",class:"help-link"},x={key:1,class:"custom-config-section"},ee={class:"form-group"},se={for:"baseUrl",class:"form-label"},ae=["placeholder","disabled"],oe={class:"form-hint"},ie={class:"form-group"},le={for:"customApiKey",class:"form-label"},te=["placeholder","disabled"],ne={class:"form-group"},de={for:"modelName",class:"form-label"},re=["placeholder","disabled"],ue={class:"form-hint"},me={class:"form-group"},ce={for:"modelDisplayName",class:"form-label"},pe=["placeholder","disabled"],ve={class:"form-actions"},fe=["disabled"],he={key:0,class:"loading-spinner"},be={key:0,class:"error-message"},ye={key:0,class:"success-message"},ge={class:"background-animation"},_e=w({__name:"index",setup(Ne){const{t:m}=D(),h=T(),s=f({configMode:"dashscope",apiKey:"",baseUrl:"",modelName:"",modelDisplayName:""}),t=f(!1),n=f(""),b=f(!1),K=C(()=>s.value.apiKey.trim()?s.value.configMode==="custom"?s.value.baseUrl.trim()&&s.value.modelName.trim():!0:!1),y=()=>{s.value.apiKey="",s.value.baseUrl="",s.value.modelName="",s.value.modelDisplayName="",n.value=""},U=()=>{if(!s.value.apiKey.trim())return n.value=m("init.apiKeyRequired"),!1;if(s.value.configMode==="custom"){if(!s.value.baseUrl.trim())return n.value=m("init.baseUrlRequired"),!1;if(!s.value.modelName.trim())return n.value=m("init.modelNameRequired"),!1}return!0},k=async()=>{if(U())try{t.value=!0,n.value="";const a={configMode:s.value.configMode,apiKey:s.value.apiKey.trim()};s.value.configMode==="custom"&&(a.baseUrl=s.value.baseUrl.trim(),a.modelName=s.value.modelName.trim(),a.modelDisplayName=s.value.modelDisplayName.trim()||s.value.modelName.trim());const i=await(await fetch("/api/init/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();i.success?(b.value=!0,localStorage.setItem("hasInitialized","true"),localStorage.setItem("hasVisitedHome","true"),R.clearCache(),i.requiresRestart?setTimeout(()=>{confirm(m("init.restartRequired"))?window.location.reload():h.push("/home")},2e3):setTimeout(()=>{h.push("/home")},2e3)):n.value=i.error||m("init.saveFailed")}catch(a){console.error("Save config failed:",a),n.value=m("init.networkError")}finally{t.value=!1}},q=async()=>{try{const o=await(await fetch("/api/init/status")).json();o.success&&o.initialized&&(localStorage.setItem("hasInitialized","true"),h.push("/home"))}catch(a){console.error("Check init status failed:",a)}};return V(()=>{q()}),(a,o)=>(r(),d("div",P,[e("div",F,[e("div",j,[o[7]||(o[7]=e("div",{class:"logo"},[e("h1",null,"ðŸ¤– JManus")],-1)),e("h2",null,l(a.$t("init.welcome")),1),e("p",z,l(a.$t("init.description")),1)]),e("div",B,[e("form",{onSubmit:S(k,["prevent"])},[e("div",H,[e("label",E,l(a.$t("init.configModeLabel")),1),e("div",J,[e("label",{class:_(["radio-option",{active:s.value.configMode==="dashscope"}])},[u(e("input",{type:"radio","onUpdate:modelValue":o[0]||(o[0]=i=>s.value.configMode=i),value:"dashscope",onChange:y},null,544),[[N,s.value.configMode]]),e("span",O,[e("strong",null,l(a.$t("init.dashscopeMode")),1),e("small",null,l(a.$t("init.dashscopeModeDesc")),1)])],2),e("label",{class:_(["radio-option",{active:s.value.configMode==="custom"}])},[u(e("input",{type:"radio","onUpdate:modelValue":o[1]||(o[1]=i=>s.value.configMode=i),value:"custom",onChange:y},null,544),[[N,s.value.configMode]]),e("span",G,[e("strong",null,l(a.$t("init.customMode")),1),e("small",null,l(a.$t("init.customModeDesc")),1)])],2)])]),s.value.configMode==="dashscope"?(r(),d("div",Q,[e("label",W,[c(l(a.$t("init.apiKeyLabel"))+" ",1),o[8]||(o[8]=e("span",{class:"required"},"*",-1))]),u(e("input",{id:"apiKey","onUpdate:modelValue":o[2]||(o[2]=i=>s.value.apiKey=i),type:"password",class:"form-input",placeholder:a.$t("init.apiKeyPlaceholder"),disabled:t.value,required:""},null,8,X),[[v,s.value.apiKey]]),e("div",Y,[c(l(a.$t("init.apiKeyHint"))+" ",1),e("a",Z,l(a.$t("init.getApiKey")),1)])])):p("",!0),s.value.configMode==="custom"?(r(),d("div",x,[e("div",ee,[e("label",se,[c(l(a.$t("init.baseUrlLabel"))+" ",1),o[9]||(o[9]=e("span",{class:"required"},"*",-1))]),u(e("input",{id:"baseUrl","onUpdate:modelValue":o[3]||(o[3]=i=>s.value.baseUrl=i),type:"url",class:"form-input",placeholder:a.$t("init.baseUrlPlaceholder"),disabled:t.value,required:""},null,8,ae),[[v,s.value.baseUrl]]),e("div",oe,l(a.$t("init.baseUrlHint")),1)]),e("div",ie,[e("label",le,[c(l(a.$t("init.customApiKeyLabel"))+" ",1),o[10]||(o[10]=e("span",{class:"required"},"*",-1))]),u(e("input",{id:"customApiKey","onUpdate:modelValue":o[4]||(o[4]=i=>s.value.apiKey=i),type:"password",class:"form-input",placeholder:a.$t("init.customApiKeyPlaceholder"),disabled:t.value,required:""},null,8,te),[[v,s.value.apiKey]])]),e("div",ne,[e("label",de,[c(l(a.$t("init.modelNameLabel"))+" ",1),o[11]||(o[11]=e("span",{class:"required"},"*",-1))]),u(e("input",{id:"modelName","onUpdate:modelValue":o[5]||(o[5]=i=>s.value.modelName=i),type:"text",class:"form-input",placeholder:a.$t("init.modelNamePlaceholder"),disabled:t.value,required:""},null,8,re),[[v,s.value.modelName]]),e("div",ue,l(a.$t("init.modelNameHint")),1)]),e("div",me,[e("label",ce,l(a.$t("init.modelDisplayNameLabel")),1),u(e("input",{id:"modelDisplayName","onUpdate:modelValue":o[6]||(o[6]=i=>s.value.modelDisplayName=i),type:"text",class:"form-input",placeholder:a.$t("init.modelDisplayNamePlaceholder"),disabled:t.value},null,8,pe),[[v,s.value.modelDisplayName]])])])):p("",!0),e("div",ve,[e("button",{type:"submit",class:"submit-btn",disabled:t.value||!K.value},[t.value?(r(),d("span",he)):p("",!0),c(" "+l(t.value?a.$t("init.saving"):a.$t("init.saveAndContinue")),1)],8,fe)])],32)]),g($,{name:"error-fade"},{default:M(()=>[n.value?(r(),d("div",be,l(n.value),1)):p("",!0)]),_:1}),g($,{name:"success-fade"},{default:M(()=>[b.value?(r(),d("div",ye,l(a.$t("init.successMessage")),1)):p("",!0)]),_:1})]),e("div",ge,[(r(),d(L,null,I(6,i=>e("div",{class:"floating-shape",key:i})),64))]),o[12]||(o[12]=e("div",{class:"background-effects"},[e("div",{class:"gradient-orb orb-1"}),e("div",{class:"gradient-orb orb-2"}),e("div",{class:"gradient-orb orb-3"})],-1))]))}}),Ue=A(_e,[["__scopeId","data-v-2e6fb342"]]);export{Ue as default};
