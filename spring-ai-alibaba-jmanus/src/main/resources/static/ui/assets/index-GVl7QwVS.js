import{d as I,u as R,r as m,c as z,o as P,L as E,a as n,b as d,e,f as v,g as U,t as l,n as h,w as c,v as _,h as F,i as y,j as w,k,l as C,T as L,F as O,m as j,p as B,q as H}from"./index-BCRkYqpX.js";import{L as J}from"./llm-check-BVkAKrj3.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"init-container"},Q={class:"init-card"},X={class:"init-header"},Y={class:"description"},Z={class:"step-indicator"},x={class:"step-label"},ee={class:"step-label"},se={key:0,class:"init-form language-selection"},ae={class:"form-group"},te={class:"form-label"},le={class:"language-options"},ie={class:"language-content"},oe={class:"language-text"},ne={class:"form-actions single"},de=["disabled"],ue={key:1,class:"init-form"},re={class:"form-group"},pe={class:"form-label"},ce={class:"config-mode-selection"},me={class:"radio-text"},ve={class:"radio-text"},fe={key:0,class:"form-group"},ge={for:"apiKey",class:"form-label"},be={class:"api-key-input-container"},he=["type","placeholder","disabled"],ye=["title"],_e={key:0},$e={key:1},ke={class:"form-hint"},Ne={href:"https://bailian.console.aliyun.com/?tab=model#/api-key",target:"_blank",class:"help-link"},Me={key:1,class:"custom-config-section"},Ke={class:"form-group"},Ue={for:"baseUrl",class:"form-label"},we=["placeholder","disabled"],Ce={class:"form-hint"},Le={class:"form-group"},Se={for:"customApiKey",class:"form-label"},De={class:"api-key-input-container"},Ae=["type","placeholder","disabled"],qe=["title"],Ve={key:0},Te={key:1},Ie={class:"form-group"},Re={for:"modelName",class:"form-label"},ze=["placeholder","disabled"],Pe={class:"form-hint"},Ee={class:"form-group"},Fe={for:"modelDisplayName",class:"form-label"},Oe=["placeholder","disabled"],je={class:"form-actions"},Be=["disabled"],He=["disabled"],Je={key:0,class:"loading-spinner"},Ge={key:0,class:"error-message"},We={key:0,class:"success-message"},Qe={class:"background-animation"},Xe=I({__name:"index",setup(Ye){const{t:f,locale:N}=R(),$=H(),u=m(1),r=m(N.value||"en"),t=m({configMode:"dashscope",apiKey:"",baseUrl:"",modelName:"",modelDisplayName:""}),o=m(!1),p=m(""),M=m(!1),g=m(!1),b=m(!1),S=z(()=>t.value.apiKey.trim()?t.value.configMode==="custom"?t.value.baseUrl.trim()&&t.value.modelName.trim():!0:!1),D=async()=>{if(r.value)try{o.value=!0,await B(r.value),u.value=2}catch(s){console.warn("Failed to switch language:",s),u.value=2}finally{o.value=!1}},A=()=>{u.value=1},K=()=>{t.value.apiKey="",t.value.baseUrl="",t.value.modelName="",t.value.modelDisplayName="",p.value="",g.value=!1,b.value=!1},q=()=>{if(!t.value.apiKey.trim())return p.value=f("init.apiKeyRequired"),!1;if(t.value.configMode==="custom"){if(!t.value.baseUrl.trim())return p.value=f("init.baseUrlRequired"),!1;if(!t.value.modelName.trim())return p.value=f("init.modelNameRequired"),!1}return!0},V=async()=>{if(q())try{o.value=!0,p.value="";const s={configMode:t.value.configMode,apiKey:t.value.apiKey.trim()};t.value.configMode==="custom"&&(s.baseUrl=t.value.baseUrl.trim(),s.modelName=t.value.modelName.trim(),s.modelDisplayName=t.value.modelDisplayName.trim()||t.value.modelName.trim());const i=await(await fetch("/api/init/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();i.success?(M.value=!0,localStorage.setItem("hasInitialized","true"),localStorage.setItem("hasVisitedHome","true"),J.clearCache(),i.requiresRestart?setTimeout(()=>{confirm(f("init.restartRequired"))?window.location.reload():$.push("/home")},2e3):setTimeout(()=>{$.push("/home")},2e3)):p.value=i.error||f("init.saveFailed")}catch(s){console.error("Save config failed:",s),p.value=f("init.networkError")}finally{o.value=!1}},T=async()=>{try{const a=await(await fetch("/api/init/status")).json();a.success&&a.initialized&&(localStorage.setItem("hasInitialized","true"),$.push("/home"))}catch(s){console.error("Check init status failed:",s)}};return P(()=>{const s=localStorage.getItem(E);s&&(s==="zh"||s==="en")&&(r.value=s,N.value=s),T()}),(s,a)=>(d(),n("div",W,[e("div",Q,[e("div",X,[a[11]||(a[11]=e("div",{class:"logo"},[e("h1",null,"🤖 JManus")],-1)),e("h2",null,l(u.value===1?s.$t("init.welcomeStep"):s.$t("init.welcome")),1),e("p",Y,l(u.value===1?s.$t("init.languageStepDescription"):s.$t("init.description")),1)]),e("div",Z,[e("div",{class:h(["step",{active:u.value>=1,completed:u.value>1}])},[a[12]||(a[12]=e("span",{class:"step-number"},"1",-1)),e("span",x,l(s.$t("init.stepLanguage")),1)],2),a[14]||(a[14]=e("div",{class:"step-divider"},null,-1)),e("div",{class:h(["step",{active:u.value>=2,completed:u.value>2}])},[a[13]||(a[13]=e("span",{class:"step-number"},"2",-1)),e("span",ee,l(s.$t("init.stepModel")),1)],2)]),u.value===1?(d(),n("div",se,[e("div",ae,[e("label",te,l(s.$t("init.selectLanguageLabel")),1),e("div",le,[e("label",{class:h(["language-option",{active:r.value==="zh"}])},[c(e("input",{type:"radio","onUpdate:modelValue":a[0]||(a[0]=i=>r.value=i),value:"zh"},null,512),[[_,r.value]]),e("span",ie,[a[15]||(a[15]=e("span",{class:"language-flag"},"🇨🇳",-1)),e("span",oe,[e("strong",null,l(s.$t("language.zh")),1),e("small",null,l(s.$t("init.simplifiedChinese")),1)])])],2),e("label",{class:h(["language-option",{active:r.value==="en"}])},[c(e("input",{type:"radio","onUpdate:modelValue":a[1]||(a[1]=i=>r.value=i),value:"en"},null,512),[[_,r.value]]),a[16]||(a[16]=e("span",{class:"language-content"},[e("span",{class:"language-flag"},"🇺🇸"),e("span",{class:"language-text"},[e("strong",null,"English"),e("small",null,"English (US)")])],-1))],2)])]),e("div",ne,[e("button",{type:"button",class:"submit-btn",disabled:!r.value,onClick:D},l(s.$t("init.continueToModel")),9,de)])])):v("",!0),u.value===2?(d(),n("div",ue,[e("form",{onSubmit:F(V,["prevent"])},[e("div",re,[e("label",pe,l(s.$t("init.configModeLabel")),1),e("div",ce,[e("label",{class:h(["radio-option",{active:t.value.configMode==="dashscope"}])},[c(e("input",{type:"radio","onUpdate:modelValue":a[2]||(a[2]=i=>t.value.configMode=i),value:"dashscope",onChange:K},null,544),[[_,t.value.configMode]]),e("span",me,[e("strong",null,l(s.$t("init.dashscopeMode")),1),e("small",null,l(s.$t("init.dashscopeModeDesc")),1)])],2),e("label",{class:h(["radio-option",{active:t.value.configMode==="custom"}])},[c(e("input",{type:"radio","onUpdate:modelValue":a[3]||(a[3]=i=>t.value.configMode=i),value:"custom",onChange:K},null,544),[[_,t.value.configMode]]),e("span",ve,[e("strong",null,l(s.$t("init.customMode")),1),e("small",null,l(s.$t("init.customModeDesc")),1)])],2)])]),t.value.configMode==="dashscope"?(d(),n("div",fe,[e("label",ge,[y(l(s.$t("init.apiKeyLabel"))+" ",1),a[17]||(a[17]=e("span",{class:"required"},"*",-1))]),e("div",be,[c(e("input",{id:"apiKey","onUpdate:modelValue":a[4]||(a[4]=i=>t.value.apiKey=i),type:g.value?"text":"password",class:"form-input",placeholder:s.$t("init.apiKeyPlaceholder"),disabled:o.value,required:""},null,8,he),[[w,t.value.apiKey]]),e("button",{type:"button",class:"api-key-toggle-btn",onClick:a[5]||(a[5]=i=>g.value=!g.value),title:g.value?s.$t("init.hideApiKey"):s.$t("init.showApiKey")},[g.value?(d(),n("span",_e,"👁️")):(d(),n("span",$e,"🙈"))],8,ye)]),e("div",ke,[y(l(s.$t("init.apiKeyHint"))+" ",1),e("a",Ne,l(s.$t("init.getApiKey")),1)])])):v("",!0),t.value.configMode==="custom"?(d(),n("div",Me,[e("div",Ke,[e("label",Ue,[y(l(s.$t("init.baseUrlLabel"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),c(e("input",{id:"baseUrl","onUpdate:modelValue":a[6]||(a[6]=i=>t.value.baseUrl=i),type:"url",class:"form-input",placeholder:s.$t("init.baseUrlPlaceholder"),disabled:o.value,required:""},null,8,we),[[k,t.value.baseUrl]]),e("div",Ce,l(s.$t("init.baseUrlHint")),1)]),e("div",Le,[e("label",Se,[y(l(s.$t("init.customApiKeyLabel"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),e("div",De,[c(e("input",{id:"customApiKey","onUpdate:modelValue":a[7]||(a[7]=i=>t.value.apiKey=i),type:b.value?"text":"password",class:"form-input",placeholder:s.$t("init.customApiKeyPlaceholder"),disabled:o.value,required:""},null,8,Ae),[[w,t.value.apiKey]]),e("button",{type:"button",class:"api-key-toggle-btn",onClick:a[8]||(a[8]=i=>b.value=!b.value),title:b.value?s.$t("init.hideApiKey"):s.$t("init.showApiKey")},[b.value?(d(),n("span",Ve,"👁️")):(d(),n("span",Te,"🙈"))],8,qe)])]),e("div",Ie,[e("label",Re,[y(l(s.$t("init.modelNameLabel"))+" ",1),a[20]||(a[20]=e("span",{class:"required"},"*",-1))]),c(e("input",{id:"modelName","onUpdate:modelValue":a[9]||(a[9]=i=>t.value.modelName=i),type:"text",class:"form-input",placeholder:s.$t("init.modelNamePlaceholder"),disabled:o.value,required:""},null,8,ze),[[k,t.value.modelName]]),e("div",Pe,l(s.$t("init.modelNameHint")),1)]),e("div",Ee,[e("label",Fe,l(s.$t("init.modelDisplayNameLabel")),1),c(e("input",{id:"modelDisplayName","onUpdate:modelValue":a[10]||(a[10]=i=>t.value.modelDisplayName=i),type:"text",class:"form-input",placeholder:s.$t("init.modelDisplayNamePlaceholder"),disabled:o.value},null,8,Oe),[[k,t.value.modelDisplayName]])])])):v("",!0),e("div",je,[e("button",{type:"button",class:"back-btn",onClick:A,disabled:o.value},l(s.$t("init.back")),9,Be),e("button",{type:"submit",class:"submit-btn",disabled:o.value||!S.value},[o.value?(d(),n("span",Je)):v("",!0),y(" "+l(o.value?s.$t("init.saving"):s.$t("init.saveAndContinue")),1)],8,He)])],32)])):v("",!0),U(L,{name:"error-fade"},{default:C(()=>[p.value?(d(),n("div",Ge,l(p.value),1)):v("",!0)]),_:1}),U(L,{name:"success-fade"},{default:C(()=>[M.value?(d(),n("div",We,l(s.$t("init.successMessage")),1)):v("",!0)]),_:1})]),e("div",Qe,[(d(),n(O,null,j(6,i=>e("div",{class:"floating-shape",key:i})),64))]),a[21]||(a[21]=e("div",{class:"background-effects"},[e("div",{class:"gradient-orb orb-1"}),e("div",{class:"gradient-orb orb-2"}),e("div",{class:"gradient-orb orb-3"})],-1))]))}}),ss=G(Xe,[["__scopeId","data-v-63053a81"]]);export{ss as default};
