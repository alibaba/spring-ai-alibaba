var Oe=Object.defineProperty;var qe=(B,o,n)=>o in B?Oe(B,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):B[o]=n;var ge=(B,o,n)=>qe(B,typeof o!="symbol"?o+"":o,n);import{d as se,c as d,o as c,e,t as s,f as fe,r as R,m as ae,g as te,h as ve,i as b,b as F,s as k,w as K,v as H,F as Y,j as X,q as ee,D as Ee,a as W,z as J,T as Ce,E as ke,G as Re,u as t,x as be,A as Me,H as Ge,k as je,C as Ke,n as Je,y as ze,I as Ae,J as He,K as Ye,B as We,L as Xe,l as Qe}from"./index-Bjk7B1SW.js";import{_ as ne,I as T}from"./_plugin-vue_export-helper-CNFk-1N3.js";import{L as Ze}from"./index-3KlFc0uz.js";const eo={class:"switch"},oo=["checked"],to={class:"switch-label"},so=se({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(B,{emit:o}){const n=o,u=y=>{const g=y.target.checked;n("update:switchValue",g)};return(y,g)=>(c(),d("label",eo,[e("input",{type:"checkbox",checked:y.enabled,onChange:u},null,40,oo),g[0]||(g[0]=e("span",{class:"slider"},null,-1)),e("span",to,s(y.label),1)]))}}),no=ne(so,[["__scopeId","data-v-d484b4a3"]]);class we{static async getConfigsByGroup(o){try{const n=await fetch(`${this.BASE_URL}/group/${o}`);if(!n.ok)throw new Error(`Failed to get ${o} group configuration: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get ${o} group configuration:`,n),n}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const n=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Batch update configuration failed: ${n.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(n){return console.error("Batch update configuration failed:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}static async getConfigById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);if(!n.ok)throw new Error(`Failed to get configuration item: ${n.status}`);return await n.json()}catch(n){throw console.error(`Failed to get configuration item[${o}]:`,n),n}}static async updateConfig(o){try{const n=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to update configuration item: ${n.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(n){return console.error("Failed to update configuration item:",n),{success:!1,message:n instanceof Error?n.message:"Update failed, please try again"}}}}ge(we,"BASE_URL","/api/config");const ao={class:"config-panel"},lo={class:"config-header"},io={class:"header-left"},co={class:"config-stats"},ro={class:"stat-item"},uo={class:"stat-label"},po={class:"stat-value"},fo={key:0,class:"stat-item"},mo={class:"stat-label"},go={class:"stat-value modified"},vo={class:"header-right"},ho={class:"import-export-actions"},yo=["title"],_o=["title"],bo={class:"search-box"},Co=["placeholder"],$o={key:0,class:"loading-container"},wo={key:1,class:"config-groups"},ko={class:"group-header"},So={class:"group-info"},To={class:"group-icon"},No={class:"group-actions"},Vo=["onClick","disabled","title"],Mo={class:"sub-groups"},Ao=["onClick"],Uo={class:"sub-group-info"},Eo={class:"sub-group-title"},Po={class:"item-count"},xo={class:"config-items"},Do={key:0,class:"config-item-content vertical-layout"},Lo={class:"config-item-info"},Ro={class:"config-item-header"},Fo={class:"config-label"},Bo={class:"type-badge boolean"},Io={key:0,class:"modified-badge"},Oo=["title"],qo={class:"config-control"},Go=["value","onChange"],jo=["value"],Ko={key:1,class:"config-item-content vertical-layout"},Jo={class:"config-item-info"},zo={class:"config-item-header"},Ho={class:"config-label"},Yo={class:"type-badge select"},Wo={key:0,class:"modified-badge"},Xo=["title"],Qo={class:"config-control"},Zo=["value","onChange"],et=["value"],ot={key:2,class:"config-item-content vertical-layout"},tt={class:"config-item-info"},st={class:"config-item-header"},nt={class:"config-label"},at={class:"type-badge textarea"},lt={key:0,class:"modified-badge"},it=["title"],ct={class:"config-control"},rt=["value","onInput"],dt={key:3,class:"config-item-content vertical-layout"},ut={class:"config-item-info"},pt={class:"config-item-header"},ft={class:"config-label"},mt={class:"type-badge number"},gt={key:0,class:"modified-badge"},vt=["title"],ht={key:0,class:"config-meta"},yt={class:"range-info"},_t={class:"config-control"},bt=["value","onInput","min","max"],Ct={key:4,class:"config-item-content vertical-layout"},$t={class:"config-item-info"},wt={class:"config-item-header"},kt={class:"config-label"},St={class:"type-badge string"},Tt={key:0,class:"modified-badge"},Nt=["title"],Vt={class:"config-control"},Mt=["value","onInput"],At={key:2,class:"empty-state"},Ut=se({__name:"basicConfig",setup(B){const{t:o}=fe(),n=R(!0),u=R(!1),y=R([]),g=R(new Map),h=R(new Set),i=ae({show:!1,text:"",type:"success"}),M=R(""),A={headless:"config.basicConfig.browserSettings.headless",requestTimeout:"config.basicConfig.browserSettings.requestTimeout",debugDetail:"config.basicConfig.general.debugDetail",baseDir:"config.basicConfig.general.baseDir",openBrowser:"config.basicConfig.interactionSettings.openBrowser",maxSteps:"config.basicConfig.agentSettings.maxSteps",userInputTimeout:"config.basicConfig.agentSettings.userInputTimeout",maxMemory:"config.basicConfig.agentSettings.maxMemory",parallelToolCalls:"config.basicConfig.agentSettings.parallelToolCalls",forceOverrideFromYaml:"config.basicConfig.agents.forceOverrideFromYaml",enabled:"config.basicConfig.infiniteContext.enabled",parallelThreads:"config.basicConfig.infiniteContext.parallelThreads",taskContextSize:"config.basicConfig.infiniteContext.taskContextSize",allowExternalAccess:"config.basicConfig.fileSystem.allowExternalAccess"},E={manus:"config.basicConfig.groupDisplayNames.manus"},L={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},j={agent:"config.subGroupDisplayNames.agent",browser:"config.subGroupDisplayNames.browser",interaction:"config.subGroupDisplayNames.interaction",agents:"config.subGroupDisplayNames.agents",infiniteContext:"config.subGroupDisplayNames.infiniteContext",general:"config.subGroupDisplayNames.general",filesystem:"config.subGroupDisplayNames.filesystem"},I=te(()=>y.value.some(l=>l.subGroups.some(C=>C.items.some(U=>g.value.get(U.id)!==U.configValue)))),S=l=>l==="true",N=l=>parseFloat(l)||0,w=l=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[l]||1,x=l=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[l]||1e4,Q=l=>typeof l=="string"?l:l.value,le=l=>typeof l=="string"?l:l.label,D=(l,C)=>{if(typeof C=="boolean")return C.toString();if(typeof C=="string"){if(l.options&&l.options.length>0){const U=l.options.find(V=>(typeof V=="string"?V:V.label)===C||(typeof V=="string"?V:V.value)===C);if(U)return typeof U=="string"?U:U.value}return C}return String(C)},P=(l,C,U=!1)=>{let V;l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"?V=D(l,C):V=String(C),l.configValue!==V&&(l.configValue=V,l._modified=!0,(U||l.inputType==="BOOLEAN"||l.inputType==="CHECKBOX"||l.inputType==="SELECT")&&f())};let _=null;const f=()=>{_&&clearTimeout(_),_=window.setTimeout(()=>{q()},500)},r=(l,C="success")=>{i.text=l,i.type=C,i.show=!0,setTimeout(()=>{i.show=!1},3e3)},$=async()=>{try{n.value=!0;const C=["manus"].map(async V=>{try{const v=await we.getConfigsByGroup(V);if(console.log("加载配置组:",V,v),v.length===0)return null;const O=v.map(oe=>({...oe,displayName:A[oe.configKey]||oe.configKey,min:w(oe.configKey),max:x(oe.configKey)}));O.forEach(oe=>{g.value.set(oe.id,oe.configValue)});const G=new Map;O.forEach(oe=>{const ce=oe.configSubGroup??"general";G.has(ce)||G.set(ce,[]),G.get(ce).push(oe)});const Z=Array.from(G.entries()).map(([oe,ce])=>({name:oe,displayName:j[oe]||oe,items:ce}));return{name:V,displayName:E[V]||V,subGroups:Z}}catch(v){return console.warn(`加载配置组 ${V} 失败，跳过:`,v),null}}),U=await Promise.all(C);y.value=U.filter(V=>V!==null),console.log("配置加载完成:",y.value)}catch(l){console.error("加载配置失败:",l),r(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},q=async()=>{if(!(u.value||!I.value))try{u.value=!0;const l=[];if(y.value.forEach(U=>{U.subGroups.forEach(V=>{const v=V.items.filter(O=>O._modified);l.push(...v)})}),l.length===0){r("没有需要保存的修改");return}const C=await we.batchUpdateConfigs(l);C.success?(l.forEach(U=>{g.value.set(U.id,U.configValue),U._modified=!1}),r("配置保存成功")):r(C.message||"保存失败","error")}catch(l){console.error("保存配置失败:",l),r(o("config.basicConfig.saveFailed"),"error")}finally{u.value=!1}},z=async l=>{if(confirm(`确定要重置 "${E[l]||l}" 组的所有配置吗？`))try{u.value=!0;const U=y.value.find(O=>O.name===l);if(!U)return;const V=[];if(U.subGroups.forEach(O=>{O.items.forEach(G=>{const Z=re(G.configKey);Z!==G.configValue&&V.push({...G,configValue:Z})})}),V.length===0){r("该组配置已是默认值");return}const v=await we.batchUpdateConfigs(V);v.success?(await $(),r(`成功重置 ${V.length} 项配置`)):r(v.message||"重置失败","error")}catch(U){console.error("重置组配置失败:",U),r(o("config.basicConfig.resetFailed"),"error")}finally{u.value=!1}},re=l=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[l]||"",$e=(l,C)=>{const U=`${l}-${C}`;h.value.has(U)?h.value.delete(U):h.value.add(U)},he=(l,C)=>h.value.has(`${l}-${C}`),me=te(()=>{const l=y.value.reduce((U,V)=>U+V.subGroups.reduce((v,O)=>v+O.items.length,0),0),C=y.value.reduce((U,V)=>U+V.subGroups.reduce((v,O)=>v+O.items.filter(G=>g.value.get(G.id)!==G.configValue).length,0),0);return{total:l,modified:C}}),p=te(()=>{if(!M.value.trim())return y.value;const l=M.value.toLowerCase();return y.value.map(C=>({...C,subGroups:C.subGroups.map(U=>({...U,items:U.items.filter(V=>V.displayName.toLowerCase().includes(l)||V.configKey.toLowerCase().includes(l)||V.description&&V.description.toLowerCase().includes(l))})).filter(U=>U.items.length>0)})).filter(C=>C.subGroups.length>0)}),a=()=>{try{const l={timestamp:new Date().toISOString(),version:"1.0",configs:y.value.reduce((v,O)=>(O.subGroups.forEach(G=>{G.items.forEach(Z=>{v[Z.configKey]=Z.configValue})}),v),{})},C=JSON.stringify(l,null,2),U=new Blob([C],{type:"application/json"}),V=document.createElement("a");V.href=URL.createObjectURL(U),V.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,V.click(),r("配置导出成功")}catch(l){console.error("导出配置失败:",l),r("导出失败","error")}},m=l=>{var v;const C=l.target,U=(v=C.files)==null?void 0:v[0];if(!U)return;const V=new FileReader;V.onload=async O=>{var G;try{const Z=JSON.parse((G=O.target)==null?void 0:G.result);if(!Z.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;u.value=!0;const ce=[];if(y.value.forEach(Be=>{Be.subGroups.forEach(Ie=>{Ie.items.forEach(Ve=>{Object.prototype.hasOwnProperty.call(Z.configs,Ve.configKey)&&ce.push({...Ve,configValue:Z.configs[Ve.configKey]})})})}),ce.length===0){r("没有找到可导入的配置项");return}const xe=await we.batchUpdateConfigs(ce);xe.success?(await $(),r(`成功导入 ${ce.length} 项配置`)):r(xe.message||"导入失败","error")}catch(Z){console.error("导入配置失败:",Z),r(o("config.basicConfig.importFailed"),"error")}finally{u.value=!1,C.value=""}},V.readAsText(U)};return ve(()=>{$()}),(l,C)=>(c(),d("div",ao,[e("div",lo,[e("div",io,[e("h2",null,s(l.$t("config.basicConfig.title")),1),e("div",co,[e("span",ro,[e("span",uo,s(l.$t("config.basicConfig.totalConfigs"))+":",1),e("span",po,s(me.value.total),1)]),me.value.modified>0?(c(),d("span",fo,[e("span",mo,s(l.$t("config.basicConfig.modified"))+":",1),e("span",go,s(me.value.modified),1)])):F("",!0)])]),e("div",vo,[e("div",ho,[e("button",{onClick:a,class:"action-btn",title:l.$t("config.basicConfig.exportConfigs")}," 📤 ",8,yo),e("label",{class:"action-btn",title:l.$t("config.basicConfig.importConfigs")},[C[1]||(C[1]=k(" 📥 ")),e("input",{type:"file",accept:".json",onChange:m,style:{display:"none"}},null,32)],8,_o)]),e("div",bo,[K(e("input",{"onUpdate:modelValue":C[0]||(C[0]=U=>M.value=U),type:"text",placeholder:l.$t("config.search"),class:"search-input"},null,8,Co),[[H,M.value]]),C[2]||(C[2]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(c(),d("div",$o,[C[3]||(C[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(l.$t("config.loading")),1)])):p.value.length>0?(c(),d("div",wo,[(c(!0),d(Y,null,X(p.value,U=>(c(),d("div",{key:U.name,class:"config-group"},[e("div",ko,[e("div",So,[e("span",To,s(L[U.name]||"⚙️"),1)]),e("div",No,[e("button",{onClick:V=>z(U.name),class:"reset-btn",disabled:u.value,title:l.$t("config.resetGroupConfirm")},s(l.$t("config.reset")),9,Vo)]),C[4]||(C[4]=e("div",{class:"group-divider"},null,-1))]),e("div",Mo,[(c(!0),d(Y,null,X(U.subGroups,V=>(c(),d("div",{key:V.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:v=>$e(U.name,V.name)},[e("div",Uo,[C[5]||(C[5]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",Eo,s(l.$t(V.displayName)),1),e("span",Po,"("+s(V.items.length)+")",1)]),e("span",{class:ee(["collapse-icon",{collapsed:he(U.name,V.name)}])}," ▼ ",2)],8,Ao),K(e("div",xo,[(c(!0),d(Y,null,X(V.items,v=>(c(),d("div",{key:v.id,class:ee(["config-item",{modified:g.value.get(v.id)!==v.configValue}])},[v.inputType==="BOOLEAN"||v.inputType==="CHECKBOX"?(c(),d("div",Do,[e("div",Lo,[e("div",Ro,[e("label",Fo,[k(s(l.$t(v.displayName)||v.description)+" ",1),e("span",Bo,s(v.inputType==="CHECKBOX"?l.$t("config.types.checkbox"):l.$t("config.types.boolean")),1),g.value.get(v.id)!==v.configValue?(c(),d("span",Io,s(l.$t("config.modified")),1)):F("",!0)]),e("span",{class:"config-key",title:v.configKey},s(v.configKey),9,Oo)])]),e("div",qo,[v.options&&v.options.length>0?(c(),d("select",{key:0,class:"config-input select-input",value:v.configValue,onChange:O=>{var G;return P(v,((G=O.target)==null?void 0:G.value)||"")}},[(c(!0),d(Y,null,X(v.options,O=>(c(),d("option",{key:Q(O),value:Q(O)},s(le(O)),9,jo))),128))],40,Go)):(c(),W(no,{key:1,enabled:S(v.configValue),label:"","onUpdate:switchValue":O=>P(v,O)},null,8,["enabled","onUpdate:switchValue"]))])])):v.inputType==="SELECT"?(c(),d("div",Ko,[e("div",Jo,[e("div",zo,[e("label",Ho,[k(s(l.$t(v.displayName)||v.description)+" ",1),e("span",Yo,s(l.$t("config.types.select")),1),g.value.get(v.id)!==v.configValue?(c(),d("span",Wo,s(l.$t("config.modified")),1)):F("",!0)]),e("span",{class:"config-key",title:v.configKey},s(v.configKey),9,Xo)])]),e("div",Qo,[e("select",{class:"config-input select-input",value:v.configValue,onChange:O=>{var G;return P(v,((G=O.target)==null?void 0:G.value)||"")}},[(c(!0),d(Y,null,X(v.options||[],O=>(c(),d("option",{key:Q(O),value:Q(O)},s(le(O)),9,et))),128))],40,Zo)])])):v.inputType==="TEXTAREA"?(c(),d("div",ot,[e("div",tt,[e("div",st,[e("label",nt,[k(s(l.$t(v.displayName)||v.description)+" ",1),e("span",at,s(l.$t("config.types.textarea")),1),g.value.get(v.id)!==v.configValue?(c(),d("span",lt,s(l.$t("config.modified")),1)):F("",!0)]),e("span",{class:"config-key",title:v.configKey},s(v.configKey),9,it)])]),e("div",ct,[e("textarea",{class:"config-input textarea-input",value:v.configValue,onInput:O=>{var G;return P(v,((G=O.target)==null?void 0:G.value)||"")},onBlur:f,rows:"3"},null,40,rt)])])):v.inputType==="NUMBER"?(c(),d("div",dt,[e("div",ut,[e("div",pt,[e("label",ft,[k(s(l.$t(v.displayName)||v.description)+" ",1),e("span",mt,s(l.$t("config.types.number")),1),g.value.get(v.id)!==v.configValue?(c(),d("span",gt,s(l.$t("config.modified")),1)):F("",!0)]),e("span",{class:"config-key",title:v.configKey},s(v.configKey),9,vt),v.min||v.max?(c(),d("div",ht,[e("span",yt,s(l.$t("config.range"))+": "+s(v.min||0)+" - "+s(v.max||"∞"),1)])):F("",!0)])]),e("div",_t,[e("input",{type:"number",class:"config-input number-input",value:N(v.configValue),onInput:O=>{var G;return P(v,((G=O.target)==null?void 0:G.value)||"")},onBlur:f,min:v.min||1,max:v.max||1e4},null,40,bt)])])):(c(),d("div",Ct,[e("div",$t,[e("div",wt,[e("label",kt,[k(s(l.$t(v.displayName)||v.description)+" ",1),e("span",St,s(v.inputType==="TEXT"?l.$t("config.types.text"):l.$t("config.types.string")),1),g.value.get(v.id)!==v.configValue?(c(),d("span",Tt,s(l.$t("config.modified")),1)):F("",!0)]),e("span",{class:"config-key",title:v.configKey},s(v.configKey),9,Nt)])]),e("div",Vt,[e("input",{type:"text",class:"config-input text-input",value:v.configValue,onInput:O=>{var G;return P(v,((G=O.target)==null?void 0:G.value)||"")},onBlur:f},null,40,Mt)])]))],2))),128))],512),[[Ee,!he(U.name,V.name)]])]))),128))])]))),128))])):(c(),d("div",At,[e("p",null,s(l.$t("config.notFound")),1)])),b(Ce,{name:"message-fade"},{default:J(()=>[i.show?(c(),d("div",{key:0,class:ee(["message-toast",i.type])},s(i.text),3)):F("",!0)]),_:1})]))}}),De=ne(Ut,[["__scopeId","data-v-8f028e7e"]]),Et={},Pt={class:"config-config"},xt={class:"panel-header"},Dt={class:"panel-actions"};function Lt(B,o){return c(),d("div",Pt,[e("div",xt,[ke(B.$slots,"title",{},void 0),e("div",Dt,[ke(B.$slots,"actions",{},void 0)])]),ke(B.$slots,"default",{},void 0)])}const Ne=ne(Et,[["render",Lt],["__scopeId","data-v-c91688e7"]]),Rt={class:"modal-header"},Ft={class:"modal-content"},Bt={class:"modal-footer"},It=se({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(B){const o=n=>{n.target===n.currentTarget&&(n.stopPropagation(),n.preventDefault())};return(n,u)=>(c(),W(Re,{to:"body"},[b(Ce,{name:"modal"},{default:J(()=>[B.modelValue?(c(),d("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:u[3]||(u[3]=be(()=>{},["stop"]))},[e("div",Rt,[e("h3",null,s(B.title),1),e("button",{class:"close-btn",onClick:u[0]||(u[0]=y=>n.$emit("update:modelValue",!1))},[b(t(T),{icon:"carbon:close"})])]),e("div",Ft,[ke(n.$slots,"default",{},void 0,!0)]),e("div",Bt,[ke(n.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:u[1]||(u[1]=y=>n.$emit("update:modelValue",!1))},s(n.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:u[2]||(u[2]=y=>n.$emit("confirm"))},s(n.$t("common.confirm")),1)],!0)])])])):F("",!0)]),_:3})]))}}),de=ne(It,[["__scopeId","data-v-baaf1c89"]]),Ot={class:"tool-selection-content"},qt={class:"tool-controls"},Gt={class:"search-container"},jt={class:"sort-container"},Kt={class:"tool-summary"},Jt={class:"summary-text"},zt={key:0,class:"tool-groups"},Ht=["onClick"],Yt={class:"group-title-area"},Wt={class:"group-name"},Xt={class:"group-count"},Qt={class:"group-enable-all"},Zt=["checked","onChange","data-group"],es={class:"tool-info"},os={class:"tool-selection-name"},ts={key:0,class:"tool-selection-desc"},ss={class:"tool-actions"},ns=["checked","onChange"],as={key:1,class:"empty-state"},ls=se({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(B,{emit:o}){const n=B,u=o,y=te({get:()=>n.modelValue,set:_=>u("update:modelValue",_)}),g=R(""),h=R("group"),i=R(new Set),M=R([]),A=(_,f)=>{const r=document.querySelector(`input[data-group="${_}"]`);r&&(r.indeterminate=x(f))};Me(()=>n.selectedToolIds,_=>{M.value=[..._]},{immediate:!0});const E=te(()=>{let _=n.tools.filter(f=>f.key);if(g.value){const f=g.value.toLowerCase();_=_.filter(r=>{var $;return r.name.toLowerCase().includes(f)||r.description.toLowerCase().includes(f)||((($=r.serviceGroup)==null?void 0:$.toLowerCase().includes(f))??!1)})}switch(h.value){case"name":_=[..._].sort((f,r)=>f.name.localeCompare(r.name));break;case"enabled":_=[..._].sort((f,r)=>{const $=M.value.includes(f.key),q=M.value.includes(r.key);return $&&!q?-1:!$&&q?1:f.name.localeCompare(r.name)});break;case"group":default:_=[..._].sort((f,r)=>{const $=f.serviceGroup??"未分组",q=r.serviceGroup??"未分组";return $!==q?$.localeCompare(q):f.name.localeCompare(r.name)});break}return _}),L=te(()=>{const _=new Map;return E.value.forEach(f=>{const r=f.serviceGroup??"未分组";_.has(r)||_.set(r,[]),_.get(r).push(f)}),new Map([..._.entries()].sort())}),j=te(()=>E.value.length);Me([M,L],()=>{je(()=>{for(const[_,f]of L.value)A(_,f)})},{flush:"post",deep:!1});const I=_=>M.value.includes(_),S=(_,f)=>{f.stopPropagation();const $=f.target.checked;if(!_){console.error("toolKey is undefined, cannot proceed");return}$?M.value.includes(_)||(M.value=[...M.value,_]):M.value=M.value.filter(q=>q!==_)},N=_=>_.filter(f=>M.value.includes(f.key)),w=_=>_.length>0&&_.every(f=>M.value.includes(f.key)),x=_=>{const f=N(_).length;return f>0&&f<_.length},Q=(_,f)=>{f.stopPropagation();const $=f.target.checked,q=_.map(z=>z.key);if($){const z=[...M.value];q.forEach(re=>{z.includes(re)||z.push(re)}),M.value=z}else M.value=M.value.filter(z=>!q.includes(z))},le=_=>{i.value.has(_)?i.value.delete(_):i.value.add(_)},D=()=>{u("confirm",[...M.value]),u("update:modelValue",!1)},P=()=>{M.value=[...n.selectedToolIds],u("update:modelValue",!1)};return Me(y,_=>{if(_){i.value.clear();const f=Array.from(L.value.keys());f.length>1&&f.slice(1).forEach(r=>{i.value.add(r)})}}),(_,f)=>(c(),W(de,{modelValue:y.value,"onUpdate:modelValue":[f[4]||(f[4]=r=>y.value=r),P],title:"选择工具",onConfirm:D},{default:J(()=>[e("div",Ot,[e("div",qt,[e("div",Gt,[K(e("input",{"onUpdate:modelValue":f[0]||(f[0]=r=>g.value=r),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[H,g.value]])]),e("div",jt,[K(e("select",{"onUpdate:modelValue":f[1]||(f[1]=r=>h.value=r),class:"sort-select"},f[5]||(f[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Ge,h.value]])])]),e("div",Kt,[e("span",Jt," 共 "+s(L.value.size)+" 个服务组，"+s(j.value)+" 个工具 (已选择 "+s(M.value.length)+" 个) ",1)]),L.value.size>0?(c(),d("div",zt,[(c(!0),d(Y,null,X(L.value,([r,$])=>(c(),d("div",{key:r,class:"tool-group"},[e("div",{class:ee(["tool-group-header",{collapsed:i.value.has(r)}]),onClick:q=>le(r)},[e("div",Yt,[b(t(T),{icon:i.value.has(r)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),b(t(T),{icon:"carbon:folder",class:"group-icon"}),e("span",Wt,s(r),1),e("span",Xt," ("+s(N($).length)+"/"+s($.length)+") ",1)]),e("div",{class:"group-actions",onClick:f[2]||(f[2]=be(()=>{},["stop"]))},[e("label",Qt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:w($),onChange:q=>Q($,q),"data-group":r},null,40,Zt),f[6]||(f[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Ht),e("div",{class:ee(["tool-group-content",{collapsed:i.value.has(r)}])},[(c(!0),d(Y,null,X($.filter(q=>q&&q.key),q=>(c(),d("div",{key:q.key,class:"tool-selection-item"},[e("div",es,[e("div",os,s(q.name),1),q.description?(c(),d("div",ts,s(q.description),1)):F("",!0)]),e("div",ss,[e("label",{class:"tool-enable-switch",onClick:f[3]||(f[3]=be(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:I(q.key),onChange:z=>S(q.key,z)},null,40,ns),f[7]||(f[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(c(),d("div",as,[b(t(T),{icon:"carbon:tools",class:"empty-icon"}),f[8]||(f[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),is=ne(ls,[["__scopeId","data-v-79f6a572"]]);class pe{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}else{const n=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(n)).json()}}catch(n){throw console.error("Failed to get Agent list:",n),n}}static async getAgentById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Agent[${o}] details:`,n),n}}static async createAgent(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Agent:",n),n}}static async updateAgent(o,n){try{const u=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(u)).json()}catch(u){throw console.error(`Failed to update Agent[${o}]:`,u),u}}static async deleteAgent(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Agent[${o}]:`,n),n}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}ge(pe,"BASE_URL","/api/agents");class ie{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Model[${o}] details:`,n),n}}static async createModel(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Model:",n),n}}static async updateModel(o,n){try{const u=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(u)).json()}catch(u){throw console.error(`Failed to update Model[${o}]:`,u),u}}static async deleteModel(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Model[${o}]:`,n),n}}static async validateConfig(o){try{const n=await fetch(`${this.BASE_URL}/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to validate model configuration:",n),n}}}ge(ie,"BASE_URL","/api/models");const Pe=Ke("namespace",()=>{const B=R("default");function o(y){B.value=y}const n=R([{name:"Default",id:"default"}]);function u(y){n.value=y}return{namespace:B,db:n,setNamespace:o,setDb:u}}),cs=["disabled"],rs={class:"agent-layout"},ds={class:"agent-list"},us={class:"list-header"},ps={class:"agent-count"},fs={key:0,class:"agents-container"},ms=["onClick"],gs={class:"agent-card-header"},vs={class:"agent-name"},hs={class:"agent-desc"},ys={key:0,class:"agent-model"},_s={class:"model-tag"},bs={class:"model-tag"},Cs={key:1,class:"agent-tools"},$s={key:0,class:"tool-more"},ws={key:1,class:"loading-state"},ks={key:2,class:"empty-state"},Ss={key:0,class:"agent-detail"},Ts={class:"detail-header"},Ns={class:"detail-actions"},Vs={class:"form-item"},Ms=["placeholder"],As={class:"form-item"},Us=["placeholder"],Es={class:"form-item"},Ps=["value","placeholder"],xs={class:"model-section"},Ds={class:"form-item"},Ls={class:"model-chooser"},Rs=["title"],Fs={key:0,class:"current-model"},Bs={class:"model-type"},Is={class:"model-name"},Os={key:1,class:"current-model"},qs={class:"current-model"},Gs={class:"dropdown-header"},js={class:"model-options"},Ks=["onClick"],Js={class:"model-type"},zs={class:"model-name"},Hs={class:"tools-section"},Ys={class:"assigned-tools"},Ws={class:"section-header"},Xs={class:"tools-grid"},Qs={class:"tool-info"},Zs={class:"tool-name"},en={class:"tool-desc"},on={key:0,class:"no-tools"},tn={key:1,class:"no-selection"},sn={class:"modal-form"},nn={class:"form-item"},an=["placeholder"],ln={class:"form-item"},cn=["placeholder"],rn={class:"form-item"},dn=["value","placeholder"],un={class:"delete-confirm"},pn={class:"warning-text"},fn=se({__name:"agentConfig",setup(B){const{t:o}=fe(),n=Pe(),u=R(!1),y=R(""),g=R(""),h=ae([]),i=R(null),M=ae([]),A=R(!1),E=R(!1),L=R(!1),j=R(!1),I=R(null),S=ae([]),N=()=>{j.value=!j.value},w=p=>{I.value=p,j.value=!1},x=ae({name:"",description:"",nextStepPrompt:""}),Q=p=>{const a=M.find(m=>m.key===p);return a?a.name:p},le=p=>{const a=M.find(m=>m.key===p);return a?a.description:""},D=(p,a)=>{a==="success"?(g.value=p,setTimeout(()=>{g.value=""},3e3)):(y.value=p,setTimeout(()=>{y.value=""},5e3))},P=async()=>{u.value=!0;try{const[p,a,m]=await Promise.all([pe.getAllAgents(n.namespace),pe.getAvailableTools(),ie.getAllModels()]),l=p.map(C=>({...C,availableTools:C.availableTools,...m}));h.splice(0,h.length,...l),M.splice(0,M.length,...a),S.splice(0,S.length,...m),l.length>0&&await _(l[0])}catch(p){console.error("加载数据失败:",p),D(o("config.agentConfig.loadDataFailed")+": "+p.message,"error");const a=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],m=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];M.splice(0,M.length,...a),h.splice(0,h.length,...m),m.length>0&&(i.value=m[0])}finally{u.value=!1}},_=async p=>{try{const a=await pe.getAgentById(p.id);i.value={...a,availableTools:a.availableTools},I.value=a.model??null}catch(a){console.error("加载Agent详情失败:",a),D(o("config.agentConfig.loadDetailsFailed")+": "+a.message,"error"),i.value={...p,availableTools:p.availableTools}}},f=()=>{x.name="",x.description="",x.nextStepPrompt="",A.value=!0},r=async()=>{var p;if(!x.name.trim()||!x.description.trim()){D(o("config.agentConfig.requiredFields"),"error");return}try{const a={name:x.name.trim(),description:x.description.trim(),nextStepPrompt:((p=x.nextStepPrompt)==null?void 0:p.trim())??"",availableTools:[]},m=await pe.createAgent(a);h.push(m),i.value=m,A.value=!1,D(o("config.agentConfig.createSuccess"),"success")}catch(a){D(o("config.agentConfig.createFailed")+": "+a.message,"error")}},$=()=>{L.value=!0},q=p=>{i.value&&(i.value.availableTools=[...p])},z=async()=>{if(i.value){if(!i.value.name.trim()||!i.value.description.trim()){D(o("config.agentConfig.requiredFields"),"error");return}try{i.value.model=I.value;const p=await pe.updateAgent(i.value.id,i.value),a=h.findIndex(m=>m.id===p.id);a!==-1&&(h[a]=p),i.value=p,i.value.model=I.value,D(o("config.agentConfig.saveSuccess"),"success")}catch(p){D(o("config.agentConfig.saveFailed")+": "+p.message,"error")}}},re=()=>{E.value=!0},$e=async()=>{if(i.value)try{await pe.deleteAgent(i.value.id);const p=h.findIndex(a=>a.id===i.value.id);p!==-1&&h.splice(p,1),i.value=h.length>0?h[0]:null,E.value=!1,D(o("config.agentConfig.deleteSuccess"),"success")}catch(p){D(o("config.agentConfig.deleteFailed")+": "+p.message,"error")}},he=()=>{const p=document.createElement("input");p.type="file",p.accept=".json",p.onchange=a=>{var l;const m=(l=a.target.files)==null?void 0:l[0];if(m){const C=new FileReader;C.onload=async U=>{var V;try{const v=JSON.parse((V=U.target)==null?void 0:V.result);if(!v.name||!v.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:O,...G}=v,Z=await pe.createAgent(G);h.push(Z),i.value=Z,D(o("config.agentConfig.importSuccess"),"success")}catch(v){D(o("config.agentConfig.importFailed")+": "+v.message,"error")}},C.readAsText(m)}},p.click()},me=()=>{if(i.value)try{const p=JSON.stringify(i.value,null,2),a=new Blob([p],{type:"application/json"}),m=URL.createObjectURL(a),l=document.createElement("a");l.href=m,l.download=`agent-${i.value.name}-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(m),D(o("config.agentConfig.exportSuccess"),"success")}catch(p){D(o("config.agentConfig.exportFailed")+": "+p.message,"error")}};return ve(()=>{P()}),(p,a)=>(c(),W(Ne,null,{title:J(()=>[e("h2",null,s(t(o)("config.agentConfig.title")),1)]),actions:J(()=>[e("button",{class:"action-btn",onClick:he},[b(t(T),{icon:"carbon:upload"}),k(" "+s(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:me,disabled:!i.value},[b(t(T),{icon:"carbon:download"}),k(" "+s(t(o)("config.agentConfig.export")),1)],8,cs)]),default:J(()=>{var m;return[e("div",rs,[e("div",ds,[e("div",us,[e("h3",null,s(t(o)("config.agentConfig.configuredAgents")),1),e("span",ps,"("+s(h.length)+s(t(o)("config.agentConfig.agentCount"))+")",1)]),u.value?F("",!0):(c(),d("div",fs,[(c(!0),d(Y,null,X(h,l=>{var C,U;return c(),d("div",{key:l.id,class:ee(["agent-card",{active:((C=i.value)==null?void 0:C.id)===l.id}]),onClick:V=>_(l)},[e("div",gs,[e("span",vs,s(l.name),1),b(t(T),{icon:"carbon:chevron-right"})]),e("p",hs,s(l.description),1),l.model?(c(),d("div",ys,[e("span",_s,s(l.model.type),1),e("span",bs,s(l.model.modelName),1)])):F("",!0),((U=l.availableTools)==null?void 0:U.length)>0?(c(),d("div",Cs,[(c(!0),d(Y,null,X(l.availableTools.slice(0,3),V=>(c(),d("span",{key:V,class:"tool-tag"},s(Q(V)),1))),128)),l.availableTools.length>3?(c(),d("span",$s," +"+s(l.availableTools.length-3),1)):F("",!0)])):F("",!0)],10,ms)}),128))])),u.value?(c(),d("div",ws,[b(t(T),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(t(o)("common.loading")),1)])):F("",!0),!u.value&&h.length===0?(c(),d("div",ks,[b(t(T),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.agentConfig.noAgent")),1)])):F("",!0),e("button",{class:"add-btn",onClick:f},[b(t(T),{icon:"carbon:add"}),k(" "+s(t(o)("config.agentConfig.createNew")),1)])]),i.value?(c(),d("div",Ss,[e("div",Ts,[e("h3",null,s(i.value.name),1),e("div",Ns,[e("button",{class:"action-btn primary",onClick:z},[b(t(T),{icon:"carbon:save"}),k(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:re},[b(t(T),{icon:"carbon:trash-can"}),k(" "+s(t(o)("common.delete")),1)])])]),e("div",Vs,[e("label",null,[k(s(t(o)("config.agentConfig.agentName"))+" ",1),a[15]||(a[15]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=l=>i.value.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Ms),[[H,i.value.name]])]),e("div",As,[e("label",null,[k(s(t(o)("config.agentConfig.description"))+" ",1),a[16]||(a[16]=e("span",{class:"required"},"*",-1))]),K(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=l=>i.value.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,Us),[[H,i.value.description]])]),e("div",Es,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:i.value.nextStepPrompt||"",onInput:a[2]||(a[2]=l=>i.value.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,Ps)]),e("div",xs,[e("h4",null,s(t(o)("config.agentConfig.modelConfiguration")),1),e("div",Ds,[e("div",Ls,[e("button",{class:"model-btn",onClick:N,title:p.$t("model.switch")},[b(t(T),{icon:"carbon:build-run",width:"18"}),I.value?(c(),d("span",Fs,[e("span",Bs,s(I.value.type),1),a[17]||(a[17]=e("span",{class:"spacer"},null,-1)),e("span",Is,s(I.value.modelName),1)])):(c(),d("span",Os,[e("span",qs,s(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),b(t(T),{icon:j.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Rs),j.value?(c(),d("div",{key:0,class:"model-dropdown",onClick:a[4]||(a[4]=be(()=>{},["stop"]))},[e("div",Gs,[e("span",null,s(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:a[3]||(a[3]=l=>j.value=!1)},[b(t(T),{icon:"carbon:close",width:"16"})])]),e("div",js,[(c(!0),d(Y,null,X(S,l=>{var C,U;return c(),d("button",{key:l.id,class:ee(["model-option",{active:((C=I.value)==null?void 0:C.id)===l.id}]),onClick:V=>w(l)},[e("span",Js,s(l.type),1),e("span",zs,s(l.modelName),1),((U=I.value)==null?void 0:U.id)===l.id?(c(),W(t(T),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):F("",!0)],10,Ks)}),128))])])):F("",!0),j.value?(c(),d("div",{key:1,class:"backdrop",onClick:a[5]||(a[5]=l=>j.value=!1)})):F("",!0)])])]),e("div",Hs,[e("h4",null,s(t(o)("config.agentConfig.toolConfiguration")),1),e("div",Ys,[e("div",Ws,[e("span",null,s(t(o)("config.agentConfig.assignedTools"))+" ("+s((i.value.availableTools||[]).length)+")",1),M.length>0?(c(),d("button",{key:0,class:"action-btn small",onClick:$},[b(t(T),{icon:"carbon:add"}),k(" "+s(t(o)("config.agentConfig.addRemoveTools")),1)])):F("",!0)]),e("div",Xs,[(c(!0),d(Y,null,X(i.value.availableTools||[],l=>(c(),d("div",{key:l,class:"tool-item assigned"},[e("div",Qs,[e("span",Zs,s(Q(l)),1),e("span",en,s(le(l)),1)])]))),128)),i.value.availableTools.length===0?(c(),d("div",on,[b(t(T),{icon:"carbon:tool-box"}),e("span",null,s(t(o)("config.agentConfig.noAssignedTools")),1)])):F("",!0)])])])])):(c(),d("div",tn,[b(t(T),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.agentConfig.selectAgentHint")),1)]))]),b(de,{modelValue:A.value,"onUpdate:modelValue":a[9]||(a[9]=l=>A.value=l),title:t(o)("config.agentConfig.newAgent"),onConfirm:r},{default:J(()=>[e("div",sn,[e("div",nn,[e("label",null,[k(s(t(o)("config.agentConfig.agentName"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=l=>x.name=l),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,an),[[H,x.name]])]),e("div",ln,[e("label",null,[k(s(t(o)("config.agentConfig.description"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),K(e("textarea",{"onUpdate:modelValue":a[7]||(a[7]=l=>x.description=l),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,cn),[[H,x.description]])]),e("div",rn,[e("label",null,s(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:x.nextStepPrompt||"",onInput:a[8]||(a[8]=l=>x.nextStepPrompt=l.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,dn)])])]),_:1},8,["modelValue","title"]),b(is,{modelValue:L.value,"onUpdate:modelValue":a[10]||(a[10]=l=>L.value=l),tools:M,"selected-tool-ids":((m=i.value)==null?void 0:m.availableTools)||[],onConfirm:q},null,8,["modelValue","tools","selected-tool-ids"]),b(de,{modelValue:E.value,"onUpdate:modelValue":a[12]||(a[12]=l=>E.value=l),title:t(o)("config.agentConfig.deleteConfirm")},{footer:J(()=>[e("button",{class:"cancel-btn",onClick:a[11]||(a[11]=l=>E.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:$e},s(t(o)("common.delete")),1)]),default:J(()=>{var l;return[e("div",un,[b(t(T),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s((l=i.value)==null?void 0:l.name),1),k(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",pn,s(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),y.value?(c(),d("div",{key:0,class:"error-toast",onClick:a[13]||(a[13]=l=>y.value="")},[b(t(T),{icon:"carbon:error"}),k(" "+s(y.value),1)])):F("",!0),g.value?(c(),d("div",{key:1,class:"success-toast",onClick:a[14]||(a[14]=l=>g.value="")},[b(t(T),{icon:"carbon:checkmark"}),k(" "+s(g.value),1)])):F("",!0)]}),_:1}))}}),mn=ne(fn,[["__scopeId","data-v-9e905dc6"]]),gn={class:"custom-select"},vn=["title"],hn={key:0,class:"current-option"},yn={class:"option-name"},_n={key:1,class:"current-option"},bn={class:"dropdown-header"},Cn={class:"select-options"},$n=["onClick"],wn={class:"option-name"},kn=se({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{}},emits:["update:modelValue"],setup(B,{emit:o}){const n=B,u=o,y=R(!1),g=te(()=>n.options.find(A=>A.id===n.modelValue)),h=A=>A.id===n.modelValue,i=()=>{y.value=!y.value},M=A=>{u("update:modelValue",A.id),y.value=!1};return(A,E)=>(c(),d("div",gn,[e("button",{class:"select-btn",onClick:i,title:A.placeholder},[b(t(T),{icon:n.icon||"carbon:select-01",width:"18"},null,8,["icon"]),g.value?(c(),d("span",hn,[e("span",yn,s(g.value.name),1)])):(c(),d("span",_n,s(A.placeholder),1)),b(t(T),{icon:y.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,vn),b(Ce,{name:"slideDown"},{default:J(()=>[K(e("div",{class:"select-dropdown",style:Je({...A.dropStyles,...n.direction==="right"?{right:0}:{left:0}}),onClick:E[1]||(E[1]=be(()=>{},["stop"]))},[e("div",bn,[e("span",null,s(A.dropdownTitle),1),e("button",{class:"close-btn",onClick:E[0]||(E[0]=L=>y.value=!1)},[b(t(T),{icon:"carbon:close",width:"16"})])]),e("div",Cn,[(c(!0),d(Y,null,X(A.options,L=>(c(),d("button",{key:L.id,class:ee(["select-option",{active:h(L)}]),onClick:j=>M(L)},[e("span",wn,s(L.name),1),h(L)?(c(),W(t(T),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):F("",!0)],10,$n))),128))])],4),[[Ee,y.value]])]),_:1}),y.value?(c(),d("div",{key:0,class:"backdrop",onClick:E[2]||(E[2]=L=>y.value=!1)})):F("",!0)]))}}),Ue=ne(kn,[["__scopeId","data-v-138e90e7"]]),Sn={class:"grouped-select"},Tn=["title"],Nn={key:0,class:"selected-text"},Vn={class:"model-category"},Mn={key:1,class:"placeholder-text"},An={key:1,class:"dropdown-content"},Un={class:"dropdown-header"},En={class:"search-container"},Pn=["placeholder"],xn={class:"groups-container"},Dn={class:"group-header"},Ln={class:"group-title"},Rn={class:"group-count"},Fn={class:"models-grid"},Bn=["onClick","title"],In={class:"model-info"},On={class:"model-name"},qn={class:"model-description"},Gn={class:"model-category-tag"},jn=se({__name:"GroupedSelect",props:{modelValue:{},options:{},placeholder:{default:"请选择模型"},dropdownTitle:{default:"可用模型"}},emits:["update:modelValue"],setup(B,{emit:o}){const n=B,u=o,{t:y}=fe(),g=R(!1),h=R(""),i=te(()=>{const S={};return n.options.forEach(w=>{S[w.category]||(S[w.category]=[]),S[w.category].push(w)}),["Turbo","Plus","Max","Coder","Math","Vision","TTS","Standard"].filter(w=>S[w]).map(w=>({category:w,models:S[w].sort((x,Q)=>x.name.localeCompare(Q.name))}))}),M=te(()=>h.value?i.value.map(S=>({...S,models:S.models.filter(N=>N.name.toLowerCase().includes(h.value.toLowerCase())||N.description.toLowerCase().includes(h.value.toLowerCase())||N.category.toLowerCase().includes(h.value.toLowerCase()))})).filter(S=>S.models.length>0):i.value),A=te(()=>n.options.find(S=>S.id===n.modelValue)),E=()=>{g.value=!g.value,g.value&&(h.value="")},L=()=>{g.value=!1,h.value=""},j=S=>{u("update:modelValue",S.id),L()},I=S=>{S.target.closest(".grouped-select")||L()};return ve(()=>{document.addEventListener("click",I)}),ze(()=>{document.removeEventListener("click",I)}),(S,N)=>(c(),d("div",Sn,[e("button",{class:"select-btn",onClick:E,title:S.placeholder||""},[A.value?(c(),d("span",Nn,[k(s(A.value.name)+" ",1),e("span",Vn,"["+s(A.value.category)+"]",1)])):(c(),d("span",Mn,s(S.placeholder),1)),b(t(T),{icon:"carbon:chevron-down",class:ee(["chevron",{rotated:g.value}])},null,8,["class"])],8,Tn),g.value?(c(),d("div",{key:0,class:"dropdown-overlay",onClick:L})):F("",!0),g.value?(c(),d("div",An,[e("div",Un,[e("h3",null,s(S.dropdownTitle),1),e("button",{class:"close-btn",onClick:L},[b(t(T),{icon:"carbon:close"})])]),e("div",En,[K(e("input",{"onUpdate:modelValue":N[0]||(N[0]=w=>h.value=w),type:"text",placeholder:t(y)("config.modelConfig.searchModels"),class:"search-input"},null,8,Pn),[[H,h.value]]),b(t(T),{icon:"carbon:search",class:"search-icon"})]),e("div",xn,[(c(!0),d(Y,null,X(M.value,w=>(c(),d("div",{key:w.category,class:"model-group"},[e("div",Dn,[e("span",Ln,s(w.category),1),e("span",Rn,"("+s(w.models.length)+")",1)]),e("div",Fn,[(c(!0),d(Y,null,X(w.models,x=>(c(),d("button",{key:x.id,class:ee(["model-option",{selected:x.id===S.modelValue}]),onClick:Q=>j(x),title:x.description},[e("div",In,[e("div",On,s(x.name),1),e("div",qn,s(x.description),1)]),e("div",Gn,"["+s(x.category)+"]",1)],10,Bn))),128))])]))),128))])])):F("",!0)]))}}),Le=ne(jn,[["__scopeId","data-v-bed97f2a"]]),Kn=["disabled"],Jn={class:"model-layout"},zn={class:"model-list"},Hn={class:"list-header"},Yn={class:"model-count"},Wn={key:0,class:"models-container"},Xn=["onClick"],Qn={class:"model-card-header"},Zn={class:"model-name"},ea={class:"model-desc"},oa={key:0,class:"model-type"},ta={class:"model-tag"},sa={key:1,class:"loading-state"},na={key:2,class:"empty-state"},aa={key:0,class:"model-detail"},la={class:"detail-header"},ia={class:"detail-actions"},ca={class:"form-item"},ra={class:"form-item"},da=["placeholder"],ua={class:"form-item"},pa={class:"api-key-container"},fa=["placeholder"],ma=["disabled","title"],ga={class:"form-item"},va={key:1,class:"readonly-field"},ha={class:"form-item"},ya={class:"readonly-field description-field"},_a={key:1,class:"no-selection"},ba={class:"modal-form"},Ca={class:"form-item"},$a={class:"form-item"},wa=["placeholder"],ka={class:"form-item"},Sa={class:"api-key-container"},Ta=["placeholder"],Na=["disabled","title"],Va={class:"form-item"},Ma={key:1,class:"readonly-field"},Aa={class:"form-item"},Ua={class:"readonly-field description-field"},Ea={class:"delete-confirm"},Pa={class:"warning-text"},xa=se({__name:"modelConfig",setup(B){const{t:o}=fe(),n=R(!1),u=R(""),y=R(""),g=ae([]),h=ae([]),i=R(null),M=R(!1),A=R(!1),E=R(!1),L=R(new Map),j=R(!1),I=R([]),S=ae({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),N=(p,a)=>{a==="success"?(y.value=p,setTimeout(()=>{y.value=""},3e3)):(u.value=p,setTimeout(()=>{u.value=""},5e3))},w=async()=>{n.value=!0;try{const[p,a]=await Promise.all([ie.getAllModels(),ie.getAllTypes()]),m=p.map(l=>({...l}));g.splice(0,g.length,...m),h.splice(0,h.length,...a),m.length>0&&await x(m[0])}catch(p){console.error("加载数据失败:",p),N(o("config.modelConfig.loadDataFailed")+": "+p.message,"error")}finally{n.value=!1}},x=async p=>{try{const a=await ie.getModelById(p.id);i.value={...a},E.value=!1}catch(a){console.error("加载Model详情失败:",a),N(o("config.modelConfig.loadDetailsFailed")+": "+a.message,"error"),i.value={...p}}},Q=()=>{S.baseUrl="",S.apiKey="",S.modelName="",S.modelDescription="",S.type="",j.value=!1,I.value=[],M.value=!0},le=async()=>{var p,a,m,l;if(!((p=i.value)!=null&&p.baseUrl)||!((a=i.value)!=null&&a.apiKey)){N(o("config.modelConfig.pleaseEnterBaseUrlAndApiKey"),"error");return}E.value=!0;try{const C=await ie.validateConfig({baseUrl:i.value.baseUrl,apiKey:i.value.apiKey});C.valid?(N(o("config.modelConfig.validationSuccess")+` - ${o("config.modelConfig.getModelsCount",{count:((m=C.availableModels)==null?void 0:m.length)||0})}`,"success"),(l=i.value)!=null&&l.id&&L.value.set(i.value.id,C.availableModels||[]),C.availableModels&&C.availableModels.length>0&&(i.value.modelName=C.availableModels[0].modelName,i.value.modelDescription=C.availableModels[0].description||P(C.availableModels[0].modelName))):N(o("config.modelConfig.validationFailed")+": "+C.message,"error")}catch(C){N(o("config.modelConfig.validationFailed")+": "+C.message,"error")}finally{E.value=!1}},D=p=>{const a=p.toLowerCase();return a.includes("turbo")?"Turbo":a.includes("plus")?"Plus":a.includes("max")?"Max":a.includes("coder")||a.includes("code")?"Coder":a.includes("math")?"Math":a.includes("vision")||a.includes("vl")?"Vision":a.includes("tts")?"TTS":"Standard"},P=p=>{const a=p.toLowerCase();return a.includes("turbo")?"通义千问 Turbo 模型，快速响应":a.includes("plus")?"通义千问 Plus 模型，平衡性能":a.includes("max")?"通义千问 Max 模型，最强性能":a.includes("coder")||a.includes("code")?"代码生成专用模型":a.includes("math")?"数学计算专用模型":a.includes("vision")||a.includes("vl")?"视觉理解模型":a.includes("tts")?"文本转语音模型":"标准模型"},_=()=>{var p;return(p=i.value)!=null&&p.id?L.value.get(i.value.id)||[]:[]},f=p=>{if(i.value&&p){const m=_().find(l=>l.modelName===p);m&&(i.value.modelDescription=m.description||P(p))}},r=async()=>{var p;if(!S.baseUrl||!S.apiKey){N(o("config.modelConfig.pleaseEnterBaseUrlAndApiKey"),"error");return}j.value=!0;try{const a=await ie.validateConfig({baseUrl:S.baseUrl,apiKey:S.apiKey});a.valid?(N(o("config.modelConfig.validationSuccess")+` - ${o("config.modelConfig.getModelsCount",{count:((p=a.availableModels)==null?void 0:p.length)||0})}`,"success"),I.value=a.availableModels||[],a.availableModels&&a.availableModels.length>0&&(S.modelName=a.availableModels[0].modelName,S.modelDescription=a.availableModels[0].description||P(a.availableModels[0].modelName))):N(o("config.modelConfig.validationFailed")+": "+a.message,"error")}catch(a){N(o("config.modelConfig.validationFailed")+": "+a.message,"error")}finally{j.value=!1}},$=p=>{if(p){const a=I.value.find(m=>m.modelName===p);a&&(S.modelDescription=a.description||P(p))}},q=async()=>{if(!S.modelName.trim()||!S.modelDescription.trim()){N(o("config.modelConfig.requiredFields"),"error");return}try{const p={baseUrl:S.baseUrl.trim(),apiKey:S.apiKey.trim(),modelName:S.modelName.trim(),modelDescription:S.modelDescription.trim(),type:S.type.trim()},a=await ie.createModel(p);g.push(a),i.value=a,M.value=!1,N(o("config.modelConfig.createSuccess"),"success")}catch(p){N(o("config.modelConfig.createFailed")+": "+p.message,"error")}},z=async()=>{if(i.value){if(!i.value.modelName.trim()||!i.value.modelDescription.trim()){N(o("config.modelConfig.requiredFields"),"error");return}try{const p=await ie.updateModel(i.value.id,i.value),a=g.findIndex(m=>m.id===p.id);a!==-1&&(g[a]=p),i.value=p,N(o("config.modelConfig.saveSuccess"),"success")}catch(p){N(o("config.modelConfig.saveFailed")+": "+p.message,"error")}}},re=()=>{A.value=!0},$e=async()=>{if(i.value)try{await ie.deleteModel(i.value.id);const p=g.findIndex(a=>a.id===i.value.id);p!==-1&&g.splice(p,1),i.value=g.length>0?g[0]:null,A.value=!1,N(o("config.modelConfig.deleteSuccess"),"success")}catch(p){N(o("config.modelConfig.deleteFailed")+": "+p.message,"error")}},he=()=>{const p=document.createElement("input");p.type="file",p.accept=".json",p.onchange=a=>{var l;const m=(l=a.target.files)==null?void 0:l[0];if(m){const C=new FileReader;C.onload=async U=>{var V;try{const v=JSON.parse((V=U.target)==null?void 0:V.result);if(!v.modelName||!v.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:O,...G}=v,Z=await ie.createModel(G);g.push(Z),i.value=Z,N(o("config.modelConfig.importSuccess"),"success")}catch(v){N(o("config.modelConfig.importFailed")+": "+v.message,"error")}},C.readAsText(m)}},p.click()},me=()=>{if(i.value)try{const p=JSON.stringify(i.value,null,2),a=new Blob([p],{type:"application/json"}),m=URL.createObjectURL(a),l=document.createElement("a");l.href=m,l.download=`model-${i.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(m),N(o("config.modelConfig.exportSuccess"),"success")}catch(p){N(o("config.modelConfig.exportFailed")+": "+p.message,"error")}};return ve(()=>{w()}),(p,a)=>(c(),W(Ne,null,{title:J(()=>[e("h2",null,s(t(o)("config.modelConfig.title")),1)]),actions:J(()=>[e("button",{class:"action-btn",onClick:he},[b(t(T),{icon:"carbon:upload"}),k(" "+s(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:me,disabled:!i.value},[b(t(T),{icon:"carbon:download"}),k(" "+s(t(o)("config.modelConfig.export")),1)],8,Kn)]),default:J(()=>[e("div",Jn,[e("div",zn,[e("div",Hn,[e("h3",null,s(t(o)("config.modelConfig.configuredModels")),1),e("span",Yn,"("+s(g.length)+")",1)]),n.value?F("",!0):(c(),d("div",Wn,[(c(!0),d(Y,null,X(g,m=>{var l;return c(),d("div",{key:m.id,class:ee(["model-card",{active:((l=i.value)==null?void 0:l.id)===m.id}]),onClick:C=>x(m)},[e("div",Qn,[e("span",Zn,s(m.modelName),1),b(t(T),{icon:"carbon:chevron-right"})]),e("p",ea,s(m.modelDescription),1),m.type?(c(),d("div",oa,[e("span",ta,s(m.type),1)])):F("",!0)],10,Xn)}),128))])),n.value?(c(),d("div",sa,[b(t(T),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(t(o)("common.loading")),1)])):F("",!0),!n.value&&g.length===0?(c(),d("div",na,[b(t(T),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.modelConfig.noModel")),1)])):F("",!0),e("button",{class:"add-btn",onClick:Q},[b(t(T),{icon:"carbon:add"}),k(" "+s(t(o)("config.modelConfig.createNew")),1)])]),i.value?(c(),d("div",aa,[e("div",la,[e("h3",null,s(i.value.modelName),1),e("div",ia,[e("button",{class:"action-btn primary",onClick:z},[b(t(T),{icon:"carbon:save"}),k(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:re},[b(t(T),{icon:"carbon:trash-can"}),k(" "+s(t(o)("common.delete")),1)])])]),e("div",ca,[e("label",null,[k(s(t(o)("config.modelConfig.type"))+" ",1),a[13]||(a[13]=e("span",{class:"required"},"*",-1))]),b(Ue,{modelValue:i.value.type,"onUpdate:modelValue":a[0]||(a[0]=m=>i.value.type=m),options:h.map(m=>({id:m,name:m})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",ra,[e("label",null,[k(s(t(o)("config.modelConfig.baseUrl"))+" ",1),a[14]||(a[14]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=m=>i.value.baseUrl=m),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,da),[[H,i.value.baseUrl]])]),e("div",ua,[e("label",null,[k(s(t(o)("config.modelConfig.apiKey"))+" ",1),a[15]||(a[15]=e("span",{class:"required"},"*",-1))]),e("div",pa,[K(e("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=m=>i.value.apiKey=m),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,fa),[[H,i.value.apiKey]]),e("button",{class:"check-btn",onClick:le,disabled:E.value||!i.value.baseUrl||!i.value.apiKey,title:t(o)("config.modelConfig.validateConfig")},[E.value?(c(),W(t(T),{key:1,icon:"carbon:loading",class:"loading-icon"})):(c(),W(t(T),{key:0,icon:"carbon:checkmark"}))],8,ma)])]),e("div",ga,[e("label",null,[k(s(t(o)("config.modelConfig.modelName"))+" ",1),a[16]||(a[16]=e("span",{class:"required"},"*",-1))]),_().length>0?(c(),W(Le,{key:0,modelValue:i.value.modelName,"onUpdate:modelValue":[a[3]||(a[3]=m=>i.value.modelName=m),f],options:_().map(m=>({id:m.modelName,name:m.modelName,description:m.description||P(m.modelName),category:D(m.modelName)})),placeholder:t(o)("config.modelConfig.selectModel"),"dropdown-title":t(o)("config.modelConfig.availableModels")},null,8,["modelValue","options","placeholder","dropdown-title"])):(c(),d("div",va,s(i.value.modelName||t(o)("config.modelConfig.modelNamePlaceholder")),1))]),e("div",ha,[e("label",null,[k(s(t(o)("config.modelConfig.description"))+" ",1),a[17]||(a[17]=e("span",{class:"required"},"*",-1))]),e("div",ya,s(i.value.modelDescription||t(o)("config.modelConfig.descriptionPlaceholder")),1)])])):(c(),d("div",_a,[b(t(T),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.modelConfig.selectModelHint")),1)]))]),b(de,{modelValue:M.value,"onUpdate:modelValue":a[8]||(a[8]=m=>M.value=m),title:t(o)("config.modelConfig.newModel"),onConfirm:q},{default:J(()=>[e("div",ba,[e("div",Ca,[e("label",null,[k(s(t(o)("config.modelConfig.type"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),b(Ue,{modelValue:S.type,"onUpdate:modelValue":a[4]||(a[4]=m=>S.type=m),options:h.map(m=>({id:m,name:m})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",$a,[e("label",null,[k(s(t(o)("config.modelConfig.baseUrl"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=m=>S.baseUrl=m),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,wa),[[H,S.baseUrl]])]),e("div",ka,[e("label",null,[k(s(t(o)("config.modelConfig.apiKey"))+" ",1),a[20]||(a[20]=e("span",{class:"required"},"*",-1))]),e("div",Sa,[K(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=m=>S.apiKey=m),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Ta),[[H,S.apiKey]]),e("button",{class:"check-btn",onClick:r,disabled:j.value||!S.baseUrl||!S.apiKey,title:t(o)("config.modelConfig.validateConfig")},[j.value?(c(),W(t(T),{key:1,icon:"carbon:loading",class:"loading-icon"})):(c(),W(t(T),{key:0,icon:"carbon:checkmark"}))],8,Na)])]),e("div",Va,[e("label",null,[k(s(t(o)("config.modelConfig.modelName"))+" ",1),a[21]||(a[21]=e("span",{class:"required"},"*",-1))]),I.value.length>0?(c(),W(Le,{key:0,modelValue:S.modelName,"onUpdate:modelValue":[a[7]||(a[7]=m=>S.modelName=m),$],options:I.value.map(m=>({id:m.modelName,name:m.modelName,description:m.description||P(m.modelName),category:D(m.modelName)})),placeholder:t(o)("config.modelConfig.selectModel"),"dropdown-title":t(o)("config.modelConfig.availableModels")},null,8,["modelValue","options","placeholder","dropdown-title"])):(c(),d("div",Ma,s(S.modelName||t(o)("config.modelConfig.modelNamePlaceholder")),1))]),e("div",Aa,[e("label",null,[k(s(t(o)("config.modelConfig.description"))+" ",1),a[22]||(a[22]=e("span",{class:"required"},"*",-1))]),e("div",Ua,s(S.modelDescription||t(o)("config.modelConfig.descriptionPlaceholder")),1)])])]),_:1},8,["modelValue","title"]),b(de,{modelValue:A.value,"onUpdate:modelValue":a[10]||(a[10]=m=>A.value=m),title:"Delete confirmation"},{footer:J(()=>[e("button",{class:"cancel-btn",onClick:a[9]||(a[9]=m=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:$e},s(t(o)("common.delete")),1)]),default:J(()=>{var m;return[e("div",Ea,[b(t(T),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((m=i.value)==null?void 0:m.modelName),1),k(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",Pa,s(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),u.value?(c(),d("div",{key:0,class:"error-toast",onClick:a[11]||(a[11]=m=>u.value="")},[b(t(T),{icon:"carbon:error"}),k(" "+s(u.value),1)])):F("",!0),y.value?(c(),d("div",{key:1,class:"success-toast",onClick:a[12]||(a[12]=m=>y.value="")},[b(t(T),{icon:"carbon:checkmark"}),k(" "+s(y.value),1)])):F("",!0)]),_:1}))}}),Da=ne(xa,[["__scopeId","data-v-cd2adea0"]]);class Te{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!n.ok)throw new Error(`Failed to add MCP server: ${n.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(n){return console.error("Failed to add MCP server:",n),{success:!1,message:n instanceof Error?n.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const n=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!n.ok)throw new Error(`Failed to delete MCP server: ${n.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(n){return console.error(`Failed to delete MCP server[${o}]:`,n),{success:!1,message:n instanceof Error?n.message:"Failed to delete, please retry"}}}}ge(Te,"BASE_URL","/api/mcp");const La={class:"mcp-config-panel"},Ra={class:"mcp-header"},Fa={class:"header-left"},Ba={class:"mcp-stats"},Ia={class:"stat-item"},Oa={class:"stat-label"},qa={class:"stat-value"},Ga={class:"header-right"},ja={class:"search-box"},Ka=["placeholder"],Ja={key:0,class:"loading-container"},za={key:1,class:"mcp-layout"},Ha={class:"mcp-table-container"},Ya={class:"section-title"},Wa={key:0,class:"empty-state"},Xa={class:"empty-state-text"},Qa={key:1,class:"mcp-table-wrapper"},Za={class:"mcp-table"},el={class:"mcp-id"},ol={class:"mcp-server-name"},tl={class:"server-name-content"},sl={class:"mcp-connection-type"},nl={class:"mcp-config"},al=["title"],ll={class:"mcp-actions"},il=["onClick","disabled"],cl={class:"add-mcp-container"},rl={class:"add-mcp-header"},dl={class:"add-mcp-title"},ul={class:"mcp-form"},pl={class:"mcp-form-group"},fl={class:"form-label"},ml={class:"connection-type-options"},gl={class:"connection-type-option"},vl={for:"mcp-connection-type-studio",class:"radio-label"},hl={class:"connection-type-desc"},yl={class:"connection-type-option"},_l={for:"mcp-connection-type-sse",class:"radio-label"},bl={class:"connection-type-desc"},Cl={class:"connection-type-option"},$l={for:"mcp-connection-type-streaming",class:"radio-label"},wl={class:"connection-type-desc"},kl={class:"mcp-form-group"},Sl={class:"form-label"},Tl=["placeholder"],Nl={class:"mcp-form-actions"},Vl=["disabled"],Ml=["disabled"],Al={class:"mcp-form-instructions"},Ul={class:"indented-list"},El=se({__name:"mcpConfig",setup(B){const{t:o}=fe(),n=R(!1),u=R([]),y=R(""),g=ae({connectionType:"STUDIO",configJson:""}),h=ae({show:!1,text:"",type:"success"}),i=te(()=>g.configJson.trim().length>0),M=te(()=>{if(!y.value.trim())return u.value;const N=y.value.toLowerCase();return u.value.filter(w=>w.mcpServerName.toLowerCase().includes(N)||w.connectionType.toLowerCase().includes(N)||w.connectionConfig.toLowerCase().includes(N))}),A=N=>N?N.length>50?N.substring(0,50)+"...":N:"",E=(N,w="success")=>{h.text=N,h.type=w,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},L=async()=>{try{n.value=!0,u.value=await Te.getAllMcpServers()}catch(N){console.error("加载MCP服务器列表失败:",N),E(o("config.basicConfig.loadConfigFailed"),"error")}finally{n.value=!1}},j=async()=>{if(!i.value){E(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(g.configJson)}catch{E(o("config.mcpConfig.invalidJson"),"error");return}try{n.value=!0;const N={connectionType:g.connectionType,configJson:g.configJson},w=await Te.addMcpServer(N);w.success?(E(o("config.mcpConfig.addSuccess")),S(),await L()):E(w.message||o("config.mcpConfig.addFailed"),"error")}catch(N){console.error("添加MCP服务器失败:",N),E(o("config.mcpConfig.addFailed"),"error")}finally{n.value=!1}},I=async N=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{n.value=!0;const w=await Te.removeMcpServer(N);w.success?(E(o("config.mcpConfig.deleteSuccess")),await L()):E(w.message||o("config.mcpConfig.deleteFailed"),"error")}catch(w){console.error("删除MCP服务器失败:",w),E(o("config.mcpConfig.deleteFailed"),"error")}finally{n.value=!1}},S=()=>{g.connectionType="STUDIO",g.configJson=""};return ve(()=>{L()}),(N,w)=>(c(),d("div",La,[e("div",Ra,[e("div",Fa,[e("h2",null,s(t(o)("config.mcpConfig.title")),1),e("div",Ba,[e("span",Ia,[e("span",Oa,s(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",qa,s(u.value.length),1)])])]),e("div",Ga,[e("div",ja,[K(e("input",{"onUpdate:modelValue":w[0]||(w[0]=x=>y.value=x),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,Ka),[[H,y.value]]),w[5]||(w[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),n.value?(c(),d("div",Ja,[w[6]||(w[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(t(o)("config.loading")),1)])):(c(),d("div",za,[e("div",Ha,[e("h3",Ya,s(t(o)("config.mcpConfig.serverList")),1),M.value.length===0?(c(),d("div",Wa,[w[7]||(w[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Xa,s(y.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(c(),d("div",Qa,[e("table",Za,[e("thead",null,[e("tr",null,[w[8]||(w[8]=e("th",null,"ID",-1)),e("th",null,s(t(o)("agent.name")),1),e("th",null,s(t(o)("config.mcpConfig.connectionType")),1),e("th",null,s(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,s(t(o)("common.actions")),1)])]),e("tbody",null,[(c(!0),d(Y,null,X(M.value,x=>(c(),d("tr",{key:x.id,class:"mcp-row"},[e("td",el,s(x.id),1),e("td",ol,[e("div",tl,[w[9]||(w[9]=e("span",{class:"server-icon"},"🔌",-1)),k(" "+s(x.mcpServerName),1)])]),e("td",sl,[e("span",{class:ee(["connection-type-badge",x.connectionType.toLowerCase()])},s(x.connectionType),3)]),e("td",nl,[e("div",{class:"config-preview",title:x.connectionConfig},s(A(x.connectionConfig)),9,al)]),e("td",ll,[e("button",{onClick:Q=>I(x.id),class:"action-btn delete-btn",disabled:n.value},s(t(o)("common.delete")),9,il)])]))),128))])])]))]),e("div",cl,[e("div",rl,[e("h3",dl,s(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",ul,[e("div",pl,[e("label",fl,s(t(o)("config.mcpConfig.connectionType"))+"：",1),e("div",ml,[e("div",gl,[K(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":w[1]||(w[1]=x=>g.connectionType=x),value:"STUDIO"},null,512),[[Ae,g.connectionType]]),e("label",vl,[w[10]||(w[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",hl,s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",yl,[K(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":w[2]||(w[2]=x=>g.connectionType=x),value:"SSE"},null,512),[[Ae,g.connectionType]]),e("label",_l,[w[11]||(w[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",bl,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Cl,[K(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":w[3]||(w[3]=x=>g.connectionType=x),value:"STREAMING"},null,512),[[Ae,g.connectionType]]),e("label",$l,[w[12]||(w[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",wl,s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",kl,[e("label",Sl,s(t(o)("config.mcpConfig.configJsonLabel")),1),K(e("textarea",{"onUpdate:modelValue":w[4]||(w[4]=x=>g.configJson=x),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,Tl),[[H,g.configJson]])]),e("div",Nl,[e("button",{onClick:j,class:"action-btn add-btn",disabled:n.value},s(t(o)("common.add")),9,Vl),e("button",{onClick:S,class:"action-btn reset-btn",disabled:n.value},s(t(o)("common.reset")),9,Ml)])]),e("div",Al,[e("h4",null,s(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[k(s(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",Ul,[e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Local")),1),k("："+s(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,s(t(o)("config.mcpConfig.instructionStep1Remote")),1),k("："+s(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,s(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,s(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),b(Ce,{name:"message-fade"},{default:J(()=>[h.show?(c(),d("div",{key:0,class:ee(["message-toast",h.type])},s(h.text),3)):F("",!0)]),_:1})]))}}),Pl=ne(El,[["__scopeId","data-v-355da8bb"]]);class ye{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const n=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to get Prompt list:",n),n}}static async getPromptById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,n),n}}static async createPrompt(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Prompt:",n),n}}static async updatePrompt(o,n){try{const u=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(u)).json()}catch(u){throw console.error(`Failed to update Prompt[${o}]:`,u),u}}static async deletePrompt(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Prompt[${o}]:`,n),n}}}ge(ye,"BASE_URL","/api/prompt");const xl=se({__name:"Toast",setup(B,{expose:o}){const n=R(!1),u=R(""),y=R("success"),g=R("carbon:checkmark"),h=R(3e3),i=(A,E="success",L=3e3)=>{u.value=A,y.value=E,g.value=E==="success"?"carbon:checkmark":"carbon:error",h.value=L,n.value=!0,setTimeout(()=>{n.value=!1},h.value)},M=()=>{n.value=!1};return o({show:i}),(A,E)=>(c(),W(Re,{to:"body"},[b(Ce,{name:"slide"},{default:J(()=>[n.value?(c(),d("div",{key:0,class:ee(["toast",`toast--${y.value}`]),onClick:M},[b(t(T),{icon:g.value,class:"toast-icon"},null,8,["icon"]),e("span",null,s(u.value),1)],2)):F("",!0)]),_:1})]))}}),Dl=ne(xl,[["__scopeId","data-v-581895ae"]]);let ue=null;const Fe=()=>{if(!ue){const B=He(Dl),o=document.createElement("div");document.body.appendChild(o),ue=B.mount(o)}return{success:(B,o)=>{ue==null||ue.show(B,"success",o)},error:(B,o)=>{ue==null||ue.show(B,"error",o)}}},Ll={class:"custom-select"},Rl=["title"],Fl={key:0,class:"current-option"},Bl={class:"option-name"},Il={key:1,class:"current-option"},Ol={class:"select-options"},ql=["onClick"],Gl={class:"option-name"},jl=se({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(B,{emit:o}){const n=B,u=o,y=R(!1),g=te(()=>n.options.find(A=>A.id===n.modelValue)),h=A=>A.id===n.modelValue,i=()=>{y.value=!y.value},M=A=>{u("update:modelValue",A.id),y.value=!1};return(A,E)=>(c(),d("div",Ll,[e("button",{class:"select-btn",onClick:i,title:A.placeholder},[g.value?(c(),d("span",Fl,[e("span",Bl,s(g.value.name),1)])):(c(),d("span",Il,s(A.placeholder),1)),b(t(T),{icon:y.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Rl),b(Ce,{name:"slideDown"},{default:J(()=>[K(e("div",{class:"select-dropdown",onClick:E[0]||(E[0]=be(()=>{},["stop"]))},[e("div",Ol,[(c(!0),d(Y,null,X(A.options,L=>(c(),d("button",{key:L.id,class:ee(["select-option",{active:h(L)}]),onClick:j=>M(L)},[e("span",Gl,s(L.name),1),h(L)?(c(),W(t(T),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):F("",!0)],10,ql))),128))])],512),[[Ee,y.value]])]),_:1}),y.value?(c(),d("div",{key:0,class:"backdrop",onClick:E[1]||(E[1]=L=>y.value=!1)})):F("",!0)]))}}),Se=ne(jl,[["__scopeId","data-v-4c6d676f"]]),Kl={class:"prompt-layout"},Jl={class:"prompt-list"},zl={class:"list-header"},Hl={class:"prompt-count"},Yl={key:0,class:"prompts-container"},Wl=["onClick"],Xl={class:"prompt-card-header"},Ql={class:"prompt-name"},Zl={key:0,class:"prompt-desc"},ei={class:"tags"},oi={class:"tag"},ti={key:1,class:"loading-state"},si={key:2,class:"empty-state"},ni={key:0,class:"prompt-detail"},ai={class:"detail-header"},li={class:"detail-actions"},ii={class:"form-item"},ci=["placeholder"],ri={class:"form-item"},di={class:"form-item"},ui={class:"form-item"},pi=["placeholder"],fi={class:"form-item"},mi=["placeholder"],gi={key:1,class:"no-selection"},vi={class:"modal-form"},hi={class:"form-item"},yi=["placeholder"],_i={class:"form-item"},bi={class:"form-item"},Ci={class:"form-item"},$i=["placeholder"],wi={class:"form-item"},ki=["placeholder"],Si={class:"delete-confirm"},Ti={class:"warning-text"},Ni=se({__name:"dynamicPromptConfig",setup(B){const{t:o}=fe(),{success:n,error:u}=Fe(),y=Pe(),g=R(!1),h=ae([]),i=R(null),M=R(!1),A=R(!1),E=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],L=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],j={promptName:"",messageType:"",type:"",promptDescription:""},I=ae({...j}),S=async()=>{g.value=!0;try{const f=await ye.getAllPrompts(y.namespace);f.length>0&&await N(f[0]),h.splice(0,h.length,...f)}catch(f){console.error("加载数据失败:",f),u(o("config.promptConfig.loadDataFailed")+": "+f.message)}finally{g.value=!1}},N=async f=>{try{const r=await ye.getPromptById(f.id);i.value={...r}}catch(r){console.error("加载Prompt详情失败:",r),u(o("config.promptConfig.loadDetailsFailed")+": "+r.message),i.value={...f}}},w=async()=>{if(le(I))try{const f={...I,builtIn:!1},r=await ye.createPrompt(f);h.push(r),i.value=r,M.value=!1,n(o("config.promptConfig.createSuccess"))}catch(f){u(o("config.promptConfig.createFailed")+": "+f.message)}},x=async()=>{if(i.value&&le(i.value))try{const f=await ye.updatePrompt(i.value.id,i.value),r=h.findIndex($=>$.id===f.id);r!==-1&&(h[r]=f),i.value={...f},n(o("config.promptConfig.saveSuccess"))}catch(f){u(o("config.promptConfig.saveFailed")+": "+f.message)}},Q=async()=>{if(i.value)try{await ye.deletePrompt(i.value.id);const f=h.findIndex(r=>r.id===i.value.id);f!==-1&&h.splice(f,1),i.value=h.length>0?h[0]:null,A.value=!1,n(o("config.promptConfig.deleteSuccess"))}catch(f){u(o("config.promptConfig.deleteFailed")+": "+f.message)}};function le(f){const r=["promptName","messageType","type","promptContent"];for(const q of r){const z=f[q];if(z==null||typeof z=="string"&&z.trim()==="")return u(`${q} is required and cannot be empty`),!1}return!!D(h,f)}function D(f,r){const $=f.find(q=>q.promptName===r.promptName);return $&&r.id&&$.id!==r.id?(u(`Name "${r.promptName}" already exists. Please use a different name.`),!1):$&&!r.id?(u(`Name "${r.promptName}" already exists. Please use a different name.`),!1):!0}const P=()=>{I.promptName="",I.promptDescription="",I.promptContent="",Object.assign(I,j),M.value=!0},_=()=>{A.value=!0};return ve(()=>{S()}),(f,r)=>(c(),W(Ne,null,{title:J(()=>[e("h2",null,s(t(o)("config.promptConfig.title")),1)]),default:J(()=>[e("div",Kl,[e("div",Jl,[e("div",zl,[e("h3",null,s(t(o)("config.promptConfig.configuredprompts")),1),e("span",Hl,"("+s(h.length)+s(t(o)("config.promptConfig.promptCount"))+")",1)]),g.value?F("",!0):(c(),d("div",Yl,[(c(!0),d(Y,null,X(h,$=>{var q,z;return c(),d("div",{key:$.id,class:ee(["prompt-card",{active:((q=i.value)==null?void 0:q.id)===$.id}]),onClick:re=>N($)},[e("div",Xl,[e("span",Ql,s($.promptName),1),b(t(T),{icon:"carbon:chevron-right"})]),(z=$.promptDescription)!=null&&z.trim()?(c(),d("p",Zl,s($.promptDescription),1)):F("",!0),e("div",ei,[e("span",oi,s($.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,Wl)}),128))])),g.value?(c(),d("div",ti,[b(t(T),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(t(o)("common.loading")),1)])):F("",!0),!g.value&&h.length===0?(c(),d("div",si,[b(t(T),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.promptConfig.noPrompts")),1)])):F("",!0),e("button",{class:"add-btn",onClick:P},[b(t(T),{icon:"carbon:add"}),k(" "+s(t(o)("config.promptConfig.createNew")),1)])]),i.value?(c(),d("div",ni,[e("div",ai,[e("h3",null,s(i.value.promptName),1),e("div",li,[e("button",{class:"action-btn primary",onClick:x},[b(t(T),{icon:"carbon:save"}),k(" "+s(t(o)("common.save")),1)]),i.value.builtIn?F("",!0):(c(),d("button",{key:0,class:"action-btn danger",onClick:_},[b(t(T),{icon:"carbon:trash-can"}),k(" "+s(t(o)("common.delete")),1)]))])]),e("div",ii,[e("label",null,[k(s(t(o)("config.promptConfig.promptName"))+" ",1),r[15]||(r[15]=e("span",{class:"required"},"*",-1))]),K(e("input",{disabled:!0,type:"text","onUpdate:modelValue":r[0]||(r[0]=$=>i.value.promptName=$),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,ci),[[H,i.value.promptName]])]),e("div",ri,[e("label",null,[k(s(t(o)("config.promptConfig.messageType"))+" ",1),r[16]||(r[16]=e("span",{class:"required"},"*",-1))]),i.value.builtIn?K((c(),d("input",{key:1,type:"text","onUpdate:modelValue":r[2]||(r[2]=$=>i.value.messageType=$),disabled:!0},null,512)),[[H,i.value.messageType]]):(c(),W(Se,{key:0,modelValue:i.value.messageType,"onUpdate:modelValue":r[1]||(r[1]=$=>i.value.messageType=$),options:E,disabled:i.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",di,[e("label",null,[k(s(t(o)("config.promptConfig.type"))+" ",1),r[17]||(r[17]=e("span",{class:"required"},"*",-1))]),i.value.builtIn?K((c(),d("input",{key:1,type:"text","onUpdate:modelValue":r[4]||(r[4]=$=>i.value.type=$),disabled:!0,required:""},null,512)),[[H,i.value.type]]):(c(),W(Se,{key:0,modelValue:i.value.type,"onUpdate:modelValue":r[3]||(r[3]=$=>i.value.type=$),options:L,disabled:i.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",ui,[e("label",null,s(t(o)("config.promptConfig.description")),1),K(e("textarea",{"onUpdate:modelValue":r[5]||(r[5]=$=>i.value.promptDescription=$),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,pi),[[H,i.value.promptDescription]])]),e("div",fi,[e("label",null,[k(s(t(o)("config.promptConfig.promptContent"))+" ",1),r[18]||(r[18]=e("span",{class:"required"},"*",-1))]),K(e("textarea",{"onUpdate:modelValue":r[6]||(r[6]=$=>i.value.promptContent=$),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,mi),[[H,i.value.promptContent]])])])):(c(),d("div",gi,[b(t(T),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.promptConfig.selectPromptHint")),1)]))]),b(de,{modelValue:M.value,"onUpdate:modelValue":r[12]||(r[12]=$=>M.value=$),title:t(o)("config.promptConfig.newPrompt"),onConfirm:w},{default:J(()=>[e("div",vi,[e("div",hi,[e("label",null,[k(s(t(o)("config.promptConfig.promptName"))+" ",1),r[19]||(r[19]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":r[7]||(r[7]=$=>I.promptName=$),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,yi),[[H,I.promptName]])]),e("div",_i,[e("label",null,[k(s(t(o)("config.promptConfig.messageType"))+" ",1),r[20]||(r[20]=e("span",{class:"required"},"*",-1))]),b(Se,{modelValue:I.messageType,"onUpdate:modelValue":r[8]||(r[8]=$=>I.messageType=$),options:E,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",bi,[e("label",null,[k(s(t(o)("config.promptConfig.type"))+" ",1),r[21]||(r[21]=e("span",{class:"required"},"*",-1))]),b(Se,{modelValue:I.type,"onUpdate:modelValue":r[9]||(r[9]=$=>I.type=$),options:L,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Ci,[e("label",null,s(t(o)("config.promptConfig.description")),1),K(e("textarea",{"onUpdate:modelValue":r[10]||(r[10]=$=>I.promptDescription=$),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,$i),[[H,I.promptDescription]])]),e("div",wi,[e("label",null,[k(s(t(o)("config.promptConfig.promptContent"))+" ",1),r[22]||(r[22]=e("span",{class:"required"},"*",-1))]),K(e("textarea",{"onUpdate:modelValue":r[11]||(r[11]=$=>I.promptContent=$),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,ki),[[H,I.promptContent]])])])]),_:1},8,["modelValue","title"]),b(de,{modelValue:A.value,"onUpdate:modelValue":r[14]||(r[14]=$=>A.value=$),title:t(o)("config.promptConfig.deleteConfirm")},{footer:J(()=>[e("button",{class:"cancel-btn",onClick:r[13]||(r[13]=$=>A.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Q},s(t(o)("common.delete")),1)]),default:J(()=>{var $;return[e("div",Si,[b(t(T),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,s(($=i.value)==null?void 0:$.promptName),1),k(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",Ti,s(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),Vi=ne(Ni,[["__scopeId","data-v-697ad7ba"]]);class _e{static async handleResponse(o){if(!o.ok)try{const n=await o.json();throw new Error(n.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const n=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(n)).json()}catch(n){throw console.error(`Failed to get Namespace[${o}] details:`,n),n}}static async createNamespace(o){try{const n=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(n)).json()}catch(n){throw console.error("Failed to create Namespace:",n),n}}static async updateNamespace(o,n){try{const u=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return await(await this.handleResponse(u)).json()}catch(u){throw console.error(`Failed to update Namespace[${o}]:`,u),u}}static async deleteNamespace(o){try{const n=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(n.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(n)}catch(n){throw console.error(`Failed to delete Namespace[${o}]:`,n),n}}}ge(_e,"BASE_URL","/api/namespace");const Mi={class:"namespace-layout"},Ai={class:"namespace-list"},Ui={class:"list-header"},Ei={key:0,class:"namespaces-container"},Pi=["onClick"],xi={class:"namespace-card-header"},Di={class:"namespace-name"},Li={key:0,class:"loading-state"},Ri={key:1,class:"empty-state"},Fi={key:0,class:"namespace-detail"},Bi={class:"detail-header"},Ii={class:"detail-actions"},Oi={class:"form-item"},qi=["placeholder"],Gi={key:1,class:"no-selection"},ji={class:"modal-form"},Ki={class:"form-item"},Ji=["placeholder"],zi={class:"delete-confirm"},Hi={class:"warning-text"},Yi=se({__name:"namespaceConfig",setup(B){const{t:o}=fe(),{success:n,error:u}=Fe(),y=R(!1),g=ae([]),h=R(null),i=R(!1),M=R(!1),A={name:""},E=ae({...A}),L=async()=>{y.value=!0;try{const D=await _e.getAllNamespaces();D.length>0&&await j(D[0]),g.splice(0,g.length,...D)}catch(D){console.error("加载数据失败:",D),u(o("config.namespaceConfig.loadDataFailed")+": "+D.message)}finally{y.value=!1}},j=async D=>{try{const P=await _e.getNamespaceById(D.id);h.value={...P}}catch(P){console.error("加载Prompt详情失败:",P),u(o("config.namespaceConfig.loadDetailsFailed")+": "+P.message),h.value={...D}}},I=async()=>{if(w(E))try{const D={...E},P=await _e.createNamespace(D);g.push(P),h.value=P,i.value=!1,n(o("config.namespaceConfig.createSuccess"))}catch(D){u(o("config.namespaceConfig.createFailed")+": "+D.message)}},S=async()=>{if(h.value&&w(h.value))try{const D=await _e.updateNamespace(h.value.id,h.value),P=g.findIndex(_=>_.id===D.id);P!==-1&&(g[P]=D),h.value={...D},n(o("config.namespaceConfig.saveSuccess"))}catch(D){u(o("config.namespaceConfig.saveFailed")+": "+D.message)}},N=async()=>{if(h.value)try{await _e.deleteNamespace(h.value.id);const D=g.findIndex(P=>P.id===h.value.id);D!==-1&&g.splice(D,1),h.value=g.length>0?g[0]:null,M.value=!1,n(o("config.namespaceConfig.deleteSuccess"))}catch(D){u(o("config.namespaceConfig.deleteFailed")+": "+D.message)}};function w(D){const P=["name"];for(const f of P){const r=D[f];if(r==null||typeof r=="string"&&r.trim()==="")return u(`${f} is required and cannot be empty`),!1}return!!x(g,D)}function x(D,P){const _=D.find(f=>f.name===P.name);return _&&P.id&&_.id!==P.id?(u(`Name "${P.name}" already exists. Please use a different name.`),!1):_&&!P.id?(u(`Name "${P.name}" already exists. Please use a different name.`),!1):!0}const Q=()=>{E.name="",Object.assign(E,A),i.value=!0},le=()=>{M.value=!0};return ve(()=>{L()}),(D,P)=>(c(),W(Ne,null,{title:J(()=>[e("h2",null,s(t(o)("config.namespaceConfig.title")),1)]),default:J(()=>[e("div",Mi,[e("div",Ai,[e("div",Ui,[e("h3",null,s(t(o)("config.namespaceConfig.configured")),1)]),y.value?F("",!0):(c(),d("div",Ei,[(c(!0),d(Y,null,X(g,_=>{var f;return c(),d("div",{key:_.id,class:ee(["namespace-card",{active:((f=h.value)==null?void 0:f.id)===_.id}]),onClick:r=>j(_)},[e("div",xi,[e("span",Di,s(_.name),1),b(t(T),{icon:"carbon:chevron-right"})])],10,Pi)}),128))]))]),y.value?(c(),d("div",Li,[b(t(T),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(t(o)("common.loading")),1)])):F("",!0),!y.value&&g.length===0?(c(),d("div",Ri,[b(t(T),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(t(o)("config.namespaceConfig.noPrompts")),1)])):F("",!0),e("button",{class:"add-btn",onClick:Q},[b(t(T),{icon:"carbon:add"}),k(" "+s(t(o)("config.namespaceConfig.createNew")),1)])]),h.value?(c(),d("div",Fi,[e("div",Bi,[e("h3",null,s(h.value.name),1),e("div",Ii,[e("button",{class:"action-btn primary",onClick:S},[b(t(T),{icon:"carbon:save"}),k(" "+s(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:le},[b(t(T),{icon:"carbon:trash-can"}),k(" "+s(t(o)("common.delete")),1)])])]),e("div",Oi,[e("label",null,[k(s(t(o)("config.namespaceConfig.name"))+" ",1),P[5]||(P[5]=e("span",{class:"required"},"*",-1))]),K(e("input",{disabled:!0,type:"text","onUpdate:modelValue":P[0]||(P[0]=_=>h.value.name=_),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,qi),[[H,h.value.name]])])])):(c(),d("div",Gi,[b(t(T),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(t(o)("config.namespaceConfig.selectPromptHint")),1)])),b(de,{modelValue:i.value,"onUpdate:modelValue":P[2]||(P[2]=_=>i.value=_),title:t(o)("config.namespaceConfig.newPrompt"),onConfirm:I},{default:J(()=>[e("div",ji,[e("div",Ki,[e("label",null,[k(s(t(o)("config.namespaceConfig.name"))+" ",1),P[6]||(P[6]=e("span",{class:"required"},"*",-1))]),K(e("input",{type:"text","onUpdate:modelValue":P[1]||(P[1]=_=>E.name=_),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,Ji),[[H,E.name]])])])]),_:1},8,["modelValue","title"]),b(de,{modelValue:M.value,"onUpdate:modelValue":P[4]||(P[4]=_=>M.value=_),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:J(()=>[e("button",{class:"cancel-btn",onClick:P[3]||(P[3]=_=>M.value=!1)},s(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:N},s(t(o)("common.delete")),1)]),default:J(()=>{var _;return[e("div",zi,[b(t(T),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((_=h.value)==null?void 0:_.name),1),k(" "+s(t(o)("common.confirm"))+"？ ",1)]),e("p",Hi,s(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),Wi=ne(Yi,[["__scopeId","data-v-d0b2912a"]]),Xi=se({__name:"namespaceSwitch",setup(B){const{namespace:o,setNamespace:n,db:u}=Pe(),y=g=>{n(g)};return(g,h)=>(c(),d("div",null,[b(Ue,{modelValue:t(o),"onUpdate:modelValue":h[0]||(h[0]=i=>Ye(o)?o.value=i:null),options:t(u),"dropdown-title":"命名空间",onChange:y,placeholder:"请选择命名空间",direction:"right",dropStyles:{minWidth:"180px"}},null,8,["modelValue","options"])]))}}),Qi={class:"config-container"},Zi={class:"config-header"},ec={class:"header-actions"},oc={class:"header-actions-left"},tc={class:"header-actions-right"},sc={class:"config-content"},nc={class:"config-nav"},ac=["onClick"],lc={class:"config-details"},ic=se({__name:"index",setup(B){const{t:o}=fe(),n=We(),u=Qe(),y=R(n.params.category||"basic"),g={basic:De,agent:mn,model:Da,mcp:Pl,prompt:Vi,namespace:Wi},h=te(()=>{const A=y.value;return g[A]||De}),i=te(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",disabled:!0,icon:"carbon:repo-artifact"}]),M=A=>{y.value=A,u.push({name:n.name,params:{...n.params,category:A},query:n.query})};return(A,E)=>(c(),d("div",Qi,[e("div",Zi,[e("div",ec,[e("div",oc,[e("button",{class:"action-btn",onClick:E[0]||(E[0]=L=>A.$router.push("/"))},[b(t(T),{icon:"carbon:arrow-left"}),k(" "+s(A.$t("backHome")),1)]),b(Ze)]),e("div",tc,[b(Xi)])])]),e("div",sc,[e("nav",nc,[(c(!0),d(Y,null,X(i.value,(L,j)=>(c(),d(Y,null,[L.disabled?F("",!0):(c(),d("div",{key:j,class:ee(["nav-item",{active:y.value===L.key}]),onClick:I=>M(L.key)},[b(t(T),{icon:L.icon,width:"20"},null,8,["icon"]),e("span",null,s(L.label),1)],10,ac))],64))),256))]),e("div",lc,[(c(),W(Xe(h.value)))])])]))}}),pc=ne(ic,[["__scopeId","data-v-5d4a51b7"]]);export{pc as default};
