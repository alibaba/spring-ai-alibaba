var Ie=Object.defineProperty;var qe=(D,o,s)=>o in D?Ie(D,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):D[o]=s;var me=(D,o,s)=>qe(D,typeof o!="symbol"?o+"":o,s);import{d as se,c as u,o as d,e,t as n,f as ge,r as E,m as oe,g as ie,h as be,i as y,u as t,b as M,s as w,w as O,v as J,F as H,j as Y,q as ee,D as Pe,a as te,z as j,T as Ce,E as we,G as Re,x as _e,A as Ue,H as Oe,k as je,C as Ge,n as Ke,I as Ne,J as Je,K as ze,B as He,L as Ye,l as We}from"./index-BhAHEd14.js";import{_ as ne,I as V}from"./_plugin-vue_export-helper-4DnIhLUO.js";import{L as Xe}from"./index-CoeyuGTG.js";const Qe={class:"switch"},Ze=["checked"],eo={class:"switch-label"},oo=se({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(D,{emit:o}){const s=o,p=v=>{const m=v.target.checked;s("update:switchValue",m)};return(v,m)=>(d(),u("label",Qe,[e("input",{type:"checkbox",checked:v.enabled,onChange:p},null,40,Ze),m[0]||(m[0]=e("span",{class:"slider"},null,-1)),e("span",eo,n(v.label),1)]))}}),to=ne(oo,[["__scopeId","data-v-d484b4a3"]]);class $e{static async getConfigsByGroup(o){try{const s=await fetch(`${this.BASE_URL}/group/${o}`);if(!s.ok)throw new Error(`Failed to get ${o} group configuration: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get ${o} group configuration:`,s),s}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const s=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Batch update configuration failed: ${s.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(s){return console.error("Batch update configuration failed:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}static async getConfigById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);if(!s.ok)throw new Error(`Failed to get configuration item: ${s.status}`);return await s.json()}catch(s){throw console.error(`Failed to get configuration item[${o}]:`,s),s}}static async updateConfig(o){try{const s=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Failed to update configuration item: ${s.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(s){return console.error("Failed to update configuration item:",s),{success:!1,message:s instanceof Error?s.message:"Update failed, please try again"}}}}me($e,"BASE_URL","/api/config");const so={class:"config-panel"},no={class:"config-header"},ao={class:"header-left"},lo={class:"config-stats"},io={class:"stat-item"},co={class:"stat-value"},ro={key:0,class:"stat-item"},uo={class:"stat-value modified"},po={class:"header-right"},fo={class:"import-export-actions"},mo={class:"action-btn",title:"导入配置"},go={class:"search-box"},ho=["placeholder"],vo={key:0,class:"loading-container"},yo={key:1,class:"config-groups"},_o={class:"group-header"},bo={class:"group-info"},Co={class:"group-icon"},$o={class:"group-actions"},wo=["onClick","disabled","title"],ko={class:"sub-groups"},So=["onClick"],To={class:"sub-group-info"},Vo={class:"sub-group-title"},Ao={class:"item-count"},Uo={class:"config-items"},No={key:0,class:"config-item-content vertical-layout"},xo={class:"config-item-info"},Po={class:"config-item-header"},Eo={class:"config-label"},Mo={class:"type-badge boolean"},Do={key:0,class:"modified-badge"},Ro=["title"],Lo={class:"config-control"},Fo=["value","onChange"],Bo=["value"],Io={key:1,class:"config-item-content vertical-layout"},qo={class:"config-item-info"},Oo={class:"config-item-header"},jo={class:"config-label"},Go={class:"type-badge select"},Ko={key:0,class:"modified-badge"},Jo=["title"],zo={class:"config-control"},Ho=["value","onChange"],Yo=["value"],Wo={key:2,class:"config-item-content vertical-layout"},Xo={class:"config-item-info"},Qo={class:"config-item-header"},Zo={class:"config-label"},et={class:"type-badge textarea"},ot={key:0,class:"modified-badge"},tt=["title"],st={class:"config-control"},nt=["value","onInput"],at={key:3,class:"config-item-content vertical-layout"},lt={class:"config-item-info"},it={class:"config-item-header"},ct={class:"config-label"},rt={class:"type-badge number"},dt={key:0,class:"modified-badge"},ut=["title"],pt={key:0,class:"config-meta"},ft={class:"range-info"},mt={class:"config-control"},gt=["value","onInput","min","max"],ht={key:4,class:"config-item-content vertical-layout"},vt={class:"config-item-info"},yt={class:"config-item-header"},_t={class:"config-label"},bt={class:"type-badge string"},Ct={key:0,class:"modified-badge"},$t=["title"],wt={class:"config-control"},kt=["value","onInput"],St={key:2,class:"empty-state"},Tt=se({__name:"basicConfig",setup(D){const{t:o}=ge(),s=E(!0),p=E(!1),v=E([]),m=E(new Map),h=E(new Set),r=oe({show:!1,text:"",type:"success"}),k=E(""),A={maxSteps:"智能体执行最大步数",resetAllAgents:"重置所有agent",maxMemory:"能记住的最大消息数",parallelToolCalls:"并行工具调用",headlessBrowser:"是否使用无头浏览器模式",browserTimeout:o("config.basicConfig.browserTimeout"),browserDebug:"浏览器debug模式",autoOpenBrowser:"启动时自动打开浏览器",consoleInteractive:"启用控制台交互模式",systemName:"系统名称",language:"默认语言",maxThreads:"最大线程数",timeoutSeconds:o("config.basicConfig.requestTimeout")},C={manus:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置"},S={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},G={agent:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置",general:"常规设置"},L=ie(()=>v.value.some(i=>i.subGroups.some($=>$.items.some(U=>m.value.get(U.id)!==U.configValue)))),X=i=>i==="true",I=i=>parseFloat(i)||0,N=i=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[i]||1,R=i=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[i]||1e4,Q=i=>typeof i=="string"?i:i.value,ae=i=>typeof i=="string"?i:i.label,x=(i,$)=>{if(typeof $=="boolean")return $.toString();if(typeof $=="string"){if(i.options&&i.options.length>0){const U=i.options.find(T=>(typeof T=="string"?T:T.label)===$||(typeof T=="string"?T:T.value)===$);if(U)return typeof U=="string"?U:U.value}return $}return String($)},g=(i,$,U=!1)=>{let T;i.inputType==="BOOLEAN"||i.inputType==="CHECKBOX"?T=x(i,$):T=String($),i.configValue!==T&&(i.configValue=T,i._modified=!0,(U||i.inputType==="BOOLEAN"||i.inputType==="CHECKBOX"||i.inputType==="SELECT")&&a())};let l=null;const a=()=>{l&&clearTimeout(l),l=window.setTimeout(()=>{F()},500)},c=(i,$="success")=>{r.text=i,r.type=$,r.show=!0,setTimeout(()=>{r.show=!1},3e3)},_=async()=>{try{s.value=!0;const $=["manus","browser","interaction","system","performance"].map(async T=>{try{const f=await $e.getConfigsByGroup(T);if(f.length===0)return null;const B=f.map(W=>({...W,displayName:W.description??(A[W.configKey]||W.configKey),min:N(W.configKey),max:R(W.configKey)}));B.forEach(W=>{m.value.set(W.id,W.configValue)});const q=new Map;B.forEach(W=>{const ce=W.configSubGroup??"general";q.has(ce)||q.set(ce,[]),q.get(ce).push(W)});const Z=Array.from(q.entries()).map(([W,ce])=>({name:W,displayName:G[W]||W,items:ce}));return{name:T,displayName:C[T]||T,subGroups:Z}}catch(f){return console.warn(`加载配置组 ${T} 失败，跳过:`,f),null}}),U=await Promise.all($);v.value=U.filter(T=>T!==null),console.log("配置加载完成:",v.value)}catch(i){console.error("加载配置失败:",i),c(o("config.basicConfig.loadConfigFailed"),"error")}finally{s.value=!1}},F=async()=>{if(!(p.value||!L.value))try{p.value=!0;const i=[];if(v.value.forEach(U=>{U.subGroups.forEach(T=>{const f=T.items.filter(B=>B._modified);i.push(...f)})}),i.length===0){c("没有需要保存的修改");return}const $=await $e.batchUpdateConfigs(i);$.success?(i.forEach(U=>{m.value.set(U.id,U.configValue),U._modified=!1}),c("配置保存成功")):c($.message||"保存失败","error")}catch(i){console.error("保存配置失败:",i),c(o("config.basicConfig.saveFailed"),"error")}finally{p.value=!1}},z=async i=>{if(confirm(`确定要重置 "${C[i]||i}" 组的所有配置吗？`))try{p.value=!0;const U=v.value.find(B=>B.name===i);if(!U)return;const T=[];if(U.subGroups.forEach(B=>{B.items.forEach(q=>{const Z=le(q.configKey);Z!==q.configValue&&T.push({...q,configValue:Z})})}),T.length===0){c("该组配置已是默认值");return}const f=await $e.batchUpdateConfigs(T);f.success?(await _(),c(`成功重置 ${T.length} 项配置`)):c(f.message||"重置失败","error")}catch(U){console.error("重置组配置失败:",U),c(o("config.basicConfig.resetFailed"),"error")}finally{p.value=!1}},le=i=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[i]||"",ke=(i,$)=>{const U=`${i}-${$}`;h.value.has(U)?h.value.delete(U):h.value.add(U)},he=(i,$)=>h.value.has(`${i}-${$}`),ue=ie(()=>{const i=v.value.reduce((U,T)=>U+T.subGroups.reduce((f,B)=>f+B.items.length,0),0),$=v.value.reduce((U,T)=>U+T.subGroups.reduce((f,B)=>f+B.items.filter(q=>m.value.get(q.id)!==q.configValue).length,0),0);return{total:i,modified:$}}),P=ie(()=>{if(!k.value.trim())return v.value;const i=k.value.toLowerCase();return v.value.map($=>({...$,subGroups:$.subGroups.map(U=>({...U,items:U.items.filter(T=>T.displayName.toLowerCase().includes(i)||T.configKey.toLowerCase().includes(i)||T.description&&T.description.toLowerCase().includes(i))})).filter(U=>U.items.length>0)})).filter($=>$.subGroups.length>0)}),b=()=>{try{const i={timestamp:new Date().toISOString(),version:"1.0",configs:v.value.reduce((f,B)=>(B.subGroups.forEach(q=>{q.items.forEach(Z=>{f[Z.configKey]=Z.configValue})}),f),{})},$=JSON.stringify(i,null,2),U=new Blob([$],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(U),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),c("配置导出成功")}catch(i){console.error("导出配置失败:",i),c("导出失败","error")}},K=i=>{var f;const $=i.target,U=(f=$.files)==null?void 0:f[0];if(!U)return;const T=new FileReader;T.onload=async B=>{var q;try{const Z=JSON.parse((q=B.target)==null?void 0:q.result);if(!Z.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;p.value=!0;const ce=[];if(v.value.forEach(Fe=>{Fe.subGroups.forEach(Be=>{Be.items.forEach(Ae=>{Object.prototype.hasOwnProperty.call(Z.configs,Ae.configKey)&&ce.push({...Ae,configValue:Z.configs[Ae.configKey]})})})}),ce.length===0){c("没有找到可导入的配置项");return}const Me=await $e.batchUpdateConfigs(ce);Me.success?(await _(),c(`成功导入 ${ce.length} 项配置`)):c(Me.message||"导入失败","error")}catch(Z){console.error("导入配置失败:",Z),c(o("config.basicConfig.importFailed"),"error")}finally{p.value=!1,$.value=""}},T.readAsText(U)};return be(()=>{_()}),(i,$)=>(d(),u("div",so,[e("div",no,[e("div",ao,[e("h2",null,n(t(o)("config.basicConfig.title")),1),e("div",lo,[e("span",io,[$[1]||($[1]=e("span",{class:"stat-label"},"总配置项:",-1)),e("span",co,n(ue.value.total),1)]),ue.value.modified>0?(d(),u("span",ro,[$[2]||($[2]=e("span",{class:"stat-label"},"已修改:",-1)),e("span",uo,n(ue.value.modified),1)])):M("",!0)])]),e("div",po,[e("div",fo,[e("button",{onClick:b,class:"action-btn",title:"导出配置"}," 📤 "),e("label",mo,[$[3]||($[3]=w(" 📥 ")),e("input",{type:"file",accept:".json",onChange:K,style:{display:"none"}},null,32)])]),e("div",go,[O(e("input",{"onUpdate:modelValue":$[0]||($[0]=U=>k.value=U),type:"text",placeholder:i.$t("config.search"),class:"search-input"},null,8,ho),[[J,k.value]]),$[4]||($[4]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(d(),u("div",vo,[$[5]||($[5]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,n(i.$t("config.loading")),1)])):P.value.length>0?(d(),u("div",yo,[(d(!0),u(H,null,Y(P.value,U=>(d(),u("div",{key:U.name,class:"config-group"},[e("div",_o,[e("div",bo,[e("span",Co,n(S[U.name]||"⚙️"),1)]),e("div",$o,[e("button",{onClick:T=>z(U.name),class:"reset-btn",disabled:p.value,title:i.$t("config.resetGroupConfirm")},n(i.$t("config.reset")),9,wo)]),$[6]||($[6]=e("div",{class:"group-divider"},null,-1))]),e("div",ko,[(d(!0),u(H,null,Y(U.subGroups,T=>(d(),u("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:f=>ke(U.name,T.name)},[e("div",To,[$[7]||($[7]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",Vo,n(T.displayName),1),e("span",Ao,"("+n(T.items.length)+")",1)]),e("span",{class:ee(["collapse-icon",{collapsed:he(U.name,T.name)}])}," ▼ ",2)],8,So),O(e("div",Uo,[(d(!0),u(H,null,Y(T.items,f=>(d(),u("div",{key:f.id,class:ee(["config-item",{modified:m.value.get(f.id)!==f.configValue}])},[f.inputType==="BOOLEAN"||f.inputType==="CHECKBOX"?(d(),u("div",No,[e("div",xo,[e("div",Po,[e("label",Eo,[w(n(f.description||f.displayName)+" ",1),e("span",Mo,n(f.inputType==="CHECKBOX"?i.$t("config.types.checkbox"):i.$t("config.types.boolean")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Do,n(i.$t("config.modified")),1)):M("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,Ro)])]),e("div",Lo,[f.options&&f.options.length>0?(d(),u("select",{key:0,class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options,B=>(d(),u("option",{key:Q(B),value:Q(B)},n(ae(B)),9,Bo))),128))],40,Fo)):(d(),te(to,{key:1,enabled:X(f.configValue),label:"","onUpdate:switchValue":B=>g(f,B)},null,8,["enabled","onUpdate:switchValue"]))])])):f.inputType==="SELECT"?(d(),u("div",Io,[e("div",qo,[e("div",Oo,[e("label",jo,[w(n(f.description||f.displayName)+" ",1),e("span",Go,n(i.$t("config.types.select")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Ko,n(i.$t("config.modified")),1)):M("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,Jo)])]),e("div",zo,[e("select",{class:"config-input select-input",value:f.configValue,onChange:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")}},[(d(!0),u(H,null,Y(f.options||[],B=>(d(),u("option",{key:Q(B),value:Q(B)},n(ae(B)),9,Yo))),128))],40,Ho)])])):f.inputType==="TEXTAREA"?(d(),u("div",Wo,[e("div",Xo,[e("div",Qo,[e("label",Zo,[w(n(f.description||f.displayName)+" ",1),e("span",et,n(i.$t("config.types.textarea")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",ot,n(i.$t("config.modified")),1)):M("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,tt)])]),e("div",st,[e("textarea",{class:"config-input textarea-input",value:f.configValue,onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,rows:"3"},null,40,nt)])])):f.inputType==="NUMBER"?(d(),u("div",at,[e("div",lt,[e("div",it,[e("label",ct,[w(n(f.description||f.displayName)+" ",1),e("span",rt,n(i.$t("config.types.number")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",dt,n(i.$t("config.modified")),1)):M("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,ut),f.min||f.max?(d(),u("div",pt,[e("span",ft,n(i.$t("config.range"))+": "+n(f.min||0)+" - "+n(f.max||"∞"),1)])):M("",!0)])]),e("div",mt,[e("input",{type:"number",class:"config-input number-input",value:I(f.configValue),onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a,min:f.min||1,max:f.max||1e4},null,40,gt)])])):(d(),u("div",ht,[e("div",vt,[e("div",yt,[e("label",_t,[w(n(f.description||f.displayName)+" ",1),e("span",bt,n(f.inputType==="TEXT"?i.$t("config.types.text"):i.$t("config.types.string")),1),m.value.get(f.id)!==f.configValue?(d(),u("span",Ct,n(i.$t("config.modified")),1)):M("",!0)]),e("span",{class:"config-key",title:f.configKey},n(f.configKey),9,$t)])]),e("div",wt,[e("input",{type:"text",class:"config-input text-input",value:f.configValue,onInput:B=>{var q;return g(f,((q=B.target)==null?void 0:q.value)||"")},onBlur:a},null,40,kt)])]))],2))),128))],512),[[Pe,!he(U.name,T.name)]])]))),128))])]))),128))])):(d(),u("div",St,[e("p",null,n(i.$t("config.notFound")),1)])),y(Ce,{name:"message-fade"},{default:j(()=>[r.show?(d(),u("div",{key:0,class:ee(["message-toast",r.type])},n(r.text),3)):M("",!0)]),_:1})]))}}),De=ne(Tt,[["__scopeId","data-v-43f36b25"]]),Vt={},At={class:"config-config"},Ut={class:"panel-header"},Nt={class:"panel-actions"};function xt(D,o){return d(),u("div",At,[e("div",Ut,[we(D.$slots,"title",{},void 0),e("div",Nt,[we(D.$slots,"actions",{},void 0)])]),we(D.$slots,"default",{},void 0)])}const Ve=ne(Vt,[["render",xt],["__scopeId","data-v-c91688e7"]]),Pt={class:"modal-header"},Et={class:"modal-content"},Mt={class:"modal-footer"},Dt=se({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(D){const o=s=>{s.target===s.currentTarget&&(s.stopPropagation(),s.preventDefault())};return(s,p)=>(d(),te(Re,{to:"body"},[y(Ce,{name:"modal"},{default:j(()=>[D.modelValue?(d(),u("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:p[3]||(p[3]=_e(()=>{},["stop"]))},[e("div",Pt,[e("h3",null,n(D.title),1),e("button",{class:"close-btn",onClick:p[0]||(p[0]=v=>s.$emit("update:modelValue",!1))},[y(t(V),{icon:"carbon:close"})])]),e("div",Et,[we(s.$slots,"default",{},void 0,!0)]),e("div",Mt,[we(s.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:p[1]||(p[1]=v=>s.$emit("update:modelValue",!1))},n(s.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:p[2]||(p[2]=v=>s.$emit("confirm"))},n(s.$t("common.confirm")),1)],!0)])])])):M("",!0)]),_:3})]))}}),de=ne(Dt,[["__scopeId","data-v-baaf1c89"]]),Rt={class:"tool-selection-content"},Lt={class:"tool-controls"},Ft={class:"search-container"},Bt={class:"sort-container"},It={class:"tool-summary"},qt={class:"summary-text"},Ot={key:0,class:"tool-groups"},jt=["onClick"],Gt={class:"group-title-area"},Kt={class:"group-name"},Jt={class:"group-count"},zt={class:"group-enable-all"},Ht=["checked","onChange","data-group"],Yt={class:"tool-info"},Wt={class:"tool-selection-name"},Xt={key:0,class:"tool-selection-desc"},Qt={class:"tool-actions"},Zt=["checked","onChange"],es={key:1,class:"empty-state"},os=se({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(D,{emit:o}){const s=D,p=o,v=ie({get:()=>s.modelValue,set:l=>p("update:modelValue",l)}),m=E(""),h=E("group"),r=E(new Set),k=E([]),A=(l,a)=>{const c=document.querySelector(`input[data-group="${l}"]`);c&&(c.indeterminate=R(a))};Ue(()=>s.selectedToolIds,l=>{k.value=[...l]},{immediate:!0});const C=ie(()=>{let l=s.tools.filter(a=>a.key);if(m.value){const a=m.value.toLowerCase();l=l.filter(c=>{var _;return c.name.toLowerCase().includes(a)||c.description.toLowerCase().includes(a)||(((_=c.serviceGroup)==null?void 0:_.toLowerCase().includes(a))??!1)})}switch(h.value){case"name":l=[...l].sort((a,c)=>a.name.localeCompare(c.name));break;case"enabled":l=[...l].sort((a,c)=>{const _=k.value.includes(a.key),F=k.value.includes(c.key);return _&&!F?-1:!_&&F?1:a.name.localeCompare(c.name)});break;case"group":default:l=[...l].sort((a,c)=>{const _=a.serviceGroup??"未分组",F=c.serviceGroup??"未分组";return _!==F?_.localeCompare(F):a.name.localeCompare(c.name)});break}return l}),S=ie(()=>{const l=new Map;return C.value.forEach(a=>{const c=a.serviceGroup??"未分组";l.has(c)||l.set(c,[]),l.get(c).push(a)}),new Map([...l.entries()].sort())}),G=ie(()=>C.value.length);Ue([k,S],()=>{je(()=>{for(const[l,a]of S.value)A(l,a)})},{flush:"post",deep:!1});const L=l=>k.value.includes(l),X=(l,a)=>{a.stopPropagation();const _=a.target.checked;if(!l){console.error("toolKey is undefined, cannot proceed");return}_?k.value.includes(l)||(k.value=[...k.value,l]):k.value=k.value.filter(F=>F!==l)},I=l=>l.filter(a=>k.value.includes(a.key)),N=l=>l.length>0&&l.every(a=>k.value.includes(a.key)),R=l=>{const a=I(l).length;return a>0&&a<l.length},Q=(l,a)=>{a.stopPropagation();const _=a.target.checked,F=l.map(z=>z.key);if(_){const z=[...k.value];F.forEach(le=>{z.includes(le)||z.push(le)}),k.value=z}else k.value=k.value.filter(z=>!F.includes(z))},ae=l=>{r.value.has(l)?r.value.delete(l):r.value.add(l)},x=()=>{p("confirm",[...k.value]),p("update:modelValue",!1)},g=()=>{k.value=[...s.selectedToolIds],p("update:modelValue",!1)};return Ue(v,l=>{if(l){r.value.clear();const a=Array.from(S.value.keys());a.length>1&&a.slice(1).forEach(c=>{r.value.add(c)})}}),(l,a)=>(d(),te(de,{modelValue:v.value,"onUpdate:modelValue":[a[4]||(a[4]=c=>v.value=c),g],title:"选择工具",onConfirm:x},{default:j(()=>[e("div",Rt,[e("div",Lt,[e("div",Ft,[O(e("input",{"onUpdate:modelValue":a[0]||(a[0]=c=>m.value=c),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[J,m.value]])]),e("div",Bt,[O(e("select",{"onUpdate:modelValue":a[1]||(a[1]=c=>h.value=c),class:"sort-select"},a[5]||(a[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Oe,h.value]])])]),e("div",It,[e("span",qt," 共 "+n(S.value.size)+" 个服务组，"+n(G.value)+" 个工具 (已选择 "+n(k.value.length)+" 个) ",1)]),S.value.size>0?(d(),u("div",Ot,[(d(!0),u(H,null,Y(S.value,([c,_])=>(d(),u("div",{key:c,class:"tool-group"},[e("div",{class:ee(["tool-group-header",{collapsed:r.value.has(c)}]),onClick:F=>ae(c)},[e("div",Gt,[y(t(V),{icon:r.value.has(c)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),y(t(V),{icon:"carbon:folder",class:"group-icon"}),e("span",Kt,n(c),1),e("span",Jt," ("+n(I(_).length)+"/"+n(_.length)+") ",1)]),e("div",{class:"group-actions",onClick:a[2]||(a[2]=_e(()=>{},["stop"]))},[e("label",zt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:N(_),onChange:F=>Q(_,F),"data-group":c},null,40,Ht),a[6]||(a[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,jt),e("div",{class:ee(["tool-group-content",{collapsed:r.value.has(c)}])},[(d(!0),u(H,null,Y(_.filter(F=>F&&F.key),F=>(d(),u("div",{key:F.key,class:"tool-selection-item"},[e("div",Yt,[e("div",Wt,n(F.name),1),F.description?(d(),u("div",Xt,n(F.description),1)):M("",!0)]),e("div",Qt,[e("label",{class:"tool-enable-switch",onClick:a[3]||(a[3]=_e(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:L(F.key),onChange:z=>X(F.key,z)},null,40,Zt),a[7]||(a[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(d(),u("div",es,[y(t(V),{icon:"carbon:tools",class:"empty-icon"}),a[8]||(a[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),ts=ne(os,[["__scopeId","data-v-79f6a572"]]);class fe{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(o){try{if(o){const s=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(s)).json()}else{const s=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(s)).json()}}catch(s){throw console.error("Failed to get Agent list:",s),s}}static async getAgentById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Agent[${o}] details:`,s),s}}static async createAgent(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Agent:",s),s}}static async updateAgent(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Agent[${o}]:`,p),p}}static async deleteAgent(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Agent[${o}]:`,s),s}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}me(fe,"BASE_URL","/api/agents");class re{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Model[${o}] details:`,s),s}}static async createModel(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Model:",s),s}}static async updateModel(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Model[${o}]:`,p),p}}static async deleteModel(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Model[${o}]:`,s),s}}}me(re,"BASE_URL","/api/models");const Ee=Ge("namespace",()=>{const D=E("default");function o(v){D.value=v}const s=E([{name:"Default",id:"default"}]);function p(v){s.value=v}return{namespace:D,db:s,setNamespace:o,setDb:p}}),ss=["disabled"],ns={class:"agent-layout"},as={class:"agent-list"},ls={class:"list-header"},is={class:"agent-count"},cs={key:0,class:"agents-container"},rs=["onClick"],ds={class:"agent-card-header"},us={class:"agent-name"},ps={class:"agent-desc"},fs={key:0,class:"agent-model"},ms={class:"model-tag"},gs={class:"model-tag"},hs={key:1,class:"agent-tools"},vs={key:0,class:"tool-more"},ys={key:1,class:"loading-state"},_s={key:2,class:"empty-state"},bs={key:0,class:"agent-detail"},Cs={class:"detail-header"},$s={class:"detail-actions"},ws={class:"form-item"},ks=["placeholder"],Ss={class:"form-item"},Ts=["placeholder"],Vs={class:"form-item"},As=["value","placeholder"],Us={class:"model-section"},Ns={class:"form-item"},xs={class:"model-chooser"},Ps=["title"],Es={key:0,class:"current-model"},Ms={class:"model-type"},Ds={class:"model-name"},Rs={key:1,class:"current-model"},Ls={class:"current-model"},Fs={class:"dropdown-header"},Bs={class:"model-options"},Is=["onClick"],qs={class:"model-type"},Os={class:"model-name"},js={class:"tools-section"},Gs={class:"assigned-tools"},Ks={class:"section-header"},Js={class:"tools-grid"},zs={class:"tool-info"},Hs={class:"tool-name"},Ys={class:"tool-desc"},Ws={key:0,class:"no-tools"},Xs={key:1,class:"no-selection"},Qs={class:"modal-form"},Zs={class:"form-item"},en=["placeholder"],on={class:"form-item"},tn=["placeholder"],sn={class:"form-item"},nn=["value","placeholder"],an={class:"delete-confirm"},ln={class:"warning-text"},cn=se({__name:"agentConfig",setup(D){const{t:o}=ge(),s=Ee(),p=E(!1),v=E(""),m=E(""),h=oe([]),r=E(null),k=oe([]),A=E(!1),C=E(!1),S=E(!1),G=E(!1),L=E(null),X=oe([]),I=()=>{G.value=!G.value},N=P=>{L.value=P,G.value=!1},R=oe({name:"",description:"",nextStepPrompt:""}),Q=P=>{const b=k.find(K=>K.key===P);return b?b.name:P},ae=P=>{const b=k.find(K=>K.key===P);return b?b.description:""},x=(P,b)=>{b==="success"?(m.value=P,setTimeout(()=>{m.value=""},3e3)):(v.value=P,setTimeout(()=>{v.value=""},5e3))},g=async()=>{p.value=!0;try{const[P,b,K]=await Promise.all([fe.getAllAgents(s.namespace),fe.getAvailableTools(),re.getAllModels()]),i=P.map($=>({...$,availableTools:$.availableTools,...K}));h.splice(0,h.length,...i),k.splice(0,k.length,...b),X.splice(0,X.length,...K),i.length>0&&await l(i[0])}catch(P){console.error("加载数据失败:",P),x(o("config.agentConfig.loadDataFailed")+": "+P.message,"error");const b=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],K=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];k.splice(0,k.length,...b),h.splice(0,h.length,...K),K.length>0&&(r.value=K[0])}finally{p.value=!1}},l=async P=>{try{const b=await fe.getAgentById(P.id);r.value={...b,availableTools:b.availableTools},L.value=b.model??null}catch(b){console.error("加载Agent详情失败:",b),x(o("config.agentConfig.loadDetailsFailed")+": "+b.message,"error"),r.value={...P,availableTools:P.availableTools}}},a=()=>{R.name="",R.description="",R.nextStepPrompt="",A.value=!0},c=async()=>{var P;if(!R.name.trim()||!R.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{const b={name:R.name.trim(),description:R.description.trim(),nextStepPrompt:((P=R.nextStepPrompt)==null?void 0:P.trim())??"",availableTools:[]},K=await fe.createAgent(b);h.push(K),r.value=K,A.value=!1,x(o("config.agentConfig.createSuccess"),"success")}catch(b){x(o("config.agentConfig.createFailed")+": "+b.message,"error")}},_=()=>{S.value=!0},F=P=>{r.value&&(r.value.availableTools=[...P])},z=async()=>{if(r.value){if(!r.value.name.trim()||!r.value.description.trim()){x(o("config.agentConfig.requiredFields"),"error");return}try{r.value.model=L.value;const P=await fe.updateAgent(r.value.id,r.value),b=h.findIndex(K=>K.id===P.id);b!==-1&&(h[b]=P),r.value=P,r.value.model=L.value,x(o("config.agentConfig.saveSuccess"),"success")}catch(P){x(o("config.agentConfig.saveFailed")+": "+P.message,"error")}}},le=()=>{C.value=!0},ke=async()=>{if(r.value)try{await fe.deleteAgent(r.value.id);const P=h.findIndex(b=>b.id===r.value.id);P!==-1&&h.splice(P,1),r.value=h.length>0?h[0]:null,C.value=!1,x(o("config.agentConfig.deleteSuccess"),"success")}catch(P){x(o("config.agentConfig.deleteFailed")+": "+P.message,"error")}},he=()=>{const P=document.createElement("input");P.type="file",P.accept=".json",P.onchange=b=>{var i;const K=(i=b.target.files)==null?void 0:i[0];if(K){const $=new FileReader;$.onload=async U=>{var T;try{const f=JSON.parse((T=U.target)==null?void 0:T.result);if(!f.name||!f.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:B,...q}=f,Z=await fe.createAgent(q);h.push(Z),r.value=Z,x(o("config.agentConfig.importSuccess"),"success")}catch(f){x(o("config.agentConfig.importFailed")+": "+f.message,"error")}},$.readAsText(K)}},P.click()},ue=()=>{if(r.value)try{const P=JSON.stringify(r.value,null,2),b=new Blob([P],{type:"application/json"}),K=URL.createObjectURL(b),i=document.createElement("a");i.href=K,i.download=`agent-${r.value.name}-${new Date().toISOString().split("T")[0]}.json`,i.click(),URL.revokeObjectURL(K),x(o("config.agentConfig.exportSuccess"),"success")}catch(P){x(o("config.agentConfig.exportFailed")+": "+P.message,"error")}};return be(()=>{g()}),(P,b)=>(d(),te(Ve,null,{title:j(()=>[e("h2",null,n(t(o)("config.agentConfig.title")),1)]),actions:j(()=>[e("button",{class:"action-btn",onClick:he},[y(t(V),{icon:"carbon:upload"}),w(" "+n(t(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ue,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),w(" "+n(t(o)("config.agentConfig.export")),1)],8,ss)]),default:j(()=>{var K;return[e("div",ns,[e("div",as,[e("div",ls,[e("h3",null,n(t(o)("config.agentConfig.configuredAgents")),1),e("span",is,"("+n(h.length)+n(t(o)("config.agentConfig.agentCount"))+")",1)]),p.value?M("",!0):(d(),u("div",cs,[(d(!0),u(H,null,Y(h,i=>{var $,U;return d(),u("div",{key:i.id,class:ee(["agent-card",{active:(($=r.value)==null?void 0:$.id)===i.id}]),onClick:T=>l(i)},[e("div",ds,[e("span",us,n(i.name),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",ps,n(i.description),1),i.model?(d(),u("div",fs,[e("span",ms,n(i.model.type),1),e("span",gs,n(i.model.modelName),1)])):M("",!0),((U=i.availableTools)==null?void 0:U.length)>0?(d(),u("div",hs,[(d(!0),u(H,null,Y(i.availableTools.slice(0,3),T=>(d(),u("span",{key:T,class:"tool-tag"},n(Q(T)),1))),128)),i.availableTools.length>3?(d(),u("span",vs," +"+n(i.availableTools.length-3),1)):M("",!0)])):M("",!0)],10,rs)}),128))])),p.value?(d(),u("div",ys,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),w(" "+n(t(o)("common.loading")),1)])):M("",!0),!p.value&&h.length===0?(d(),u("div",_s,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.agentConfig.noAgent")),1)])):M("",!0),e("button",{class:"add-btn",onClick:a},[y(t(V),{icon:"carbon:add"}),w(" "+n(t(o)("config.agentConfig.createNew")),1)])]),r.value?(d(),u("div",bs,[e("div",Cs,[e("h3",null,n(r.value.name),1),e("div",$s,[e("button",{class:"action-btn primary",onClick:z},[y(t(V),{icon:"carbon:save"}),w(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:le},[y(t(V),{icon:"carbon:trash-can"}),w(" "+n(t(o)("common.delete")),1)])])]),e("div",ws,[e("label",null,[w(n(t(o)("config.agentConfig.agentName"))+" ",1),b[15]||(b[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=i=>r.value.name=i),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,ks),[[J,r.value.name]])]),e("div",Ss,[e("label",null,[w(n(t(o)("config.agentConfig.description"))+" ",1),b[16]||(b[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[1]||(b[1]=i=>r.value.description=i),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,Ts),[[J,r.value.description]])]),e("div",Vs,[e("label",null,n(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:r.value.nextStepPrompt||"",onInput:b[2]||(b[2]=i=>r.value.nextStepPrompt=i.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,As)]),e("div",Us,[e("h4",null,n(t(o)("config.agentConfig.modelConfiguration")),1),e("div",Ns,[e("div",xs,[e("button",{class:"model-btn",onClick:I,title:P.$t("model.switch")},[y(t(V),{icon:"carbon:build-run",width:"18"}),L.value?(d(),u("span",Es,[e("span",Ms,n(L.value.type),1),b[17]||(b[17]=e("span",{class:"spacer"},null,-1)),e("span",Ds,n(L.value.modelName),1)])):(d(),u("span",Rs,[e("span",Ls,n(t(o)("config.agentConfig.modelConfigurationLabel")),1)])),y(t(V),{icon:G.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ps),G.value?(d(),u("div",{key:0,class:"model-dropdown",onClick:b[4]||(b[4]=_e(()=>{},["stop"]))},[e("div",Fs,[e("span",null,n(t(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:b[3]||(b[3]=i=>G.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",Bs,[(d(!0),u(H,null,Y(X,i=>{var $,U;return d(),u("button",{key:i.id,class:ee(["model-option",{active:(($=L.value)==null?void 0:$.id)===i.id}]),onClick:T=>N(i)},[e("span",qs,n(i.type),1),e("span",Os,n(i.modelName),1),((U=L.value)==null?void 0:U.id)===i.id?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):M("",!0)],10,Is)}),128))])])):M("",!0),G.value?(d(),u("div",{key:1,class:"backdrop",onClick:b[5]||(b[5]=i=>G.value=!1)})):M("",!0)])])]),e("div",js,[e("h4",null,n(t(o)("config.agentConfig.toolConfiguration")),1),e("div",Gs,[e("div",Ks,[e("span",null,n(t(o)("config.agentConfig.assignedTools"))+" ("+n((r.value.availableTools||[]).length)+")",1),k.length>0?(d(),u("button",{key:0,class:"action-btn small",onClick:_},[y(t(V),{icon:"carbon:add"}),w(" "+n(t(o)("config.agentConfig.addRemoveTools")),1)])):M("",!0)]),e("div",Js,[(d(!0),u(H,null,Y(r.value.availableTools||[],i=>(d(),u("div",{key:i,class:"tool-item assigned"},[e("div",zs,[e("span",Hs,n(Q(i)),1),e("span",Ys,n(ae(i)),1)])]))),128)),r.value.availableTools.length===0?(d(),u("div",Ws,[y(t(V),{icon:"carbon:tool-box"}),e("span",null,n(t(o)("config.agentConfig.noAssignedTools")),1)])):M("",!0)])])])])):(d(),u("div",Xs,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.agentConfig.selectAgentHint")),1)]))]),y(de,{modelValue:A.value,"onUpdate:modelValue":b[9]||(b[9]=i=>A.value=i),title:t(o)("config.agentConfig.newAgent"),onConfirm:c},{default:j(()=>[e("div",Qs,[e("div",Zs,[e("label",null,[w(n(t(o)("config.agentConfig.agentName"))+" ",1),b[18]||(b[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":b[6]||(b[6]=i=>R.name=i),placeholder:t(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,en),[[J,R.name]])]),e("div",on,[e("label",null,[w(n(t(o)("config.agentConfig.description"))+" ",1),b[19]||(b[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":b[7]||(b[7]=i=>R.description=i),rows:"3",placeholder:t(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,tn),[[J,R.description]])]),e("div",sn,[e("label",null,n(t(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:R.nextStepPrompt||"",onInput:b[8]||(b[8]=i=>R.nextStepPrompt=i.target.value),rows:"8",placeholder:t(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,nn)])])]),_:1},8,["modelValue","title"]),y(ts,{modelValue:S.value,"onUpdate:modelValue":b[10]||(b[10]=i=>S.value=i),tools:k,"selected-tool-ids":((K=r.value)==null?void 0:K.availableTools)||[],onConfirm:F},null,8,["modelValue","tools","selected-tool-ids"]),y(de,{modelValue:C.value,"onUpdate:modelValue":b[12]||(b[12]=i=>C.value=i),title:t(o)("config.agentConfig.deleteConfirm")},{footer:j(()=>[e("button",{class:"cancel-btn",onClick:b[11]||(b[11]=i=>C.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:ke},n(t(o)("common.delete")),1)]),default:j(()=>{var i;return[e("div",an,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(n(t(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,n((i=r.value)==null?void 0:i.name),1),w(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",ln,n(t(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),v.value?(d(),u("div",{key:0,class:"error-toast",onClick:b[13]||(b[13]=i=>v.value="")},[y(t(V),{icon:"carbon:error"}),w(" "+n(v.value),1)])):M("",!0),m.value?(d(),u("div",{key:1,class:"success-toast",onClick:b[14]||(b[14]=i=>m.value="")},[y(t(V),{icon:"carbon:checkmark"}),w(" "+n(m.value),1)])):M("",!0)]}),_:1}))}}),rn=ne(cn,[["__scopeId","data-v-9e905dc6"]]),dn={class:"custom-select"},un=["title"],pn={key:0,class:"current-option"},fn={class:"option-name"},mn={key:1,class:"current-option"},gn={class:"dropdown-header"},hn={class:"select-options"},vn=["onClick"],yn={class:"option-name"},_n=se({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{},direction:{},dropStyles:{}},emits:["update:modelValue"],setup(D,{emit:o}){const s=D,p=o,v=E(!1),m=ie(()=>s.options.find(A=>A.id===s.modelValue)),h=A=>A.id===s.modelValue,r=()=>{v.value=!v.value},k=A=>{p("update:modelValue",A.id),v.value=!1};return(A,C)=>(d(),u("div",dn,[e("button",{class:"select-btn",onClick:r,title:A.placeholder},[y(t(V),{icon:s.icon||"carbon:select-01",width:"18"},null,8,["icon"]),m.value?(d(),u("span",pn,[e("span",fn,n(m.value.name),1)])):(d(),u("span",mn,n(A.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,un),y(Ce,{name:"slideDown"},{default:j(()=>[O(e("div",{class:"select-dropdown",style:Ke({...A.dropStyles,...s.direction==="right"?{right:0}:{left:0}}),onClick:C[1]||(C[1]=_e(()=>{},["stop"]))},[e("div",gn,[e("span",null,n(A.dropdownTitle),1),e("button",{class:"close-btn",onClick:C[0]||(C[0]=S=>v.value=!1)},[y(t(V),{icon:"carbon:close",width:"16"})])]),e("div",hn,[(d(!0),u(H,null,Y(A.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:G=>k(S)},[e("span",yn,n(S.name),1),h(S)?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):M("",!0)],10,vn))),128))])],4),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[2]||(C[2]=S=>v.value=!1)})):M("",!0)]))}}),xe=ne(_n,[["__scopeId","data-v-138e90e7"]]),bn=["disabled"],Cn={class:"model-layout"},$n={class:"model-list"},wn={class:"list-header"},kn={class:"model-count"},Sn={key:0,class:"models-container"},Tn=["onClick"],Vn={class:"model-card-header"},An={class:"model-name"},Un={class:"model-desc"},Nn={key:0,class:"model-type"},xn={class:"model-tag"},Pn={key:1,class:"loading-state"},En={key:2,class:"empty-state"},Mn={key:0,class:"model-detail"},Dn={class:"detail-header"},Rn={class:"detail-actions"},Ln={class:"form-item"},Fn={class:"form-item"},Bn=["placeholder"],In={class:"form-item"},qn=["placeholder"],On={class:"form-item"},jn=["placeholder"],Gn={class:"form-item"},Kn=["placeholder"],Jn={key:1,class:"no-selection"},zn={class:"modal-form"},Hn={class:"form-item"},Yn={class:"form-item"},Wn=["placeholder"],Xn={class:"form-item"},Qn=["placeholder"],Zn={class:"form-item"},ea=["placeholder"],oa={class:"form-item"},ta=["placeholder"],sa={class:"delete-confirm"},na={class:"warning-text"},aa=se({__name:"modelConfig",setup(D){const{t:o}=ge(),s=E(!1),p=E(""),v=E(""),m=oe([]),h=oe([]),r=E(null),k=E(!1),A=E(!1),C=oe({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),S=(g,l)=>{l==="success"?(v.value=g,setTimeout(()=>{v.value=""},3e3)):(p.value=g,setTimeout(()=>{p.value=""},5e3))},G=async()=>{s.value=!0;try{const[g,l]=await Promise.all([re.getAllModels(),re.getAllTypes()]),a=g.map(c=>({...c}));m.splice(0,m.length,...a),h.splice(0,h.length,...l),a.length>0&&await L(a[0])}catch(g){console.error("加载数据失败:",g),S(o("config.modelConfig.loadDataFailed")+": "+g.message,"error")}finally{s.value=!1}},L=async g=>{try{const l=await re.getModelById(g.id);r.value={...l}}catch(l){console.error("加载Model详情失败:",l),S(o("config.modelConfig.loadDetailsFailed")+": "+l.message,"error"),r.value={...g}}},X=()=>{C.baseUrl="",C.apiKey="",C.modelName="",C.modelDescription="",C.type="",k.value=!0},I=async()=>{if(!C.modelName.trim()||!C.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const g={baseUrl:C.baseUrl.trim(),apiKey:C.apiKey.trim(),modelName:C.modelName.trim(),modelDescription:C.modelDescription.trim(),type:C.type.trim()},l=await re.createModel(g);m.push(l),r.value=l,k.value=!1,S(o("config.modelConfig.createSuccess"),"success")}catch(g){S(o("config.modelConfig.createFailed")+": "+g.message,"error")}},N=async()=>{if(r.value){if(!r.value.modelName.trim()||!r.value.modelDescription.trim()){S(o("config.modelConfig.requiredFields"),"error");return}try{const g=await re.updateModel(r.value.id,r.value),l=m.findIndex(a=>a.id===g.id);l!==-1&&(m[l]=g),r.value=g,S(o("config.modelConfig.saveSuccess"),"success")}catch(g){S(o("config.modelConfig.saveFailed")+": "+g.message,"error")}}},R=()=>{A.value=!0},Q=async()=>{if(r.value)try{await re.deleteModel(r.value.id);const g=m.findIndex(l=>l.id===r.value.id);g!==-1&&m.splice(g,1),r.value=m.length>0?m[0]:null,A.value=!1,S(o("config.modelConfig.deleteSuccess"),"success")}catch(g){S(o("config.modelConfig.deleteFailed")+": "+g.message,"error")}},ae=()=>{const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=l=>{var c;const a=(c=l.target.files)==null?void 0:c[0];if(a){const _=new FileReader;_.onload=async F=>{var z;try{const le=JSON.parse((z=F.target)==null?void 0:z.result);if(!le.modelName||!le.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:ke,...he}=le,ue=await re.createModel(he);m.push(ue),r.value=ue,S(o("config.modelConfig.importSuccess"),"success")}catch(le){S(o("config.modelConfig.importFailed")+": "+le.message,"error")}},_.readAsText(a)}},g.click()},x=()=>{if(r.value)try{const g=JSON.stringify(r.value,null,2),l=new Blob([g],{type:"application/json"}),a=URL.createObjectURL(l),c=document.createElement("a");c.href=a,c.download=`model-${r.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(a),S(o("config.modelConfig.exportSuccess"),"success")}catch(g){S(o("config.modelConfig.exportFailed")+": "+g.message,"error")}};return be(()=>{G()}),(g,l)=>(d(),te(Ve,null,{title:j(()=>[e("h2",null,n(t(o)("config.modelConfig.title")),1)]),actions:j(()=>[e("button",{class:"action-btn",onClick:ae},[y(t(V),{icon:"carbon:upload"}),w(" "+n(t(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:x,disabled:!r.value},[y(t(V),{icon:"carbon:download"}),w(" "+n(t(o)("config.modelConfig.export")),1)],8,bn)]),default:j(()=>[e("div",Cn,[e("div",$n,[e("div",wn,[e("h3",null,n(t(o)("config.modelConfig.configuredModels")),1),e("span",kn,"("+n(m.length)+")",1)]),s.value?M("",!0):(d(),u("div",Sn,[(d(!0),u(H,null,Y(m,a=>{var c;return d(),u("div",{key:a.id,class:ee(["model-card",{active:((c=r.value)==null?void 0:c.id)===a.id}]),onClick:_=>L(a)},[e("div",Vn,[e("span",An,n(a.modelName),1),y(t(V),{icon:"carbon:chevron-right"})]),e("p",Un,n(a.modelDescription),1),a.type?(d(),u("div",Nn,[e("span",xn,n(a.type),1)])):M("",!0)],10,Tn)}),128))])),s.value?(d(),u("div",Pn,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),w(" "+n(t(o)("common.loading")),1)])):M("",!0),!s.value&&m.length===0?(d(),u("div",En,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.modelConfig.noModel")),1)])):M("",!0),e("button",{class:"add-btn",onClick:X},[y(t(V),{icon:"carbon:add"}),w(" "+n(t(o)("config.modelConfig.createNew")),1)])]),r.value?(d(),u("div",Mn,[e("div",Dn,[e("h3",null,n(r.value.modelName),1),e("div",Rn,[e("button",{class:"action-btn primary",onClick:N},[y(t(V),{icon:"carbon:save"}),w(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:R},[y(t(V),{icon:"carbon:trash-can"}),w(" "+n(t(o)("common.delete")),1)])])]),e("div",Ln,[e("label",null,[w(n(t(o)("config.modelConfig.type"))+" ",1),l[15]||(l[15]=e("span",{class:"required"},"*",-1))]),y(xe,{modelValue:r.value.type,"onUpdate:modelValue":l[0]||(l[0]=a=>r.value.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Fn,[e("label",null,[w(n(t(o)("config.modelConfig.baseUrl"))+" ",1),l[16]||(l[16]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>r.value.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Bn),[[J,r.value.baseUrl]])]),e("div",In,[e("label",null,[w(n(t(o)("config.modelConfig.apiKey"))+" ",1),l[17]||(l[17]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=a=>r.value.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,qn),[[J,r.value.apiKey]])]),e("div",On,[e("label",null,[w(n(t(o)("config.modelConfig.modelName"))+" ",1),l[18]||(l[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=a=>r.value.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,jn),[[J,r.value.modelName]])]),e("div",Gn,[e("label",null,[w(n(t(o)("config.modelConfig.description"))+" ",1),l[19]||(l[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=a=>r.value.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Kn),[[J,r.value.modelDescription]])])])):(d(),u("div",Jn,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.modelConfig.selectModelHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":l[10]||(l[10]=a=>k.value=a),title:t(o)("config.modelConfig.newModel"),onConfirm:I},{default:j(()=>[e("div",zn,[e("div",Hn,[e("label",null,[w(n(t(o)("config.modelConfig.type"))+" ",1),l[20]||(l[20]=e("span",{class:"required"},"*",-1))]),y(xe,{modelValue:C.type,"onUpdate:modelValue":l[5]||(l[5]=a=>C.type=a),options:h.map(a=>({id:a,name:a})),placeholder:t(o)("config.modelConfig.typePlaceholder"),"dropdown-title":t(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Yn,[e("label",null,[w(n(t(o)("config.modelConfig.baseUrl"))+" ",1),l[21]||(l[21]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[6]||(l[6]=a=>C.baseUrl=a),placeholder:t(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Wn),[[J,C.baseUrl]])]),e("div",Xn,[e("label",null,[w(n(t(o)("config.modelConfig.apiKey"))+" ",1),l[22]||(l[22]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=a=>C.apiKey=a),placeholder:t(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Qn),[[J,C.apiKey]])]),e("div",Zn,[e("label",null,[w(n(t(o)("config.modelConfig.modelName"))+" ",1),l[23]||(l[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":l[8]||(l[8]=a=>C.modelName=a),placeholder:t(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,ea),[[J,C.modelName]])]),e("div",oa,[e("label",null,[w(n(t(o)("config.modelConfig.description"))+" ",1),l[24]||(l[24]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=a=>C.modelDescription=a),rows:"3",placeholder:t(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,ta),[[J,C.modelDescription]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:A.value,"onUpdate:modelValue":l[12]||(l[12]=a=>A.value=a),title:"Delete confirmation"},{footer:j(()=>[e("button",{class:"cancel-btn",onClick:l[11]||(l[11]=a=>A.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Q},n(t(o)("common.delete")),1)]),default:j(()=>{var a;return[e("div",sa,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(n(t(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,n((a=r.value)==null?void 0:a.modelName),1),w(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",na,n(t(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),p.value?(d(),u("div",{key:0,class:"error-toast",onClick:l[13]||(l[13]=a=>p.value="")},[y(t(V),{icon:"carbon:error"}),w(" "+n(p.value),1)])):M("",!0),v.value?(d(),u("div",{key:1,class:"success-toast",onClick:l[14]||(l[14]=a=>v.value="")},[y(t(V),{icon:"carbon:checkmark"}),w(" "+n(v.value),1)])):M("",!0)]),_:1}))}}),la=ne(aa,[["__scopeId","data-v-2ee2eba1"]]);class Te{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const s=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error(`Failed to add MCP server: ${s.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(s){return console.error("Failed to add MCP server:",s),{success:!1,message:s instanceof Error?s.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const s=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!s.ok)throw new Error(`Failed to delete MCP server: ${s.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(s){return console.error(`Failed to delete MCP server[${o}]:`,s),{success:!1,message:s instanceof Error?s.message:"Failed to delete, please retry"}}}}me(Te,"BASE_URL","/api/mcp");const ia={class:"mcp-config-panel"},ca={class:"mcp-header"},ra={class:"header-left"},da={class:"mcp-stats"},ua={class:"stat-item"},pa={class:"stat-label"},fa={class:"stat-value"},ma={class:"header-right"},ga={class:"search-box"},ha=["placeholder"],va={key:0,class:"loading-container"},ya={key:1,class:"mcp-layout"},_a={class:"mcp-table-container"},ba={class:"section-title"},Ca={key:0,class:"empty-state"},$a={class:"empty-state-text"},wa={key:1,class:"mcp-table-wrapper"},ka={class:"mcp-table"},Sa={class:"mcp-id"},Ta={class:"mcp-server-name"},Va={class:"server-name-content"},Aa={class:"mcp-connection-type"},Ua={class:"mcp-config"},Na=["title"],xa={class:"mcp-actions"},Pa=["onClick","disabled"],Ea={class:"add-mcp-container"},Ma={class:"add-mcp-header"},Da={class:"add-mcp-title"},Ra={class:"mcp-form"},La={class:"mcp-form-group"},Fa={class:"form-label"},Ba={class:"connection-type-options"},Ia={class:"connection-type-option"},qa={for:"mcp-connection-type-studio",class:"radio-label"},Oa={class:"connection-type-desc"},ja={class:"connection-type-option"},Ga={for:"mcp-connection-type-sse",class:"radio-label"},Ka={class:"connection-type-desc"},Ja={class:"connection-type-option"},za={for:"mcp-connection-type-streaming",class:"radio-label"},Ha={class:"connection-type-desc"},Ya={class:"mcp-form-group"},Wa={class:"form-label"},Xa=["placeholder"],Qa={class:"mcp-form-actions"},Za=["disabled"],el=["disabled"],ol={class:"mcp-form-instructions"},tl={class:"indented-list"},sl=se({__name:"mcpConfig",setup(D){const{t:o}=ge(),s=E(!1),p=E([]),v=E(""),m=oe({connectionType:"STUDIO",configJson:""}),h=oe({show:!1,text:"",type:"success"}),r=ie(()=>m.configJson.trim().length>0),k=ie(()=>{if(!v.value.trim())return p.value;const I=v.value.toLowerCase();return p.value.filter(N=>N.mcpServerName.toLowerCase().includes(I)||N.connectionType.toLowerCase().includes(I)||N.connectionConfig.toLowerCase().includes(I))}),A=I=>I?I.length>50?I.substring(0,50)+"...":I:"",C=(I,N="success")=>{h.text=I,h.type=N,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},S=async()=>{try{s.value=!0,p.value=await Te.getAllMcpServers()}catch(I){console.error("加载MCP服务器列表失败:",I),C(o("config.basicConfig.loadConfigFailed"),"error")}finally{s.value=!1}},G=async()=>{if(!r.value){C(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(m.configJson)}catch{C(o("config.mcpConfig.invalidJson"),"error");return}try{s.value=!0;const I={connectionType:m.connectionType,configJson:m.configJson},N=await Te.addMcpServer(I);N.success?(C(o("config.mcpConfig.addSuccess")),X(),await S()):C(N.message||o("config.mcpConfig.addFailed"),"error")}catch(I){console.error("添加MCP服务器失败:",I),C(o("config.mcpConfig.addFailed"),"error")}finally{s.value=!1}},L=async I=>{if(confirm(o("config.mcpConfig.deleteConfirm")))try{s.value=!0;const N=await Te.removeMcpServer(I);N.success?(C(o("config.mcpConfig.deleteSuccess")),await S()):C(N.message||o("config.mcpConfig.deleteFailed"),"error")}catch(N){console.error("删除MCP服务器失败:",N),C(o("config.mcpConfig.deleteFailed"),"error")}finally{s.value=!1}},X=()=>{m.connectionType="STUDIO",m.configJson=""};return be(()=>{S()}),(I,N)=>(d(),u("div",ia,[e("div",ca,[e("div",ra,[e("h2",null,n(t(o)("config.mcpConfig.title")),1),e("div",da,[e("span",ua,[e("span",pa,n(t(o)("config.mcpConfig.mcpServers"))+":",1),e("span",fa,n(p.value.length),1)])])]),e("div",ma,[e("div",ga,[O(e("input",{"onUpdate:modelValue":N[0]||(N[0]=R=>v.value=R),type:"text",placeholder:t(o)("config.mcpSearch"),class:"search-input"},null,8,ha),[[J,v.value]]),N[5]||(N[5]=e("span",{class:"search-icon"},"🔍",-1))])])]),s.value?(d(),u("div",va,[N[6]||(N[6]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,n(t(o)("config.loading")),1)])):(d(),u("div",ya,[e("div",_a,[e("h3",ba,n(t(o)("config.mcpConfig.serverList")),1),k.value.length===0?(d(),u("div",Ca,[N[7]||(N[7]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",$a,n(v.value?t(o)("config.notFound"):t(o)("config.mcpConfig.noServers")),1)])):(d(),u("div",wa,[e("table",ka,[e("thead",null,[e("tr",null,[N[8]||(N[8]=e("th",null,"ID",-1)),e("th",null,n(t(o)("agent.name")),1),e("th",null,n(t(o)("config.mcpConfig.connectionType")),1),e("th",null,n(t(o)("config.mcpConfig.configJsonLabel")),1),e("th",null,n(t(o)("common.actions")),1)])]),e("tbody",null,[(d(!0),u(H,null,Y(k.value,R=>(d(),u("tr",{key:R.id,class:"mcp-row"},[e("td",Sa,n(R.id),1),e("td",Ta,[e("div",Va,[N[9]||(N[9]=e("span",{class:"server-icon"},"🔌",-1)),w(" "+n(R.mcpServerName),1)])]),e("td",Aa,[e("span",{class:ee(["connection-type-badge",R.connectionType.toLowerCase()])},n(R.connectionType),3)]),e("td",Ua,[e("div",{class:"config-preview",title:R.connectionConfig},n(A(R.connectionConfig)),9,Na)]),e("td",xa,[e("button",{onClick:Q=>L(R.id),class:"action-btn delete-btn",disabled:s.value},n(t(o)("common.delete")),9,Pa)])]))),128))])])]))]),e("div",Ea,[e("div",Ma,[e("h3",Da,n(t(o)("config.mcpConfig.addMcpServer")),1)]),e("div",Ra,[e("div",La,[e("label",Fa,n(t(o)("config.mcpConfig.connectionType"))+"：",1),e("div",Ba,[e("div",Ia,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":N[1]||(N[1]=R=>m.connectionType=R),value:"STUDIO"},null,512),[[Ne,m.connectionType]]),e("label",qa,[N[10]||(N[10]=e("span",{class:"radio-title"},"STUDIO",-1)),e("span",Oa,n(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)])]),e("div",ja,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":N[2]||(N[2]=R=>m.connectionType=R),value:"SSE"},null,512),[[Ne,m.connectionType]]),e("label",Ga,[N[11]||(N[11]=e("span",{class:"radio-title"},"SSE",-1)),e("span",Ka,n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])]),e("div",Ja,[O(e("input",{type:"radio",id:"mcp-connection-type-streaming","onUpdate:modelValue":N[3]||(N[3]=R=>m.connectionType=R),value:"STREAMING"},null,512),[[Ne,m.connectionType]]),e("label",za,[N[12]||(N[12]=e("span",{class:"radio-title"},"Streamable HTTP",-1)),e("span",Ha,n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])])]),e("div",Ya,[e("label",Wa,n(t(o)("config.mcpConfig.configJsonLabel")),1),O(e("textarea",{"onUpdate:modelValue":N[4]||(N[4]=R=>m.configJson=R),placeholder:t(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,Xa),[[J,m.configJson]])]),e("div",Qa,[e("button",{onClick:G,class:"action-btn add-btn",disabled:s.value},n(t(o)("common.add")),9,Za),e("button",{onClick:X,class:"action-btn reset-btn",disabled:s.value},n(t(o)("common.reset")),9,el)])]),e("div",ol,[e("h4",null,n(t(o)("config.mcpConfig.instructions")),1),e("ol",null,[e("li",null,[w(n(t(o)("config.mcpConfig.instructionStep1"))+" ",1),e("ul",tl,[e("li",null,[e("strong",null,n(t(o)("config.mcpConfig.instructionStep1Local")),1),w("："+n(t(o)("config.mcpConfig.instructionStep1LocalDesc")),1)]),e("li",null,[e("strong",null,n(t(o)("config.mcpConfig.instructionStep1Remote")),1),w("："+n(t(o)("config.mcpConfig.instructionStep1RemoteDesc")),1)])])]),e("li",null,n(t(o)("config.mcpConfig.instructionStep2")),1),e("li",null,n(t(o)("config.mcpConfig.instructionStep3")),1),e("li",null,n(t(o)("config.mcpConfig.instructionStep4")),1)])])])])),y(Ce,{name:"message-fade"},{default:j(()=>[h.show?(d(),u("div",{key:0,class:ee(["message-toast",h.type])},n(h.text),3)):M("",!0)]),_:1})]))}}),nl=ne(sl,[["__scopeId","data-v-355da8bb"]]);class ve{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllPrompts(o){try{const s=await fetch(`${this.BASE_URL}/namespace/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to get Prompt list:",s),s}}static async getPromptById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Pr'o'm'p't[${o}] details:`,s),s}}static async createPrompt(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Prompt:",s),s}}static async updatePrompt(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Prompt[${o}]:`,p),p}}static async deletePrompt(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Prompt");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Prompt[${o}]:`,s),s}}}me(ve,"BASE_URL","/api/prompt");const al=se({__name:"Toast",setup(D,{expose:o}){const s=E(!1),p=E(""),v=E("success"),m=E("carbon:checkmark"),h=E(3e3),r=(A,C="success",S=3e3)=>{p.value=A,v.value=C,m.value=C==="success"?"carbon:checkmark":"carbon:error",h.value=S,s.value=!0,setTimeout(()=>{s.value=!1},h.value)},k=()=>{s.value=!1};return o({show:r}),(A,C)=>(d(),te(Re,{to:"body"},[y(Ce,{name:"slide"},{default:j(()=>[s.value?(d(),u("div",{key:0,class:ee(["toast",`toast--${v.value}`]),onClick:k},[y(t(V),{icon:m.value,class:"toast-icon"},null,8,["icon"]),e("span",null,n(p.value),1)],2)):M("",!0)]),_:1})]))}}),ll=ne(al,[["__scopeId","data-v-581895ae"]]);let pe=null;const Le=()=>{if(!pe){const D=Je(ll),o=document.createElement("div");document.body.appendChild(o),pe=D.mount(o)}return{success:(D,o)=>{pe==null||pe.show(D,"success",o)},error:(D,o)=>{pe==null||pe.show(D,"error",o)}}},il={class:"custom-select"},cl=["title"],rl={key:0,class:"current-option"},dl={class:"option-name"},ul={key:1,class:"current-option"},pl={class:"select-options"},fl=["onClick"],ml={class:"option-name"},gl=se({__name:"select",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue"],setup(D,{emit:o}){const s=D,p=o,v=E(!1),m=ie(()=>s.options.find(A=>A.id===s.modelValue)),h=A=>A.id===s.modelValue,r=()=>{v.value=!v.value},k=A=>{p("update:modelValue",A.id),v.value=!1};return(A,C)=>(d(),u("div",il,[e("button",{class:"select-btn",onClick:r,title:A.placeholder},[m.value?(d(),u("span",rl,[e("span",dl,n(m.value.name),1)])):(d(),u("span",ul,n(A.placeholder),1)),y(t(V),{icon:v.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,cl),y(Ce,{name:"slideDown"},{default:j(()=>[O(e("div",{class:"select-dropdown",onClick:C[0]||(C[0]=_e(()=>{},["stop"]))},[e("div",pl,[(d(!0),u(H,null,Y(A.options,S=>(d(),u("button",{key:S.id,class:ee(["select-option",{active:h(S)}]),onClick:G=>k(S)},[e("span",ml,n(S.name),1),h(S)?(d(),te(t(V),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):M("",!0)],10,fl))),128))])],512),[[Pe,v.value]])]),_:1}),v.value?(d(),u("div",{key:0,class:"backdrop",onClick:C[1]||(C[1]=S=>v.value=!1)})):M("",!0)]))}}),Se=ne(gl,[["__scopeId","data-v-4c6d676f"]]),hl={class:"prompt-layout"},vl={class:"prompt-list"},yl={class:"list-header"},_l={class:"prompt-count"},bl={key:0,class:"prompts-container"},Cl=["onClick"],$l={class:"prompt-card-header"},wl={class:"prompt-name"},kl={key:0,class:"prompt-desc"},Sl={class:"tags"},Tl={class:"tag"},Vl={key:1,class:"loading-state"},Al={key:2,class:"empty-state"},Ul={key:0,class:"prompt-detail"},Nl={class:"detail-header"},xl={class:"detail-actions"},Pl={class:"form-item"},El=["placeholder"],Ml={class:"form-item"},Dl={class:"form-item"},Rl={class:"form-item"},Ll=["placeholder"],Fl={class:"form-item"},Bl=["placeholder"],Il={key:1,class:"no-selection"},ql={class:"modal-form"},Ol={class:"form-item"},jl=["placeholder"],Gl={class:"form-item"},Kl={class:"form-item"},Jl={class:"form-item"},zl=["placeholder"],Hl={class:"form-item"},Yl=["placeholder"],Wl={class:"delete-confirm"},Xl={class:"warning-text"},Ql=se({__name:"dynamicPromptConfig",setup(D){const{t:o}=ge(),{success:s,error:p}=Le(),v=Ee(),m=E(!1),h=oe([]),r=E(null),k=E(!1),A=E(!1),C=[{id:"USER",name:"USER"},{id:"ASSISTANT",name:"ASSISTANT"},{id:"SYSTEM",name:"SYSTEM"},{id:"TOOL",name:"TOOL"}],S=[{id:"LLM",name:"LLM"},{id:"PLANNING",name:"PLANNING"},{id:"AGENT",name:"AGENT"}],G={promptName:"",messageType:"",type:"",promptDescription:""},L=oe({...G}),X=async()=>{m.value=!0;try{const a=await ve.getAllPrompts(v.namespace);a.length>0&&await I(a[0]),h.splice(0,h.length,...a)}catch(a){console.error("加载数据失败:",a),p(o("config.promptConfig.loadDataFailed")+": "+a.message)}finally{m.value=!1}},I=async a=>{try{const c=await ve.getPromptById(a.id);r.value={...c}}catch(c){console.error("加载Prompt详情失败:",c),p(o("config.promptConfig.loadDetailsFailed")+": "+c.message),r.value={...a}}},N=async()=>{if(ae(L))try{const a={...L,builtIn:!1},c=await ve.createPrompt(a);h.push(c),r.value=c,k.value=!1,s(o("config.promptConfig.createSuccess"))}catch(a){p(o("config.promptConfig.createFailed")+": "+a.message)}},R=async()=>{if(r.value&&ae(r.value))try{const a=await ve.updatePrompt(r.value.id,r.value),c=h.findIndex(_=>_.id===a.id);c!==-1&&(h[c]=a),r.value={...a},s(o("config.promptConfig.saveSuccess"))}catch(a){p(o("config.promptConfig.saveFailed")+": "+a.message)}},Q=async()=>{if(r.value)try{await ve.deletePrompt(r.value.id);const a=h.findIndex(c=>c.id===r.value.id);a!==-1&&h.splice(a,1),r.value=h.length>0?h[0]:null,A.value=!1,s(o("config.promptConfig.deleteSuccess"))}catch(a){p(o("config.promptConfig.deleteFailed")+": "+a.message)}};function ae(a){const c=["promptName","messageType","type","promptContent"];for(const F of c){const z=a[F];if(z==null||typeof z=="string"&&z.trim()==="")return p(`${F} is required and cannot be empty`),!1}return!!x(h,a)}function x(a,c){const _=a.find(F=>F.promptName===c.promptName);return _&&c.id&&_.id!==c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):_&&!c.id?(p(`Name "${c.promptName}" already exists. Please use a different name.`),!1):!0}const g=()=>{L.promptName="",L.promptDescription="",L.promptContent="",Object.assign(L,G),k.value=!0},l=()=>{A.value=!0};return be(()=>{X()}),(a,c)=>(d(),te(Ve,null,{title:j(()=>[e("h2",null,n(t(o)("config.promptConfig.title")),1)]),default:j(()=>[e("div",hl,[e("div",vl,[e("div",yl,[e("h3",null,n(t(o)("config.promptConfig.configuredprompts")),1),e("span",_l,"("+n(h.length)+n(t(o)("config.promptConfig.promptCount"))+")",1)]),m.value?M("",!0):(d(),u("div",bl,[(d(!0),u(H,null,Y(h,_=>{var F,z;return d(),u("div",{key:_.id,class:ee(["prompt-card",{active:((F=r.value)==null?void 0:F.id)===_.id}]),onClick:le=>I(_)},[e("div",$l,[e("span",wl,n(_.promptName),1),y(t(V),{icon:"carbon:chevron-right"})]),(z=_.promptDescription)!=null&&z.trim()?(d(),u("p",kl,n(_.promptDescription),1)):M("",!0),e("div",Sl,[e("span",Tl,n(_.builtIn?t(o)("config.promptConfig.builtIn"):t(o)("config.promptConfig.custom")),1)])],10,Cl)}),128))])),m.value?(d(),u("div",Vl,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),w(" "+n(t(o)("common.loading")),1)])):M("",!0),!m.value&&h.length===0?(d(),u("div",Al,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.promptConfig.noPrompts")),1)])):M("",!0),e("button",{class:"add-btn",onClick:g},[y(t(V),{icon:"carbon:add"}),w(" "+n(t(o)("config.promptConfig.createNew")),1)])]),r.value?(d(),u("div",Ul,[e("div",Nl,[e("h3",null,n(r.value.promptName),1),e("div",xl,[e("button",{class:"action-btn primary",onClick:R},[y(t(V),{icon:"carbon:save"}),w(" "+n(t(o)("common.save")),1)]),r.value.builtIn?M("",!0):(d(),u("button",{key:0,class:"action-btn danger",onClick:l},[y(t(V),{icon:"carbon:trash-can"}),w(" "+n(t(o)("common.delete")),1)]))])]),e("div",Pl,[e("label",null,[w(n(t(o)("config.promptConfig.promptName"))+" ",1),c[15]||(c[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":c[0]||(c[0]=_=>r.value.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,El),[[J,r.value.promptName]])]),e("div",Ml,[e("label",null,[w(n(t(o)("config.promptConfig.messageType"))+" ",1),c[16]||(c[16]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[2]||(c[2]=_=>r.value.messageType=_),disabled:!0},null,512)),[[J,r.value.messageType]]):(d(),te(Se,{key:0,modelValue:r.value.messageType,"onUpdate:modelValue":c[1]||(c[1]=_=>r.value.messageType=_),options:C,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Dl,[e("label",null,[w(n(t(o)("config.promptConfig.type"))+" ",1),c[17]||(c[17]=e("span",{class:"required"},"*",-1))]),r.value.builtIn?O((d(),u("input",{key:1,type:"text","onUpdate:modelValue":c[4]||(c[4]=_=>r.value.type=_),disabled:!0,required:""},null,512)),[[J,r.value.type]]):(d(),te(Se,{key:0,modelValue:r.value.type,"onUpdate:modelValue":c[3]||(c[3]=_=>r.value.type=_),options:S,disabled:r.value.builtIn,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","disabled","placeholder"]))]),e("div",Rl,[e("label",null,n(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=_=>r.value.promptDescription=_),rows:"2",placeholder:t(o)("config.promptConfig.descriptionPlaceholder"),required:""},null,8,Ll),[[J,r.value.promptDescription]])]),e("div",Fl,[e("label",null,[w(n(t(o)("config.promptConfig.promptContent"))+" ",1),c[18]||(c[18]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[6]||(c[6]=_=>r.value.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Bl),[[J,r.value.promptContent]])])])):(d(),u("div",Il,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.promptConfig.selectPromptHint")),1)]))]),y(de,{modelValue:k.value,"onUpdate:modelValue":c[12]||(c[12]=_=>k.value=_),title:t(o)("config.promptConfig.newPrompt"),onConfirm:N},{default:j(()=>[e("div",ql,[e("div",Ol,[e("label",null,[w(n(t(o)("config.promptConfig.promptName"))+" ",1),c[19]||(c[19]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[7]||(c[7]=_=>L.promptName=_),placeholder:t(o)("config.promptConfig.placeholder"),required:""},null,8,jl),[[J,L.promptName]])]),e("div",Gl,[e("label",null,[w(n(t(o)("config.promptConfig.messageType"))+" ",1),c[20]||(c[20]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:L.messageType,"onUpdate:modelValue":c[8]||(c[8]=_=>L.messageType=_),options:C,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Kl,[e("label",null,[w(n(t(o)("config.promptConfig.type"))+" ",1),c[21]||(c[21]=e("span",{class:"required"},"*",-1))]),y(Se,{modelValue:L.type,"onUpdate:modelValue":c[9]||(c[9]=_=>L.type=_),options:S,placeholder:t(o)("config.promptConfig.placeholder")},null,8,["modelValue","placeholder"])]),e("div",Jl,[e("label",null,n(t(o)("config.promptConfig.description")),1),O(e("textarea",{"onUpdate:modelValue":c[10]||(c[10]=_=>L.promptDescription=_),rows:"3",placeholder:t(o)("config.promptConfig.descriptionPlaceholder")},null,8,zl),[[J,L.promptDescription]])]),e("div",Hl,[e("label",null,[w(n(t(o)("config.promptConfig.promptContent"))+" ",1),c[22]||(c[22]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[11]||(c[11]=_=>L.promptContent=_),rows:"8",placeholder:t(o)("config.promptConfig.promptContentPlaceholder"),required:""},null,8,Yl),[[J,L.promptContent]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:A.value,"onUpdate:modelValue":c[14]||(c[14]=_=>A.value=_),title:t(o)("config.promptConfig.deleteConfirm")},{footer:j(()=>[e("button",{class:"cancel-btn",onClick:c[13]||(c[13]=_=>A.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Q},n(t(o)("common.delete")),1)]),default:j(()=>{var _;return[e("div",Wl,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(n(t(o)("config.promptConfig.deleteConfirmText"))+" ",1),e("strong",null,n((_=r.value)==null?void 0:_.promptName),1),w(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",Xl,n(t(o)("config.promptConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),Zl=ne(Ql,[["__scopeId","data-v-697ad7ba"]]);class ye{static async handleResponse(o){if(!o.ok)try{const s=await o.json();throw new Error(s.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(`${this.BASE_URL}`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getNamespaceById(o){try{const s=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(s)).json()}catch(s){throw console.error(`Failed to get Namespace[${o}] details:`,s),s}}static async createNamespace(o){try{const s=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(s)).json()}catch(s){throw console.error("Failed to create Namespace:",s),s}}static async updateNamespace(o,s){try{const p=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return await(await this.handleResponse(p)).json()}catch(p){throw console.error(`Failed to update Namespace[${o}]:`,p),p}}static async deleteNamespace(o){try{const s=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(s.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(s)}catch(s){throw console.error(`Failed to delete Namespace[${o}]:`,s),s}}}me(ye,"BASE_URL","/api/namespace");const ei={class:"namespace-layout"},oi={class:"namespace-list"},ti={class:"list-header"},si={key:0,class:"namespaces-container"},ni=["onClick"],ai={class:"namespace-card-header"},li={class:"namespace-name"},ii={key:0,class:"loading-state"},ci={key:1,class:"empty-state"},ri={key:0,class:"namespace-detail"},di={class:"detail-header"},ui={class:"detail-actions"},pi={class:"form-item"},fi=["placeholder"],mi={key:1,class:"no-selection"},gi={class:"modal-form"},hi={class:"form-item"},vi=["placeholder"],yi={class:"delete-confirm"},_i={class:"warning-text"},bi=se({__name:"namespaceConfig",setup(D){const{t:o}=ge(),{success:s,error:p}=Le(),v=E(!1),m=oe([]),h=E(null),r=E(!1),k=E(!1),A={name:""},C=oe({...A}),S=async()=>{v.value=!0;try{const x=await ye.getAllNamespaces();x.length>0&&await G(x[0]),m.splice(0,m.length,...x)}catch(x){console.error("加载数据失败:",x),p(o("config.namespaceConfig.loadDataFailed")+": "+x.message)}finally{v.value=!1}},G=async x=>{try{const g=await ye.getNamespaceById(x.id);h.value={...g}}catch(g){console.error("加载Prompt详情失败:",g),p(o("config.namespaceConfig.loadDetailsFailed")+": "+g.message),h.value={...x}}},L=async()=>{if(N(C))try{const x={...C},g=await ye.createNamespace(x);m.push(g),h.value=g,r.value=!1,s(o("config.namespaceConfig.createSuccess"))}catch(x){p(o("config.namespaceConfig.createFailed")+": "+x.message)}},X=async()=>{if(h.value&&N(h.value))try{const x=await ye.updateNamespace(h.value.id,h.value),g=m.findIndex(l=>l.id===x.id);g!==-1&&(m[g]=x),h.value={...x},s(o("config.namespaceConfig.saveSuccess"))}catch(x){p(o("config.namespaceConfig.saveFailed")+": "+x.message)}},I=async()=>{if(h.value)try{await ye.deleteNamespace(h.value.id);const x=m.findIndex(g=>g.id===h.value.id);x!==-1&&m.splice(x,1),h.value=m.length>0?m[0]:null,k.value=!1,s(o("config.namespaceConfig.deleteSuccess"))}catch(x){p(o("config.namespaceConfig.deleteFailed")+": "+x.message)}};function N(x){const g=["name"];for(const a of g){const c=x[a];if(c==null||typeof c=="string"&&c.trim()==="")return p(`${a} is required and cannot be empty`),!1}return!!R(m,x)}function R(x,g){const l=x.find(a=>a.name===g.name);return l&&g.id&&l.id!==g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):l&&!g.id?(p(`Name "${g.name}" already exists. Please use a different name.`),!1):!0}const Q=()=>{C.name="",Object.assign(C,A),r.value=!0},ae=()=>{k.value=!0};return be(()=>{S()}),(x,g)=>(d(),te(Ve,null,{title:j(()=>[e("h2",null,n(t(o)("config.namespaceConfig.title")),1)]),default:j(()=>[e("div",ei,[e("div",oi,[e("div",ti,[e("h3",null,n(t(o)("config.namespaceConfig.configured")),1)]),v.value?M("",!0):(d(),u("div",si,[(d(!0),u(H,null,Y(m,l=>{var a;return d(),u("div",{key:l.id,class:ee(["namespace-card",{active:((a=h.value)==null?void 0:a.id)===l.id}]),onClick:c=>G(l)},[e("div",ai,[e("span",li,n(l.name),1),y(t(V),{icon:"carbon:chevron-right"})])],10,ni)}),128))]))]),v.value?(d(),u("div",ii,[y(t(V),{icon:"carbon:loading",class:"loading-icon"}),w(" "+n(t(o)("common.loading")),1)])):M("",!0),!v.value&&m.length===0?(d(),u("div",ci,[y(t(V),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,n(t(o)("config.namespaceConfig.noPrompts")),1)])):M("",!0),e("button",{class:"add-btn",onClick:Q},[y(t(V),{icon:"carbon:add"}),w(" "+n(t(o)("config.namespaceConfig.createNew")),1)])]),h.value?(d(),u("div",ri,[e("div",di,[e("h3",null,n(h.value.name),1),e("div",ui,[e("button",{class:"action-btn primary",onClick:X},[y(t(V),{icon:"carbon:save"}),w(" "+n(t(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:ae},[y(t(V),{icon:"carbon:trash-can"}),w(" "+n(t(o)("common.delete")),1)])])]),e("div",pi,[e("label",null,[w(n(t(o)("config.namespaceConfig.name"))+" ",1),g[5]||(g[5]=e("span",{class:"required"},"*",-1))]),O(e("input",{disabled:!0,type:"text","onUpdate:modelValue":g[0]||(g[0]=l=>h.value.name=l),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,fi),[[J,h.value.name]])])])):(d(),u("div",mi,[y(t(V),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,n(t(o)("config.namespaceConfig.selectPromptHint")),1)])),y(de,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=l=>r.value=l),title:t(o)("config.namespaceConfig.newPrompt"),onConfirm:L},{default:j(()=>[e("div",gi,[e("div",hi,[e("label",null,[w(n(t(o)("config.namespaceConfig.name"))+" ",1),g[6]||(g[6]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":g[1]||(g[1]=l=>C.name=l),placeholder:t(o)("config.namespaceConfig.placeholder"),required:""},null,8,vi),[[J,C.name]])])])]),_:1},8,["modelValue","title"]),y(de,{modelValue:k.value,"onUpdate:modelValue":g[4]||(g[4]=l=>k.value=l),title:t(o)("config.namespaceConfig.deleteConfirm")},{footer:j(()=>[e("button",{class:"cancel-btn",onClick:g[3]||(g[3]=l=>k.value=!1)},n(t(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:I},n(t(o)("common.delete")),1)]),default:j(()=>{var l;return[e("div",yi,[y(t(V),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[w(n(t(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,n((l=h.value)==null?void 0:l.name),1),w(" "+n(t(o)("common.confirm"))+"？ ",1)]),e("p",_i,n(t(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"])]),_:1}))}}),Ci=ne(bi,[["__scopeId","data-v-d0b2912a"]]),$i=se({__name:"namespaceSwitch",setup(D){const{namespace:o,setNamespace:s,db:p}=Ee(),v=m=>{s(m)};return(m,h)=>(d(),u("div",null,[y(xe,{modelValue:t(o),"onUpdate:modelValue":h[0]||(h[0]=r=>ze(o)?o.value=r:null),options:t(p),"dropdown-title":"命名空间",onChange:v,placeholder:"请选择命名空间",direction:"right",dropStyles:{minWidth:"180px"}},null,8,["modelValue","options"])]))}}),wi={class:"config-container"},ki={class:"config-header"},Si={class:"header-actions"},Ti={class:"header-actions-left"},Vi={class:"header-actions-right"},Ai={class:"config-content"},Ui={class:"config-nav"},Ni=["onClick"],xi={class:"config-details"},Pi=se({__name:"index",setup(D){const{t:o}=ge(),s=He(),p=We(),v=E(s.params.category||"basic"),m={basic:De,agent:rn,model:la,mcp:nl,prompt:Zl,namespace:Ci},h=ie(()=>{const A=v.value;return m[A]||De}),r=ie(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"},{key:"prompt",label:o("config.categories.prompt"),icon:"carbon:repo-artifact"},{key:"namespace",disabled:!0,icon:"carbon:repo-artifact"}]),k=A=>{v.value=A,p.push({name:s.name,params:{...s.params,category:A},query:s.query})};return(A,C)=>(d(),u("div",wi,[e("div",ki,[e("div",Si,[e("div",Ti,[e("button",{class:"action-btn",onClick:C[0]||(C[0]=S=>A.$router.push("/"))},[y(t(V),{icon:"carbon:arrow-left"}),w(" "+n(A.$t("backHome")),1)]),y(Xe)]),e("div",Vi,[y($i)])])]),e("div",Ai,[e("nav",Ui,[(d(!0),u(H,null,Y(r.value,(S,G)=>(d(),u(H,null,[S.disabled?M("",!0):(d(),u("div",{key:G,class:ee(["nav-item",{active:v.value===S.key}]),onClick:L=>k(S.key)},[y(t(V),{icon:S.icon,width:"20"},null,8,["icon"]),e("span",null,n(S.label),1)],10,Ni))],64))),256))]),e("div",xi,[(d(),te(Ye(h.value)))])])]))}}),Li=ne(Pi,[["__scopeId","data-v-5d4a51b7"]]);export{Li as default};
