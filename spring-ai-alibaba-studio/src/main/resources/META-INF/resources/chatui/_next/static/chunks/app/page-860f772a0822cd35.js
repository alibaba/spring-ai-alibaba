(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{26126:(e,t,s)=>{Promise.resolve().then(s.bind(s,70434))},58413:()=>{},70434:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>e6});var a=s(99405),r=s(37913),n=s(2430),l=s(23962),o=s(7907);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,l.$)(t))}var c=s(23678);function d(e){let{className:t,...s}=e;return(0,a.jsx)(c.b,{"data-slot":"label",className:i("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}var m=s(41837);class u{async listApps(){let e=await fetch("".concat(this.baseUrl,"/list-apps"));if(!e.ok)throw Error("Failed to fetch apps: ".concat(e.statusText));return await e.json()}async listSessions(e,t){let s=await fetch("".concat(this.baseUrl,"/apps/").concat(e,"/users/").concat(t,"/threads"));if(!s.ok)throw Error("Failed to fetch sessions: ".concat(s.statusText));return await s.json()}async getSession(e){let t=m.env.NEXT_PUBLIC_APP_NAME||"research_agent",s=m.env.NEXT_PUBLIC_USER_ID||"user-001",a=await fetch("".concat(this.baseUrl,"/apps/").concat(t,"/users/").concat(s,"/threads/").concat(e));if(!a.ok)throw Error("Failed to fetch session: ".concat(a.statusText));return await a.json()}async createSession(e,t,s){let a=await fetch("".concat(this.baseUrl,"/apps/").concat(e,"/users/").concat(t,"/threads"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s||{})});if(!a.ok)throw Error("Failed to create session: ".concat(a.statusText));return await a.json()}async createSessionWithId(e,t,s,a){let r=await fetch("".concat(this.baseUrl,"/apps/").concat(e,"/users/").concat(t,"/threads/").concat(s),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a||{})});if(!r.ok)throw Error("Failed to create session with ID: ".concat(r.statusText));return await r.json()}async deleteSession(e,t,s){let a=await fetch("".concat(this.baseUrl,"/apps/").concat(e,"/users/").concat(t,"/threads/").concat(s),{method:"DELETE"});if(!a.ok)throw Error("Failed to delete session: ".concat(a.statusText))}async runAgent(e){let t=await fetch("".concat(this.baseUrl,"/run"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to run agent: ".concat(t.statusText));return await t.json()}async *runAgentStream(e,t,s){let a={appName:m.env.NEXT_PUBLIC_APP_NAME||"research_agent",userId:m.env.NEXT_PUBLIC_USER_ID||"user-001",threadId:e,newMessage:{messageType:"user",content:t.content,metadata:t.metadata||{},media:t.media||[]},streaming:!0},r=await fetch("".concat(this.baseUrl,"/run_sse"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify(a),signal:s});if(!r.ok)throw Error("Failed to run agent stream: ".concat(r.statusText));yield*this._processSSEStream(r)}async *resumeAgentStream(e,t,s){let a=m.env.NEXT_PUBLIC_APP_NAME||"research_agent",r=m.env.NEXT_PUBLIC_USER_ID||"user-001",n=await fetch("".concat(this.baseUrl,"/resume_sse"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify({appName:a,userId:r,threadId:e,toolFeedbacks:t,streaming:!0}),signal:s});if(!n.ok)throw Error("Failed to resume agent stream: ".concat(n.statusText));yield*this._processSSEStream(n)}async *_processSSEStream(e){var t;let s=null==(t=e.body)?void 0:t.getReader();if(!s)throw Error("Response body is not readable");let a=new TextDecoder,r="";console.log("[API] Starting SSE stream reading...");try{for(;;){let{done:e,value:t}=await s.read();if(e){console.log("[API] SSE stream done");break}let n=(r+=a.decode(t,{stream:!0})).split("\n");for(let e of(r=n.pop()||"",n))if(e.trim().startsWith("data:")){let t=e.slice(5).trim();if(t)try{console.log("[API] Received SSE data:",t);let e=JSON.parse(t);console.log("[API] Parsed agent response:",e),yield e}catch(e){console.error("[API] Failed to parse SSE data:",e,"Raw data:",t)}}else e.trim()&&console.log("[API] Skipping non-data line:",e)}}finally{s.releaseLock(),console.log("[API] SSE stream ended")}}async getSessionTrace(e){let t=await fetch("".concat(this.baseUrl,"/debug/trace/thread/").concat(e));if(!t.ok)throw Error("Failed to fetch session trace: ".concat(t.statusText));return await t.json()}constructor(e){this.baseUrl=e}}function g(){return new u(m.env.NEXT_PUBLIC_API_URL||"")}var x=s(32812),h=s(41837);let p=(0,r.createContext)(void 0);function f(){let e=(0,r.useContext)(p);if(!e)throw Error("useThreads must be used within a ThreadProvider");return e}function b(e){let{children:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(null),[i,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(new Set),u=h.env.NEXT_PUBLIC_APP_NAME||"research_agent",f=h.env.NEXT_PUBLIC_USER_ID||"user-001",b=(0,r.useCallback)(e=>d.has(e),[d]),y=(0,r.useCallback)(async()=>{c(!0);try{let e=g(),t=(await e.listSessions(u,f)).sort((e,t)=>e.thread_id.localeCompare(t.thread_id));n(t)}catch(e){console.error("Failed to load threads:",e),x.oR.error("Failed to load threads: "+(e.message||"Unknown error"))}finally{c(!1)}},[u,f]),v=(0,r.useCallback)(async()=>{try{let e=g(),t=await e.createSession(u,f,{});return m(e=>new Set(e).add(t.thread_id)),n(e=>[t,...e]),o(t.thread_id),x.oR.success("New thread created"),t}catch(e){return console.error("Failed to create thread:",e),x.oR.error("Failed to create thread: "+(e.message||"Unknown error")),null}},[u,f]),j=(0,r.useCallback)(async e=>{try{let t=g();await t.deleteSession(u,f,e),n(t=>t.filter(t=>t.thread_id!==e)),l===e&&o(null),x.oR.success("Thread deleted")}catch(e){console.error("Failed to delete thread:",e),x.oR.error("Failed to delete thread: "+(e.message||"Unknown error"))}},[u,f,l]),w=(0,r.useMemo)(()=>({threads:s,currentThreadId:l,setCurrentThreadId:o,loadThreads:y,createThread:v,deleteThread:j,appName:u,userId:f,isLoading:i,isNewlyCreatedThread:b}),[s,l,o,y,v,j,u,f,i,b]);return(0,a.jsx)(p.Provider,{value:w,children:t})}function y(e){return"tool-confirm"===e.messageType}function v(e){switch(e.messageType){case"user":return{messageType:"user",content:e.content||"",metadata:e.metadata||{},media:e.media||[]};case"assistant":return{messageType:"assistant",content:e.content||"",metadata:e.metadata||{},toolCalls:e.toolCalls||[]};case"tool-request":return{messageType:"tool-request",content:e.content||"",metadata:e.metadata||{},toolCalls:e.toolCalls||[]};case"tool-confirm":return{messageType:"tool-confirm",content:e.content||"",metadata:e.metadata||{},toolFeedback:e.toolFeedback||[],toolsAutomaticallyApproved:e.toolsAutomaticallyApproved||[]};case"tool":return{messageType:"tool",content:e.content||"",metadata:e.metadata||{},responses:e.responses||[]};default:return{messageType:"user",content:e.content||"",metadata:e.metadata||{}}}}function j(e,t,s){return{id:t||"".concat(e.messageType,"-").concat(Date.now()),message:e,timestamp:s||Date.now()}}s(41837);let w=(0,r.createContext)(void 0),N=()=>{let e=(0,r.useContext)(w),{currentThreadId:t}=f();if(!e)throw Error("useStream must be used within a StreamProvider");let{clearMessages:s}=e;return(0,r.useEffect)(()=>{null===t&&s()},[t,s]),e},k=e=>{let{children:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),{currentThreadId:d,createThread:m,isNewlyCreatedThread:u}=f(),h=(0,r.useRef)(null);(0,r.useEffect)(()=>{d?p(d):n([])},[d]);let p=async e=>{c(!0);try{console.log("[Stream] Loading thread messages for threadId:",e);let t=g(),s=await t.getSession(e);if(console.log("[Stream] Loaded session:",s),s.values&&Array.isArray(s.values.messages)&&s.values.messages.length>0){let t=s.values.messages.map((t,s)=>j(v(t),"".concat(e,"-").concat(s)));n(t),console.log("[Stream] Loaded messages:",t)}else if(u(e))console.log("[Stream] Newly created thread - showing empty state"),n([]);else{console.log("[Stream] Existing thread with empty values - showing development notice");let t=j({messageType:"assistant",content:"\uD83D\uDCA1 Support for agent message loading is under development.\n\nThis thread exists but its message history cannot be displayed yet.\n\nPlease create a new thread to start a conversation.",metadata:{isPlaceholder:!0}},"".concat(e,"-placeholder"));n([t])}}catch(e){console.error("Failed to load thread messages:",e),x.oR.error("Failed to load thread messages"),n([])}finally{c(!1)}},b=(0,r.useCallback)(async e=>{if(!e.trim())return;let t=d;if(!t){x.oR.info("Creating new thread...");let e=await m();if(!e)return void x.oR.error("Failed to create thread");t=e.thread_id}let s={id:"user-".concat(Date.now()),message:{messageType:"user",content:e.trim(),metadata:{}},timestamp:Date.now()};n(e=>[...e,s]),o(!0),h.current=new AbortController;try{let s=g(),a={messageType:"user",content:e.trim(),metadata:{},media:[]},r=s.runAgentStream(t,a,h.current.signal),l=!0;for await(let e of(console.log("[Stream] Starting to process agent responses..."),r)){if(console.log("[Stream] Received agent response:",e),"heartbeat"===e.node){console.log("[Stream] Skipping heartbeat message");continue}if(e.chunk)if(console.log("[Stream] Processing chunk:",e.chunk),e.message&&"assistant"!==e.message.messageType&&console.warn("[Stream] Warning: chunk exists but message type is not assistant:",e.message.messageType,"This indicates a backend data format issue."),l){let t={id:"assistant-".concat(Date.now()),message:{messageType:"assistant",content:e.chunk,metadata:{},toolCalls:[]},timestamp:Date.now()};n(e=>(console.log("[Stream] Adding first chunk, prev messages:",e.length),[...e,t])),l=!1}else n(t=>{let s=[...t],a=s[s.length-1];return s[s.length-1]={...a,message:{...a.message,content:a.message.content+e.chunk}},console.log("[Stream] Updated message content length:",s[s.length-1].message.content.length),s});else if(e.message){console.log("[Stream] Processing message:",e.message);let t=v(e.message),s=e.message.messageType;if("assistant"===s||"tool-request"===s)if(l){let e={id:"".concat(s,"-").concat(Date.now()),message:t,timestamp:Date.now()};n(t=>(console.log("[Stream] Adding first message, prev messages:",t.length),[...t,e])),l=!1}else n(e=>{let s=[...e],a=s[s.length-1],r=t.content||a.message.content;return s[s.length-1]={...a,message:{...t,content:r}},console.log("[Stream] Updated message content:",null==r?void 0:r.length,"chars"),s});else if("tool-confirm"===s||"tool"===s){let e={id:"".concat(s,"-").concat(Date.now()),message:t,timestamp:Date.now()};n(t=>[...t,e]),l=!0}else console.warn("[Stream] Unknown message type:",s)}else console.log("[Stream] No chunk or message in response")}console.log("[Stream] Streaming complete")}catch(e){"AbortError"===e.name?(console.log("Request was aborted"),x.oR.info("Request cancelled")):(console.error("Failed to send message:",e),x.oR.error(e.message||"Failed to send message"))}finally{o(!1),h.current=null}},[d,m]),y=(0,r.useCallback)(()=>{n([]),h.current&&(h.current.abort(),h.current=null)},[]),N=(0,r.useCallback)(async e=>{if(!d)return void x.oR.error("No active thread");o(!0),h.current=new AbortController;try{let t=g().resumeAgentStream(d,e,h.current.signal),s=!0;for await(let e of(console.log("[Stream] Starting to process resume agent responses..."),t)){if(console.log("[Stream] Received agent response:",e),"heartbeat"===e.node){console.log("[Stream] Skipping heartbeat message");continue}if(e.chunk)if(console.log("[Stream] Processing chunk:",e.chunk),s){let t={id:"assistant-".concat(Date.now()),message:{messageType:"assistant",content:e.chunk,metadata:{},toolCalls:[]},timestamp:Date.now()};n(e=>(console.log("[Stream] Adding first chunk, prev messages:",e.length),[...e,t])),s=!1}else n(t=>{let s=[...t],a=s[s.length-1];return s[s.length-1]={...a,message:{...a.message,content:a.message.content+e.chunk}},s});else if(e.message){console.log("[Stream] Processing message:",e.message);let t=v(e.message),a=e.message.messageType;if("assistant"===a||"tool-request"===a)if(s){let e={id:"".concat(a,"-").concat(Date.now()),message:t,timestamp:Date.now()};n(t=>[...t,e]),s=!1}else n(e=>{let s=[...e],a=s[s.length-1],r=t.content||a.message.content;return s[s.length-1]={...a,message:{...t,content:r}},s});else if("tool-confirm"===a||"tool"===a){let e={id:"".concat(a,"-").concat(Date.now()),message:t,timestamp:Date.now()};n(t=>[...t,e]),s=!0}}}console.log("[Stream] Resume streaming complete")}catch(e){"AbortError"===e.name?(console.log("Resume request was aborted"),x.oR.info("Request cancelled")):(console.error("Failed to resume with feedback:",e),x.oR.error(e.message||"Failed to resume execution"))}finally{o(!1),h.current=null}},[d]);(0,r.useEffect)(()=>()=>{h.current&&h.current.abort()},[]);let k=(0,r.useMemo)(()=>({messages:s,isStreaming:l,sendMessage:b,resumeFeedback:N,clearMessages:y}),[s,l,b,N,y]);return(0,a.jsx)(w.Provider,{value:k,children:t})};var S=s(12947);let T=(0,s(97260).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",brand:"bg-[#2F6868] hover:bg-[#2F6868]/90 border-[#2F6868] text-white"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function A(e){let{className:t,variant:s,size:r,asChild:n=!1,...l}=e,o=n?S.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:i(T({variant:s,size:r,className:t})),...l})}s(58413);var C=s(35709),E=s(2373),P=s(13446),R=s(64526),_=s(70735),D=s(35702),F=s(59625),z=s(15842),L=s(88809),I=s(51641);F.A.registerLanguage("js",z.A),F.A.registerLanguage("jsx",z.A),F.A.registerLanguage("ts",z.A),F.A.registerLanguage("tsx",z.A),F.A.registerLanguage("python",L.A);let U=e=>{let{children:t,language:s,className:r}=e;return(0,a.jsx)(F.A,{language:s,style:I.hY,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},className:r,children:t})};var O=s(22224);function q(e){let{delayDuration:t=0,...s}=e;return(0,a.jsx)(O.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...s})}function M(e){let{...t}=e;return(0,a.jsx)(q,{children:(0,a.jsx)(O.bL,{"data-slot":"tooltip",...t})})}function B(e){let{...t}=e;return(0,a.jsx)(O.l9,{"data-slot":"tooltip-trigger",...t})}function J(e){let{className:t,sideOffset:s=0,children:r,...n}=e;return(0,a.jsx)(O.ZL,{children:(0,a.jsxs)(O.UC,{"data-slot":"tooltip-content",sideOffset:s,className:i("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance",t),...n,children:[r,(0,a.jsx)(O.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}let H=(0,r.forwardRef)((e,t)=>{let{children:s,tooltip:r,side:n="bottom",className:l,...o}=e;return(0,a.jsx)(q,{children:(0,a.jsxs)(M,{children:[(0,a.jsx)(B,{asChild:!0,children:(0,a.jsxs)(A,{variant:"ghost",size:"icon",...o,className:i("size-6 p-1",l),ref:t,children:[s,(0,a.jsx)("span",{className:"sr-only",children:r})]})}),(0,a.jsx)(J,{side:n,children:r})]})})});H.displayName="TooltipIconButton",s(20595);let G=function(){let{copiedDuration:e=3e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,r.useState)(!1);return{isCopied:t,copyToClipboard:t=>{t&&navigator.clipboard.writeText(t).then(()=>{s(!0),setTimeout(()=>s(!1),e)})}}},W=e=>{let{language:t,code:s}=e,{isCopied:r,copyToClipboard:n}=G();return(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-t-lg bg-zinc-900 px-4 py-2 text-sm font-semibold text-white",children:[(0,a.jsx)("span",{className:"lowercase [&>span]:text-xs",children:t}),(0,a.jsxs)(H,{tooltip:"Copy",onClick:()=>{s&&!r&&n(s)},children:[!r&&(0,a.jsx)(_.A,{}),r&&(0,a.jsx)(D.A,{})]})]})},X={h1:e=>{let{className:t,...s}=e;return(0,a.jsx)("h1",{className:i("mb-8 scroll-m-20 text-4xl font-extrabold tracking-tight last:mb-0",t),...s})},h2:e=>{let{className:t,...s}=e;return(0,a.jsx)("h2",{className:i("mt-8 mb-4 scroll-m-20 text-3xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...s})},h3:e=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{className:i("mt-6 mb-4 scroll-m-20 text-2xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...s})},h4:e=>{let{className:t,...s}=e;return(0,a.jsx)("h4",{className:i("mt-6 mb-4 scroll-m-20 text-xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...s})},h5:e=>{let{className:t,...s}=e;return(0,a.jsx)("h5",{className:i("my-4 text-lg font-semibold first:mt-0 last:mb-0",t),...s})},h6:e=>{let{className:t,...s}=e;return(0,a.jsx)("h6",{className:i("my-4 font-semibold first:mt-0 last:mb-0",t),...s})},p:e=>{let{className:t,...s}=e;return(0,a.jsx)("p",{className:i("mt-5 mb-5 leading-7 first:mt-0 last:mb-0",t),...s})},a:e=>{let{className:t,...s}=e;return(0,a.jsx)("a",{className:i("text-primary font-medium underline underline-offset-4",t),...s})},blockquote:e=>{let{className:t,...s}=e;return(0,a.jsx)("blockquote",{className:i("border-l-2 pl-6 italic",t),...s})},ul:e=>{let{className:t,...s}=e;return(0,a.jsx)("ul",{className:i("my-5 ml-6 list-disc [&>li]:mt-2",t),...s})},ol:e=>{let{className:t,...s}=e;return(0,a.jsx)("ol",{className:i("my-5 ml-6 list-decimal [&>li]:mt-2",t),...s})},hr:e=>{let{className:t,...s}=e;return(0,a.jsx)("hr",{className:i("my-5 border-b",t),...s})},table:e=>{let{className:t,...s}=e;return(0,a.jsx)("table",{className:i("my-5 w-full border-separate border-spacing-0 overflow-y-auto",t),...s})},th:e=>{let{className:t,...s}=e;return(0,a.jsx)("th",{className:i("bg-muted px-4 py-2 text-left font-bold first:rounded-tl-lg last:rounded-tr-lg [&[align=center]]:text-center [&[align=right]]:text-right",t),...s})},td:e=>{let{className:t,...s}=e;return(0,a.jsx)("td",{className:i("border-b border-l px-4 py-2 text-left last:border-r [&[align=center]]:text-center [&[align=right]]:text-right",t),...s})},tr:e=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{className:i("m-0 border-b p-0 first:border-t [&:last-child>td:first-child]:rounded-bl-lg [&:last-child>td:last-child]:rounded-br-lg",t),...s})},sup:e=>{let{className:t,...s}=e;return(0,a.jsx)("sup",{className:i("[&>a]:text-xs [&>a]:no-underline",t),...s})},pre:e=>{let{className:t,...s}=e;return(0,a.jsx)("pre",{className:i("max-w-4xl overflow-x-auto rounded-lg bg-black text-white",t),...s})},code:e=>{let{className:t,children:s,...r}=e,n=/language-(\w+)/.exec(t||"");if(n){let e=n[1],r=String(s).replace(/\n$/,"");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W,{language:e,code:r}),(0,a.jsx)(U,{language:e,className:t,children:r})]})}return(0,a.jsx)("code",{className:i("rounded font-semibold",t),...r,children:s})}},Z=(0,r.memo)(e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"markdown-content",children:(0,a.jsx)(C.oz,{remarkPlugins:[E.A,R.A],rehypePlugins:[P.A],components:X,children:t})})});var V=s(32700);function K(e){var t;let{message:s}=e;if("assistant"!==s.message.messageType)return console.warn("[AssistantMessage] Warning: Received non-assistant message type:",s.message.messageType,"This should be handled by the appropriate component."),null;console.log("[AssistantMessage] Rendering:",{id:s.id,messageType:s.message.messageType,content:s.message.content,contentLength:null==(t=s.message.content)?void 0:t.length,toolCalls:s.message.toolCalls,fullMessage:s});let r=s.message.content;return s.message.toolCalls&&s.message.toolCalls.length>0&&console.warn("[AssistantMessage] Warning: Assistant message contains toolCalls.","This should typically be a tool-request message instead.","toolCalls:",s.message.toolCalls),(0,a.jsx)("div",{className:"group flex flex-col gap-2",children:r&&(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,a.jsx)(Z,{children:r})})})}function Y(){return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(V.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{className:"text-sm",children:"Thinking..."})]})}function $(e){let{message:t}=e,s=t.message.content;return(0,a.jsx)("div",{className:"group ml-auto flex items-center gap-2",children:(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsx)("p",{className:"bg-muted ml-auto w-fit rounded-3xl px-4 py-2 text-right whitespace-pre-wrap",children:s})})})}var Q=s(85983),ee=s(37189),et=s(99780),es=s(98183),ea=s(88344);function er(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function en(e){return Array.isArray(e)||"object"==typeof e&&null!==e}function el(e){let t,{toolCall:s,index:l}=e,[o,i]=(0,r.useState)(!1);try{t=s.arguments?JSON.parse(s.arguments):{}}catch(e){t={raw:s.arguments}}let c=Object.keys(t).length>0;return(0,a.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-2",children:(0,a.jsx)("div",{className:"flex flex-wrap items-center justify-between gap-2 w-full",children:(0,a.jsxs)("h3",{className:"font-medium text-gray-900",children:[s.name,s.id&&(0,a.jsx)("code",{className:"ml-2 rounded bg-gray-100 px-2 py-1 text-sm",children:s.id}),"type"in s&&(0,a.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["Type: ",s.type]})]})})}),(0,a.jsx)(Q.N,{initial:!1,children:o&&(0,a.jsx)(n.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:c?(0,a.jsx)("table",{className:"min-w-full divide-y divide-gray-200",children:(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:Object.entries(t).map((e,t)=>{let[s,r]=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium whitespace-nowrap text-gray-900",children:s}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:en(r)?(0,a.jsx)("code",{className:"rounded bg-gray-50 px-2 py-1 font-mono text-sm break-all",children:JSON.stringify(r,null,2)}):String(r)})]},t)})})}):(0,a.jsx)("code",{className:"block p-3 text-sm",children:"{}"})})}),(0,a.jsx)(n.P.button,{onClick:()=>i(!o),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-gray-200 py-2 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:o?(0,a.jsx)(ee.A,{}):(0,a.jsx)(et.A,{})})]},s.id||l)}function eo(e){let t,{toolCall:s,index:l,itemBorder:o,itemText:c}=e,[d,m]=(0,r.useState)(!1);try{t=JSON.parse(s.arguments)}catch(e){t={raw:s.arguments}}let u="description"in s&&s.description;return(0,a.jsxs)("div",{className:i("bg-white rounded-md border overflow-hidden",o||""),children:[(0,a.jsx)("div",{className:"p-2 border-b border-gray-200 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:i("font-mono text-xs font-semibold",c||""),children:s.name}),s.id&&(0,a.jsx)("code",{className:"rounded bg-gray-100 px-1.5 py-0.5 text-xs",children:s.id})]}),"type"in s&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:s.type})]})}),u&&(0,a.jsx)("div",{className:"px-2 pt-1.5 text-xs text-gray-600 italic bg-white",children:s.description}),(0,a.jsx)(Q.N,{initial:!1,children:d&&(0,a.jsx)(n.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,a.jsx)("div",{className:"p-2 bg-white",children:(0,a.jsx)("pre",{className:"text-xs bg-gray-50 p-1.5 rounded overflow-x-auto",children:JSON.stringify(t,null,2)})})})}),(0,a.jsx)(n.P.button,{onClick:()=>m(!d),className:i("flex w-full cursor-pointer items-center justify-center border-t-[1px] py-1 text-gray-500 transition-all duration-200 ease-in-out hover:text-gray-600",o||"","hover:bg-gray-50"),initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:d?(0,a.jsx)(ee.A,{className:"size-3.5"}):(0,a.jsx)(et.A,{className:"size-3.5"})})]},s.id||l)}function ei(e){let{toolCalls:t,variant:s="default",title:r,description:n}=e;if(!t||0===t.length)return null;let l={default:{container:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",card:"overflow-hidden rounded-lg border border-gray-200",header:"border-b border-gray-200 bg-gray-50 px-4 py-2",headerText:"font-medium text-gray-900",useCard:!1},request:{container:"group flex flex-col gap-2",card:"p-2 bg-blue-50 border-blue-200",header:"flex items-center gap-1.5 text-blue-700 mb-2",headerText:"font-medium text-sm",icon:(0,a.jsx)(es.A,{className:"size-3.5"}),useCard:!0,itemBorder:"border-blue-200",itemText:"text-blue-700"},confirm:{container:"group flex flex-col gap-2",card:"p-4 bg-green-50 border-green-200",header:"flex items-center gap-2 text-green-700 mb-3",headerText:"font-medium",icon:(0,a.jsx)(ea.A,{className:"size-4"}),useCard:!0,itemBorder:"border-green-200",itemText:"text-green-700"}}[s];if("default"===s)return(0,a.jsx)("div",{className:l.container,children:t.map((e,t)=>(0,a.jsx)(el,{toolCall:e,index:t},e.id||t))});let o="itemBorder"in l?l.itemBorder:void 0,i="itemText"in l?l.itemText:void 0;return(0,a.jsx)("div",{className:l.container,children:(0,a.jsxs)(er,{className:l.card,children:[(r||"icon"in l&&l.icon)&&(0,a.jsxs)("div",{className:l.header,children:["icon"in l&&l.icon,(0,a.jsx)("span",{className:l.headerText,children:r||("request"===s?"Tool Request":"Tool Execution Confirmation")})]}),n&&(0,a.jsx)("p",{className:"mb-2 text-xs text-gray-700",children:n}),(0,a.jsx)("div",{className:"space-y-1.5",children:t.map((e,t)=>(0,a.jsx)(eo,{toolCall:e,index:t,itemBorder:o,itemText:i},e.id||t))})]})})}function ec(e){let t,{toolResponse:s}=e,[l,o]=(0,r.useState)(!1),i=!1;try{t=JSON.parse(s.responseData),i=en(t)}catch(e){t=s.responseData}return(0,a.jsx)("div",{className:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",children:(0,a.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-2",children:(0,a.jsx)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:(0,a.jsxs)("h3",{className:"font-medium text-gray-900",children:[s.name&&(0,a.jsxs)(a.Fragment,{children:["Tool Result:"," ",(0,a.jsx)("code",{className:"rounded bg-gray-100 px-2 py-1",children:s.name})]}),s.id&&(0,a.jsx)("code",{className:"ml-2 rounded bg-gray-100 px-2 py-1 text-sm",children:s.id})]})})}),(0,a.jsx)(Q.N,{initial:!1,children:l&&(0,a.jsx)(n.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,a.jsx)("div",{className:"bg-gray-100 p-3",children:i?(0,a.jsx)("table",{className:"min-w-full divide-y divide-gray-200",children:(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:(Array.isArray(t)?t:Object.entries(t)).map((e,s)=>{let[r,n]=Array.isArray(t)?[s,e]:[e[0],e[1]];return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium whitespace-nowrap text-gray-900",children:r}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:en(n)?(0,a.jsx)("code",{className:"rounded bg-gray-50 px-2 py-1 font-mono text-sm break-all",children:JSON.stringify(n,null,2)}):String(n)})]},s)})})}):(0,a.jsx)("code",{className:"block text-sm",children:String(s.responseData)})})})}),(0,a.jsx)(n.P.button,{onClick:()=>o(!l),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-gray-200 py-2 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:l?(0,a.jsx)(ee.A,{}):(0,a.jsx)(et.A,{})})]})})}function ed(e){let{message:t}=e;if(console.log("[ToolResponseMessage] Rendering:",{id:t.id,messageType:t.message.messageType,fullMessage:t}),"tool"!==t.message.messageType)return console.warn("[ToolResponseMessage] Not a tool response message:",t),null;let s=t.message.responses||[];return 0===s.length?(console.warn("[ToolResponseMessage] No responses found"),null):(0,a.jsx)("div",{className:"group flex flex-col gap-2",children:s.map((e,t)=>(0,a.jsx)(ec,{toolResponse:e},e.id||t))})}function em(e){let{message:t}=e;if(console.log("[ToolRequestMessage] Rendering:",{id:t.id,messageType:t.message.messageType,fullMessage:t}),"tool-request"!==t.message.messageType)return console.warn("[ToolRequestMessage] Not a tool request message:",t),null;let s=t.message.toolCalls||[];return 0===s.length?(console.warn("[ToolRequestMessage] No tool calls found"),null):(0,a.jsx)(ei,{toolCalls:s,variant:"request",title:"Tool Request",description:t.message.content})}var eu=s(805),eg=s(71891),ex=s(29195),eh=s(53704);function ep(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:i("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}function ef(e){let t,{toolCall:s,index:l}=e,[o,c]=(0,r.useState)(!1);try{t=JSON.parse(s.arguments)}catch(e){t={raw:s.arguments}}return(0,a.jsxs)("div",{className:i("rounded-md border overflow-hidden transition-all","border-green-300 bg-green-50"),children:[(0,a.jsx)("div",{className:"p-3 border-b border-green-200 bg-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eu.A,{className:"size-4 text-green-600"}),(0,a.jsx)("span",{className:"font-mono text-sm font-semibold text-gray-900",children:s.name}),s.id&&(0,a.jsx)("code",{className:"rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600",children:s.id})]}),(0,a.jsx)("span",{className:"text-xs font-medium px-2 py-1 rounded bg-green-100 text-green-700",children:"Auto-Approved"})]})}),(0,a.jsx)(Q.N,{initial:!1,children:o&&(0,a.jsx)(n.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,a.jsx)("div",{className:"p-3 bg-white",children:(0,a.jsx)("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-x-auto",children:JSON.stringify(t,null,2)})})})}),(0,a.jsx)(n.P.button,{onClick:()=>c(!o),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-green-200 py-1.5 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:o?(0,a.jsx)(ee.A,{className:"size-4"}):(0,a.jsx)(et.A,{className:"size-4"})})]})}function eb(e){let t,{feedback:s,onUpdate:l,disabled:o}=e,[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(s.arguments),[p,f]=(0,r.useState)(s.result);try{t=JSON.parse(g)}catch(e){t={raw:g}}let b={APPROVED:"border-green-300 bg-green-50",REJECTED:"border-red-300 bg-red-50",EDITED:"border-blue-300 bg-blue-50",default:o&&p?"border-gray-300 bg-gray-100":"border-yellow-300 bg-yellow-50"},y=p?b[p]:b.default,v=o&&p;return(0,a.jsxs)("div",{className:i("rounded-md border overflow-hidden transition-all",y,v&&"opacity-75"),children:[(0,a.jsxs)("div",{className:"p-3 border-b border-gray-200 bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-sm font-semibold text-gray-900",children:s.name}),s.id&&(0,a.jsx)("code",{className:"rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600",children:s.id})]}),p&&(0,a.jsxs)("span",{className:i("text-xs font-medium px-2 py-1 rounded","APPROVED"===p&&"bg-green-100 text-green-700","REJECTED"===p&&"bg-red-100 text-red-700","EDITED"===p&&"bg-blue-100 text-blue-700",v&&"ring-1 ring-gray-400"),children:[p,v&&" ✓"]})]}),s.description&&(0,a.jsx)("p",{className:"mt-1.5 text-xs text-gray-600 italic",children:s.description})]}),!o&&(0,a.jsx)("div",{className:"p-2 bg-white border-b border-gray-200 flex gap-2",children:p?(0,a.jsxs)("div",{className:"flex-1 flex items-center justify-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:["Feedback: ",(0,a.jsx)("span",{className:"font-medium",children:p})]}),(0,a.jsx)(A,{size:"sm",variant:"ghost",className:"text-xs text-gray-500 hover:text-gray-700",onClick:()=>{f(void 0),l(s.id,null,void 0),h(s.arguments),u(!1)},children:"Change"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(A,{size:"sm",variant:"outline",className:"flex-1 text-green-600 border-green-300 hover:bg-green-50",onClick:()=>{f("APPROVED"),l(s.id,"APPROVED"),x.oR.success('Tool "'.concat(s.name,'" approved'))},children:[(0,a.jsx)(ea.A,{className:"size-4 mr-1"}),"Approve"]}),(0,a.jsxs)(A,{size:"sm",variant:"outline",className:"flex-1 text-red-600 border-red-300 hover:bg-red-50",onClick:()=>{f("REJECTED"),l(s.id,"REJECTED"),x.oR.success('Tool "'.concat(s.name,'" rejected'))},children:[(0,a.jsx)(eg.A,{className:"size-4 mr-1"}),"Reject"]}),(0,a.jsxs)(A,{size:"sm",variant:"outline",className:"flex-1 text-blue-600 border-blue-300 hover:bg-blue-50",onClick:()=>{u(!0),d(!0)},children:[(0,a.jsx)(ex.A,{className:"size-4 mr-1"}),"Edit"]})]})}),(0,a.jsx)(Q.N,{initial:!1,children:c&&(0,a.jsx)(n.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,a.jsx)("div",{className:"p-3 bg-white",children:m?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Edit Arguments (JSON):"}),(0,a.jsx)(ep,{value:g,onChange:e=>h(e.target.value),className:"font-mono text-xs min-h-[120px]",placeholder:"Enter valid JSON"}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)(A,{size:"sm",variant:"outline",onClick:()=>{h(s.arguments),u(!1)},children:"Cancel"}),(0,a.jsxs)(A,{size:"sm",onClick:()=>{f("EDITED"),l(s.id,"EDITED",g),u(!1),x.oR.success('Tool "'.concat(s.name,'" arguments edited'))},className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(eh.A,{className:"size-3.5 mr-1"}),"Save Edit"]})]})]}):(0,a.jsx)("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-x-auto",children:JSON.stringify(t,null,2)})})})}),(0,a.jsx)(n.P.button,{onClick:()=>d(!c),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-gray-200 py-1.5 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:c?(0,a.jsx)(ee.A,{className:"size-4"}):(0,a.jsx)(et.A,{className:"size-4"})})]})}function ey(e){let{message:t}=e,s=N(),[l,o]=(0,r.useState)({}),[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1);if(console.log("[ToolFeedbackConfirm] Rendering:",{id:t.id,messageType:t.message.messageType,fullMessage:t,isSubmitted:m}),!y(t.message))return console.warn("[ToolFeedbackConfirm] Not a tool request confirm message:",t),null;let g=t.message.toolFeedback||[],h=t.message.toolsAutomaticallyApproved||[];if(0===g.length&&0===h.length)return console.warn("[ToolFeedbackConfirm] No tool feedback or auto-approved tools found"),null;g.length,h.length;let p=(e,t,s)=>{if(null===t)return void o(t=>{let s={...t};return delete s[e],s});o(a=>({...a,[e]:{result:t,editedArgs:s}}))},f=async()=>{if(m||c)return void x.oR.warning("Feedback has already been submitted");if(!g.every(e=>l[e.id]))return void x.oR.error("Please provide feedback for all tools");d(!0);try{let e=g.map(e=>{let t=l[e.id];return{id:e.id,name:e.name,arguments:"EDITED"===t.result&&t.editedArgs?t.editedArgs:e.arguments,result:t.result,description:e.description}});console.log("[ToolFeedbackConfirm] Submitting feedback:",e),await s.resumeFeedback(e),u(!0),d(!1),x.oR.success("Feedback submitted successfully")}catch(e){console.error("[ToolFeedbackConfirm] Failed to submit feedback:",e),x.oR.error(e.message||"Failed to submit feedback"),d(!1)}},b=g.every(e=>l[e.id]),v=Object.keys(l).length>0,j=g.filter(e=>!l[e.id]).length,w=g.length-j;return(0,a.jsx)("div",{className:"group flex flex-col gap-3",children:(0,a.jsxs)(er,{className:i("p-4 border-2",m?"bg-gray-50 border-gray-300":"bg-yellow-50 border-yellow-200"),children:[(0,a.jsxs)("div",{className:i("flex items-center justify-between mb-3",m?"text-gray-600":"text-yellow-700"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ea.A,{className:"size-5"}),(0,a.jsx)("span",{className:"font-medium",children:m?"Feedback Submitted - Processing...":"Tool Execution Confirmation Required"})]}),!m&&!c&&g.length>1&&(0,a.jsxs)("div",{className:"text-xs font-medium px-2 py-1 rounded bg-yellow-100 text-yellow-700",children:[w," / ",g.length," completed"]})]}),t.message.content&&(0,a.jsx)("p",{className:"mb-3 text-sm text-gray-700",children:t.message.content}),h.length>0&&(0,a.jsx)("div",{className:"mb-3 p-2 bg-blue-50 rounded border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-blue-800",children:[(0,a.jsx)(eu.A,{className:"size-3.5"}),(0,a.jsxs)("span",{children:[h.length," tool",h.length>1?"s":""," automatically approved",g.length>0&&", ".concat(g.length," tool").concat(g.length>1?"s":""," require").concat(g.length>1?"":"s"," confirmation")]})]})}),!m&&!c&&g.length>1&&(0,a.jsxs)("div",{className:"mb-3 p-2 bg-yellow-100 rounded border border-yellow-200",children:[(0,a.jsx)("p",{className:"text-xs text-yellow-800 mb-1",children:"Please provide feedback for each tool call below. All feedback will be submitted together when complete."}),j>0&&(0,a.jsxs)("p",{className:"text-xs text-yellow-700 italic",children:[j," tool call",j>1?"s":""," remaining"]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-3",children:[h.length>0&&(0,a.jsxs)(a.Fragment,{children:[h.map((e,t)=>(0,a.jsx)(ef,{toolCall:e,index:t},e.id||"auto-".concat(t))),g.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 my-2",children:[(0,a.jsx)("div",{className:"flex-1 border-t border-gray-300"}),(0,a.jsx)("span",{className:"text-xs text-gray-500 px-2",children:"Requires Confirmation"}),(0,a.jsx)("div",{className:"flex-1 border-t border-gray-300"})]})]}),g.map(e=>(0,a.jsx)(eb,{feedback:e,onUpdate:p,disabled:c||m},e.id))]}),g.length>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center pt-2 border-t border-yellow-200",children:[!m&&!c&&(0,a.jsx)("div",{className:"text-xs text-gray-600",children:b?(0,a.jsx)("span",{className:"text-green-600 font-medium",children:"✓ All tool calls have feedback"}):(0,a.jsxs)("span",{children:["Please provide feedback for all ",g.length," tool call",g.length>1?"s":""," before submitting"]})}),(0,a.jsx)(A,{onClick:f,disabled:!b||c||m,className:i("text-white",m?"bg-green-600 hover:bg-green-600 cursor-not-allowed":b?"bg-yellow-600 hover:bg-yellow-700":"bg-gray-400 cursor-not-allowed"),children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mr-2",children:(0,a.jsx)(eh.A,{className:"size-4"})}),"Submitting..."]}):m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea.A,{className:"size-4 mr-2"}),"Submitted"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh.A,{className:"size-4 mr-2"}),"Submit All Feedback"]})})]}),m&&(0,a.jsx)("div",{className:"flex justify-center pt-2 border-t border-gray-300",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)(n.P.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:(0,a.jsx)(ea.A,{className:"size-4 text-green-600"})}),(0,a.jsx)("span",{className:"font-medium",children:"Feedback submitted. Waiting for agent response..."})]})}),!v&&!m&&(0,a.jsx)("p",{className:"text-xs text-yellow-600 italic text-center",children:"Please review each tool and provide your feedback (Approve, Reject, or Edit)"})]})})}function ev(e){let{message:t}=e;if(console.log("[ToolRequestConfirmMessage] Rendering:",{id:t.id,messageType:t.message.messageType,fullMessage:t}),!y(t.message))return console.warn("[ToolRequestConfirmMessage] Not a tool request confirm message:",t),null;let s=t.message.toolFeedback||[],r=t.message.toolsAutomaticallyApproved||[];return 0===s.length&&0===r.length?(console.warn("[ToolRequestConfirmMessage] No tool feedback or auto-approved tools found"),null):(0,a.jsx)(ey,{message:t})}var ej=s(34790),ew=s(24202),eN=s(73270),ek=s(62238),eS=s(12198),eT=s(29934),eA=s(92215),eC=s(5872);function eE(e){let{...t}=e;return(0,a.jsx)(eC.bL,{"data-slot":"sheet",...t})}function eP(e){let{...t}=e;return(0,a.jsx)(eC.ZL,{"data-slot":"sheet-portal",...t})}function eR(e){let{className:t,...s}=e;return(0,a.jsx)(eC.hJ,{"data-slot":"sheet-overlay",className:i("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t),...s})}function e_(e){let{className:t,children:s,side:r="right",...n}=e;return(0,a.jsxs)(eP,{children:[(0,a.jsx)(eR,{}),(0,a.jsxs)(eC.UC,{"data-slot":"sheet-content",className:i("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===r&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===r&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===r&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===r&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...n,children:[s,(0,a.jsxs)(eC.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,a.jsx)(eS.A,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eD(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"sheet-header",className:i("flex flex-col gap-1.5 p-4",t),...s})}function eF(e){let{className:t,...s}=e;return(0,a.jsx)(eC.hE,{"data-slot":"sheet-title",className:i("text-foreground font-semibold",t),...s})}function ez(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"skeleton",className:i("bg-primary/10 animate-pulse rounded-md",t),...s})}function eL(e){let[t,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=window.matchMedia(e);s(t.matches);let a=e=>s(e.matches);return t.addEventListener("change",a),()=>t.removeEventListener("change",a)},[e]),t}function eI(e){let{threads:t,onThreadClick:s}=e,[r,n]=(0,eT.ZA)("threadId");return(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-start justify-start gap-2 overflow-y-scroll [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",children:t.map(e=>{var t,l;let o=e.thread_id;return"object"==typeof e.values&&e.values&&"messages"in e.values&&Array.isArray(e.values.messages)&&(null==(t=e.values.messages)?void 0:t.length)>0&&(o="string"==typeof(l=e.values.messages[0].content)?l:l.filter(e=>"text"===e.type).map(e=>e.text).join(" ")),(0,a.jsx)("div",{className:"w-full px-1",children:(0,a.jsx)(A,{variant:"ghost",className:"w-[280px] items-start justify-start text-left font-normal",onClick:t=>{t.preventDefault(),null==s||s(e.thread_id),e.thread_id!==r&&n(e.thread_id)},children:(0,a.jsx)("p",{className:"truncate text-ellipsis",children:o})})},e.thread_id)})})}function eU(){return(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-start justify-start gap-2 overflow-y-scroll [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",children:Array.from({length:30}).map((e,t)=>(0,a.jsx)(ez,{className:"h-10 w-[280px]"},"skeleton-".concat(t)))})}function eO(){let e=eL("(min-width: 1024px)"),[t,s]=(0,eT.ZA)("chatHistoryOpen",eT.cr.withDefault(!1)),[n]=(0,eT.ZA)("threadId"),{threads:l,isLoading:o,loadThreads:i}=f();return(0,r.useEffect)(()=>{(t||n)&&i()},[i,t,n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"shadow-inner-right hidden h-screen w-[300px] shrink-0 flex-col items-start justify-start gap-6 border-r-[1px] border-slate-300 lg:flex",children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between px-4 pt-1.5",children:[(0,a.jsx)(A,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>s(e=>!e),children:t?(0,a.jsx)(ew.A,{className:"size-5"}):(0,a.jsx)(eN.A,{className:"size-5"})}),(0,a.jsx)("h1",{className:"text-xl font-semibold tracking-tight",children:"Thread History"})]}),o?(0,a.jsx)(eU,{}):(0,a.jsx)(eI,{threads:l})]}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsx)(eE,{open:!!t&&!e,onOpenChange:t=>{e||s(t)},children:(0,a.jsxs)(e_,{side:"left",className:"flex lg:hidden",children:[(0,a.jsx)(eD,{children:(0,a.jsx)(eF,{children:"Thread History"})}),(0,a.jsx)(eI,{threads:l,onThreadClick:()=>s(e=>!e)})]})})})]})}var eq=s(81545);function eM(e){let{className:t,...s}=e;return(0,a.jsx)(eq.bL,{"data-slot":"switch",className:i("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 inline-flex h-5 w-9 shrink-0 items-center rounded-full border-2 border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,a.jsx)(eq.zi,{"data-slot":"switch-thumb",className:i("bg-background pointer-events-none block size-4 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})}let eB=e=>{let{width:t="100%",height:s="100%"}=e;return(0,a.jsxs)("svg",{role:"img",viewBox:"0 0 24 24",width:t,height:s,xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("title",{children:"GitHub"}),(0,a.jsx)("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})]})};async function eJ(e){let t=["image/jpeg","image/png","image/gif","image/webp"],s=[...t,"application/pdf"];if(!s.includes(e.type))return x.oR.error("Unsupported file type: ".concat(e.type,". Supported types are: ").concat(s.join(", "))),Promise.reject(Error("Unsupported file type: ".concat(e.type)));let a=await eH(e);return t.includes(e.type)?{type:"image",source_type:"base64",mime_type:e.type,data:a,metadata:{name:e.name}}:{type:"file",source_type:"base64",mime_type:"application/pdf",data:a,metadata:{filename:e.name}}}async function eH(e){return new Promise((t,s)=>{let a=new FileReader;a.onloadend=()=>{t(a.result.split(",")[1])},a.onerror=s,a.readAsDataURL(e)})}let eG=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];var eW=s(98704),eX=s(56454);let eZ=e=>{var t,s,r;let{block:n,removable:l=!1,onRemove:o,className:c,size:d="md"}=e;if("image"===n.type&&"base64"===n.source_type&&"string"==typeof n.mime_type&&n.mime_type.startsWith("image/")){let e="data:".concat(n.mime_type,";base64,").concat(n.data),s="rounded-md object-cover h-16 w-16 text-lg";return"sm"===d&&(s="rounded-md object-cover h-10 w-10 text-base"),"lg"===d&&(s="rounded-md object-cover h-24 w-24 text-xl"),(0,a.jsxs)("div",{className:i("relative inline-block",c),children:[(0,a.jsx)(eX.default,{src:e,alt:String((null==(t=n.metadata)?void 0:t.name)||"uploaded image"),className:s,width:"sm"===d?16:"md"===d?32:48,height:"sm"===d?16:"md"===d?32:48}),l&&(0,a.jsx)("button",{type:"button",className:"absolute top-1 right-1 z-10 rounded-full bg-gray-500 text-white hover:bg-gray-700",onClick:o,"aria-label":"Remove image",children:(0,a.jsx)(eS.A,{className:"h-4 w-4"})})]})}if("file"===n.type&&"base64"===n.source_type&&"application/pdf"===n.mime_type){let e=(null==(s=n.metadata)?void 0:s.filename)||(null==(r=n.metadata)?void 0:r.name)||"PDF file";return(0,a.jsxs)("div",{className:i("relative flex items-start gap-2 rounded-md border bg-gray-100 px-3 py-2",c),children:[(0,a.jsx)("div",{className:"flex flex-shrink-0 flex-col items-start justify-start",children:(0,a.jsx)(eW.A,{className:i("text-teal-700","sm"===d?"h-5 w-5":"h-7 w-7")})}),(0,a.jsx)("span",{className:i("min-w-0 flex-1 text-sm break-all text-gray-800"),style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:String(e)}),l&&(0,a.jsx)("button",{type:"button",className:"ml-2 self-start rounded-full bg-gray-200 p-1 text-teal-700 hover:bg-gray-300",onClick:o,"aria-label":"Remove PDF",children:(0,a.jsx)(eS.A,{className:"h-4 w-4"})})]})}return(0,a.jsxs)("div",{className:i("flex items-center gap-2 rounded-md border bg-gray-100 px-3 py-2 text-gray-500",c),children:[(0,a.jsx)(eW.A,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"Unsupported file type"}),l&&(0,a.jsx)("button",{type:"button",className:"ml-2 rounded-full bg-gray-200 p-1 text-gray-500 hover:bg-gray-300",onClick:o,"aria-label":"Remove file",children:(0,a.jsx)(eS.A,{className:"h-4 w-4"})})]})},eV=e=>{let{blocks:t,onRemove:s,size:r="md",className:n}=e;return t.length?(0,a.jsx)("div",{className:i("flex flex-wrap gap-2 p-3.5 pb-0",n),children:t.map((e,t)=>(0,a.jsx)(eZ,{block:e,removable:!0,onRemove:()=>s(t),size:r},t))}):null};s(43692);let eK=(0,r.createContext)(null);function eY(e){let t=(0,r.useContext)(eK),[s]=t.mounted,n=(0,r.useRef)(null),[,l]=t.content;return((0,r.useLayoutEffect)(()=>null==l?void 0:l(s?n.current:null),[l,s]),s)?(0,a.jsx)("div",{...e,ref:n}):null}function e$(e){let t=(0,r.useContext)(eK),s=(0,r.useRef)(null),[,n]=t.title;return(0,r.useLayoutEffect)(()=>null==n?void 0:n(s.current),[n]),(0,a.jsx)("div",{...e,ref:s})}function eQ(e){let t=(0,r.useState)(null),s=(0,r.useState)(null),n=(0,r.useState)(null),l=(0,r.useState)(null),o=(0,r.useState)({});return(0,a.jsx)(eK.Provider,{value:{open:n,mounted:l,title:s,content:t,context:o},children:e.children})}function e0(e){let t=(0,eA.B)();return(0,a.jsxs)("div",{ref:t.scrollRef,style:{width:"100%",height:"100%"},className:e.className,children:[(0,a.jsx)("div",{ref:t.contentRef,className:e.contentClassName,children:e.content}),e.footer]})}function e1(e){let{isAtBottom:t,scrollToBottom:s}=(0,eA.B)();return t?null:(0,a.jsxs)(A,{variant:"outline",className:e.className,onClick:()=>s(),children:[(0,a.jsx)(ej.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Scroll to bottom"})]})}function e2(){return(0,a.jsx)(q,{children:(0,a.jsxs)(M,{children:[(0,a.jsx)(B,{asChild:!0,children:(0,a.jsx)("a",{href:"https://github.com/alibaba/spring-ai-alibaba/",target:"_blank",className:"flex items-center justify-center",children:(0,a.jsx)(eB,{width:"24",height:"24"})})}),(0,a.jsx)(J,{side:"left",children:(0,a.jsx)("p",{children:"Open GitHub repo"})})]})})}function e5(){var e;let[t,s]=(0,r.useContext)(eK).context,[l,o]=function(){let[e,t]=(0,r.useContext)(eK).open;return[null!==e,(0,r.useCallback)(()=>t(null),[t])]}(),[c,m]=(0,eT.ZA)("threadId"),[u,g]=(0,eT.ZA)("chatHistoryOpen",eT.cr.withDefault(!1)),[h,p]=(0,eT.ZA)("hideToolCalls",eT.cr.withDefault(!1)),[b,y]=(0,r.useState)(""),{contentBlocks:v,setContentBlocks:j,handleFileUpload:w,dropRef:k,removeBlock:S,resetBlocks:T,dragOver:C,handlePaste:E}=function(){let{initialBlocks:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,r.useState)(e),a=(0,r.useRef)(null),[n,l]=(0,r.useState)(!1),o=(0,r.useRef)(0),i=(e,t)=>"application/pdf"===e.type?t.some(t=>{var s;return"file"===t.type&&"application/pdf"===t.mime_type&&(null==(s=t.metadata)?void 0:s.filename)===e.name}):!!eG.includes(e.type)&&t.some(t=>{var s;return"image"===t.type&&(null==(s=t.metadata)?void 0:s.name)===e.name&&t.mime_type===e.type}),c=async e=>{let a=e.target.files;if(!a)return;let r=Array.from(a),n=r.filter(e=>eG.includes(e.type)),l=r.filter(e=>!eG.includes(e.type)),o=n.filter(e=>i(e,t)),c=n.filter(e=>!i(e,t));l.length>0&&x.oR.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),o.length>0&&x.oR.error("Duplicate file(s) detected: ".concat(o.map(e=>e.name).join(", "),". Each file can only be uploaded once per message."));let d=c.length?await Promise.all(c.map(eJ)):[];s(e=>[...e,...d]),e.target.value=""};(0,r.useEffect)(()=>{if(!a.current)return;let e=e=>{var t,s;(null==(s=e.dataTransfer)||null==(t=s.types)?void 0:t.includes("Files"))&&(o.current+=1,l(!0))},r=e=>{var t,s;(null==(s=e.dataTransfer)||null==(t=s.types)?void 0:t.includes("Files"))&&(o.current-=1,o.current<=0&&(l(!1),o.current=0))},n=async e=>{if(e.preventDefault(),e.stopPropagation(),o.current=0,l(!1),!e.dataTransfer)return;let a=Array.from(e.dataTransfer.files),r=a.filter(e=>eG.includes(e.type)),n=a.filter(e=>!eG.includes(e.type)),c=r.filter(e=>i(e,t)),d=r.filter(e=>!i(e,t));n.length>0&&x.oR.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),c.length>0&&x.oR.error("Duplicate file(s) detected: ".concat(c.map(e=>e.name).join(", "),". Each file can only be uploaded once per message."));let m=d.length?await Promise.all(d.map(eJ)):[];s(e=>[...e,...m])},c=e=>{o.current=0,l(!1)};window.addEventListener("dragenter",e),window.addEventListener("dragleave",r),window.addEventListener("drop",n),window.addEventListener("dragend",c);let d=e=>{e.preventDefault(),e.stopPropagation()};window.addEventListener("dragover",d);let m=e=>{e.preventDefault(),e.stopPropagation(),l(!0)},u=e=>{e.preventDefault(),e.stopPropagation(),l(!0)},g=e=>{e.preventDefault(),e.stopPropagation(),l(!1)},h=a.current;return h.addEventListener("dragover",m),h.addEventListener("dragenter",u),h.addEventListener("dragleave",g),()=>{h.removeEventListener("dragover",m),h.removeEventListener("dragenter",u),h.removeEventListener("dragleave",g),window.removeEventListener("dragenter",e),window.removeEventListener("dragleave",r),window.removeEventListener("drop",n),window.removeEventListener("dragend",c),window.removeEventListener("dragover",d),o.current=0}},[t]);let d=async e=>{let a=e.clipboardData.items;if(!a)return;let r=[];for(let e=0;e<a.length;e+=1){let t=a[e];if("file"===t.kind){let e=t.getAsFile();e&&r.push(e)}}if(0===r.length)return;e.preventDefault();let n=r.filter(e=>eG.includes(e.type)),l=r.filter(e=>!eG.includes(e.type)),o=e=>"application/pdf"===e.type?t.some(t=>{var s;return"file"===t.type&&"application/pdf"===t.mime_type&&(null==(s=t.metadata)?void 0:s.filename)===e.name}):!!eG.includes(e.type)&&t.some(t=>{var s;return"image"===t.type&&(null==(s=t.metadata)?void 0:s.name)===e.name&&t.mime_type===e.type}),i=n.filter(o),c=n.filter(e=>!o(e));if(l.length>0&&x.oR.error("You have pasted an invalid file type. Please paste a JPEG, PNG, GIF, WEBP image or a PDF."),i.length>0&&x.oR.error("Duplicate file(s) detected: ".concat(i.map(e=>e.name).join(", "),". Each file can only be uploaded once per message.")),c.length>0){let e=await Promise.all(c.map(eJ));s(t=>[...t,...e])}};return{contentBlocks:t,setContentBlocks:s,handleFileUpload:c,dropRef:a,removeBlock:e=>{s(t=>t.filter((t,s)=>s!==e))},resetBlocks:()=>s([]),dragOver:n,handlePaste:d}}(),[P,R]=(0,r.useState)(!1),_=eL("(min-width: 1024px)"),D=N(),F=D.messages,z=D.isStreaming,{setCurrentThreadId:L}=f();(0,r.useEffect)(()=>{L(c)},[c,L]),(0,r.useEffect)(()=>{console.log("[Thread] Messages updated:",F.length,F),F.forEach((e,t)=>{var s;console.log("[Thread] Message ".concat(t,":"),{id:e.id,type:e.message.messageType,content:null==(s=e.message.content)?void 0:s.substring(0,50),fullMessage:e})})},[F]),(0,r.useRef)(void 0);let I=e=>{m(e),L(e),o(),s({})},U=(0,r.useRef)(0);(0,r.useEffect)(()=>{F.length!==U.current&&(null==F?void 0:F.length)&&"assistant"===F[F.length-1].message.messageType&&R(!0),U.current=F.length},[F]);let O=async e=>{if(e.preventDefault(),0===b.trim().length&&0===v.length||z)return;R(!1);let t=b.trim();if(v.length>0){let e=v.filter(e=>"text"===e.type).map(e=>e.text).join("\n");t=t?"".concat(t,"\n").concat(e):e}t&&(await D.sendMessage(t),y(""),j([]))},q=!!c||!!F.length,M=1===F.length&&(null==(e=F[0].message.metadata)?void 0:e.isPlaceholder)===!0;return(0,a.jsxs)("div",{className:"flex h-screen w-full overflow-hidden",children:[(0,a.jsx)("div",{className:"relative hidden lg:flex",children:(0,a.jsx)(n.P.div,{className:"absolute z-20 h-full overflow-hidden border-r bg-white",style:{width:300},animate:{x:u?0:-300},initial:{x:-300},transition:_?{type:"spring",stiffness:300,damping:30}:{duration:0},children:(0,a.jsx)("div",{className:"relative h-full",style:{width:300},children:(0,a.jsx)(eO,{})})})}),(0,a.jsxs)("div",{className:i("grid w-full grid-cols-[1fr_0fr] transition-all duration-500",l&&"grid-cols-[3fr_2fr]"),children:[(0,a.jsxs)(n.P.div,{className:i("relative flex min-w-0 flex-1 flex-col overflow-hidden",!q&&"grid-rows-[1fr]"),layout:_,animate:{marginLeft:u?300*!!_:0,width:u&&_?"calc(100% - 300px)":"100%"},transition:_?{type:"spring",stiffness:300,damping:30}:{duration:0},children:[!q&&(0,a.jsxs)("div",{className:"absolute top-0 left-0 z-10 flex w-full items-center justify-between gap-3 p-2 pl-4",children:[(0,a.jsx)("div",{children:(!u||!_)&&(0,a.jsx)(A,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>g(e=>!e),children:u?(0,a.jsx)(ew.A,{className:"size-5"}):(0,a.jsx)(eN.A,{className:"size-5"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-4 flex items-center",children:(0,a.jsx)(e2,{})})]}),q&&(0,a.jsxs)("div",{className:"relative z-10 flex items-center justify-between gap-3 p-2",children:[(0,a.jsxs)("div",{className:"relative flex items-center justify-start gap-2",children:[(0,a.jsx)("div",{className:"absolute left-0 z-10",children:(!u||!_)&&(0,a.jsx)(A,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>g(e=>!e),children:u?(0,a.jsx)(ew.A,{className:"size-5"}):(0,a.jsx)(eN.A,{className:"size-5"})})}),(0,a.jsx)(n.P.button,{className:"flex cursor-pointer items-center gap-2",onClick:()=>I(null),animate:{marginLeft:48*!u},transition:{type:"spring",stiffness:300,damping:30},children:(0,a.jsxs)("span",{className:"text-xl font-semibold tracking-tight",children:[(0,a.jsx)("span",{className:"text-green-600",children:"Spring AI Alibaba"})," Agent Chat"]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(e2,{})}),(0,a.jsx)(H,{size:"lg",className:"p-4",tooltip:"New thread",variant:"ghost",onClick:()=>{I(null)},children:(0,a.jsx)(ek.A,{className:"size-5"})})]}),(0,a.jsx)("div",{className:"from-background to-background/0 absolute inset-x-0 top-full h-5 bg-gradient-to-b"})]}),(0,a.jsx)(eA.z,{className:"relative flex-1 overflow-hidden",children:(0,a.jsx)(e0,{className:i("absolute inset-0 overflow-y-scroll px-4 [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",!q&&"mt-[25vh] flex flex-col items-stretch",q&&"grid grid-rows-[1fr_auto]"),contentClassName:"pt-8 pb-16  max-w-3xl mx-auto flex flex-col gap-4 w-full",content:(0,a.jsxs)(a.Fragment,{children:[(()=>{let e=F.filter(e=>{var t;return!(null==(t=e.id)?void 0:t.startsWith("do-not-render-"))});return console.log("[Thread] Rendering messages:",{total:F.length,filtered:e.length,messages:e.map(e=>({id:e.id,type:e.message.messageType}))}),e.map((e,t)=>{console.log("[Thread] Rendering message:",e.message.messageType,e);let s=e.message.messageType,r=e.id||"".concat(s,"-").concat(t);if(h&&("tool-request"===s||"tool-confirm"===s||"tool"===s))return console.log("[Thread] Hiding tool message due to hideToolCalls:",s),null;switch(s){case"user":return(0,a.jsx)($,{message:e},r);case"assistant":return(0,a.jsx)(K,{message:e},r);case"tool-request":return(0,a.jsx)(em,{message:e},r);case"tool-confirm":return(0,a.jsx)(ev,{message:e},r);case"tool":return(0,a.jsx)(ed,{message:e},r);default:return console.log("[Thread] Unknown message type:",s),null}})})(),z&&!P&&(0,a.jsx)(Y,{})]}),footer:(0,a.jsxs)("div",{className:"sticky bottom-0 flex flex-col items-center gap-8 bg-white",children:[!q&&(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("h1",{className:"text-2xl font-semibold tracking-tight",children:[(0,a.jsx)("span",{className:"text-green-600 italic",children:"Spring AI Alibaba"})," Agent Chat"]})}),(0,a.jsx)(e1,{className:"animate-in fade-in-0 zoom-in-95 absolute bottom-full left-1/2 mb-4 -translate-x-1/2"}),(0,a.jsx)("div",{ref:k,className:i("bg-muted relative z-10 mx-auto mb-8 w-full max-w-3xl rounded-2xl shadow-xs transition-all",C?"border-primary border-2 border-dotted":"border border-solid"),children:(0,a.jsxs)("form",{onSubmit:O,className:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",children:[(0,a.jsx)(eV,{blocks:v,onRemove:S}),(0,a.jsx)("textarea",{value:b,onChange:e=>y(e.target.value),onPaste:E,onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey&&!e.metaKey&&!e.nativeEvent.isComposing){e.preventDefault();let t=e.target,s=null==t?void 0:t.closest("form");null==s||s.requestSubmit()}},placeholder:M?"Please create a new thread to start chatting...":"Type your message...",disabled:M,className:i("field-sizing-content resize-none border-none bg-transparent p-3.5 pb-0 shadow-none ring-0 outline-none focus:ring-0 focus:outline-none",M&&"opacity-50 cursor-not-allowed")}),(0,a.jsxs)("div",{className:"flex items-center gap-6 p-2 pt-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eM,{id:"render-tool-calls",checked:null!=h&&h,onCheckedChange:p}),(0,a.jsx)(d,{htmlFor:"render-tool-calls",className:"text-sm text-gray-600",children:"Hide Tool Calls"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 opacity-50 cursor-not-allowed",children:[(0,a.jsx)(ek.A,{className:"size-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Upload PDF or Image"}),(0,a.jsx)("span",{className:"text-xs text-gray-400 italic",children:"(Coming Soon)"})]}),(0,a.jsx)(A,{type:"submit",className:"ml-auto shadow-md transition-all",disabled:z||!b.trim()&&0===v.length,children:"Send"})]})]})})]})})})]}),(0,a.jsx)("div",{className:"relative flex flex-col border-l",children:(0,a.jsxs)("div",{className:"absolute inset-0 flex min-w-[30vw] flex-col",children:[(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_auto] border-b p-4",children:[(0,a.jsx)(e$,{className:"truncate overflow-hidden"}),(0,a.jsx)("button",{onClick:o,className:"cursor-pointer",children:(0,a.jsx)(eS.A,{className:"size-5"})})]}),(0,a.jsx)(eY,{className:"relative flex-grow"})]})})]})]})}var e3=s(35151);let e4=e=>{let{...t}=e,{theme:s="system"}=(0,e3.D)();return(0,a.jsx)(x.l$,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...t})};function e6(){return(0,a.jsxs)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading (layout)..."}),children:[(0,a.jsx)(e4,{}),(0,a.jsx)(b,{children:(0,a.jsx)(k,{children:(0,a.jsx)(eQ,{children:(0,a.jsx)(e5,{})})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8160,8447,146,2982,9670,7358],()=>t(26126)),_N_E=e.O()}]);