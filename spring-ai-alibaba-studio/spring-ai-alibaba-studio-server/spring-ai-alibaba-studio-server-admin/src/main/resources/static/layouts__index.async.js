"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[1717],{61738:function(R,P,e){e.d(P,{Z:function(){return g}});var h=e(99604),s=e(44433),M=e(32963),u=e(52322);function g(p){var l=(0,h.sA)().isDarkMode;return(0,u.jsxs)("div",{className:M.Z.header,children:[(0,u.jsx)("img",{className:M.Z["header-logo"],onClick:function(){return s.m8.push("/")},src:l?"/images/logoBlack.png":"/images/logoWhite.png"}),p.children,(0,u.jsx)("div",{className:M.Z["header-right"],children:p.right})]})}},36133:function(R,P,e){e.d(P,{Z:function(){return b}});var h=e(22453),s=e(45753),M=e(78308),u=e(90257),g=e(3636),p=e(5693),l=e(52322),j=[{key:"en",label:(0,l.jsxs)("div",{className:"flex items-center gap-[4px]",children:[(0,l.jsx)(s.Z,{type:"spark-english02-line"})," English"]})},{key:"zh",label:(0,l.jsxs)("div",{className:"flex items-center gap-[4px]",children:[(0,l.jsx)(s.Z,{type:"spark-chinese02-line"})," \u7B80\u4F53\u4E2D\u6587"]})}];function b(){var c=h.Z.getCurrentLanguage(),E={zh:"spark-chinese02-line",en:"spark-english02-line",ja:"spark-japan-line"}[c];(0,p.Z)(function(){(0,g.Wz)(c)});var v=(0,l.jsx)(M.Z,{bordered:!1,icon:E,shape:"default"});return(0,l.jsx)(u.Z,{menu:{items:j,onClick:function(O){h.Z.setCurrentLanguage(O.key),(0,g.Wz)(O.key),location.reload()}},trigger:["click"],children:v})}},84013:function(R,P,e){e.r(P),e.d(P,{default:function(){return ue}});var h=e(12323),s=e.n(h),M=e(63260),u=e.n(M),g=e(13311),p=e.n(g),l=e(42035),j=e.n(l),b=e(2835),c=e(11082),E=e(12870),v=e(2784),r=e(22453),O={admin:r.Z.get({id:"main.types.account.administrator",dm:"\u7BA1\u7406\u5458"}),user:r.Z.get({id:"main.types.account.normalUser",dm:"\u666E\u901A\u7528\u6237"})},m=e(58541),y=e(84546),k=e(72624),U=e(92748),d=e(4513),_=e(91030),i={modal:"modal___TciC6","user-info-header":"user-info-header___s0lc_","user-info-details":"user-info-details___glMHb","user-name":"user-name___acbC7","section-title":"section-title___aj1w8"},n=e(52322),a=function(A){var D=A.open,L=A.onCancel,W=A.onOk,C=A.userInfo,B=m.Z.useForm(),N=j()(B,1),w=N[0];(0,v.useEffect)(function(){D&&C&&w.setFieldsValue({currentPassword:"",newPassword:"",confirmPassword:""})},[D,C,w]);var X=function(){w.validateFields().then(function(G){W(G)})};return C?(0,n.jsxs)(y.Z,{title:r.Z.get({id:"main.components.AccountModal.index.accountManagement",dm:"\u8D26\u53F7\u7BA1\u7406"}),open:D,onCancel:L,footer:[(0,n.jsx)(k.Z,{onClick:L,children:r.Z.get({id:"main.pages.Setting.ModelService.components.ProviderInfoForm.index.cancel",dm:"\u53D6\u6D88"})},"cancel"),(0,n.jsx)(k.Z,{type:"primary",onClick:X,children:r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.confirm",dm:"\u786E\u5B9A"})},"submit")],width:520,children:[(0,n.jsxs)("div",{className:i["user-info-header"],children:[(0,n.jsx)(E.Z,{size:40,children:C.username.charAt(0).toUpperCase()}),(0,n.jsxs)("div",{className:i["user-info-details"],children:[(0,n.jsxs)(_.Z,{align:"center",gap:24,children:[(0,n.jsx)("div",{className:i["user-name"],children:C.username}),(0,n.jsx)(k.Z,{size:"small",iconType:"spark-escape-line",onClick:function(){(0,c.bg)()},children:r.Z.get({id:"main.components.AccountModal.index.logout",dm:"\u9000\u51FA\u767B\u5F55"})})]}),(0,n.jsx)(U.Z,{color:C.type==="admin"?"purple":"mauve",children:O[C.type]})]})]}),(0,n.jsxs)(m.Z,{form:w,requiredMark:!1,colon:!1,labelCol:r.Z.getCurrentLanguage()==="cn"?{span:4}:void 0,labelAlign:"right",children:[(0,n.jsx)("div",{className:i["section-title"],children:r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.changePassword",dm:"\u66F4\u6539\u5BC6\u7801"})}),(0,n.jsx)(m.Z.Item,{name:"currentPassword",label:r.Z.get({id:"main.components.AccountModal.index.currentPassword",dm:"\u5F53\u524D\u5BC6\u7801"}),rules:[{required:!0,message:r.Z.get({id:"main.components.AccountModal.index.enterCurrentPassword",dm:"\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801"})}],children:(0,n.jsx)(d.Z.Password,{placeholder:r.Z.get({id:"main.components.AccountModal.index.inputCurrentPassword",dm:"\u8F93\u5165\u5F53\u524D\u5BC6\u7801"})})}),(0,n.jsx)(m.Z.Item,{name:"newPassword",label:r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.newPassword",dm:"\u65B0\u5BC6\u7801"}),children:(0,n.jsx)(d.Z.Password,{placeholder:r.Z.get({id:"main.components.AccountModal.index.inputNewPassword",dm:"\u8F93\u5165\u65B0\u7684\u5BC6\u7801"})})}),(0,n.jsx)(m.Z.Item,{name:"confirmPassword",label:r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.newPassword",dm:"\u65B0\u5BC6\u7801"}),dependencies:["newPassword"],rules:[function($){var G=$.getFieldValue;return{validator:function(Y,F){var Q=G("newPassword");return Q&&Q!==F?Promise.reject(new Error(r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.passwordNotMatch",dm:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"}))):Promise.resolve()}}}],children:(0,n.jsx)(d.Z.Password,{placeholder:r.Z.get({id:"main.pages.Setting.Account.components.UserEditModal.index.confirmNewPassword",dm:"\u786E\u8BA4\u65B0\u5BC6\u7801"})})})]})]}):null},o=a,Z=function(A){var D,L=A.trigger,W=A.avatarProps,C=(0,v.useState)(!1),B=j()(C,2),N=B[0],w=B[1],X=window.g_config.user,$=(0,n.jsx)(E.Z,p()(p()({size:32,onClick:function(){return w(!0)}},W),{},{children:(D=window.g_config.user)===null||D===void 0?void 0:D.username.charAt(0).toUpperCase()})),G=function(){var H=u()(s()().mark(function Y(F){return s()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,b.Cp)({password:F.currentPassword,new_password:F.newPassword});case 2:w(!1),(0,c.bg)();case 4:case"end":return V.stop()}},Y)}));return function(F){return H.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[L||$,(0,n.jsx)(o,{open:N,onCancel:function(){return w(!1)},onOk:G,userInfo:X})]})},f=Z,x=e(44433),z=e(61738),T=e(32963),q=e(36133),I=e(65741),K=e(74465);function J(S){var A=(0,I.Z)(b.fn,{onSuccess:function(W){window.g_config.user=W.data},onError:function(){new URL(window.location.href).searchParams.get("ignore-login")||x.m8.replace("/login")}}),D=A.loading;return D?(0,n.jsx)("div",{className:"loading-center",children:(0,n.jsx)(K.Z,{})}):S.children}var ee=[{to:"app",title:r.Z.get({id:"main.layouts.MenuList.application",dm:"\u5E94\u7528"})},{to:"mcp",title:"MCP"},{to:"component",title:r.Z.get({id:"main.pages.Component.AppComponent.index.component",dm:"\u7EC4\u4EF6"})},{to:"knowledge",title:r.Z.get({id:"main.pages.Knowledge.Test.index.knowledgeBase",dm:"\u77E5\u8BC6\u5E93"})}];function t(){return(0,n.jsx)("div",{className:T.Z["menu-list"],children:ee.map(function(S,A){return(0,n.jsx)(x.OL,{className:T.Z["menu-item"],to:S.to,children:S.title},A)})})}var ne=e(97948),ae=e(78308),re=e(90257),se=[{key:"/setting/account",label:r.Z.get({id:"main.layouts.SettingDropdown.accountManagement",dm:"\u8D26\u53F7\u7BA1\u7406"})},{key:"/setting/modelService",label:r.Z.get({id:"main.pages.Setting.ModelService.index.modelServiceManagement",dm:"\u6A21\u578B\u670D\u52A1\u7BA1\u7406"})},{key:"/setting/apiKeys",label:r.Z.get({id:"main.layouts.SettingDropdown.apiKeyManagement",dm:"API KEY\u7BA1\u7406"})}],te=function(){var A,D=(0,x.s0)(),L=((A=window.g_config.user)===null||A===void 0?void 0:A.type)==="admin",W=function(w){D(w.key)},C=function(){D("/setting/modelService")},B=(0,n.jsx)(ae.Z,{icon:"spark-setting-line",bordered:!1,shape:"default",onClick:L?void 0:C});return L?(0,n.jsx)(re.Z,{menu:{items:se,onClick:W},trigger:["click"],children:B}):B},ie=te,oe=e(9072);function ue(){return(0,n.jsx)(ne.Z,{children:(0,n.jsxs)(J,{children:[(0,n.jsx)(z.Z,{right:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(oe.Z,{}),(0,n.jsx)(q.Z,{}),(0,n.jsx)(ie,{}),(0,n.jsx)(f,{avatarProps:{className:T.Z.avatar}})]}),children:(0,n.jsx)(t,{})}),(0,n.jsx)("div",{className:T.Z.body,children:(0,n.jsx)(x.j3,{})})]})})}},46639:function(R,P,e){e.d(P,{W:function(){return h.ZP}});var h=e(85545)},85545:function(R,P,e){e.d(P,{v2:function(){return m},ZP:function(){return _},nP:function(){return v.n}});var h=e(13311),s=e.n(h),M=e(12323),u=e.n(M),g=e(63260),p=e.n(g),l=e(22453),j=e(18900),b=e(18561),c=e(21749),E={error:"error___zGtyb"},v=e(87645),r=e(52322),O="",m={set:function(a){O=a},get:function(){return O}};m.set("http://127.0.0.1:8080");var y=c.Z.create({baseURL:m.get(),timeout:60*1e3,headers:{}});function k(){return U.apply(this,arguments)}function U(){return U=p()(u()().mark(function n(){var a,o;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return a={"Accept-Language":l.Z.getCurrentLanguage()},f.next=3,v.n.asyncGet();case 3:return o=f.sent,o&&(a.Authorization="Bearer "+o),f.abrupt("return",a);case 6:case"end":return f.stop()}},n)})),U.apply(this,arguments)}function d(n){var a,o,Z;j.ZP.error({className:E.error,message:((a=n.response)===null||a===void 0||(a=a.data)===null||a===void 0?void 0:a.code)||n.message,description:(0,r.jsxs)(b.Z,{direction:"vertical",children:[(0,r.jsx)("div",{children:(o=n.response)===null||o===void 0||(o=o.data)===null||o===void 0?void 0:o.message}),(0,r.jsx)("div",{children:(Z=n.response)===null||Z===void 0||(Z=Z.data)===null||Z===void 0?void 0:Z.request_id})]})})}function _(n){return i.apply(this,arguments)}function i(){return i=p()(u()().mark(function n(a){var o,Z,f,x,z,T;return u()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return T=function(){return T=p()(u()().mark(function J(){return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=y,t.t1=s(),t.t2=s()({},a),t.t3={},t.t4=s(),t.t5=s()({},Z),t.next=8,k();case 8:return t.t6=t.sent,t.t7=(0,t.t4)(t.t5,t.t6),t.t8={headers:t.t7},t.t9=(0,t.t1)(t.t2,t.t3,t.t8),t.abrupt("return",t.t0.request.call(t.t0,t.t9));case 13:case"end":return t.stop()}},J)})),T.apply(this,arguments)},z=function(){return T.apply(this,arguments)},o=a.headers,Z=o===void 0?{}:o,f=a.autoMsg,x=f===void 0?!0:f,I.next=5,z().catch(function(K){throw x&&d(K),K});case 5:return I.abrupt("return",I.sent);case 6:case"end":return I.stop()}},n)})),i.apply(this,arguments)}},87645:function(R,P,e){e.d(P,{n:function(){return j}});var h=e(12323),s=e.n(h),M=e(63260),u=e.n(M),g=e(21749),p=e(85545),l="data-prefers-session",j={set:function(c){var E=c.access_token,v=c.expires_in,r=c.refresh_token,O={access_token:E,refresh_token:r,expires_time:v*1e3};localStorage.setItem(l,JSON.stringify(O))},clear:function(){localStorage.removeItem(l)},get:function(){var c=localStorage.getItem(l);if(!c)return"";if(c){var E=JSON.parse(c);return E.access_token}},asyncGet:function(){return u()(s()().mark(function c(){var E,v,r;return s()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(E=localStorage.getItem(l),E){m.next=3;break}return m.abrupt("return","");case 3:if(!E){m.next=11;break}if(v=JSON.parse(E),!(v.expires_time>Date.now())){m.next=9;break}return m.abrupt("return",v.access_token);case 9:return r=v.refresh_token,m.abrupt("return",g.Z.request({baseURL:p.v2.get(),method:"POST",url:"/console/v1/auth/refresh-token",data:{refresh_token:r}}).then(function(y){return j.set(y.data.data),y.data.data.access_token}).catch(function(){return j.clear(),""}));case 11:case"end":return m.stop()}},c)}))()}}},2835:function(R,P,e){e.d(P,{Cp:function(){return k},Vo:function(){return m},fn:function(){return r},o1:function(){return l},sG:function(){return b},tm:function(){return E}});var h=e(12323),s=e.n(h),M=e(63260),u=e.n(M),g=e(46639),p=e(87645);function l(d){return j.apply(this,arguments)}function j(){return j=u()(s()().mark(function d(_){var i;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,g.W)({url:"/console/v1/accounts",method:"POST",data:_});case 2:return i=a.sent,a.abrupt("return",i.data);case 4:case"end":return a.stop()}},d)})),j.apply(this,arguments)}function b(d,_){return c.apply(this,arguments)}function c(){return c=u()(s()().mark(function d(_,i){var n;return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,g.W)({url:"/console/v1/accounts/".concat(_),method:"PUT",data:i});case 2:return n=o.sent,o.abrupt("return",n.data);case 4:case"end":return o.stop()}},d)})),c.apply(this,arguments)}function E(d){return v.apply(this,arguments)}function v(){return v=u()(s()().mark(function d(_){var i;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,g.W)({url:"/console/v1/accounts/".concat(_),method:"DELETE"});case 2:return i=a.sent,a.abrupt("return",i.data);case 4:case"end":return a.stop()}},d)})),v.apply(this,arguments)}function r(){return O.apply(this,arguments)}function O(){return O=u()(s()().mark(function d(){var _,i,n,a,o;return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return _=new URL(window.location.href),i=_.searchParams.get("access_token"),n=_.searchParams.get("refresh_token"),a=_.searchParams.get("expires_in"),i&&n&&a&&p.n.set({access_token:i,refresh_token:n,expires_in:parseInt(a)}),f.next=7,(0,g.W)({url:"/console/v1/accounts/profile",method:"GET",autoMsg:!1});case 7:return o=f.sent,f.abrupt("return",o.data);case 9:case"end":return f.stop()}},d)})),O.apply(this,arguments)}function m(d){return y.apply(this,arguments)}function y(){return y=u()(s()().mark(function d(_){var i;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,g.W)({url:"/console/v1/accounts",method:"GET",params:_});case 2:return i=a.sent,a.abrupt("return",i.data);case 4:case"end":return a.stop()}},d)})),y.apply(this,arguments)}function k(d){return U.apply(this,arguments)}function U(){return U=u()(s()().mark(function d(_){var i;return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,g.W)({url:"/console/v1/accounts/change-password",method:"PUT",data:_});case 2:return i=a.sent,a.abrupt("return",i.data);case 4:case"end":return a.stop()}},d)})),U.apply(this,arguments)}},11082:function(R,P,e){e.d(P,{KK:function(){return u},bg:function(){return g},eU:function(){return M}});var h=e(46639),s=e(87645);function M(p){return(0,h.W)({method:"POST",url:"/console/v1/auth/login",data:p}).then(function(l){return s.n.set(l.data.data),l})}function u(){return(0,h.W)({method:"GET",url:"/oauth2/login/github"}).then(function(p){return p.data})}function g(){s.n.clear(),location.reload()}}}]);
