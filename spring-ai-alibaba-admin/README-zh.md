# Spring AI Alibaba Admin

> Spring AI Alibaba Repo: https://github.com/alibaba/spring-ai-alibaba
>
> Spring AI Alibaba Website: https://java2ai.com
>
> Spring AI Alibaba Website Repo: https://github.com/springaialibaba/spring-ai-alibaba-website

[English](./README.md) | ä¸­æ–‡

## é¡¹ç›®èƒŒæ™¯

Spring AI Alibaba Admin æ˜¯ä¸€ä¸ªåŸºäº Spring AI Alibaba çš„ AI Agent å¼€å‘ä¸è¯„ä¼°å¹³å°ï¼Œæ—¨åœ¨ä¸ºå¼€å‘è€…å’Œä¼ä¸šæä¾›å®Œæ•´çš„ AI Agent ç”Ÿå‘½å‘¨æœŸç®¡ç†è§£å†³æ–¹æ¡ˆã€‚å¹³å°æ”¯æŒä» Prompt å·¥ç¨‹ã€æ•°æ®é›†ç®¡ç†ã€è¯„ä¼°å™¨é…ç½®åˆ°å®éªŒæ‰§è¡Œå’Œç»“æœåˆ†æçš„å®Œæ•´å·¥ä½œæµï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ„å»ºã€æµ‹è¯•å’Œä¼˜åŒ– AI Agent åº”ç”¨ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### ğŸ¤– Prompt ç®¡ç†
- **Prompt æ¨¡æ¿ç®¡ç†**: åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ Prompt æ¨¡æ¿
- **ç‰ˆæœ¬æ§åˆ¶**: æ”¯æŒ Prompt ç‰ˆæœ¬ç®¡ç†å’Œå†å²è¿½è¸ª
- **å®æ—¶è°ƒè¯•**: æä¾› Prompt åœ¨çº¿è°ƒè¯•å’Œæµå¼å“åº”
- **ä¼šè¯ç®¡ç†**: æ”¯æŒå¤šè½®å¯¹è¯ä¼šè¯ç®¡ç†

### ğŸ“Š æ•°æ®é›†ç®¡ç†
- **æ•°æ®é›†åˆ›å»º**: æ”¯æŒå¤šç§æ ¼å¼çš„æ•°æ®é›†å¯¼å…¥å’Œåˆ›å»º
- **ç‰ˆæœ¬ç®¡ç†**: æ•°æ®é›†ç‰ˆæœ¬æ§åˆ¶å’Œå†å²ç®¡ç†
- **æ•°æ®é¡¹ç®¡ç†**: ç»†ç²’åº¦çš„æ•°æ®é¡¹å¢åˆ æ”¹æŸ¥
- **ä»é“¾è·¯è¿½è¸ªåˆ›å»º**: æ”¯æŒä» OpenTelemetry é“¾è·¯æ•°æ®åˆ›å»ºæ•°æ®é›†

### âš–ï¸ è¯„ä¼°å™¨ç®¡ç†
- **è¯„ä¼°å™¨é…ç½®**: æ”¯æŒå¤šç§è¯„ä¼°å™¨çš„åˆ›å»ºå’Œé…ç½®
- **æ¨¡æ¿ç³»ç»Ÿ**: æä¾›è¯„ä¼°å™¨æ¨¡æ¿å’Œè‡ªå®šä¹‰è¯„ä¼°é€»è¾‘
- **è°ƒè¯•åŠŸèƒ½**: æ”¯æŒè¯„ä¼°å™¨åœ¨çº¿è°ƒè¯•å’Œæµ‹è¯•
- **ç‰ˆæœ¬ç®¡ç†**: è¯„ä¼°å™¨ç‰ˆæœ¬æ§åˆ¶å’Œå‘å¸ƒç®¡ç†

### ğŸ§ª å®éªŒç®¡ç†
- **å®éªŒæ‰§è¡Œ**: è‡ªåŠ¨åŒ–æ‰§è¡Œè¯„ä¼°å®éªŒ
- **ç»“æœåˆ†æ**: è¯¦ç»†çš„å®éªŒç»“æœåˆ†æå’Œç»Ÿè®¡
- **å®éªŒæ§åˆ¶**: æ”¯æŒå®éªŒçš„å¯åŠ¨ã€åœæ­¢ã€é‡å¯å’Œåˆ é™¤
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡å®éªŒæ‰§è¡Œå’Œç»“æœå¯¹æ¯”

### ğŸ“ˆ å¯è§‚æµ‹æ€§
- **é“¾è·¯è¿½è¸ª**: é›†æˆ OpenTelemetry æä¾›å®Œæ•´çš„é“¾è·¯è¿½è¸ª
- **æœåŠ¡ç›‘æ§**: æ”¯æŒæœåŠ¡åˆ—è¡¨å’Œæ¦‚è§ˆç»Ÿè®¡
- **Trace åˆ†æ**: æä¾›è¯¦ç»†çš„ Trace è¯¦æƒ…å’Œ Span åˆ†æ

### ğŸ”§ æ¨¡å‹é…ç½®
- **å¤šæ¨¡å‹æ”¯æŒ**: æ”¯æŒ OpenAIã€DashScopeã€DeepSeek ä¸»æµ AI æ¨¡å‹
- **é…ç½®ç®¡ç†**: æ¨¡å‹å‚æ•°çš„ç»Ÿä¸€é…ç½®å’Œç®¡ç†
- **åŠ¨æ€åˆ‡æ¢**: æ”¯æŒè¿è¡Œæ—¶æ¨¡å‹é…ç½®çš„åŠ¨æ€æ›´æ–°

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

![æ•´ä½“æ¶æ„](./docs/imgs/arch.png)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- ğŸ³ **Docker** (ç”¨äºå®¹å™¨åŒ–éƒ¨ç½²) + **Docker Compose**: 2.0+
- â˜• **Java 17+** (ç”¨äºæºç è¿è¡Œ) + **Maven**: 3.8+
- ğŸŒ **AI æ¨¡å‹æä¾›å•† API å¯†é’¥**ï¼Œæ”¯æŒOpenAIã€DashScopeã€DeepSeek

### ä»æºç è¿è¡Œ

#### 1. å…‹éš†é¡¹ç›® 

```bash
git clone https://github.com/spring-ai-alibaba/spring-ai-alibaba-admin.git
cd spring-ai-alibaba-admin
```

#### 2. é…ç½®æ‚¨çš„ API å¯†é’¥
æ ¹æ®æ‚¨çš„æ¨¡å‹ä¾›åº”å•†ï¼Œä¿®æ”¹ `spring-ai-alibaba-admin-server-start/model-config.yaml` çš„æ¨¡å‹é…ç½®ã€‚
- å¦‚æœæ‚¨ä½¿ç”¨DashScopeï¼Œè¯·å‚ç…§model-config-dashscope.yamlæ¨¡ç‰ˆè¿›è¡Œé…ç½®
- å¦‚æœæ‚¨ä½¿ç”¨DeepSeekï¼Œè¯·å‚ç…§model-config-deepseek.yamlæ¨¡ç‰ˆè¿›è¡Œé…ç½®
- å¦‚æœæ‚¨ä½¿ç”¨OpenAIï¼Œè¯·å‚ç…§model-config-openai.yamlæ¨¡ç‰ˆè¿›è¡Œé…ç½®
> ğŸ’¡ **è·å–æ‚¨çš„ DashScope API å¯†é’¥**: è®¿é—® [é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°](https://bailian.console.aliyun.com/?tab=model#/api-key) è·å–å…è´¹ API å¯†é’¥ã€‚

#### 3. nacosé…ç½®ï¼ˆå¯é€‰ï¼‰
å¦‚æœæ‚¨éœ€è¦ä¿®æ”¹nacosåœ°å€ï¼Œè¯·æ›´æ–°spring-ai-alibaba-admin-server-start/src/main/resources/application.ymlæ–‡ä»¶ä¸­çš„é…ç½®
```yaml
nacos:
  server-addr: ${nacosåœ°å€}
```

### 4. å¯åŠ¨SAA Admin

æ ¹æ®æ‚¨çš„ç¯å¢ƒéœ€æ±‚ï¼Œé€‰æ‹©ä»¥ä¸‹ä¸¤ç§å¯åŠ¨æ–¹å¼ä¹‹ä¸€ï¼š

#### æ–¹å¼ä¸€ï¼šæœ€å°å¯åŠ¨æ¨¡å¼ï¼ˆæ¨èç”¨äºå¼€å‘å’Œæµ‹è¯•ï¼‰

ä»…éœ€ MySQL å³å¯å¯åŠ¨ï¼Œæ— éœ€å…¶ä»–ä¸­é—´ä»¶æœåŠ¡ã€‚

**4.1.1 å¯åŠ¨ MySQL**

æ¨èä½¿ç”¨ Docker å¿«é€Ÿå¯åŠ¨ MySQLï¼ˆæ— éœ€æœ¬åœ°å®‰è£…ï¼‰ï¼š

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼Œå¯åŠ¨ dev æ¨¡å¼ï¼ˆä»… MySQLï¼‰
make env-start MODE=dev

# æˆ–åœ¨ docker/middleware ç›®å½•ä¸‹æ‰§è¡Œ
sh docker/middleware/run.sh dev
```

> è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [docker/middleware/README.md](docker/middleware/README.md)ã€‚

å¦‚æœæ‚¨ä½¿ç”¨æœ¬åœ° MySQLï¼Œè¯·ç¡®ä¿å·²å®‰è£… MySQL 8.0+ å¹¶åˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE IF NOT EXISTS saa_admin DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

**4.1.2 é…ç½®æ•°æ®åº“è¿æ¥ï¼ˆå¯é€‰ï¼‰**

å¦‚éœ€ä¿®æ”¹æ•°æ®åº“é…ç½®ï¼Œç¼–è¾‘ `spring-ai-alibaba-admin-server-start/src/main/resources/application-minimal.yml`ï¼š

```yaml
spring:
  datasource:
    url: jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3306}/${MYSQL_DATABASE:saa_admin}
    username: ${MYSQL_USER:root}
    password: ${MYSQL_PASSWORD:your_password}
```

**4.1.3 å¯åŠ¨åç«¯æœåŠ¡**

è¿›å…¥ `spring-ai-alibaba-admin-server-start` ç›®å½•å¹¶å¯åŠ¨ï¼ˆé»˜è®¤å·²ä½¿ç”¨ minimal é…ç½®ï¼‰ï¼š

```bash
cd spring-ai-alibaba-admin-server-start
mvn spring-boot:run
```

 **æ³¨æ„**ï¼šæœ€å°æ¨¡å¼ä¸‹ä»¥ä¸‹åŠŸèƒ½ä¸å¯ç”¨ï¼š

| åŠŸèƒ½ | ç¼ºå¤±åŸå›  | å½±å“è¯´æ˜ |
 |------|---------|---------|
 | **é“¾è·¯è¿½è¸ªï¼ˆTraceï¼‰** | ä¾èµ– Elasticsearch | æ— æ³•æŸ¥çœ‹æœåŠ¡è°ƒç”¨é“¾è·¯ã€æ€§èƒ½åˆ†æå’Œæ•…éšœæ’æŸ¥ |
 | **å¯è§‚æµ‹æ€§ Dashboard** | ä¾èµ– Elasticsearch | æ— æ³•ä½¿ç”¨ Trace åˆ†æã€æœåŠ¡ç›‘æ§å’Œç»Ÿè®¡å›¾è¡¨ |
 | **æ–‡æ¡£å¼‚æ­¥ç´¢å¼•** | ä¾èµ– RocketMQ | æ–‡æ¡£ä¸Šä¼ ååŒæ­¥å¤„ç†ï¼Œå¤§æ–‡ä»¶å¯èƒ½é˜»å¡è¯·æ±‚ |
 | **åˆ†å¸ƒå¼é”** | ä¾èµ– Redis | å¤šå®ä¾‹éƒ¨ç½²æ—¶å¯èƒ½å‡ºç°å¹¶å‘é—®é¢˜ï¼ˆå•å®ä¾‹æ— å½±å“ï¼‰|
| **ç¼“å­˜æœåŠ¡** | ä¾èµ– Redis | ä½¿ç”¨æœ¬åœ°å†…å­˜ç¼“å­˜ï¼Œé‡å¯åç¼“å­˜æ•°æ®ä¸¢å¤± |
 | **Prompt åŠ¨æ€æ›´æ–°** | ä¾èµ– Nacos | æ— æ³•é€šè¿‡ Nacos å®æ—¶æ¨é€ Prompt å˜æ›´åˆ°åº”ç”¨ |
 | **Agent åº”ç”¨æ¥å…¥** | ä¾èµ– Nacos | æ— æ³•æ¥å…¥å¤–éƒ¨ Agent åº”ç”¨è¿›è¡Œè§‚æµ‹å’Œç®¡ç† |
| **é…ç½®ä¸­å¿ƒ** | ä¾èµ– Nacos | æ— æ³•ä½¿ç”¨å¤–éƒ¨åŒ–é…ç½®å’ŒåŠ¨æ€é…ç½®åˆ·æ–° |
> **é€‚ç”¨åœºæ™¯**ï¼šæœ¬åœ°å¼€å‘ã€åŠŸèƒ½æµ‹è¯•ã€æ¼”ç¤ºç¯å¢ƒ
> **ä¸é€‚ç”¨åœºæ™¯**ï¼šç”Ÿäº§ç¯å¢ƒã€å¤šå®ä¾‹éƒ¨ç½²ã€éœ€è¦å®Œæ•´å¯è§‚æµ‹æ€§çš„åœºæ™¯

#### æ–¹å¼äºŒï¼šå®Œæ•´å¯åŠ¨æ¨¡å¼ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

éœ€è¦å¯åŠ¨å…¨éƒ¨ä¸­é—´ä»¶æœåŠ¡ï¼ˆMySQLã€Elasticsearchã€Nacosã€Redisã€RocketMQï¼‰ã€‚

**4.2.1 å¯åŠ¨ä¸­é—´ä»¶æœåŠ¡**

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿›å…¥ `docker/middleware` ç›®å½•å¹¶æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼š

```bash
cd docker/middleware
sh run.sh
```

**4.2.2 å¯åŠ¨åç«¯æœåŠ¡**

è¿›å…¥ `spring-ai-alibaba-admin-server-start` ç›®å½•ï¼Œä½¿ç”¨å®Œæ•´é…ç½®å¯åŠ¨ï¼š

```bash
cd spring-ai-alibaba-admin-server-start
mvn spring-boot:run -Dspring-boot.run.arguments="--spring.profiles.active=local"
```

æˆ–ä¿®æ”¹ `application.yml` ä¸­çš„ `spring.profiles.active` ä¸º `local`ã€`dev` æˆ– `test`ã€‚
#### 4.3 å¯åŠ¨å‰ç«¯æœåŠ¡
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿›å…¥ `frontend` ç›®å½•ï¼Œé˜…è¯»å¯¹åº”çš„READMEï¼Œå®‰è£…ç›¸å…³ä¾èµ–ä»¥åŠè¿›è¡Œç¯å¢ƒé…ç½®åï¼Œå¯åŠ¨æœåŠ¡ï¼š

```bash
cd packages/main
npm run dev
```

### 5. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:8000 å³å¯ä½¿ç”¨ SAA Admin å¹³å°ã€‚

è‡³æ­¤ï¼Œæ‚¨å·²ç»å¯ä»¥åœ¨å¹³å°ä¸­å¯¹promptè¿›è¡Œç®¡ç†ã€è°ƒè¯•ã€è¯„ä¼°ã€å¯è§‚æµ‹ã€‚å¦‚æœæ‚¨æœŸæœ›Spring AI Alibaba Agentåº”ç”¨èƒ½å¤Ÿé›†æˆNacosä»¥å®ç°promptåŠ è½½ä»¥åŠåŠ¨æ€æ›´æ–°ï¼Œå¹¶ä¸”è§‚æµ‹çº¿ä¸Šçš„è¿è¡Œæƒ…å†µï¼Œå¯ä»¥å‚ç…§ç¬¬å…­æ­¥é…ç½®æ‚¨çš„ AI Agent åº”ç”¨ã€‚

### 6. è¿æ¥æ‚¨çš„ AI Agent åº”ç”¨
åœ¨æ‚¨çš„ Spring AI Alibaba Agentåº”ç”¨ä¸­ï¼Œå¼•å…¥å¦‚ä¸‹ä¾èµ–
```xml
<dependencies>
    <!-- å¼•å…¥spring ai alibaba agent nacosä»£ç†æ¨¡å— -->
    <dependency>
        <groupId>com.alibaba.cloud.ai</groupId>
        <artifactId>spring-ai-alibaba-agent-nacos</artifactId>
        <version>{spring.ai.alibaba.version}</version>
    </dependency>

    <!-- å¼•å…¥å¯è§‚æµ‹æ¨¡å— -->

    <dependency>
        <groupId>com.alibaba.cloud.ai</groupId>
        <artifactId>spring-ai-alibaba-autoconfigure-arms-observation</artifactId>
        <version>{spring.ai.alibaba.version}</version>
    </dependency>
    
    
    <!-- ç”¨äºå®ç°å„ç§ OTel ç›¸å…³ç»„ä»¶ï¼Œå¦‚ Tracerã€Exporter çš„è‡ªåŠ¨è£…è½½ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>
    
    <!-- ç”¨äºå°† micrometer äº§ç”Ÿçš„æŒ‡æ ‡æ•°æ®å¯¹æ¥åˆ° otlp æ ¼å¼ -->
    <dependency>
        <groupId>io.micrometer</groupId>
        <artifactId>micrometer-registry-otlp</artifactId>
    </dependency>
    
    <!-- ç”¨äºå°† micrometer åº•å±‚çš„é“¾è·¯è¿½è¸ª tracer æ›¿æ¢ä¸º OTel tracer -->
    <dependency>
        <groupId>io.micrometer</groupId>
        <artifactId>micrometer-tracing-bridge-otel</artifactId>
    </dependency>
    
    <!-- ç”¨äºå°† OTel tracer äº§ç”Ÿçš„ span æŒ‰ç…§ otlp åè®®è¿›è¡Œä¸ŠæŠ¥ -->
    <dependency>
        <groupId>io.opentelemetry</groupId>
        <artifactId>opentelemetry-exporter-otlp</artifactId>
    </dependency>

    <dependency>
        <groupId>org.springframework.ai</groupId>
        <artifactId>spring-ai-autoconfigure-model-tool</artifactId>
        <version>1.0.0</version>
    </dependency>
</dependencies>
``` 

æŒ‡å®šnacosåœ°å€åŠprompKey
```yaml
    spring.ai.alibaba.agent.proxy.nacos.serverAddr={ æ›¿æ¢ nacos address, ç¤ºä¾‹ï¼š127.0.0.1:8848}
    spring.ai.alibaba.agent.proxy.nacos.username={ æ›¿æ¢ nacos ç”¨æˆ·å, ç¤ºä¾‹ï¼šnacos}
    spring.ai.alibaba.agent.proxy.nacos.password={ æ›¿æ¢ nacos å¯†ç , ç¤ºä¾‹ï¼šnacos}
    spring.ai.alibaba.agent.proxy.nacos.promptKey={ æ›¿æ¢ä¸ºpromptKeyï¼Œç¤ºä¾‹ï¼šmse-nacos-helper } 
```

è®¾ç½®å¯è§‚æµ‹å‚æ•°

```yaml
    management.otlp.tracing.export.enabled=true
    management.tracing.sampling.probability=1.0
    management.otlp.tracing.endpoint=http://{admin address}:4318/v1/traces
    management.otlp.metrics.export.enabled=false
    management.otlp.logging.export.enabled=false
    management.opentelemetry.resource-attributes.service.name=agent-nacos-prompt-test
    management.opentelemetry.resource-attributes.service.version=1.0
    spring.ai.chat.client.observations.log-prompt=true
    spring.ai.chat.observations.log-prompt=true
    spring.ai.chat.observations.log-completion=true
    spring.ai.image.observations.log-prompt=true
    spring.ai.vectorstore.observations.log-query-response=true
    spring.ai.alibaba.arms.enabled=true
    spring.ai.alibaba.arms.tool.enabled=true
    spring.ai.alibaba.arms.model.capture-input=true
    spring.ai.alibaba.arms.model.capture-output=true
```

## è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº Apache License 2.0 è®¸å¯è¯å¼€æºã€‚

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥å¸®åŠ©æ”¹è¿›é¡¹ç›®ã€‚
